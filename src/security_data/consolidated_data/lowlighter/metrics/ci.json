{
  "repo_owner": "lowlighter",
  "repo_name": "metrics",
  "workflow_name": "ci",
  "history": {
    "2022-01-16T02-25-19Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9501cc77-29be-5b0e-9f04-61b3b1d89eb5",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T02-25-19Z__37db30eabffe69348c7db703f04e426f2bec8100.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1c7106fa-8cad-5918-99c4-b5405d65cded",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T02-25-19Z__37db30eabffe69348c7db703f04e426f2bec8100.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 47,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "dcc40000ca29a8d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d27ae1c4-5ffc-57c2-bdcf-454270f42dc9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T02-25-19Z__37db30eabffe69348c7db703f04e426f2bec8100.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5d77f7f3-b17d-5bb7-bb4c-51f3e94d0d98",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T02-25-19Z__37db30eabffe69348c7db703f04e426f2bec8100.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 93,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0dc92d87-c5c4-5f8a-a880-0085f50b07f2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T02-25-19Z__37db30eabffe69348c7db703f04e426f2bec8100.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 94,
                  "startColumn": 5,
                  "endLine": 123,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-31874530-40d8-536d-ad6c-4338fb0fe528",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T02-25-19Z__37db30eabffe69348c7db703f04e426f2bec8100.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 124,
                  "startColumn": 5,
                  "endLine": 139,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-19ba8db4-5109-57c7-892a-2c8ade0d00fb",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T02-25-19Z__37db30eabffe69348c7db703f04e426f2bec8100.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 140,
                  "startColumn": 5,
                  "endLine": 161,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "af4eced8b7f68796:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c422c132-40dc-5727-9592-62cef6f05840",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T02-25-19Z__37db30eabffe69348c7db703f04e426f2bec8100.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 162,
                  "startColumn": 5,
                  "endLine": 167,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ed7ef431524668f9:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-408fd9ba-7329-5cbb-9f3c-3f75ea1a3b18",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T02-25-19Z__37db30eabffe69348c7db703f04e426f2bec8100.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 168,
                  "startColumn": 5,
                  "endLine": 192,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-83f3a49d-f6e8-5946-ae1a-5ba14157b9bb",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T02-25-19Z__37db30eabffe69348c7db703f04e426f2bec8100.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 193,
                  "startColumn": 5,
                  "endLine": 207,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-25650ba9-b628-57ff-9b07-ef795315a047",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T02-25-19Z__37db30eabffe69348c7db703f04e426f2bec8100.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 208,
                  "startColumn": 5,
                  "endLine": 228,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42b1e5925e492a55:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a5e3e2a6-2321-5b1f-81c3-e62bd1fad752",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T02-25-19Z__37db30eabffe69348c7db703f04e426f2bec8100.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 229,
                  "startColumn": 5,
                  "endLine": 235,
                  "endColumn": 138
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b5f8d6b8b7e36d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-01-16T02-25-19Z__37db30eabffe69348c7db703f04e426f2bec8100.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 235,
          "num_jobs": 12,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "action-master-test": 1,
            "docker-release": 7,
            "publish-examples": 0,
            "update-latest": 7,
            "action-latest-test": 1,
            "publish-release": 4,
            "deploy-latest": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 12,
            "num_dependencies_between_jobs": 11,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "action-master-test": 1,
              "docker-release": 7,
              "publish-examples": 0,
              "update-latest": 7,
              "action-latest-test": 1,
              "publish-release": 4,
              "deploy-latest": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 30,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\nnpm run format\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true,
                  "use_prebuilt_image": false
                }
              }
            ]
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-master-test"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "docker-release"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master"
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "if": "contains(github.event.head_commit.message, '[deploy]')",
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -H 'Content-Type: application/json' --data '${{ secrets.WEB_DEPLOY_TOKEN }}' -X POST https://deploy.metrics.lecoq.io"
              }
            ]
          }
        }
      }
    },
    "2022-01-15T20-07-17Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fcce8abb-e107-5bd4-a9ba-67a0737c2add",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-15T20-07-17Z__0ea5e5b3dcb1ee95a1c045eb23ad0f71c871b8f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6db24356-0537-519c-919b-bcd3cbecaf82",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-15T20-07-17Z__0ea5e5b3dcb1ee95a1c045eb23ad0f71c871b8f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 47,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "dcc40000ca29a8d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f8a85b1f-5e46-5d8b-8fbd-89fdbf61c2a2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-15T20-07-17Z__0ea5e5b3dcb1ee95a1c045eb23ad0f71c871b8f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 5,
                  "endLine": 64,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d9302041-7472-5f55-a692-d02907df0ca3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-15T20-07-17Z__0ea5e5b3dcb1ee95a1c045eb23ad0f71c871b8f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 65,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7ebd871a-148a-54a0-bcaf-e5b71458f3c3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-15T20-07-17Z__0ea5e5b3dcb1ee95a1c045eb23ad0f71c871b8f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 117,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-260d36bb-79e8-5a5b-9538-eaefcc8bad4b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-15T20-07-17Z__0ea5e5b3dcb1ee95a1c045eb23ad0f71c871b8f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 118,
                  "startColumn": 5,
                  "endLine": 133,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c6aa29d8-2935-5d46-b04b-33632846bb48",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-15T20-07-17Z__0ea5e5b3dcb1ee95a1c045eb23ad0f71c871b8f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 134,
                  "startColumn": 5,
                  "endLine": 155,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "af4eced8b7f68796:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8ae5df8d-aa79-566b-b2f7-33d4565a4788",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-15T20-07-17Z__0ea5e5b3dcb1ee95a1c045eb23ad0f71c871b8f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 156,
                  "startColumn": 5,
                  "endLine": 161,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ed7ef431524668f9:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a1c80eb7-eda1-5b11-bb9d-7cfd3a2b4d07",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-15T20-07-17Z__0ea5e5b3dcb1ee95a1c045eb23ad0f71c871b8f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 162,
                  "startColumn": 5,
                  "endLine": 186,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d53c6434-47ba-5b3b-aec5-8f7017a4c4bc",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-15T20-07-17Z__0ea5e5b3dcb1ee95a1c045eb23ad0f71c871b8f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 187,
                  "startColumn": 5,
                  "endLine": 201,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b8b1856d-1e09-52e3-b2c9-2185f7fc445b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-15T20-07-17Z__0ea5e5b3dcb1ee95a1c045eb23ad0f71c871b8f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 202,
                  "startColumn": 5,
                  "endLine": 222,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42b1e5925e492a55:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ffc91c45-b221-5e36-9d17-1474db44ed5c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-15T20-07-17Z__0ea5e5b3dcb1ee95a1c045eb23ad0f71c871b8f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 223,
                  "startColumn": 5,
                  "endLine": 229,
                  "endColumn": 138
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b5f8d6b8b7e36d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-01-15T20-07-17Z__0ea5e5b3dcb1ee95a1c045eb23ad0f71c871b8f3.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 229,
          "num_jobs": 12,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 4,
            "update-main": 6,
            "docker-master": 6,
            "action-master-test": 1,
            "docker-release": 7,
            "publish-examples": 0,
            "update-latest": 7,
            "action-latest-test": 1,
            "publish-release": 4,
            "deploy-latest": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 12,
            "num_dependencies_between_jobs": 11,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 4,
              "update-main": 6,
              "docker-master": 6,
              "action-master-test": 1,
              "docker-release": 7,
              "publish-examples": 0,
              "update-latest": 7,
              "action-latest-test": 1,
              "publish-release": 4,
              "deploy-latest": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 29,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\nnpm run format\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true,
                  "use_prebuilt_image": false
                }
              }
            ]
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-master-test"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "docker-release"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master"
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "if": "contains(github.event.head_commit.message, '[deploy]')",
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -H 'Content-Type: application/json' --data '${{ secrets.WEB_DEPLOY_TOKEN }}' -X POST https://deploy.metrics.lecoq.io"
              }
            ]
          }
        }
      }
    },
    "2022-01-16T03-38-24Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7abb5639-e9ac-557a-b25c-cc612c462ad0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T03-38-24Z__144de2b3b0864de8509eb2bcaf30cdfaccf491e6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-884f859a-14fd-5c4d-8ae7-a8e18e057d28",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T03-38-24Z__144de2b3b0864de8509eb2bcaf30cdfaccf491e6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 47,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "dcc40000ca29a8d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-de4d9e8c-8748-59d6-ba6e-165def87e7b5",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T03-38-24Z__144de2b3b0864de8509eb2bcaf30cdfaccf491e6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5974b720-c7f0-5bf9-99c2-fdd33b9222e2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T03-38-24Z__144de2b3b0864de8509eb2bcaf30cdfaccf491e6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 93,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-461a6482-d6dd-5866-be1c-1962b4e5baf1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T03-38-24Z__144de2b3b0864de8509eb2bcaf30cdfaccf491e6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 94,
                  "startColumn": 5,
                  "endLine": 123,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d86678da-e1b9-54bc-a613-2dbcb56e24e4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T03-38-24Z__144de2b3b0864de8509eb2bcaf30cdfaccf491e6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 124,
                  "startColumn": 5,
                  "endLine": 139,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-14dd9cfe-d9e9-58cf-ad53-860153c15ab4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T03-38-24Z__144de2b3b0864de8509eb2bcaf30cdfaccf491e6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 140,
                  "startColumn": 5,
                  "endLine": 145,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "45a1394598b530e5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8c9790a4-2629-591f-a1c4-1837fe14ee15",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T03-38-24Z__144de2b3b0864de8509eb2bcaf30cdfaccf491e6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 146,
                  "startColumn": 5,
                  "endLine": 167,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "af4eced8b7f68796:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fc38d0aa-33b8-5445-b270-5c4e4cc41217",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T03-38-24Z__144de2b3b0864de8509eb2bcaf30cdfaccf491e6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 168,
                  "startColumn": 5,
                  "endLine": 192,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b8e82db4-f71c-5d16-99a8-1c7859653921",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T03-38-24Z__144de2b3b0864de8509eb2bcaf30cdfaccf491e6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 193,
                  "startColumn": 5,
                  "endLine": 207,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ad1c08c8-7b2b-5e20-8954-a2956d2a3c0b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T03-38-24Z__144de2b3b0864de8509eb2bcaf30cdfaccf491e6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 208,
                  "startColumn": 5,
                  "endLine": 228,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42b1e5925e492a55:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-67a5123b-3023-56e4-a222-4c838f3306d3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T03-38-24Z__144de2b3b0864de8509eb2bcaf30cdfaccf491e6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 229,
                  "startColumn": 5,
                  "endLine": 235,
                  "endColumn": 138
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b5f8d6b8b7e36d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-01-16T03-38-24Z__144de2b3b0864de8509eb2bcaf30cdfaccf491e6.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 235,
          "num_jobs": 12,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "action-master-test": 1,
            "publish-examples": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "publish-release": 4,
            "deploy-latest": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 12,
            "num_dependencies_between_jobs": 11,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "action-master-test": 1,
              "publish-examples": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "publish-release": 4,
              "deploy-latest": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 30,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\nnpm run format\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true,
                  "use_prebuilt_image": false
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-master-test"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "if": "contains(github.event.head_commit.message, '[deploy]')",
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -H 'Content-Type: application/json' --data '${{ secrets.WEB_DEPLOY_TOKEN }}' -X POST https://deploy.metrics.lecoq.io"
              }
            ]
          }
        }
      }
    },
    "2022-01-16T04-45-17Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-87bf5c22-e0b0-5d5a-98c4-8535106473ae",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-45-17Z__116c7ba359735699ab2d0cce3aa8353f77c40289.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a57613f8-5e20-5d79-9d9c-c18479051231",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-45-17Z__116c7ba359735699ab2d0cce3aa8353f77c40289.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 47,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "dcc40000ca29a8d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cd8fbf9c-e99b-5f10-b3f6-93c9e1ec2b56",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-45-17Z__116c7ba359735699ab2d0cce3aa8353f77c40289.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8087e297-8f07-5096-83cd-336a28c82879",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-45-17Z__116c7ba359735699ab2d0cce3aa8353f77c40289.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 93,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c5c105cb-e638-5ccc-86c4-08caefbd7f5f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-45-17Z__116c7ba359735699ab2d0cce3aa8353f77c40289.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 94,
                  "startColumn": 5,
                  "endLine": 123,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d7efc131-1fca-50b4-a0df-0f701ce43d3b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-45-17Z__116c7ba359735699ab2d0cce3aa8353f77c40289.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 124,
                  "startColumn": 5,
                  "endLine": 139,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ded90ab5-00c6-5cbd-a140-21ff47dd2b9b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-45-17Z__116c7ba359735699ab2d0cce3aa8353f77c40289.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 140,
                  "startColumn": 5,
                  "endLine": 153,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "45a1394598b530e5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4cab53e1-e754-5153-a1e5-76218fd3504d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-45-17Z__116c7ba359735699ab2d0cce3aa8353f77c40289.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 154,
                  "startColumn": 5,
                  "endLine": 175,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "af4eced8b7f68796:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2fa0d0a6-976f-59ff-b08a-78b3d69938ca",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-45-17Z__116c7ba359735699ab2d0cce3aa8353f77c40289.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 176,
                  "startColumn": 5,
                  "endLine": 200,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5ccd4636-3b81-5138-a20c-d24cbbeddf30",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-45-17Z__116c7ba359735699ab2d0cce3aa8353f77c40289.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 201,
                  "startColumn": 5,
                  "endLine": 215,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e971a6fd-046d-5b92-8506-b229cefe5985",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-45-17Z__116c7ba359735699ab2d0cce3aa8353f77c40289.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 216,
                  "startColumn": 5,
                  "endLine": 236,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42b1e5925e492a55:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-62212436-e821-532f-9d0a-e5081c9de9da",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-45-17Z__116c7ba359735699ab2d0cce3aa8353f77c40289.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 237,
                  "startColumn": 5,
                  "endLine": 243,
                  "endColumn": 138
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b5f8d6b8b7e36d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-01-16T04-45-17Z__116c7ba359735699ab2d0cce3aa8353f77c40289.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 243,
          "num_jobs": 12,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "action-master-test": 1,
            "publish-examples": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "publish-release": 4,
            "deploy-latest": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 12,
            "num_dependencies_between_jobs": 11,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "action-master-test": 1,
              "publish-examples": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "publish-release": 4,
              "deploy-latest": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 30,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\nnpm run format\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true,
                  "use_prebuilt_image": false
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}"
            }
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-master-test"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "if": "contains(github.event.head_commit.message, '[deploy]')",
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -H 'Content-Type: application/json' --data '${{ secrets.WEB_DEPLOY_TOKEN }}' -X POST https://deploy.metrics.lecoq.io"
              }
            ]
          }
        }
      }
    },
    "2022-01-16T04-54-13Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-30c2d986-d7e6-556f-bb91-6f1921c2e56e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-54-13Z__14d3e0901dc950c0005d28538c437c0bbeccd866.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-297e4750-7145-5bbe-91c9-851236353a26",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-54-13Z__14d3e0901dc950c0005d28538c437c0bbeccd866.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 48,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "d0c22439c5d612a4:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fa5fa718-91df-5fd4-8141-8e2b8527045b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-54-13Z__14d3e0901dc950c0005d28538c437c0bbeccd866.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 49,
                  "startColumn": 5,
                  "endLine": 71,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-711ba84a-5e49-55b8-96d5-9b7d01149a26",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-54-13Z__14d3e0901dc950c0005d28538c437c0bbeccd866.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 72,
                  "startColumn": 5,
                  "endLine": 94,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c34e56e4-0762-5a6b-b5de-52b114bc7fb0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-54-13Z__14d3e0901dc950c0005d28538c437c0bbeccd866.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 95,
                  "startColumn": 5,
                  "endLine": 124,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8f282559-e81b-569f-a2ec-d6f8406613b3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-54-13Z__14d3e0901dc950c0005d28538c437c0bbeccd866.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 125,
                  "startColumn": 5,
                  "endLine": 140,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c8bc487d-e19f-5217-b93a-404079f6983a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-54-13Z__14d3e0901dc950c0005d28538c437c0bbeccd866.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 141,
                  "startColumn": 5,
                  "endLine": 154,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "45a1394598b530e5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2c5fefe3-48a0-5332-af56-828ecadc31bf",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-54-13Z__14d3e0901dc950c0005d28538c437c0bbeccd866.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 155,
                  "startColumn": 5,
                  "endLine": 176,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "af4eced8b7f68796:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8668a8f1-1bdb-59d0-889b-29ef01d20e3e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-54-13Z__14d3e0901dc950c0005d28538c437c0bbeccd866.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 177,
                  "startColumn": 5,
                  "endLine": 201,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6d2ea1fc-7a64-527c-b41e-de702fc88e2d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-54-13Z__14d3e0901dc950c0005d28538c437c0bbeccd866.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 202,
                  "startColumn": 5,
                  "endLine": 216,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ee249efe-cfb0-55a9-b0dc-bb68551e0d64",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-54-13Z__14d3e0901dc950c0005d28538c437c0bbeccd866.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 217,
                  "startColumn": 5,
                  "endLine": 237,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42b1e5925e492a55:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f9078511-0301-5099-83a1-65daeee0659f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-54-13Z__14d3e0901dc950c0005d28538c437c0bbeccd866.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 238,
                  "startColumn": 5,
                  "endLine": 244,
                  "endColumn": 138
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b5f8d6b8b7e36d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-01-16T04-54-13Z__14d3e0901dc950c0005d28538c437c0bbeccd866.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 244,
          "num_jobs": 12,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "action-master-test": 1,
            "publish-examples": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "publish-release": 4,
            "deploy-latest": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 12,
            "num_dependencies_between_jobs": 11,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "action-master-test": 1,
              "publish-examples": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "publish-release": 4,
              "deploy-latest": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 30,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "${{ needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped' }}",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\nnpm run format\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true,
                  "use_prebuilt_image": false
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-master-test"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "if": "contains(github.event.head_commit.message, '[deploy]')",
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -H 'Content-Type: application/json' --data '${{ secrets.WEB_DEPLOY_TOKEN }}' -X POST https://deploy.metrics.lecoq.io"
              }
            ]
          }
        }
      }
    },
    "2022-01-16T04-50-40Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-478d879e-d4a5-537b-8bd5-ad46f7924df0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-50-40Z__07e55b85b366d084cd347fceea0fc803693e4b75.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ee3f279d-c85e-535c-9a25-a8a61ca1fe9b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-50-40Z__07e55b85b366d084cd347fceea0fc803693e4b75.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 47,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "dcc40000ca29a8d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3a64971b-01e0-5f1d-a28c-989a322f24f2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-50-40Z__07e55b85b366d084cd347fceea0fc803693e4b75.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e4182420-fc6a-5a2a-8abd-b1a9286c5661",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-50-40Z__07e55b85b366d084cd347fceea0fc803693e4b75.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 93,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1f1234da-6c49-5126-aaca-3f6b19cd6057",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-50-40Z__07e55b85b366d084cd347fceea0fc803693e4b75.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 94,
                  "startColumn": 5,
                  "endLine": 123,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2f702b53-95fe-58c9-9ec4-aa40388495de",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-50-40Z__07e55b85b366d084cd347fceea0fc803693e4b75.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 124,
                  "startColumn": 5,
                  "endLine": 139,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-53d927b9-bf6a-5ee0-a833-5a51e3ce84ce",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-50-40Z__07e55b85b366d084cd347fceea0fc803693e4b75.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 140,
                  "startColumn": 5,
                  "endLine": 153,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "45a1394598b530e5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-108b3c1a-52ad-566c-92f1-b8d0fccea99b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-50-40Z__07e55b85b366d084cd347fceea0fc803693e4b75.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 154,
                  "startColumn": 5,
                  "endLine": 175,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "af4eced8b7f68796:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bdf8baa8-2321-5e06-adce-707fe432163c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-50-40Z__07e55b85b366d084cd347fceea0fc803693e4b75.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 176,
                  "startColumn": 5,
                  "endLine": 200,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8cc4f906-e52b-50ac-80b6-56a13f4df857",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-50-40Z__07e55b85b366d084cd347fceea0fc803693e4b75.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 201,
                  "startColumn": 5,
                  "endLine": 215,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4f424322-469b-522d-8eed-b4d1d763e4bc",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-50-40Z__07e55b85b366d084cd347fceea0fc803693e4b75.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 216,
                  "startColumn": 5,
                  "endLine": 236,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42b1e5925e492a55:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b60578bb-9db3-5302-bf66-8b469180718e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-50-40Z__07e55b85b366d084cd347fceea0fc803693e4b75.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 237,
                  "startColumn": 5,
                  "endLine": 243,
                  "endColumn": 138
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b5f8d6b8b7e36d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-01-16T04-50-40Z__07e55b85b366d084cd347fceea0fc803693e4b75.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 243,
          "num_jobs": 12,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "action-master-test": 1,
            "publish-examples": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "publish-release": 4,
            "deploy-latest": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 12,
            "num_dependencies_between_jobs": 11,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "action-master-test": 1,
              "publish-examples": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "publish-release": 4,
              "deploy-latest": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 30,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\nnpm run format\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true,
                  "use_prebuilt_image": false
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-master-test"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "if": "contains(github.event.head_commit.message, '[deploy]')",
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -H 'Content-Type: application/json' --data '${{ secrets.WEB_DEPLOY_TOKEN }}' -X POST https://deploy.metrics.lecoq.io"
              }
            ]
          }
        }
      }
    },
    "2022-01-16T04-57-46Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bff4efbb-0945-5800-a345-66a978abfbcb",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-57-46Z__ad7ca8029e4889ff7d242f0f761eb4c89771d89a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-42b22cc6-e96b-500e-b36c-bb6851ea1394",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-57-46Z__ad7ca8029e4889ff7d242f0f761eb4c89771d89a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 48,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "eb67fc1eaca5f303:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a58c3598-fc06-5e9b-8680-1501cc69a010",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-57-46Z__ad7ca8029e4889ff7d242f0f761eb4c89771d89a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 49,
                  "startColumn": 5,
                  "endLine": 71,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-455936fb-a87d-5894-97ec-bdeb22d9083f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-57-46Z__ad7ca8029e4889ff7d242f0f761eb4c89771d89a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 72,
                  "startColumn": 5,
                  "endLine": 94,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-332565d6-16e9-53e8-8570-bc59e1333759",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-57-46Z__ad7ca8029e4889ff7d242f0f761eb4c89771d89a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 95,
                  "startColumn": 5,
                  "endLine": 124,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9915ba88-9c44-5d1e-97bf-a141ed79d92e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-57-46Z__ad7ca8029e4889ff7d242f0f761eb4c89771d89a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 125,
                  "startColumn": 5,
                  "endLine": 140,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3457ce96-4bdb-5383-bf08-b6a39fdf13df",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-57-46Z__ad7ca8029e4889ff7d242f0f761eb4c89771d89a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 141,
                  "startColumn": 5,
                  "endLine": 154,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "45a1394598b530e5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d65cab51-bcb1-59cc-9ae4-da669efe59bb",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-57-46Z__ad7ca8029e4889ff7d242f0f761eb4c89771d89a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 155,
                  "startColumn": 5,
                  "endLine": 176,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "af4eced8b7f68796:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9bc386a1-650e-5643-b128-64aa8844f2d8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-57-46Z__ad7ca8029e4889ff7d242f0f761eb4c89771d89a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 177,
                  "startColumn": 5,
                  "endLine": 201,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a215e174-1bbd-5248-ae41-cd49e2344351",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-57-46Z__ad7ca8029e4889ff7d242f0f761eb4c89771d89a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 202,
                  "startColumn": 5,
                  "endLine": 216,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d1447ac4-faf2-5053-8b12-01e4cd92f45f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-57-46Z__ad7ca8029e4889ff7d242f0f761eb4c89771d89a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 217,
                  "startColumn": 5,
                  "endLine": 237,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42b1e5925e492a55:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-91d8c36b-3dd1-5964-89a9-05fa2819d79c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-57-46Z__ad7ca8029e4889ff7d242f0f761eb4c89771d89a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 238,
                  "startColumn": 5,
                  "endLine": 244,
                  "endColumn": 138
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b5f8d6b8b7e36d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-01-16T04-57-46Z__ad7ca8029e4889ff7d242f0f761eb4c89771d89a.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 244,
          "num_jobs": 12,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "action-master-test": 1,
            "publish-examples": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "publish-release": 4,
            "deploy-latest": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 12,
            "num_dependencies_between_jobs": 11,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "action-master-test": 1,
              "publish-examples": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "publish-release": 4,
              "deploy-latest": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 30,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped'",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\nnpm run format\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true,
                  "use_prebuilt_image": false
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-master-test"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "if": "contains(github.event.head_commit.message, '[deploy]')",
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -H 'Content-Type: application/json' --data '${{ secrets.WEB_DEPLOY_TOKEN }}' -X POST https://deploy.metrics.lecoq.io"
              }
            ]
          }
        }
      }
    },
    "2022-01-16T04-58-35Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1f0f7ac2-5ea4-5c67-8308-68fbe5b4d524",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-58-35Z__a74d4e2dfc9f851e05d296a68d1fe1b073c7f8fd.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-88c2b40c-f1f1-5e34-a276-a2575480aa00",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-58-35Z__a74d4e2dfc9f851e05d296a68d1fe1b073c7f8fd.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 48,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b8268ac5-04f7-5ca7-af96-16df31ca36b4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-58-35Z__a74d4e2dfc9f851e05d296a68d1fe1b073c7f8fd.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 49,
                  "startColumn": 5,
                  "endLine": 71,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ee71a28c-366f-53f5-978c-5f3543d9f0a6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-58-35Z__a74d4e2dfc9f851e05d296a68d1fe1b073c7f8fd.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 72,
                  "startColumn": 5,
                  "endLine": 94,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bb7ae295-6b82-531b-8cf6-c93fd2f77220",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-58-35Z__a74d4e2dfc9f851e05d296a68d1fe1b073c7f8fd.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 95,
                  "startColumn": 5,
                  "endLine": 124,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cdb0ca11-7533-5be4-aa37-c58d62cba085",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-58-35Z__a74d4e2dfc9f851e05d296a68d1fe1b073c7f8fd.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 125,
                  "startColumn": 5,
                  "endLine": 140,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c1dff4de-0948-56b8-91a2-ed8ff454b319",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-58-35Z__a74d4e2dfc9f851e05d296a68d1fe1b073c7f8fd.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 141,
                  "startColumn": 5,
                  "endLine": 154,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "45a1394598b530e5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c23f5a4a-cba2-5be0-96a6-d09236c3accd",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-58-35Z__a74d4e2dfc9f851e05d296a68d1fe1b073c7f8fd.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 155,
                  "startColumn": 5,
                  "endLine": 176,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "af4eced8b7f68796:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9e9102ff-a47b-5acd-935a-cded285e3608",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-58-35Z__a74d4e2dfc9f851e05d296a68d1fe1b073c7f8fd.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 177,
                  "startColumn": 5,
                  "endLine": 201,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2ab5fecb-1aab-5892-b5fb-98a004839a8f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-58-35Z__a74d4e2dfc9f851e05d296a68d1fe1b073c7f8fd.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 202,
                  "startColumn": 5,
                  "endLine": 216,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-20a12ec2-8a9e-5bfb-b0b4-2fcdd710aeb0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-58-35Z__a74d4e2dfc9f851e05d296a68d1fe1b073c7f8fd.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 217,
                  "startColumn": 5,
                  "endLine": 237,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42b1e5925e492a55:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e45e57cb-cb69-57fd-9580-3f96c7a91536",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-16T04-58-35Z__a74d4e2dfc9f851e05d296a68d1fe1b073c7f8fd.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 238,
                  "startColumn": 5,
                  "endLine": 244,
                  "endColumn": 138
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b5f8d6b8b7e36d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-01-16T04-58-35Z__a74d4e2dfc9f851e05d296a68d1fe1b073c7f8fd.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 244,
          "num_jobs": 12,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "action-master-test": 1,
            "publish-examples": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "publish-release": 4,
            "deploy-latest": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 12,
            "num_dependencies_between_jobs": 11,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "action-master-test": 1,
              "publish-examples": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "publish-release": 4,
              "deploy-latest": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 30,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\nnpm run format\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true,
                  "use_prebuilt_image": false
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-master-test"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "if": "contains(github.event.head_commit.message, '[deploy]')",
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -H 'Content-Type: application/json' --data '${{ secrets.WEB_DEPLOY_TOKEN }}' -X POST https://deploy.metrics.lecoq.io"
              }
            ]
          }
        }
      }
    },
    "2022-01-17T04-37-37Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-381b4728-1d1e-5a0a-9ed3-92fead835e51",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-17T04-37-37Z__1f5e6da19c7aff099124cb8f7d3036515db73e8c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-23ba09b0-a5a1-5e77-9e8f-d4e95ffc8eff",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-17T04-37-37Z__1f5e6da19c7aff099124cb8f7d3036515db73e8c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 48,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f817f4a2-52b9-582f-8ce8-aa76c9dfbb72",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-17T04-37-37Z__1f5e6da19c7aff099124cb8f7d3036515db73e8c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 49,
                  "startColumn": 5,
                  "endLine": 71,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8a3aa98d-e91c-547d-aeae-e2be08f5cdfe",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-17T04-37-37Z__1f5e6da19c7aff099124cb8f7d3036515db73e8c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 72,
                  "startColumn": 5,
                  "endLine": 94,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-396cc9b2-a34f-5c61-a9f0-08e289b43df3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-17T04-37-37Z__1f5e6da19c7aff099124cb8f7d3036515db73e8c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 95,
                  "startColumn": 5,
                  "endLine": 124,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cc980c82-7044-55fd-ae76-3654f2bc03d9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-17T04-37-37Z__1f5e6da19c7aff099124cb8f7d3036515db73e8c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 125,
                  "startColumn": 5,
                  "endLine": 140,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2ac88e33-84fd-5ea1-96c1-129b175d715a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-17T04-37-37Z__1f5e6da19c7aff099124cb8f7d3036515db73e8c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 141,
                  "startColumn": 5,
                  "endLine": 154,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "45a1394598b530e5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d1c425db-4153-54cf-a3f0-22797fa3ac87",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-17T04-37-37Z__1f5e6da19c7aff099124cb8f7d3036515db73e8c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 155,
                  "startColumn": 5,
                  "endLine": 176,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "af4eced8b7f68796:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0730f542-ffc2-554e-add5-a93dbe836967",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-17T04-37-37Z__1f5e6da19c7aff099124cb8f7d3036515db73e8c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 177,
                  "startColumn": 5,
                  "endLine": 201,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b90a92e7e2f9e2a5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-680d0217-1623-5240-aa25-4e6a5f3b7095",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-17T04-37-37Z__1f5e6da19c7aff099124cb8f7d3036515db73e8c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 202,
                  "startColumn": 5,
                  "endLine": 216,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2e4898ab-d99c-53e7-ac92-82a6c506120c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-17T04-37-37Z__1f5e6da19c7aff099124cb8f7d3036515db73e8c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 217,
                  "startColumn": 5,
                  "endLine": 237,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42b1e5925e492a55:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-76cd0a00-3396-5693-b65e-6d4d6f35cd00",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-17T04-37-37Z__1f5e6da19c7aff099124cb8f7d3036515db73e8c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 238,
                  "startColumn": 5,
                  "endLine": 244,
                  "endColumn": 138
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b5f8d6b8b7e36d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-01-17T04-37-37Z__1f5e6da19c7aff099124cb8f7d3036515db73e8c.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 244,
          "num_jobs": 12,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "action-master-test": 1,
            "publish-examples": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "publish-release": 4,
            "deploy-latest": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 12,
            "num_dependencies_between_jobs": 12,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "action-master-test": 1,
              "publish-examples": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "publish-release": 4,
              "deploy-latest": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 30,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\nnpm run format\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true,
                  "use_prebuilt_image": false
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-master-test"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "publish-examples"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "if": "contains(github.event.head_commit.message, '[deploy]')",
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -H 'Content-Type: application/json' --data '${{ secrets.WEB_DEPLOY_TOKEN }}' -X POST https://deploy.metrics.lecoq.io"
              }
            ]
          }
        }
      }
    },
    "2022-01-18T03-33-49Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1ac0c485-3759-5922-b022-8b56e24c2e8c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-18T03-33-49Z__2c8c691f53d6376214fcfb8f2de6817d40b1b036.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-42aaeeb7-7a17-54a3-aaed-65aa77d04b55",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-18T03-33-49Z__2c8c691f53d6376214fcfb8f2de6817d40b1b036.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 48,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2a874f7d-b5f5-5d66-8f89-4eacca09e0d0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-18T03-33-49Z__2c8c691f53d6376214fcfb8f2de6817d40b1b036.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 49,
                  "startColumn": 5,
                  "endLine": 71,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f65bc3bd-9ffe-52ad-ae78-b5f28f9f3a7d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-18T03-33-49Z__2c8c691f53d6376214fcfb8f2de6817d40b1b036.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 72,
                  "startColumn": 5,
                  "endLine": 94,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f745b49d-d92a-58e3-ac31-9ac2d31cbc0b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-18T03-33-49Z__2c8c691f53d6376214fcfb8f2de6817d40b1b036.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 95,
                  "startColumn": 5,
                  "endLine": 124,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7a8e19b0-6866-544e-aaf9-1669e28fb4dd",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-18T03-33-49Z__2c8c691f53d6376214fcfb8f2de6817d40b1b036.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 125,
                  "startColumn": 5,
                  "endLine": 140,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-19719892-8f87-507d-bfdc-25edad2694d9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-18T03-33-49Z__2c8c691f53d6376214fcfb8f2de6817d40b1b036.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 141,
                  "startColumn": 5,
                  "endLine": 154,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "45a1394598b530e5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a52de42e-d304-586a-a341-c54c2c63a187",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-18T03-33-49Z__2c8c691f53d6376214fcfb8f2de6817d40b1b036.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 155,
                  "startColumn": 5,
                  "endLine": 176,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "46b9cd5181bd659e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-56e98eb2-a242-5a55-9a32-d430d0d44ef3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-18T03-33-49Z__2c8c691f53d6376214fcfb8f2de6817d40b1b036.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 177,
                  "startColumn": 5,
                  "endLine": 201,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b90a92e7e2f9e2a5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-59bf74dc-3f86-5731-a2b6-2d958de6e4e7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-18T03-33-49Z__2c8c691f53d6376214fcfb8f2de6817d40b1b036.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 202,
                  "startColumn": 5,
                  "endLine": 216,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2d2ca903-d8cc-5d3d-a944-c91ff2d25582",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-18T03-33-49Z__2c8c691f53d6376214fcfb8f2de6817d40b1b036.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 217,
                  "startColumn": 5,
                  "endLine": 237,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42b1e5925e492a55:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-31e28e1b-5732-5d16-bd48-daa9bcab7f59",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-18T03-33-49Z__2c8c691f53d6376214fcfb8f2de6817d40b1b036.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 238,
                  "startColumn": 5,
                  "endLine": 244,
                  "endColumn": 138
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b5f8d6b8b7e36d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-01-18T03-33-49Z__2c8c691f53d6376214fcfb8f2de6817d40b1b036.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 244,
          "num_jobs": 12,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "action-master-test": 1,
            "publish-examples": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "publish-release": 4,
            "deploy-latest": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 12,
            "num_dependencies_between_jobs": 13,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "action-master-test": 1,
              "publish-examples": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "publish-release": 4,
              "deploy-latest": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 30,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\nnpm run format\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true,
                  "use_prebuilt_image": false
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-master-test",
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "publish-examples"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "if": "contains(github.event.head_commit.message, '[deploy]')",
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -H 'Content-Type: application/json' --data '${{ secrets.WEB_DEPLOY_TOKEN }}' -X POST https://deploy.metrics.lecoq.io"
              }
            ]
          }
        }
      }
    },
    "2022-01-27T02-52-07Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-efefa1d4-0260-5073-8abc-40293d2c2a4a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-27T02-52-07Z__cba76f174899b77e1bd6cbe71cfc191047e3784a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d3403e1b-1561-5782-adfa-a5a9126f5ee3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-27T02-52-07Z__cba76f174899b77e1bd6cbe71cfc191047e3784a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 48,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7496439f-416e-5282-a0fd-d9b09a8848a7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-27T02-52-07Z__cba76f174899b77e1bd6cbe71cfc191047e3784a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 49,
                  "startColumn": 5,
                  "endLine": 71,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8c9ea183-59cf-5ad3-b41f-af45d7dae276",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-27T02-52-07Z__cba76f174899b77e1bd6cbe71cfc191047e3784a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 72,
                  "startColumn": 5,
                  "endLine": 94,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7a80b098-41a3-5cd2-9727-f7752e362343",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-27T02-52-07Z__cba76f174899b77e1bd6cbe71cfc191047e3784a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 95,
                  "startColumn": 5,
                  "endLine": 124,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ae4e9886-f0d4-5fa6-a3cd-6fd064d7899b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-27T02-52-07Z__cba76f174899b77e1bd6cbe71cfc191047e3784a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 125,
                  "startColumn": 5,
                  "endLine": 140,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e674babe-f6cd-5ae2-8a53-c884e39b3b7b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-27T02-52-07Z__cba76f174899b77e1bd6cbe71cfc191047e3784a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 141,
                  "startColumn": 5,
                  "endLine": 154,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "45a1394598b530e5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4fc4fe4f-7602-596a-9eb8-bba026377b48",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-27T02-52-07Z__cba76f174899b77e1bd6cbe71cfc191047e3784a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 155,
                  "startColumn": 5,
                  "endLine": 160,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "d6d0c5f0192773d2:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-88767c5f-a29b-55c7-a45f-fa6578903d1e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-27T02-52-07Z__cba76f174899b77e1bd6cbe71cfc191047e3784a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 161,
                  "startColumn": 5,
                  "endLine": 182,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "46b9cd5181bd659e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7b42cde8-84fb-5616-866c-4447bfc5cfa1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-27T02-52-07Z__cba76f174899b77e1bd6cbe71cfc191047e3784a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 183,
                  "startColumn": 5,
                  "endLine": 207,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b90a92e7e2f9e2a5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9920082e-77c1-50fa-a225-6e798d2dab35",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-27T02-52-07Z__cba76f174899b77e1bd6cbe71cfc191047e3784a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 208,
                  "startColumn": 5,
                  "endLine": 222,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ae51a2cb-1887-591a-8308-174e2c56b848",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-27T02-52-07Z__cba76f174899b77e1bd6cbe71cfc191047e3784a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 223,
                  "startColumn": 5,
                  "endLine": 243,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42b1e5925e492a55:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-40b9e3aa-92b3-5fee-bd6e-5d5397fb289c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-01-27T02-52-07Z__cba76f174899b77e1bd6cbe71cfc191047e3784a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 244,
                  "startColumn": 5,
                  "endLine": 250,
                  "endColumn": 138
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b5f8d6b8b7e36d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-01-27T02-52-07Z__cba76f174899b77e1bd6cbe71cfc191047e3784a.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 250,
          "num_jobs": 13,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "publish-release": 4,
            "deploy-latest": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 13,
            "num_dependencies_between_jobs": 14,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "publish-release": 4,
              "deploy-latest": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 30,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\nnpm run format\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true,
                  "use_prebuilt_image": false
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-master-test",
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "publish-examples"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "if": "contains(github.event.head_commit.message, '[deploy]')",
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -H 'Content-Type: application/json' --data '${{ secrets.WEB_DEPLOY_TOKEN }}' -X POST https://deploy.metrics.lecoq.io"
              }
            ]
          }
        }
      }
    },
    "2022-03-24T04-27-56Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3ace974b-151a-5bff-a84e-cd253c5c866d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-24T04-27-56Z__de0e963a735fc17ed1d30d389118d1ec933ce673.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-578db876-b9ff-51f8-bd33-fd6f0275ef13",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-24T04-27-56Z__de0e963a735fc17ed1d30d389118d1ec933ce673.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 48,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2ac6602d-df2a-5da0-98db-97a756f331ee",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-24T04-27-56Z__de0e963a735fc17ed1d30d389118d1ec933ce673.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 49,
                  "startColumn": 5,
                  "endLine": 71,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-833459e1-afbb-5a8c-b7c6-754568d55b78",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-24T04-27-56Z__de0e963a735fc17ed1d30d389118d1ec933ce673.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 72,
                  "startColumn": 5,
                  "endLine": 94,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ce74d514-80c0-5c92-ba2f-8343d76dea88",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-24T04-27-56Z__de0e963a735fc17ed1d30d389118d1ec933ce673.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 95,
                  "startColumn": 5,
                  "endLine": 124,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-49315f29-f732-57dd-bab4-ec0eb15dc39f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-24T04-27-56Z__de0e963a735fc17ed1d30d389118d1ec933ce673.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 125,
                  "startColumn": 5,
                  "endLine": 139,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a47f2806-df62-5b78-a845-b03aaf5bd40d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-24T04-27-56Z__de0e963a735fc17ed1d30d389118d1ec933ce673.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 140,
                  "startColumn": 5,
                  "endLine": 153,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "45a1394598b530e5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bb919949-c9f9-5122-8034-090d92f88e98",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-24T04-27-56Z__de0e963a735fc17ed1d30d389118d1ec933ce673.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 154,
                  "startColumn": 5,
                  "endLine": 159,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "d6d0c5f0192773d2:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6c9f26d5-1fc1-5c58-a5c9-ad1c0738d435",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-24T04-27-56Z__de0e963a735fc17ed1d30d389118d1ec933ce673.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 160,
                  "startColumn": 5,
                  "endLine": 181,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "46b9cd5181bd659e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-47f48149-6c46-5073-a041-f434e0ca56e9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-24T04-27-56Z__de0e963a735fc17ed1d30d389118d1ec933ce673.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 182,
                  "startColumn": 5,
                  "endLine": 206,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b90a92e7e2f9e2a5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4fbbd21a-ff40-5b97-9c71-30d54cc1880c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-24T04-27-56Z__de0e963a735fc17ed1d30d389118d1ec933ce673.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 207,
                  "startColumn": 5,
                  "endLine": 221,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ac6d8373-dd57-55da-bf41-4c44711e9ae3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-24T04-27-56Z__de0e963a735fc17ed1d30d389118d1ec933ce673.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 222,
                  "startColumn": 5,
                  "endLine": 242,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42b1e5925e492a55:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5d20aa47-4f58-5398-b602-9882af8a4578",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-24T04-27-56Z__de0e963a735fc17ed1d30d389118d1ec933ce673.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 243,
                  "startColumn": 5,
                  "endLine": 249,
                  "endColumn": 138
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b5f8d6b8b7e36d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-03-24T04-27-56Z__de0e963a735fc17ed1d30d389118d1ec933ce673.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 249,
          "num_jobs": 13,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "publish-release": 4,
            "deploy-latest": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 13,
            "num_dependencies_between_jobs": 14,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "publish-release": 4,
              "deploy-latest": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 30,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\nnpm run format\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-master-test",
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "publish-examples"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "if": "contains(github.event.head_commit.message, '[deploy]')",
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -H 'Content-Type: application/json' --data '${{ secrets.WEB_DEPLOY_TOKEN }}' -X POST https://deploy.metrics.lecoq.io"
              }
            ]
          }
        }
      }
    },
    "2022-04-23T15-02-06Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-005e09a5-0216-58fa-ae38-ecb7da931a14",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-23T15-02-06Z__683df66ffa5542b04822d0d86c0d78a3a64d68bc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7bda4a1c-0cbe-55fd-ab01-3f26075ecbad",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-23T15-02-06Z__683df66ffa5542b04822d0d86c0d78a3a64d68bc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 47,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9f4646d4-c0be-54d0-b6f7-407b8c8b3874",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-23T15-02-06Z__683df66ffa5542b04822d0d86c0d78a3a64d68bc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1b7f6aa1-1700-5220-9d91-ec78e174e8a7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-23T15-02-06Z__683df66ffa5542b04822d0d86c0d78a3a64d68bc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 93,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0a68c13d-8f3c-547e-a91e-53d12182c3a1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-23T15-02-06Z__683df66ffa5542b04822d0d86c0d78a3a64d68bc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 94,
                  "startColumn": 5,
                  "endLine": 123,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d1ec089d-33b1-5c39-8058-d1ded2e231cc",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-23T15-02-06Z__683df66ffa5542b04822d0d86c0d78a3a64d68bc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 124,
                  "startColumn": 5,
                  "endLine": 138,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cfc02e44-e8cf-53b4-b939-4117346e7260",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-23T15-02-06Z__683df66ffa5542b04822d0d86c0d78a3a64d68bc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 139,
                  "startColumn": 5,
                  "endLine": 152,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "45a1394598b530e5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-960bedee-3232-5fe1-8d48-448a829f51d2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-23T15-02-06Z__683df66ffa5542b04822d0d86c0d78a3a64d68bc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 153,
                  "startColumn": 5,
                  "endLine": 158,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "d6d0c5f0192773d2:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a2ab6e48-010c-5d69-a8e2-aa16b3bf77a2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-23T15-02-06Z__683df66ffa5542b04822d0d86c0d78a3a64d68bc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 159,
                  "startColumn": 5,
                  "endLine": 180,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "46b9cd5181bd659e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-81b42869-22c3-5ea8-a717-cb67edd5e5f0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-23T15-02-06Z__683df66ffa5542b04822d0d86c0d78a3a64d68bc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 181,
                  "startColumn": 5,
                  "endLine": 205,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b90a92e7e2f9e2a5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ff46e718-cd5d-56aa-8a7d-fa412b2411cb",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-23T15-02-06Z__683df66ffa5542b04822d0d86c0d78a3a64d68bc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 206,
                  "startColumn": 5,
                  "endLine": 220,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c8d63fd6-6192-54e9-98eb-6db771f59dff",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-23T15-02-06Z__683df66ffa5542b04822d0d86c0d78a3a64d68bc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 221,
                  "startColumn": 5,
                  "endLine": 241,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42b1e5925e492a55:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2f52e576-9c4f-55a1-9fe0-4783da1779c7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-23T15-02-06Z__683df66ffa5542b04822d0d86c0d78a3a64d68bc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 242,
                  "startColumn": 5,
                  "endLine": 248,
                  "endColumn": 138
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b5f8d6b8b7e36d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-04-23T15-02-06Z__683df66ffa5542b04822d0d86c0d78a3a64d68bc.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 248,
          "num_jobs": 13,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "publish-release": 4,
            "deploy-latest": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 13,
            "num_dependencies_between_jobs": 14,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "publish-release": 4,
              "deploy-latest": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 30,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-master-test",
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "publish-examples"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "if": "contains(github.event.head_commit.message, '[deploy]')",
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -H 'Content-Type: application/json' --data '${{ secrets.WEB_DEPLOY_TOKEN }}' -X POST https://deploy.metrics.lecoq.io"
              }
            ]
          }
        }
      }
    },
    "2022-04-24T15-50-20Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-88f2b3e7-006c-5b7f-9037-f8f90f4f287c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-24T15-50-20Z__9bdacb93832bb2848bda4c6fb5f04256a05b39b8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-341963c7-7e31-5ae2-b2cf-574a36a88514",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-24T15-50-20Z__9bdacb93832bb2848bda4c6fb5f04256a05b39b8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 47,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-09f92dd9-a080-58e2-b731-902b74216c0e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-24T15-50-20Z__9bdacb93832bb2848bda4c6fb5f04256a05b39b8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-43c7e56f-a8d6-5aba-b6ce-34253c606e1f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-24T15-50-20Z__9bdacb93832bb2848bda4c6fb5f04256a05b39b8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 93,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2cbd2f76-34e9-572e-90e6-0d704cf42399",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-24T15-50-20Z__9bdacb93832bb2848bda4c6fb5f04256a05b39b8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 94,
                  "startColumn": 5,
                  "endLine": 123,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-76db74e3-568a-5781-94a3-6dbff2da4c34",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-24T15-50-20Z__9bdacb93832bb2848bda4c6fb5f04256a05b39b8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 124,
                  "startColumn": 5,
                  "endLine": 138,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e7f9f8f2-8088-5e5e-8058-de8c3f5963cf",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-24T15-50-20Z__9bdacb93832bb2848bda4c6fb5f04256a05b39b8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 139,
                  "startColumn": 5,
                  "endLine": 153,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "45a1394598b530e5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c766bdc9-2859-55fb-82ef-6cc621c1c516",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-24T15-50-20Z__9bdacb93832bb2848bda4c6fb5f04256a05b39b8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 154,
                  "startColumn": 5,
                  "endLine": 159,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "d6d0c5f0192773d2:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-25b353ce-e881-553b-86de-ff92defe91fd",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-24T15-50-20Z__9bdacb93832bb2848bda4c6fb5f04256a05b39b8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 160,
                  "startColumn": 5,
                  "endLine": 181,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "46b9cd5181bd659e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-444da9a1-e1dd-5ce2-9d7e-261753f97c65",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-24T15-50-20Z__9bdacb93832bb2848bda4c6fb5f04256a05b39b8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 182,
                  "startColumn": 5,
                  "endLine": 206,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b90a92e7e2f9e2a5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a453c1e5-5b7e-52d7-aeb7-d8bd6d5e4a9f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-24T15-50-20Z__9bdacb93832bb2848bda4c6fb5f04256a05b39b8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 207,
                  "startColumn": 5,
                  "endLine": 221,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ba695977-6754-5cdd-9f2c-0e09861875f7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-24T15-50-20Z__9bdacb93832bb2848bda4c6fb5f04256a05b39b8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 222,
                  "startColumn": 5,
                  "endLine": 242,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42b1e5925e492a55:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cf07fdcc-3ca7-55b2-91d3-ed7885b0de68",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-24T15-50-20Z__9bdacb93832bb2848bda4c6fb5f04256a05b39b8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 243,
                  "startColumn": 5,
                  "endLine": 249,
                  "endColumn": 138
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b5f8d6b8b7e36d:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-04-24T15-50-20Z__9bdacb93832bb2848bda4c6fb5f04256a05b39b8.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 249,
          "num_jobs": 13,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "publish-release": 4,
            "deploy-latest": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 13,
            "num_dependencies_between_jobs": 14,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "publish-release": 4,
              "deploy-latest": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 30,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "METRICS_TOKEN_PERSONAL": "${{ secrets.METRICS_TOKEN_PERSONAL }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-master-test",
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "publish-examples"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test"
            ],
            "if": "contains(github.event.head_commit.message, '[deploy]')",
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -H 'Content-Type: application/json' --data '${{ secrets.WEB_DEPLOY_TOKEN }}' -X POST https://deploy.metrics.lecoq.io"
              }
            ]
          }
        }
      }
    },
    "2022-07-07T04-30-41Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5e336167-7397-536d-b267-02d4b6b654ef",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-07T04-30-41Z__1d978c18d1c8cb86e302a7223b4f7610a492f323.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-03e95bcc-b999-5bcc-95bd-cc0c0fe2ce76",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-07T04-30-41Z__1d978c18d1c8cb86e302a7223b4f7610a492f323.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 47,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f3d7c1d3-6f15-5e35-a9ec-f6fa56170ef0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-07T04-30-41Z__1d978c18d1c8cb86e302a7223b4f7610a492f323.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-51fc2272-18b0-52bd-ac50-9207eb1c9e98",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-07T04-30-41Z__1d978c18d1c8cb86e302a7223b4f7610a492f323.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 93,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cd372a1d-f4ca-5a27-b471-4fef0f876570",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-07T04-30-41Z__1d978c18d1c8cb86e302a7223b4f7610a492f323.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 94,
                  "startColumn": 5,
                  "endLine": 123,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fbdf968e-92b4-580a-8551-2dbc87932ebd",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-07T04-30-41Z__1d978c18d1c8cb86e302a7223b4f7610a492f323.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 124,
                  "startColumn": 5,
                  "endLine": 138,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ccfd5719-798b-5f0a-928b-7bea20b8d2bd",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-07T04-30-41Z__1d978c18d1c8cb86e302a7223b4f7610a492f323.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 139,
                  "startColumn": 5,
                  "endLine": 153,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "45a1394598b530e5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-269686ec-c53d-56bf-9eb3-bad0f2a719c8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-07T04-30-41Z__1d978c18d1c8cb86e302a7223b4f7610a492f323.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 154,
                  "startColumn": 5,
                  "endLine": 159,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "d6d0c5f0192773d2:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1b61f41a-2952-59b3-bd0f-34877edad526",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-07T04-30-41Z__1d978c18d1c8cb86e302a7223b4f7610a492f323.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 160,
                  "startColumn": 5,
                  "endLine": 181,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "46b9cd5181bd659e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-64827a1e-7d34-5eef-b845-4ae348836517",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-07T04-30-41Z__1d978c18d1c8cb86e302a7223b4f7610a492f323.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 182,
                  "startColumn": 5,
                  "endLine": 206,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b90a92e7e2f9e2a5:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2ec67deb-7c6d-5ece-b03b-a0dba166bad1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-07T04-30-41Z__1d978c18d1c8cb86e302a7223b4f7610a492f323.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 207,
                  "startColumn": 5,
                  "endLine": 221,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8c560ab4-0455-562d-91e4-0bbbe8c77ddf",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-07T04-30-41Z__1d978c18d1c8cb86e302a7223b4f7610a492f323.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 222,
                  "startColumn": 5,
                  "endLine": 230,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ec81d1df905503fd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7b854ca5-d5a2-5630-8d61-c58d5ce69d0b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-07T04-30-41Z__1d978c18d1c8cb86e302a7223b4f7610a492f323.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 231,
                  "startColumn": 5,
                  "endLine": 248,
                  "endColumn": 74
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4332dc8635f3a291:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-07-07T04-30-41Z__1d978c18d1c8cb86e302a7223b4f7610a492f323.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 248,
          "num_jobs": 13,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "deploy-latest": 1,
            "publish-release": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 13,
            "num_dependencies_between_jobs": 15,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "deploy-latest": 1,
              "publish-release": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 30,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "METRICS_TOKEN_PERSONAL": "${{ secrets.METRICS_TOKEN_PERSONAL }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "docker-master"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-master-test",
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "publish-examples"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_TOKEN }}' https://metrics.lecoq.io/.control/stop"
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test",
              "deploy-latest"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          }
        }
      }
    },
    "2022-07-12T01-29-10Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2ed64060-4dbc-5d07-900a-daaff67f2cad",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-12T01-29-10Z__0d8dde56141adfb5538ccc87cf291483d96532a9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c3c0312b-2f10-58d2-84c5-cc40e95f129a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-12T01-29-10Z__0d8dde56141adfb5538ccc87cf291483d96532a9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 47,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d1e4920a-b01a-5651-a01e-3bc3a8ae33a2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-12T01-29-10Z__0d8dde56141adfb5538ccc87cf291483d96532a9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e27cb794-fd23-5441-a371-98a86d6ce752",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-12T01-29-10Z__0d8dde56141adfb5538ccc87cf291483d96532a9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 93,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-19d1cce0-6911-5db2-b44a-6ae7f1ea4b6c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-12T01-29-10Z__0d8dde56141adfb5538ccc87cf291483d96532a9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 94,
                  "startColumn": 5,
                  "endLine": 123,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3785700f-63e3-5398-a7a9-22f124f9ae0a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-12T01-29-10Z__0d8dde56141adfb5538ccc87cf291483d96532a9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 124,
                  "startColumn": 5,
                  "endLine": 136,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4a75ab6a8cede150:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1f4b51d1-946f-57c0-b451-3aaad352f130",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-12T01-29-10Z__0d8dde56141adfb5538ccc87cf291483d96532a9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 137,
                  "startColumn": 5,
                  "endLine": 151,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0da012a5-9167-54b9-a32b-d069a971dc3c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-12T01-29-10Z__0d8dde56141adfb5538ccc87cf291483d96532a9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 152,
                  "startColumn": 5,
                  "endLine": 166,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3379647c39fd2439:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0a56de0e-6b66-5021-9b64-684660655956",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-12T01-29-10Z__0d8dde56141adfb5538ccc87cf291483d96532a9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 167,
                  "startColumn": 5,
                  "endLine": 172,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56a754f69fb876e3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9a448f44-3a4a-573c-94f4-a5c681ca1b98",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-12T01-29-10Z__0d8dde56141adfb5538ccc87cf291483d96532a9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 173,
                  "startColumn": 5,
                  "endLine": 194,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "cc8881d570db4f02:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0ff55ee1-28cc-5bf4-8e28-a4de4ba5f76f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-12T01-29-10Z__0d8dde56141adfb5538ccc87cf291483d96532a9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 195,
                  "startColumn": 5,
                  "endLine": 219,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5a3150b3-3603-5dea-a426-2242a5cae2fb",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-12T01-29-10Z__0d8dde56141adfb5538ccc87cf291483d96532a9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 220,
                  "startColumn": 5,
                  "endLine": 234,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-285c25bd-7e07-53fd-a393-5aecec74a7a6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-12T01-29-10Z__0d8dde56141adfb5538ccc87cf291483d96532a9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 235,
                  "startColumn": 5,
                  "endLine": 247,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3e53ae5143cadd0c:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ffa3484a-02bc-5311-8c62-6f5ab6173c99",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-12T01-29-10Z__0d8dde56141adfb5538ccc87cf291483d96532a9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 248,
                  "startColumn": 5,
                  "endLine": 265,
                  "endColumn": 74
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4332dc8635f3a291:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-07-12T01-29-10Z__0d8dde56141adfb5538ccc87cf291483d96532a9.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 265,
          "num_jobs": 14,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "deploy-master": 3,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "deploy-latest": 3,
            "publish-release": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 14,
            "num_dependencies_between_jobs": 15,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "deploy-master": 3,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "deploy-latest": 3,
              "publish-release": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 35,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "deploy-master": {
            "name": "Deploy lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_BETA_TOKEN }}' https://beta-metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://beta-metrics.lecoq.io/.version"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "METRICS_TOKEN_PERSONAL": "${{ secrets.METRICS_TOKEN_PERSONAL }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "deploy-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_TOKEN }}' https://metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://metrics.lecoq.io/.version"
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test",
              "deploy-latest"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          }
        }
      }
    },
    "2022-07-21T19-09-44Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2c48c213-ae4a-5fc2-a86f-137be94b73ea",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-21T19-09-44Z__6720308f0fceee38734771f04a344840856b00ad.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e9805da3-a71a-50da-864d-1d8839445b93",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-21T19-09-44Z__6720308f0fceee38734771f04a344840856b00ad.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 47,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9b2031c3-3ff9-5942-9723-0610dfb70f41",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-21T19-09-44Z__6720308f0fceee38734771f04a344840856b00ad.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8017f02c-cf77-5dca-9550-81b703862eac",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-21T19-09-44Z__6720308f0fceee38734771f04a344840856b00ad.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 93,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f3a8a112-f802-5033-97b3-ddeb2fc02528",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-21T19-09-44Z__6720308f0fceee38734771f04a344840856b00ad.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 94,
                  "startColumn": 5,
                  "endLine": 123,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4acdfeb6-61ed-5453-a70b-26cc35e579da",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-21T19-09-44Z__6720308f0fceee38734771f04a344840856b00ad.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 124,
                  "startColumn": 5,
                  "endLine": 136,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4a75ab6a8cede150:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-600a1fb0-1892-5f93-8e24-1493068139c7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-21T19-09-44Z__6720308f0fceee38734771f04a344840856b00ad.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 137,
                  "startColumn": 5,
                  "endLine": 151,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e81972bf-2ed2-5145-8045-5ca05e9be03b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-21T19-09-44Z__6720308f0fceee38734771f04a344840856b00ad.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 152,
                  "startColumn": 5,
                  "endLine": 167,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3379647c39fd2439:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-debee353-0673-567e-a5ab-31d480f63c8b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-21T19-09-44Z__6720308f0fceee38734771f04a344840856b00ad.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 168,
                  "startColumn": 5,
                  "endLine": 173,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56a754f69fb876e3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d1e5e7ae-92a6-5697-a43a-c3c664e653da",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-21T19-09-44Z__6720308f0fceee38734771f04a344840856b00ad.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 174,
                  "startColumn": 5,
                  "endLine": 195,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "cc8881d570db4f02:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a77a9071-ac52-542b-9223-9afc34198fe9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-21T19-09-44Z__6720308f0fceee38734771f04a344840856b00ad.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 196,
                  "startColumn": 5,
                  "endLine": 220,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8a5e192e-3354-5a7f-8b85-2aa734464a9b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-21T19-09-44Z__6720308f0fceee38734771f04a344840856b00ad.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 221,
                  "startColumn": 5,
                  "endLine": 235,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-42d37cf5-57b8-5ccf-b750-da4fc40df53e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-21T19-09-44Z__6720308f0fceee38734771f04a344840856b00ad.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 236,
                  "startColumn": 5,
                  "endLine": 248,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3e53ae5143cadd0c:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a4a95ef8-db5c-50e9-a20a-233c7e30d2c3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-21T19-09-44Z__6720308f0fceee38734771f04a344840856b00ad.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 249,
                  "startColumn": 5,
                  "endLine": 266,
                  "endColumn": 74
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4332dc8635f3a291:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-07-21T19-09-44Z__6720308f0fceee38734771f04a344840856b00ad.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 266,
          "num_jobs": 14,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "deploy-master": 3,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "deploy-latest": 3,
            "publish-release": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 14,
            "num_dependencies_between_jobs": 15,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "deploy-master": 3,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "deploy-latest": 3,
              "publish-release": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 35,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ \"$METRICS_VERSION_BETA\" != \"v-beta\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "deploy-master": {
            "name": "Deploy lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_BETA_TOKEN }}' https://beta-metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://beta-metrics.lecoq.io/.version"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "METRICS_TOKEN_PERSONAL": "${{ secrets.METRICS_TOKEN_PERSONAL }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "GOOGLE_MAP_TOKEN": "${{ secrets.GOOGLE_MAP_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "deploy-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_TOKEN }}' https://metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://metrics.lecoq.io/.version"
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test",
              "deploy-latest"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          }
        }
      }
    },
    "2022-09-05T19-26-14Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-70196d1b-a9fd-57a5-8401-e365e708be19",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-05T19-26-14Z__ec7b9884e48c1ce1af62ad90dbe713f93efd091f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a98efe5c-6761-5b16-a569-cce2eb32f103",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-05T19-26-14Z__ec7b9884e48c1ce1af62ad90dbe713f93efd091f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 47,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3fffd332-1c28-5ab7-a4ba-d3c8ef5bff8e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-05T19-26-14Z__ec7b9884e48c1ce1af62ad90dbe713f93efd091f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d8a99fdb-62be-5ff1-9134-d275619532db",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-05T19-26-14Z__ec7b9884e48c1ce1af62ad90dbe713f93efd091f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 93,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-12402366-3c0d-58e7-b229-f7e20c17376c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-05T19-26-14Z__ec7b9884e48c1ce1af62ad90dbe713f93efd091f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 94,
                  "startColumn": 5,
                  "endLine": 123,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8f1b3bdf-379e-5fa7-aae2-f9c836496d94",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-05T19-26-14Z__ec7b9884e48c1ce1af62ad90dbe713f93efd091f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 124,
                  "startColumn": 5,
                  "endLine": 136,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4a75ab6a8cede150:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d76f72f6-f111-5a31-8f37-4fdfc7def409",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-05T19-26-14Z__ec7b9884e48c1ce1af62ad90dbe713f93efd091f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 137,
                  "startColumn": 5,
                  "endLine": 151,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e7bb2ec0-a6ea-56c3-878d-2546e82e0852",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-05T19-26-14Z__ec7b9884e48c1ce1af62ad90dbe713f93efd091f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 152,
                  "startColumn": 5,
                  "endLine": 167,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3379647c39fd2439:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-76d772d5-6afa-589b-bfe5-f7fa996ea543",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-05T19-26-14Z__ec7b9884e48c1ce1af62ad90dbe713f93efd091f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 168,
                  "startColumn": 5,
                  "endLine": 173,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56a754f69fb876e3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e39faeba-7181-5c7d-8006-19d35d8f4e7b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-05T19-26-14Z__ec7b9884e48c1ce1af62ad90dbe713f93efd091f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 174,
                  "startColumn": 5,
                  "endLine": 195,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "cc8881d570db4f02:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b99952d7-5dce-5157-a5c3-f2b6af44a864",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-05T19-26-14Z__ec7b9884e48c1ce1af62ad90dbe713f93efd091f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 196,
                  "startColumn": 5,
                  "endLine": 220,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-efd85be1-e6f7-560e-8014-150ac476a1ff",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-05T19-26-14Z__ec7b9884e48c1ce1af62ad90dbe713f93efd091f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 221,
                  "startColumn": 5,
                  "endLine": 235,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fb79ed1a-87f3-5be1-976e-70ecaa621b31",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-05T19-26-14Z__ec7b9884e48c1ce1af62ad90dbe713f93efd091f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 236,
                  "startColumn": 5,
                  "endLine": 248,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3e53ae5143cadd0c:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6a57f02d-62bf-58ab-a0c8-d73be6707c01",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-05T19-26-14Z__ec7b9884e48c1ce1af62ad90dbe713f93efd091f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 249,
                  "startColumn": 5,
                  "endLine": 266,
                  "endColumn": 74
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4332dc8635f3a291:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-09-05T19-26-14Z__ec7b9884e48c1ce1af62ad90dbe713f93efd091f.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 266,
          "num_jobs": 14,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "deploy-master": 3,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "deploy-latest": 3,
            "publish-release": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 14,
            "num_dependencies_between_jobs": 15,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "deploy-master": 3,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "deploy-latest": 3,
              "publish-release": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 35,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ ! -z \"$METRICS_VERSION\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "deploy-master": {
            "name": "Deploy lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_BETA_TOKEN }}' https://beta-metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://beta-metrics.lecoq.io/.version"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "METRICS_TOKEN_PERSONAL": "${{ secrets.METRICS_TOKEN_PERSONAL }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "GOOGLE_MAP_TOKEN": "${{ secrets.GOOGLE_MAP_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "deploy-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_TOKEN }}' https://metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://metrics.lecoq.io/.version"
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test",
              "deploy-latest"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          }
        }
      }
    },
    "2022-09-06T02-49-45Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a3510f1b-96da-50ea-a478-1d9a1eee5f9e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-06T02-49-45Z__80014e5728d76749890e9c3fbe1525709a02c591.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a483578b-9d14-5084-b3c3-5fd49bf27928",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-06T02-49-45Z__80014e5728d76749890e9c3fbe1525709a02c591.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 47,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-99946a97-76a1-5477-822f-bc252c66e79e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-06T02-49-45Z__80014e5728d76749890e9c3fbe1525709a02c591.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7855ac4a-7a4f-569c-ab97-cf55980f49cc",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-06T02-49-45Z__80014e5728d76749890e9c3fbe1525709a02c591.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 93,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-174bffb2-3cba-53fa-809d-8f7a75f404a6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-06T02-49-45Z__80014e5728d76749890e9c3fbe1525709a02c591.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 94,
                  "startColumn": 5,
                  "endLine": 123,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-18243293-fec5-5cd5-8a33-bc096113bc40",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-06T02-49-45Z__80014e5728d76749890e9c3fbe1525709a02c591.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 124,
                  "startColumn": 5,
                  "endLine": 136,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4a75ab6a8cede150:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e6d48cb5-a177-5d73-a994-63133c07b617",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-06T02-49-45Z__80014e5728d76749890e9c3fbe1525709a02c591.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 137,
                  "startColumn": 5,
                  "endLine": 151,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e7017ed4-2923-50d0-b769-0a438f0b5d5d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-06T02-49-45Z__80014e5728d76749890e9c3fbe1525709a02c591.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 152,
                  "startColumn": 5,
                  "endLine": 168,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3379647c39fd2439:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f530ae5d-ddbd-5c1f-b6e3-09b601cd5321",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-06T02-49-45Z__80014e5728d76749890e9c3fbe1525709a02c591.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 169,
                  "startColumn": 5,
                  "endLine": 174,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56a754f69fb876e3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-70568577-8c5d-537c-9088-2c9f21b0005c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-06T02-49-45Z__80014e5728d76749890e9c3fbe1525709a02c591.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 175,
                  "startColumn": 5,
                  "endLine": 196,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "cc8881d570db4f02:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5b36dc1d-7ece-518d-8cd2-6c73702b484b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-06T02-49-45Z__80014e5728d76749890e9c3fbe1525709a02c591.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 197,
                  "startColumn": 5,
                  "endLine": 221,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-74af0713-662e-5374-a15b-0aeee31cfcdd",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-06T02-49-45Z__80014e5728d76749890e9c3fbe1525709a02c591.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 222,
                  "startColumn": 5,
                  "endLine": 236,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-58455fd6-1448-54fd-a19a-31aaadc0200c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-06T02-49-45Z__80014e5728d76749890e9c3fbe1525709a02c591.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 237,
                  "startColumn": 5,
                  "endLine": 249,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3e53ae5143cadd0c:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5b46b5fa-41ec-5995-9a8e-3b58c75d9d13",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-09-06T02-49-45Z__80014e5728d76749890e9c3fbe1525709a02c591.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 250,
                  "startColumn": 5,
                  "endLine": 267,
                  "endColumn": 74
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4332dc8635f3a291:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-09-06T02-49-45Z__80014e5728d76749890e9c3fbe1525709a02c591.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 267,
          "num_jobs": 14,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "deploy-master": 3,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "deploy-latest": 3,
            "publish-release": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 14,
            "num_dependencies_between_jobs": 15,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "deploy-master": 3,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "deploy-latest": 3,
              "publish-release": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 35,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ ! -z \"$METRICS_VERSION\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "deploy-master": {
            "name": "Deploy lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_BETA_TOKEN }}' https://beta-metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://beta-metrics.lecoq.io/.version"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "METRICS_TOKEN_PERSONAL": "${{ secrets.METRICS_TOKEN_PERSONAL }}",
              "CHESS_TOKEN": "${{ secrets.CHESS_TOKEN }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "GOOGLE_MAP_TOKEN": "${{ secrets.GOOGLE_MAP_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "deploy-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_TOKEN }}' https://metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://metrics.lecoq.io/.version"
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test",
              "deploy-latest"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          }
        }
      }
    },
    "2022-11-21T04-51-28Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e991e046-36af-57a5-850d-a14d48e51616",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-21T04-51-28Z__41a6562dc953135e0cdd272381797b63b835fb63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ab3ad1c6-43bf-52a6-bd4b-1d9fa9a10ea9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-21T04-51-28Z__41a6562dc953135e0cdd272381797b63b835fb63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 47,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-89fbdeac-ba31-59b0-9014-0de9b41f8e9e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-21T04-51-28Z__41a6562dc953135e0cdd272381797b63b835fb63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b3a398bf-bd49-5385-8e36-87b82272da15",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-21T04-51-28Z__41a6562dc953135e0cdd272381797b63b835fb63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 93,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bcfcb907-8bbe-5f7a-ad1c-3b4307a5c17a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-21T04-51-28Z__41a6562dc953135e0cdd272381797b63b835fb63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 94,
                  "startColumn": 5,
                  "endLine": 123,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-46887eeb-ce69-5606-ad4b-33e99d8c169a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-21T04-51-28Z__41a6562dc953135e0cdd272381797b63b835fb63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 124,
                  "startColumn": 5,
                  "endLine": 136,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4a75ab6a8cede150:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7fc32e01-4768-5f9a-a1a4-c177f4243a2c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-21T04-51-28Z__41a6562dc953135e0cdd272381797b63b835fb63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 137,
                  "startColumn": 5,
                  "endLine": 151,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d42c6c09-c292-5008-9e71-245397b9421c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-21T04-51-28Z__41a6562dc953135e0cdd272381797b63b835fb63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 152,
                  "startColumn": 5,
                  "endLine": 169,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3379647c39fd2439:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-48cda922-aee7-5afc-95a6-d63b74f5a250",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-21T04-51-28Z__41a6562dc953135e0cdd272381797b63b835fb63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 170,
                  "startColumn": 5,
                  "endLine": 175,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56a754f69fb876e3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-89e5e6f8-47d6-5a29-a531-157108a6051a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-21T04-51-28Z__41a6562dc953135e0cdd272381797b63b835fb63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 176,
                  "startColumn": 5,
                  "endLine": 197,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "cc8881d570db4f02:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e9cb76ed-66f0-5945-9fc9-d6446328b560",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-21T04-51-28Z__41a6562dc953135e0cdd272381797b63b835fb63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 198,
                  "startColumn": 5,
                  "endLine": 222,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b6db8ed9-cecb-5673-9d73-b58e93aff623",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-21T04-51-28Z__41a6562dc953135e0cdd272381797b63b835fb63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 223,
                  "startColumn": 5,
                  "endLine": 237,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3f24bc89-f432-54f7-84b8-63de1d19f166",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-21T04-51-28Z__41a6562dc953135e0cdd272381797b63b835fb63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 238,
                  "startColumn": 5,
                  "endLine": 250,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3e53ae5143cadd0c:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a43247e3-23fe-5e55-8090-89a7da5adbca",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-21T04-51-28Z__41a6562dc953135e0cdd272381797b63b835fb63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 251,
                  "startColumn": 5,
                  "endLine": 268,
                  "endColumn": 74
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4332dc8635f3a291:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-11-21T04-51-28Z__41a6562dc953135e0cdd272381797b63b835fb63.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 268,
          "num_jobs": 14,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "deploy-master": 3,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "deploy-latest": 3,
            "publish-release": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 14,
            "num_dependencies_between_jobs": 15,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "deploy-master": 3,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "deploy-latest": 3,
              "publish-release": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 35,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ ! -z \"$METRICS_VERSION\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "deploy-master": {
            "name": "Deploy lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_BETA_TOKEN }}' https://beta-metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://beta-metrics.lecoq.io/.version"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "METRICS_TOKEN_PERSONAL": "${{ secrets.METRICS_TOKEN_PERSONAL }}",
              "CHESS_TOKEN": "${{ secrets.CHESS_TOKEN }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "GOOGLE_MAP_TOKEN": "${{ secrets.GOOGLE_MAP_TOKEN }}",
              "SPLATOON_TOKEN": "${{ secrets.SPLATOON_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "deploy-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_TOKEN }}' https://metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://metrics.lecoq.io/.version"
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test",
              "deploy-latest"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          }
        }
      }
    },
    "2022-11-22T00-03-33Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-dced001e-2fa9-5c62-a11a-2b223696ecc7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-22T00-03-33Z__24029ffa89ce3dd590a59d0df5c68a072d3c7b92.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1f6ec850-929c-555e-8950-861c5148ce00",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-22T00-03-33Z__24029ffa89ce3dd590a59d0df5c68a072d3c7b92.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 47,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c9eed5e4-53fe-52aa-b944-3a06cb5ed62c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-22T00-03-33Z__24029ffa89ce3dd590a59d0df5c68a072d3c7b92.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-280c1857-787e-50d0-8026-243c812c9831",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-22T00-03-33Z__24029ffa89ce3dd590a59d0df5c68a072d3c7b92.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 93,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-11376d63-52fa-58ba-bfef-cf45eb70a3e1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-22T00-03-33Z__24029ffa89ce3dd590a59d0df5c68a072d3c7b92.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 94,
                  "startColumn": 5,
                  "endLine": 123,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7b4391f2-32a9-5f6b-ab4d-8f11c2fc0808",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-22T00-03-33Z__24029ffa89ce3dd590a59d0df5c68a072d3c7b92.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 124,
                  "startColumn": 5,
                  "endLine": 136,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4a75ab6a8cede150:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b38b2c55-2a7a-5c63-b8e9-c7e2910fbd72",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-22T00-03-33Z__24029ffa89ce3dd590a59d0df5c68a072d3c7b92.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 137,
                  "startColumn": 5,
                  "endLine": 151,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-84380ec6-5ac5-5122-a8a6-561196033df5",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-22T00-03-33Z__24029ffa89ce3dd590a59d0df5c68a072d3c7b92.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 152,
                  "startColumn": 5,
                  "endLine": 170,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3379647c39fd2439:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-18dcf5f9-eedf-5d9c-970e-9f8edb293722",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-22T00-03-33Z__24029ffa89ce3dd590a59d0df5c68a072d3c7b92.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 171,
                  "startColumn": 5,
                  "endLine": 176,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56a754f69fb876e3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-dc1a1ca7-e0f7-57c5-a0c4-1235309f20ed",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-22T00-03-33Z__24029ffa89ce3dd590a59d0df5c68a072d3c7b92.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 177,
                  "startColumn": 5,
                  "endLine": 198,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "cc8881d570db4f02:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9c652f0e-0a72-5362-a55a-6a426ee0698d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-22T00-03-33Z__24029ffa89ce3dd590a59d0df5c68a072d3c7b92.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 199,
                  "startColumn": 5,
                  "endLine": 223,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a5b8d831-e8fe-5aa9-85de-cadc015c1ab7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-22T00-03-33Z__24029ffa89ce3dd590a59d0df5c68a072d3c7b92.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 224,
                  "startColumn": 5,
                  "endLine": 238,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2ab1f271-aae3-53a2-a3a7-c31376b3e230",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-22T00-03-33Z__24029ffa89ce3dd590a59d0df5c68a072d3c7b92.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 239,
                  "startColumn": 5,
                  "endLine": 251,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3e53ae5143cadd0c:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6e13ab90-57d3-5999-a1d2-a5fa364fb4c0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-22T00-03-33Z__24029ffa89ce3dd590a59d0df5c68a072d3c7b92.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 252,
                  "startColumn": 5,
                  "endLine": 269,
                  "endColumn": 74
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4332dc8635f3a291:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-11-22T00-03-33Z__24029ffa89ce3dd590a59d0df5c68a072d3c7b92.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 269,
          "num_jobs": 14,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "deploy-master": 3,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "deploy-latest": 3,
            "publish-release": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 14,
            "num_dependencies_between_jobs": 15,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "deploy-master": 3,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "deploy-latest": 3,
              "publish-release": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v2",
              "actions/setup-node@v2",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 35,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ ! -z \"$METRICS_VERSION\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "deploy-master": {
            "name": "Deploy lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_BETA_TOKEN }}' https://beta-metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://beta-metrics.lecoq.io/.version"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "METRICS_TOKEN_PERSONAL": "${{ secrets.METRICS_TOKEN_PERSONAL }}",
              "CHESS_TOKEN": "${{ secrets.CHESS_TOKEN }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "GOOGLE_MAP_TOKEN": "${{ secrets.GOOGLE_MAP_TOKEN }}",
              "SPLATOON_TOKEN": "${{ secrets.SPLATOON_TOKEN }}",
              "SPLATOON_STATINK_TOKEN": "${{ secrets.SPLATOON_STATINK_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "deploy-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_TOKEN }}' https://metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://metrics.lecoq.io/.version"
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test",
              "deploy-latest"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v2",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          }
        }
      }
    },
    "2022-12-02T00-40-52Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4d7585a1-d42e-51ef-9732-e2ed5c733ad5",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-12-02T00-40-52Z__d8d44a14c7c869a74efddac7a9eadee9139d4822.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-47bc65cb-e2a0-5ae9-9b38-ee76b67cd4c1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-12-02T00-40-52Z__d8d44a14c7c869a74efddac7a9eadee9139d4822.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 47,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-014da360-3ea5-5453-b783-3f5a66f758bf",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-12-02T00-40-52Z__d8d44a14c7c869a74efddac7a9eadee9139d4822.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b1efbc7f-321a-51e2-a29a-92e99c855397",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-12-02T00-40-52Z__d8d44a14c7c869a74efddac7a9eadee9139d4822.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 93,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-244b2af3-4da7-5e6b-b8e3-8ca2499f9265",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-12-02T00-40-52Z__d8d44a14c7c869a74efddac7a9eadee9139d4822.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 94,
                  "startColumn": 5,
                  "endLine": 123,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1918082c-7973-5fb7-a56c-6530041ee176",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-12-02T00-40-52Z__d8d44a14c7c869a74efddac7a9eadee9139d4822.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 124,
                  "startColumn": 5,
                  "endLine": 136,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4a75ab6a8cede150:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0f447d29-bfc9-52bb-b6c0-c20deaadd024",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-12-02T00-40-52Z__d8d44a14c7c869a74efddac7a9eadee9139d4822.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 137,
                  "startColumn": 5,
                  "endLine": 151,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9bc6745f-21f7-547e-bd3e-0c4903e997d6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-12-02T00-40-52Z__d8d44a14c7c869a74efddac7a9eadee9139d4822.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 152,
                  "startColumn": 5,
                  "endLine": 170,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3379647c39fd2439:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a0523b7f-6a3d-50ba-b763-f1417dbbb635",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-12-02T00-40-52Z__d8d44a14c7c869a74efddac7a9eadee9139d4822.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 171,
                  "startColumn": 5,
                  "endLine": 176,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56a754f69fb876e3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-460dba62-3baa-5f32-b806-8006cec97949",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-12-02T00-40-52Z__d8d44a14c7c869a74efddac7a9eadee9139d4822.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 177,
                  "startColumn": 5,
                  "endLine": 198,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "cc8881d570db4f02:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0e119e0d-24d3-5b91-abca-7a9be3d9256f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-12-02T00-40-52Z__d8d44a14c7c869a74efddac7a9eadee9139d4822.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 199,
                  "startColumn": 5,
                  "endLine": 223,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-68e522a8-41b6-5825-9f8d-48efdfcf1d13",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-12-02T00-40-52Z__d8d44a14c7c869a74efddac7a9eadee9139d4822.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 224,
                  "startColumn": 5,
                  "endLine": 238,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3605b517-4478-58a3-a295-99bf7053d582",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-12-02T00-40-52Z__d8d44a14c7c869a74efddac7a9eadee9139d4822.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 239,
                  "startColumn": 5,
                  "endLine": 251,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3e53ae5143cadd0c:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-83ea77f3-db20-5602-b189-0ef798aecfd2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-12-02T00-40-52Z__d8d44a14c7c869a74efddac7a9eadee9139d4822.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 252,
                  "startColumn": 5,
                  "endLine": 269,
                  "endColumn": 74
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4332dc8635f3a291:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-12-02T00-40-52Z__d8d44a14c7c869a74efddac7a9eadee9139d4822.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 269,
          "num_jobs": 14,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "deploy-master": 3,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "deploy-latest": 3,
            "publish-release": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 14,
            "num_dependencies_between_jobs": 15,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "deploy-master": 3,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "deploy-latest": 3,
              "publish-release": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 35,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ ! -z \"$METRICS_VERSION\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "deploy-master": {
            "name": "Deploy lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_BETA_TOKEN }}' https://beta-metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://beta-metrics.lecoq.io/.version"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "METRICS_TOKEN_PERSONAL": "${{ secrets.METRICS_TOKEN_PERSONAL }}",
              "CHESS_TOKEN": "${{ secrets.CHESS_TOKEN }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "GOOGLE_MAP_TOKEN": "${{ secrets.GOOGLE_MAP_TOKEN }}",
              "SPLATOON_TOKEN": "${{ secrets.SPLATOON_TOKEN }}",
              "SPLATOON_STATINK_TOKEN": "${{ secrets.SPLATOON_STATINK_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "deploy-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_TOKEN }}' https://metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://metrics.lecoq.io/.version"
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test",
              "deploy-latest"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          }
        }
      }
    },
    "2023-03-13T03-12-33Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-44d1c7fb-af1d-5286-b198-bebbe2d42b5f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-12-33Z__e2bf05a5d39d6a0b1caf714e4ed637b4337c7fb0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-239414be-6e8e-5e9b-8692-d1ee8e1541d9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-12-33Z__e2bf05a5d39d6a0b1caf714e4ed637b4337c7fb0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 48,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-87ce3240-74b8-5b63-9183-7f400e923a73",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-12-33Z__e2bf05a5d39d6a0b1caf714e4ed637b4337c7fb0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 49,
                  "startColumn": 5,
                  "endLine": 71,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c9c117a2-d4be-5176-8205-5d7751dfec91",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-12-33Z__e2bf05a5d39d6a0b1caf714e4ed637b4337c7fb0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 72,
                  "startColumn": 5,
                  "endLine": 94,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a4748e37-5305-5b3f-a836-15833eff1c3a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-12-33Z__e2bf05a5d39d6a0b1caf714e4ed637b4337c7fb0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 95,
                  "startColumn": 5,
                  "endLine": 124,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-25cdc2ab-a1e2-5f42-bb56-fde354d0a25d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-12-33Z__e2bf05a5d39d6a0b1caf714e4ed637b4337c7fb0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 125,
                  "startColumn": 5,
                  "endLine": 137,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4a75ab6a8cede150:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-007d3f8b-c323-525e-8bf2-3d771809e863",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-12-33Z__e2bf05a5d39d6a0b1caf714e4ed637b4337c7fb0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 138,
                  "startColumn": 5,
                  "endLine": 152,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-be202e24-4e45-5120-9a9e-2807baf734e0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-12-33Z__e2bf05a5d39d6a0b1caf714e4ed637b4337c7fb0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 153,
                  "startColumn": 5,
                  "endLine": 171,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3379647c39fd2439:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c6bd3990-aa8a-5834-ac44-91d1fb40323f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-12-33Z__e2bf05a5d39d6a0b1caf714e4ed637b4337c7fb0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 172,
                  "startColumn": 5,
                  "endLine": 177,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56a754f69fb876e3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-91742cd5-7069-5248-a32b-7eca6af81678",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-12-33Z__e2bf05a5d39d6a0b1caf714e4ed637b4337c7fb0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 178,
                  "startColumn": 5,
                  "endLine": 199,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "cc8881d570db4f02:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fd75050b-6c99-543d-81d8-6982b8b19c2b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-12-33Z__e2bf05a5d39d6a0b1caf714e4ed637b4337c7fb0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 200,
                  "startColumn": 5,
                  "endLine": 224,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-dd32a25a-57f0-5ff6-b6f7-36a7ad68b4ac",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-12-33Z__e2bf05a5d39d6a0b1caf714e4ed637b4337c7fb0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 225,
                  "startColumn": 5,
                  "endLine": 239,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-785bf193-229c-59c5-9c75-5fb2df3409be",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-12-33Z__e2bf05a5d39d6a0b1caf714e4ed637b4337c7fb0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 240,
                  "startColumn": 5,
                  "endLine": 252,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3e53ae5143cadd0c:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-95b46a46-6a9d-58d0-a2dd-784213323d62",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-12-33Z__e2bf05a5d39d6a0b1caf714e4ed637b4337c7fb0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 253,
                  "startColumn": 5,
                  "endLine": 270,
                  "endColumn": 74
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4332dc8635f3a291:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-03-13T03-12-33Z__e2bf05a5d39d6a0b1caf714e4ed637b4337c7fb0.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 270,
          "num_jobs": 14,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "deploy-master": 3,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "deploy-latest": 3,
            "publish-release": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 14,
            "num_dependencies_between_jobs": 15,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "deploy-master": 3,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "deploy-latest": 3,
              "publish-release": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 35,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\nmkdir -p /home/runner/.cache/dprint/cache\nnpm install -g eslint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ ! -z \"$METRICS_VERSION\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "deploy-master": {
            "name": "Deploy lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_BETA_TOKEN }}' https://beta-metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://beta-metrics.lecoq.io/.version"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "METRICS_TOKEN_PERSONAL": "${{ secrets.METRICS_TOKEN_PERSONAL }}",
              "CHESS_TOKEN": "${{ secrets.CHESS_TOKEN }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "GOOGLE_MAP_TOKEN": "${{ secrets.GOOGLE_MAP_TOKEN }}",
              "SPLATOON_TOKEN": "${{ secrets.SPLATOON_TOKEN }}",
              "SPLATOON_STATINK_TOKEN": "${{ secrets.SPLATOON_STATINK_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "deploy-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_TOKEN }}' https://metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://metrics.lecoq.io/.version"
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test",
              "deploy-latest"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          }
        }
      }
    },
    "2023-03-13T03-18-20Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-39f181a8-0a93-5775-9777-d88517c85c68",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-18-20Z__f5244e9bce1a52c5b59cd738358b05ceed867bf8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-53cb3a86-8a94-572c-b980-d17fcddb23fc",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-18-20Z__f5244e9bce1a52c5b59cd738358b05ceed867bf8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 46,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2b9e44d7-6e51-58d5-9817-bc5d00d60ad0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-18-20Z__f5244e9bce1a52c5b59cd738358b05ceed867bf8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 47,
                  "startColumn": 5,
                  "endLine": 69,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-48ded9eb-d6a9-50c7-9525-6341a218b366",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-18-20Z__f5244e9bce1a52c5b59cd738358b05ceed867bf8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 70,
                  "startColumn": 5,
                  "endLine": 92,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-aa979342-631b-5aaf-8510-bece4b36c5ff",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-18-20Z__f5244e9bce1a52c5b59cd738358b05ceed867bf8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 93,
                  "startColumn": 5,
                  "endLine": 122,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cdbf9e8f-87d8-501f-8984-d38bc294f670",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-18-20Z__f5244e9bce1a52c5b59cd738358b05ceed867bf8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 123,
                  "startColumn": 5,
                  "endLine": 135,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4a75ab6a8cede150:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-61654b55-a154-5906-b6e7-8dad2fad0fdf",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-18-20Z__f5244e9bce1a52c5b59cd738358b05ceed867bf8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 136,
                  "startColumn": 5,
                  "endLine": 150,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9f11ab96-7bee-5b6b-8737-c25c70791802",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-18-20Z__f5244e9bce1a52c5b59cd738358b05ceed867bf8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 151,
                  "startColumn": 5,
                  "endLine": 169,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3379647c39fd2439:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-595683d7-216b-5ca7-a765-aa1a92b375cf",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-18-20Z__f5244e9bce1a52c5b59cd738358b05ceed867bf8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 170,
                  "startColumn": 5,
                  "endLine": 175,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56a754f69fb876e3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-14642aa3-d410-5d52-9093-9197e78f267d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-18-20Z__f5244e9bce1a52c5b59cd738358b05ceed867bf8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 176,
                  "startColumn": 5,
                  "endLine": 197,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "cc8881d570db4f02:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-074011f8-38d2-5a43-b7bc-77231f0492c8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-18-20Z__f5244e9bce1a52c5b59cd738358b05ceed867bf8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 198,
                  "startColumn": 5,
                  "endLine": 222,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bf0e7b20-27db-590a-8e9d-fe688e62d40d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-18-20Z__f5244e9bce1a52c5b59cd738358b05ceed867bf8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 223,
                  "startColumn": 5,
                  "endLine": 237,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-04b68ce2-a4b2-53fb-bf72-4d8240e31e06",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-18-20Z__f5244e9bce1a52c5b59cd738358b05ceed867bf8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 238,
                  "startColumn": 5,
                  "endLine": 250,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3e53ae5143cadd0c:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4cae3616-0d29-5d42-9aa4-c0eae985a94f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-18-20Z__f5244e9bce1a52c5b59cd738358b05ceed867bf8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 251,
                  "startColumn": 5,
                  "endLine": 268,
                  "endColumn": 74
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4332dc8635f3a291:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-03-13T03-18-20Z__f5244e9bce1a52c5b59cd738358b05ceed867bf8.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 268,
          "num_jobs": 14,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 5,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "deploy-master": 3,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "deploy-latest": 3,
            "publish-release": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 14,
            "num_dependencies_between_jobs": 15,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 5,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "deploy-master": 3,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "deploy-latest": 3,
              "publish-release": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 35,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup Dprint",
                "run": "curl -fsSL https://dprint.dev/install.sh | sh\ncp /home/runner/.dprint/bin/dprint /usr/local/bin/dprint\n"
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "dprint fmt --config .github/config/dprint.json\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ ! -z \"$METRICS_VERSION\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "deploy-master": {
            "name": "Deploy lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_BETA_TOKEN }}' https://beta-metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://beta-metrics.lecoq.io/.version"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "METRICS_TOKEN_PERSONAL": "${{ secrets.METRICS_TOKEN_PERSONAL }}",
              "CHESS_TOKEN": "${{ secrets.CHESS_TOKEN }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "GOOGLE_MAP_TOKEN": "${{ secrets.GOOGLE_MAP_TOKEN }}",
              "SPLATOON_TOKEN": "${{ secrets.SPLATOON_TOKEN }}",
              "SPLATOON_STATINK_TOKEN": "${{ secrets.SPLATOON_STATINK_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "deploy-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_TOKEN }}' https://metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://metrics.lecoq.io/.version"
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test",
              "deploy-latest"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          }
        }
      }
    },
    "2023-03-13T03-56-30Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1c829c5c-42e5-5b19-b742-27ab0ca87be4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-56-30Z__cb5bc6c9b9080f4986641a8aa423703ba2571bc3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c8ee5244-3fe0-5a51-875e-959feeafaded",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-56-30Z__cb5bc6c9b9080f4986641a8aa423703ba2571bc3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 44,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9986ca9f-c6e1-5c67-8050-1a7c0fd475af",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-56-30Z__cb5bc6c9b9080f4986641a8aa423703ba2571bc3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 45,
                  "startColumn": 5,
                  "endLine": 67,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ebb20210-d674-55e8-8fc9-866bc6a869b3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-56-30Z__cb5bc6c9b9080f4986641a8aa423703ba2571bc3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 68,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-909a1ff3-c02e-5265-a1fa-903f86042f29",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-56-30Z__cb5bc6c9b9080f4986641a8aa423703ba2571bc3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 120,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-07ef7508-bdd5-5613-a2c3-74713cded3b7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-56-30Z__cb5bc6c9b9080f4986641a8aa423703ba2571bc3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 121,
                  "startColumn": 5,
                  "endLine": 133,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4a75ab6a8cede150:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5799fc24-818d-5575-8fbc-84749fe6815f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-56-30Z__cb5bc6c9b9080f4986641a8aa423703ba2571bc3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 134,
                  "startColumn": 5,
                  "endLine": 148,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9ebd96ff-d312-54d8-9ea2-fcb74891af34",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-56-30Z__cb5bc6c9b9080f4986641a8aa423703ba2571bc3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 149,
                  "startColumn": 5,
                  "endLine": 167,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3379647c39fd2439:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c5ccb970-14c3-57eb-b007-fd808bfeee32",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-56-30Z__cb5bc6c9b9080f4986641a8aa423703ba2571bc3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 168,
                  "startColumn": 5,
                  "endLine": 173,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56a754f69fb876e3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-967efdea-0cc1-548a-97e4-24ccaeeb3891",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-56-30Z__cb5bc6c9b9080f4986641a8aa423703ba2571bc3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 174,
                  "startColumn": 5,
                  "endLine": 195,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "cc8881d570db4f02:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-625cf403-0099-5caf-a0a4-9c65cde065ff",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-56-30Z__cb5bc6c9b9080f4986641a8aa423703ba2571bc3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 196,
                  "startColumn": 5,
                  "endLine": 220,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4ba25f7f-7ef7-5a3a-adbd-76e923fc8298",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-56-30Z__cb5bc6c9b9080f4986641a8aa423703ba2571bc3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 221,
                  "startColumn": 5,
                  "endLine": 235,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c95e2d02-2375-5eac-b3be-991f9ca8442f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-56-30Z__cb5bc6c9b9080f4986641a8aa423703ba2571bc3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 236,
                  "startColumn": 5,
                  "endLine": 248,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3e53ae5143cadd0c:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7bcd4ff2-619b-5239-9b14-a918b9166697",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-13T03-56-30Z__cb5bc6c9b9080f4986641a8aa423703ba2571bc3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 249,
                  "startColumn": 5,
                  "endLine": 266,
                  "endColumn": 74
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4332dc8635f3a291:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-03-13T03-56-30Z__cb5bc6c9b9080f4986641a8aa423703ba2571bc3.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 266,
          "num_jobs": 14,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 4,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "deploy-master": 3,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "deploy-latest": 3,
            "publish-release": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 14,
            "num_dependencies_between_jobs": 15,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 4,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "deploy-master": 3,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "deploy-latest": 3,
              "publish-release": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 34,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "npm install -g dprint\nmkdir -v -p /home/runner/.cache/dprint/cache\nnpx dprint fmt --config .github/config/dprint.json\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ ! -z \"$METRICS_VERSION\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "deploy-master": {
            "name": "Deploy lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_BETA_TOKEN }}' https://beta-metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://beta-metrics.lecoq.io/.version"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "METRICS_TOKEN_PERSONAL": "${{ secrets.METRICS_TOKEN_PERSONAL }}",
              "CHESS_TOKEN": "${{ secrets.CHESS_TOKEN }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "GOOGLE_MAP_TOKEN": "${{ secrets.GOOGLE_MAP_TOKEN }}",
              "SPLATOON_TOKEN": "${{ secrets.SPLATOON_TOKEN }}",
              "SPLATOON_STATINK_TOKEN": "${{ secrets.SPLATOON_STATINK_TOKEN }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "deploy-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_TOKEN }}' https://metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://metrics.lecoq.io/.version"
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test",
              "deploy-latest"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          }
        }
      }
    },
    "2023-03-14T17-15-04Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-12260659-d793-58b6-9b84-c5f1f1b03277",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-14T17-15-04Z__4e8fa0f866856d00edb89c4c95ec3a5c0a09b6f4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fa01a4e4-cc5e-598e-aa4f-4ede5c2bc432",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-14T17-15-04Z__4e8fa0f866856d00edb89c4c95ec3a5c0a09b6f4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 44,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d67acc8a-5d30-53eb-987d-8bbf1dceb62d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-14T17-15-04Z__4e8fa0f866856d00edb89c4c95ec3a5c0a09b6f4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 45,
                  "startColumn": 5,
                  "endLine": 67,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-aff1a10b-a4cc-565b-b288-563a70e27e53",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-14T17-15-04Z__4e8fa0f866856d00edb89c4c95ec3a5c0a09b6f4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 68,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-480cb28e-ac51-50be-abf9-fc97264044ef",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-14T17-15-04Z__4e8fa0f866856d00edb89c4c95ec3a5c0a09b6f4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 120,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ae6d31d4-3841-5dcd-b1e5-b1ad8b89aa69",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-14T17-15-04Z__4e8fa0f866856d00edb89c4c95ec3a5c0a09b6f4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 121,
                  "startColumn": 5,
                  "endLine": 133,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4a75ab6a8cede150:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-477d0e96-861b-5824-92a6-7f2e14565428",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-14T17-15-04Z__4e8fa0f866856d00edb89c4c95ec3a5c0a09b6f4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 134,
                  "startColumn": 5,
                  "endLine": 148,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a2c7fe9c-76f6-5748-a186-1a203b878e8a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-14T17-15-04Z__4e8fa0f866856d00edb89c4c95ec3a5c0a09b6f4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 149,
                  "startColumn": 5,
                  "endLine": 168,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3379647c39fd2439:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cf11f2da-0709-5a1e-915b-e8e1613877f6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-14T17-15-04Z__4e8fa0f866856d00edb89c4c95ec3a5c0a09b6f4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 169,
                  "startColumn": 5,
                  "endLine": 174,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56a754f69fb876e3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a1cdbc4a-b991-5165-b775-d994e279cc8c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-14T17-15-04Z__4e8fa0f866856d00edb89c4c95ec3a5c0a09b6f4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 175,
                  "startColumn": 5,
                  "endLine": 196,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "cc8881d570db4f02:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-460c9128-a3ba-518a-ac82-8899b6991a56",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-14T17-15-04Z__4e8fa0f866856d00edb89c4c95ec3a5c0a09b6f4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 197,
                  "startColumn": 5,
                  "endLine": 221,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a07fb605-27d9-5365-9de6-d6c6f7f0cd79",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-14T17-15-04Z__4e8fa0f866856d00edb89c4c95ec3a5c0a09b6f4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 222,
                  "startColumn": 5,
                  "endLine": 236,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0be44029-97a4-53f8-9986-e9f7d114f010",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-14T17-15-04Z__4e8fa0f866856d00edb89c4c95ec3a5c0a09b6f4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 237,
                  "startColumn": 5,
                  "endLine": 249,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3e53ae5143cadd0c:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-40c8a685-d903-56c3-86c4-c812dc64aff6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-14T17-15-04Z__4e8fa0f866856d00edb89c4c95ec3a5c0a09b6f4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 250,
                  "startColumn": 5,
                  "endLine": 267,
                  "endColumn": 74
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4332dc8635f3a291:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-03-14T17-15-04Z__4e8fa0f866856d00edb89c4c95ec3a5c0a09b6f4.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 267,
          "num_jobs": 14,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 4,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "deploy-master": 3,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "deploy-latest": 3,
            "publish-release": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 14,
            "num_dependencies_between_jobs": 15,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 4,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "deploy-master": 3,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "deploy-latest": 3,
              "publish-release": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 34,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "npm install -g dprint\nmkdir -v -p /home/runner/.cache/dprint/cache\nnpx dprint fmt --config .github/config/dprint.json\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ ! -z \"$METRICS_VERSION\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "deploy-master": {
            "name": "Deploy lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_BETA_TOKEN }}' https://beta-metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://beta-metrics.lecoq.io/.version"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "METRICS_TOKEN_PERSONAL": "${{ secrets.METRICS_TOKEN_PERSONAL }}",
              "CHESS_TOKEN": "${{ secrets.CHESS_TOKEN }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "GOOGLE_MAP_TOKEN": "${{ secrets.GOOGLE_MAP_TOKEN }}",
              "SPLATOON_TOKEN": "${{ secrets.SPLATOON_TOKEN }}",
              "SPLATOON_STATINK_TOKEN": "${{ secrets.SPLATOON_STATINK_TOKEN }}",
              "SIXTEEN_PERSONALITIES_URL": "${{ secrets.SIXTEEN_PERSONALITIES_URL }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "deploy-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_TOKEN }}' https://metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://metrics.lecoq.io/.version"
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test",
              "deploy-latest"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 17
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          }
        }
      }
    },
    "2023-08-25T02-19-40Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-19ad9dc0-9b8f-5f60-bd99-c4880c1a7ec9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-25T02-19-40Z__84e1732079a966590518c6a70ef1d40758798ea6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6967ce02-67eb-5971-b260-17f3f32bbd5d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-25T02-19-40Z__84e1732079a966590518c6a70ef1d40758798ea6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 44,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-315b945a-680f-5cb9-96d3-197c6e0306a3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-25T02-19-40Z__84e1732079a966590518c6a70ef1d40758798ea6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 45,
                  "startColumn": 5,
                  "endLine": 67,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d7c10a55-e3d1-5259-b257-47b696c51f4b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-25T02-19-40Z__84e1732079a966590518c6a70ef1d40758798ea6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 68,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6129a567-e75b-59c1-9b97-81956125f922",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-25T02-19-40Z__84e1732079a966590518c6a70ef1d40758798ea6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 120,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1cea5607-8de8-574b-9168-f6e3aaa4164a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-25T02-19-40Z__84e1732079a966590518c6a70ef1d40758798ea6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 121,
                  "startColumn": 5,
                  "endLine": 133,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4a75ab6a8cede150:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8486ea9b-f69b-58dc-9a2f-ebc63c885ff6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-25T02-19-40Z__84e1732079a966590518c6a70ef1d40758798ea6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 134,
                  "startColumn": 5,
                  "endLine": 148,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-82ee8cfb-5c36-5131-9a62-5ef868e4b8cb",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-25T02-19-40Z__84e1732079a966590518c6a70ef1d40758798ea6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 149,
                  "startColumn": 5,
                  "endLine": 168,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3379647c39fd2439:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b15584d2-91eb-52c5-b840-66e9fa6064a0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-25T02-19-40Z__84e1732079a966590518c6a70ef1d40758798ea6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 169,
                  "startColumn": 5,
                  "endLine": 174,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56a754f69fb876e3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-82325260-ca11-5968-a0e4-e1fcb36a570d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-25T02-19-40Z__84e1732079a966590518c6a70ef1d40758798ea6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 175,
                  "startColumn": 5,
                  "endLine": 196,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "cc8881d570db4f02:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-293cecc3-5edd-591c-a46f-b948c5bc09c8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-25T02-19-40Z__84e1732079a966590518c6a70ef1d40758798ea6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 197,
                  "startColumn": 5,
                  "endLine": 221,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-04e2f475-ad24-5fb0-8e6d-8449634911ce",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-25T02-19-40Z__84e1732079a966590518c6a70ef1d40758798ea6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 222,
                  "startColumn": 5,
                  "endLine": 236,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9db176f3-2be0-50d2-8e26-3e24d11b4cd3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-25T02-19-40Z__84e1732079a966590518c6a70ef1d40758798ea6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 237,
                  "startColumn": 5,
                  "endLine": 249,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3e53ae5143cadd0c:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8269b8d7-c22b-5212-ba38-ffc77bc168c9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-25T02-19-40Z__84e1732079a966590518c6a70ef1d40758798ea6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 250,
                  "startColumn": 5,
                  "endLine": 267,
                  "endColumn": 74
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4332dc8635f3a291:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-08-25T02-19-40Z__84e1732079a966590518c6a70ef1d40758798ea6.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 267,
          "num_jobs": 14,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 4,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "deploy-master": 3,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "deploy-latest": 3,
            "publish-release": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 14,
            "num_dependencies_between_jobs": 15,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 4,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "deploy-master": 3,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "deploy-latest": 3,
              "publish-release": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 34,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "npm install -g dprint\nmkdir -v -p /home/runner/.cache/dprint/cache\nnpx dprint fmt --config .github/config/dprint.json\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 20
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 20
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ ! -z \"$METRICS_VERSION\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "deploy-master": {
            "name": "Deploy lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_BETA_TOKEN }}' https://beta-metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://beta-metrics.lecoq.io/.version"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "METRICS_TOKEN_PERSONAL": "${{ secrets.METRICS_TOKEN_PERSONAL }}",
              "CHESS_TOKEN": "${{ secrets.CHESS_TOKEN }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "GOOGLE_MAP_TOKEN": "${{ secrets.GOOGLE_MAP_TOKEN }}",
              "SPLATOON_TOKEN": "${{ secrets.SPLATOON_TOKEN }}",
              "SPLATOON_STATINK_TOKEN": "${{ secrets.SPLATOON_STATINK_TOKEN }}",
              "SIXTEEN_PERSONALITIES_URL": "${{ secrets.SIXTEEN_PERSONALITIES_URL }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo '${{ github.event.head_commit.message }}' | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 20
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "deploy-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_TOKEN }}' https://metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://metrics.lecoq.io/.version"
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test",
              "deploy-latest"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 20
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          }
        }
      }
    },
    "2023-09-14T03-06-30Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1ba48948-ba68-5963-b962-a3131965da52",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-14T03-06-30Z__47746add1e7d53352ddf9750424c0632714cd9f1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f214e7a4f2709ad3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c295fe73-17a3-5956-ae89-8d45e43359f7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-14T03-06-30Z__47746add1e7d53352ddf9750424c0632714cd9f1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 5,
                  "endLine": 44,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1e17d9238741d1df:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8827cd2e-250e-5652-b229-ff900e12cf5b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-14T03-06-30Z__47746add1e7d53352ddf9750424c0632714cd9f1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 45,
                  "startColumn": 5,
                  "endLine": 67,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "38b3db3d0f73ac83:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-508bb754-dfb3-5f5f-8e7c-8784fbccd48e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-14T03-06-30Z__47746add1e7d53352ddf9750424c0632714cd9f1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 68,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a6b83f5717b58528:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5b47e89f-58e7-5e47-9dc0-9bf4f445cdd4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-14T03-06-30Z__47746add1e7d53352ddf9750424c0632714cd9f1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 120,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "14f0b7a1a64f693e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-22595b21-4e22-523e-aaee-be3f6b54fc34",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-14T03-06-30Z__47746add1e7d53352ddf9750424c0632714cd9f1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 121,
                  "startColumn": 5,
                  "endLine": 133,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4a75ab6a8cede150:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3af18272-d4c1-51ea-82c3-69fc7901a54a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-14T03-06-30Z__47746add1e7d53352ddf9750424c0632714cd9f1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 134,
                  "startColumn": 5,
                  "endLine": 148,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "6dc6b781b3ac362a:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2ab4fe34-0850-5329-8df2-e6e723b1f3ac",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-14T03-06-30Z__47746add1e7d53352ddf9750424c0632714cd9f1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 149,
                  "startColumn": 5,
                  "endLine": 168,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3379647c39fd2439:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-80c0893f-520e-5a1b-88f2-f4b13896d4a6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-14T03-06-30Z__47746add1e7d53352ddf9750424c0632714cd9f1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 169,
                  "startColumn": 5,
                  "endLine": 174,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56a754f69fb876e3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a8905e3f-1450-5552-abd9-a20a7f3e5ee3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-14T03-06-30Z__47746add1e7d53352ddf9750424c0632714cd9f1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 175,
                  "startColumn": 5,
                  "endLine": 200,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "cc8881d570db4f02:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2e7641de-d76e-585a-8b09-1a61481296b9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-14T03-06-30Z__47746add1e7d53352ddf9750424c0632714cd9f1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 201,
                  "startColumn": 5,
                  "endLine": 225,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5c6ed6094f72737f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-183ebb9d-f999-571c-a475-32fd68e35072",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-14T03-06-30Z__47746add1e7d53352ddf9750424c0632714cd9f1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 226,
                  "startColumn": 5,
                  "endLine": 240,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "c05f40e634a54f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-04bb3246-e2c7-5b94-9b84-9b26ddcca1a8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-14T03-06-30Z__47746add1e7d53352ddf9750424c0632714cd9f1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 241,
                  "startColumn": 5,
                  "endLine": 253,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3e53ae5143cadd0c:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b47364fe-301f-567e-897c-a7492a93477f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-14T03-06-30Z__47746add1e7d53352ddf9750424c0632714cd9f1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 254,
                  "startColumn": 5,
                  "endLine": 271,
                  "endColumn": 74
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4332dc8635f3a291:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-09-14T03-06-30Z__47746add1e7d53352ddf9750424c0632714cd9f1.yml",
          "workflow_name": "Continuous integration",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 271,
          "num_jobs": 14,
          "steps_per_job": {
            "build-test-analyze": 0,
            "format": 4,
            "update-indexes": 5,
            "update-main": 6,
            "docker-master": 6,
            "deploy-master": 3,
            "action-master-test": 1,
            "publish-examples": 0,
            "publish-examples-presets": 0,
            "docker-release": 7,
            "update-latest": 7,
            "action-latest-test": 1,
            "deploy-latest": 3,
            "publish-release": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 14,
            "num_dependencies_between_jobs": 15,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build-test-analyze": 0,
              "format": 4,
              "update-indexes": 5,
              "update-main": 6,
              "docker-master": 6,
              "deploy-master": 3,
              "action-master-test": 1,
              "publish-examples": 0,
              "publish-examples-presets": 0,
              "docker-release": 7,
              "update-latest": 7,
              "action-latest-test": 1,
              "deploy-latest": 3,
              "publish-release": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 13,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3",
              "lowlighter/metrics@latest",
              "lowlighter/metrics@master"
            ],
            "num_run_commands": 34,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Continuous integration",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "build-test-analyze": {
            "name": "Build, test and analyze",
            "if": "!contains(github.event.head_commit.message, '[skip test]')",
            "uses": "lowlighter/metrics/.github/workflows/test.yml@master"
          },
          "format": {
            "name": "Format code",
            "runs-on": "ubuntu-latest",
            "needs": [
              "build-test-analyze"
            ],
            "if": "always() && (needs.build-test-analyze.result == 'success' || needs.build-test-analyze.result == 'skipped')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Checkout master",
                "run": "git checkout master"
              },
              {
                "name": "Format code",
                "run": "npm install -g dprint\nmkdir -v -p /home/runner/.cache/dprint/cache\nnpx dprint fmt --config .github/config/dprint.json\n"
              },
              {
                "name": "Publish formatted code",
                "run": "set +e\ngit config user.name github-actions[bot]\ngit config user.email 41898282+github-actions[bot]@users.noreply.github.com\ngit add --all\ngit commit -m \"chore: code formatting\"\ngit push\nset -e\n"
              }
            ]
          },
          "update-indexes": {
            "name": "Publish rebuilt metrics indexes",
            "runs-on": "ubuntu-latest",
            "needs": [
              "format"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 20
                }
              },
              {
                "name": "Pull changes",
                "run": "git checkout master\ngit pull\n"
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish rebuild metrics indexes",
                "run": "npm run build -- publish"
              }
            ]
          },
          "update-main": {
            "name": "Rebase main on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 20
                }
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout main",
                "run": "git checkout main"
              },
              {
                "name": "Rebase main on master",
                "run": "git merge master"
              },
              {
                "name": "Push main",
                "run": "git push origin main"
              }
            ]
          },
          "docker-master": {
            "name": "Publish master to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-indexes"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Build docker image",
                "run": "docker build -t ghcr.io/lowlighter/metrics:master ."
              },
              {
                "name": "Publish to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (beta) and publish to GitHub registry",
                "run": "set +e\nMETRICS_VERSION=$(cat package.json | grep -Po '(?<=\"version\": \")\\d+[.]\\d+(?=[.]0-beta\")')\nMETRICS_VERSION_BETA=\"$METRICS_VERSION-beta\"\nset -e\nif [[ ! -z \"$METRICS_VERSION\" ]]; then\n  echo \"Beta version: v$METRICS_VERSION_BETA\"\n  docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\n  docker push ghcr.io/lowlighter/metrics:$(echo \"v$METRICS_VERSION_BETA\")\nfi\n"
              },
              {
                "name": "Tag docker image (main) and publish to GitHub registry",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:main\ndocker push ghcr.io/lowlighter/metrics:main\n"
              }
            ]
          },
          "deploy-master": {
            "name": "Deploy lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_BETA_TOKEN }}' https://beta-metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://beta-metrics.lecoq.io/.version"
              }
            ]
          },
          "action-master-test": {
            "name": "Test lowlighter/metrics@master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-master"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@master",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "publish-examples": {
            "name": "Publish examples",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.yml@master",
            "secrets": {
              "METRICS_TOKEN": "${{ secrets.METRICS_TOKEN }}",
              "METRICS_TOKEN_WITH_SCOPES": "${{ secrets.METRICS_TOKEN_WITH_SCOPES }}",
              "METRICS_TOKEN_PERSONAL": "${{ secrets.METRICS_TOKEN_PERSONAL }}",
              "CHESS_TOKEN": "${{ secrets.CHESS_TOKEN }}",
              "PAGESPEED_TOKEN": "${{ secrets.PAGESPEED_TOKEN }}",
              "GOOGLE_MAP_TOKEN": "${{ secrets.GOOGLE_MAP_TOKEN }}",
              "SPLATOON_TOKEN": "${{ secrets.SPLATOON_TOKEN }}",
              "SPLATOON_STATINK_TOKEN": "${{ secrets.SPLATOON_STATINK_TOKEN }}",
              "SIXTEEN_PERSONALITIES_URL": "${{ secrets.SIXTEEN_PERSONALITIES_URL }}",
              "SPOTIFY_TOKENS": "${{ secrets.SPOTIFY_TOKENS }}",
              "STOCK_TOKEN": "${{ secrets.STOCK_TOKEN }}",
              "TWITTER_TOKEN": "${{ secrets.TWITTER_TOKEN }}",
              "WAKATIME_TOKEN": "${{ secrets.WAKATIME_TOKEN }}"
            }
          },
          "publish-examples-presets": {
            "name": "Publish examples (presets)",
            "needs": [
              "action-master-test"
            ],
            "uses": "lowlighter/metrics/.github/workflows/examples.presets.yml@master"
          },
          "docker-release": {
            "name": "Publish release to GitHub registry",
            "runs-on": "ubuntu-latest",
            "needs": [
              "publish-examples"
            ],
            "if": "contains(github.event.head_commit.message, '[release]')",
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Login to GitHub registry",
                "run": "echo ${{ github.token }} | docker login ghcr.io -u ${{ github.actor }} --password-stdin"
              },
              {
                "name": "Pull docker image (master)",
                "run": "docker pull ghcr.io/lowlighter/metrics:master"
              },
              {
                "name": "Tag docker image (release)",
                "env": {
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                },
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:$(echo $GITHUB_COMMIT_MESSAGE | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Publish release to GitHub registry",
                "env": {
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                },
                "run": "docker push ghcr.io/lowlighter/metrics:$(echo $GITHUB_COMMIT_MESSAGE | grep -Po 'v\\d+[.]\\d+')"
              },
              {
                "name": "Tag docker image (latest)",
                "run": "docker tag ghcr.io/lowlighter/metrics:master ghcr.io/lowlighter/metrics:latest"
              },
              {
                "name": "Publish latest to GitHub registry",
                "run": "docker push ghcr.io/lowlighter/metrics:latest"
              }
            ]
          },
          "update-latest": {
            "name": "Rebase latest on master",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 20
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Pull",
                "run": "git pull"
              },
              {
                "name": "Checkout latest",
                "run": "git checkout latest"
              },
              {
                "name": "Rebase latest on master",
                "run": "git merge master"
              },
              {
                "name": "Push latest",
                "run": "git push origin latest"
              }
            ]
          },
          "action-latest-test": {
            "name": "Test lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "update-latest"
            ],
            "steps": [
              {
                "name": "Run tests",
                "uses": "lowlighter/metrics@latest",
                "with": {
                  "token": "MOCKED_TOKEN",
                  "plugins_errors_fatal": true,
                  "dryrun": true,
                  "use_mocked_data": true,
                  "verify": true
                }
              }
            ]
          },
          "deploy-latest": {
            "name": "Deploy lowlighter/metrics@latest",
            "runs-on": "ubuntu-latest",
            "needs": [
              "docker-release",
              "deploy-master"
            ],
            "steps": [
              {
                "name": "Deploy web instance",
                "run": "curl -X POST -H 'Authorization: ${{ secrets.WEB_DEPLOY_TOKEN }}' https://metrics.lecoq.io/.control/stop"
              },
              {
                "name": "Wait for redeploy",
                "run": "sleep 120"
              },
              {
                "name": "Check deployment status",
                "run": "curl --retry 15 --retry-delay 60 https://metrics.lecoq.io/.version"
              }
            ]
          },
          "publish-release": {
            "name": "Publish release",
            "runs-on": "ubuntu-latest",
            "needs": [
              "action-latest-test",
              "deploy-latest"
            ],
            "steps": [
              {
                "name": "Checkout repository",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Setup NodeJS",
                "uses": "actions/setup-node@v3",
                "with": {
                  "node-version": 20
                }
              },
              {
                "name": "Setup metrics",
                "run": "npm ci"
              },
              {
                "name": "Publish release",
                "run": "node .github/scripts/release.mjs",
                "env": {
                  "GITHUB_TOKEN": "${{ github.token }}",
                  "GITHUB_REPOSITORY": "${{ github.repository }}",
                  "GITHUB_COMMIT_MESSAGE": "${{ github.event.head_commit.message }}"
                }
              }
            ]
          }
        }
      }
    }
  }
}