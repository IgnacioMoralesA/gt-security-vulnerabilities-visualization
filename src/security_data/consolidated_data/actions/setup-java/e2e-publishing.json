{
  "repo_owner": "actions",
  "repo_name": "setup-java",
  "workflow_name": "e2e-publishing",
  "history": {
    "2021-04-05T10-02-27Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b5a61dfa-916e-5db8-abad-454f41228df5",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2021-04-05T10-02-27Z__b53500dabc37db6cc1dcd35059bdcd85df25d140.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 20,
                  "startColumn": 5,
                  "endLine": 54,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bf9d8dca61516f8:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a2492271-c12e-5f06-8521-da30213daeb8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2021-04-05T10-02-27Z__b53500dabc37db6cc1dcd35059bdcd85df25d140.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1eed3861c6c0bde8:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-19f08881-3bfd-5866-b171-2dc1cb5b6edf",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2021-04-05T10-02-27Z__b53500dabc37db6cc1dcd35059bdcd85df25d140.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 127,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "526145f30a450673:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c8eec6ef-1af5-5b6b-97d6-4ebeb854958c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2021-04-05T10-02-27Z__b53500dabc37db6cc1dcd35059bdcd85df25d140.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 128,
                  "startColumn": 5,
                  "endLine": 153,
                  "endColumn": 12
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "98d2c15b1b0fd463:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "e2e-publishing__2021-04-05T10-02-27Z__b53500dabc37db6cc1dcd35059bdcd85df25d140.yml",
          "workflow_name": "Validate publishing functionality",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": {
            "run": {
              "shell": "pwsh"
            }
          },
          "line_count": 153,
          "num_jobs": 4,
          "steps_per_job": {
            "setup-java-publishing": 3,
            "test-publishing-overwrite": 4,
            "test-publishing-skip-overwrite": 4,
            "test-publishing-custom-location": 3
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 4,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 4,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "setup-java-publishing": 3,
              "test-publishing-overwrite": 4,
              "test-publishing-skip-overwrite": 4,
              "test-publishing-custom-location": 3
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 8,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 6,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Validate publishing functionality",
        "true": {
          "push": {
            "branches": [
              "main",
              "releases/*",
              "v2-preview"
            ],
            "paths-ignore": [
              "**.md"
            ]
          },
          "pull_request": {
            "paths-ignore": [
              "**.md"
            ]
          }
        },
        "defaults": {
          "run": {
            "shell": "pwsh"
          }
        },
        "jobs": {
          "setup-java-publishing": {
            "name": "Validate settings.xml",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate settings.xml",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\nGet-Content $xmlPath | ForEach-Object { Write-Host $_ }\n\n[xml]$xml = Get-Content $xmlPath\n$servers = $xml.settings.servers.server\nif (($servers[0].id -ne 'maven') -or ($servers[0].username -ne '${env.MAVEN_USERNAME}') -or ($servers[0].password -ne '${env.MAVEN_CENTRAL_TOKEN}')) {\n  throw \"Generated XML file is incorrect\"\n}\n\nif (($servers[1].id -ne 'gpg.passphrase') -or ($servers[1].passphrase -ne '${env.MAVEN_GPG_PASSPHRASE}')) {\n  throw \"Generated XML file is incorrect\"\n}\n"
              }
            ]
          },
          "test-publishing-overwrite": {
            "name": "settings.xml is overwritten if flag is true",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Create fake settings.xml",
                "run": "$xmlDirectory = Join-Path $HOME \".m2\"\n$xmlPath = Join-Path $xmlDirectory \"settings.xml\"\nNew-Item -Path $xmlDirectory -ItemType Directory\nSet-Content -Path $xmlPath -Value \"Fake_XML\"\n"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate settings.xml is overwritten",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\nGet-Content $xmlPath | ForEach-Object { Write-Host $_ }\n\n$content = Get-Content $xmlPath -Raw\nif ($content -notlike '*maven*') {\n  throw \"settings.xml file is not overwritten\"\n}\n"
              }
            ]
          },
          "test-publishing-skip-overwrite": {
            "name": "settings.xml is not overwritten if flag is false",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Create fake settings.xml",
                "run": "$xmlDirectory = Join-Path $HOME \".m2\"\n$xmlPath = Join-Path $xmlDirectory \"settings.xml\"\nNew-Item -Path $xmlDirectory -ItemType Directory\nSet-Content -Path $xmlPath -Value \"Fake_XML\"\n"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "overwrite-settings": false,
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate that settings.xml is not overwritten",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\n$content = Get-Content -Path $xmlPath -Raw\nWrite-Host $content\n\nif ($content -notlike \"*Fake_XML*\") {\n  throw \"settings.xml file was overwritten but it should not be\"\n}\n"
              }
            ]
          },
          "test-publishing-custom-location": {
            "name": "settings.xml in custom location",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE",
                  "settings-path": "${{ runner.temp }}"
                }
              },
              {
                "name": "Validate settings.xml location",
                "run": "$path = Join-Path $env:RUNNER_TEMP \"settings.xml\"\nif (-not (Test-Path $path)) {\n  throw \"settings.xml file is not found in expected location\"\n}"
              }
            ]
          }
        }
      }
    },
    "2021-04-05T10-14-38Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5909d122-742f-56ca-a058-8ee509dad940",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2021-04-05T10-14-38Z__8764a52df183aa0ccea74521dfd9d506ffc7a19a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 19,
                  "startColumn": 5,
                  "endLine": 53,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bf9d8dca61516f8:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6a97c8f8-a03f-5fa3-a509-b86af35d0850",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2021-04-05T10-14-38Z__8764a52df183aa0ccea74521dfd9d506ffc7a19a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 54,
                  "startColumn": 5,
                  "endLine": 89,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1eed3861c6c0bde8:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-be0b3ffe-3f0f-5fe6-a2ce-122076227ef5",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2021-04-05T10-14-38Z__8764a52df183aa0ccea74521dfd9d506ffc7a19a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 90,
                  "startColumn": 5,
                  "endLine": 126,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "526145f30a450673:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f55da1b9-fdea-5c7c-81d6-cbb4c2d8273e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2021-04-05T10-14-38Z__8764a52df183aa0ccea74521dfd9d506ffc7a19a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 127,
                  "startColumn": 5,
                  "endLine": 152,
                  "endColumn": 12
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "98d2c15b1b0fd463:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "e2e-publishing__2021-04-05T10-14-38Z__8764a52df183aa0ccea74521dfd9d506ffc7a19a.yml",
          "workflow_name": "Validate publishing functionality",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": {
            "run": {
              "shell": "pwsh"
            }
          },
          "line_count": 152,
          "num_jobs": 4,
          "steps_per_job": {
            "setup-java-publishing": 3,
            "test-publishing-overwrite": 4,
            "test-publishing-skip-overwrite": 4,
            "test-publishing-custom-location": 3
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 4,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 4,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "setup-java-publishing": 3,
              "test-publishing-overwrite": 4,
              "test-publishing-skip-overwrite": 4,
              "test-publishing-custom-location": 3
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 8,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 6,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Validate publishing functionality",
        "true": {
          "push": {
            "branches": [
              "main",
              "releases/*"
            ],
            "paths-ignore": [
              "**.md"
            ]
          },
          "pull_request": {
            "paths-ignore": [
              "**.md"
            ]
          }
        },
        "defaults": {
          "run": {
            "shell": "pwsh"
          }
        },
        "jobs": {
          "setup-java-publishing": {
            "name": "Validate settings.xml",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate settings.xml",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\nGet-Content $xmlPath | ForEach-Object { Write-Host $_ }\n\n[xml]$xml = Get-Content $xmlPath\n$servers = $xml.settings.servers.server\nif (($servers[0].id -ne 'maven') -or ($servers[0].username -ne '${env.MAVEN_USERNAME}') -or ($servers[0].password -ne '${env.MAVEN_CENTRAL_TOKEN}')) {\n  throw \"Generated XML file is incorrect\"\n}\n\nif (($servers[1].id -ne 'gpg.passphrase') -or ($servers[1].passphrase -ne '${env.MAVEN_GPG_PASSPHRASE}')) {\n  throw \"Generated XML file is incorrect\"\n}\n"
              }
            ]
          },
          "test-publishing-overwrite": {
            "name": "settings.xml is overwritten if flag is true",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Create fake settings.xml",
                "run": "$xmlDirectory = Join-Path $HOME \".m2\"\n$xmlPath = Join-Path $xmlDirectory \"settings.xml\"\nNew-Item -Path $xmlDirectory -ItemType Directory\nSet-Content -Path $xmlPath -Value \"Fake_XML\"\n"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate settings.xml is overwritten",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\nGet-Content $xmlPath | ForEach-Object { Write-Host $_ }\n\n$content = Get-Content $xmlPath -Raw\nif ($content -notlike '*maven*') {\n  throw \"settings.xml file is not overwritten\"\n}\n"
              }
            ]
          },
          "test-publishing-skip-overwrite": {
            "name": "settings.xml is not overwritten if flag is false",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Create fake settings.xml",
                "run": "$xmlDirectory = Join-Path $HOME \".m2\"\n$xmlPath = Join-Path $xmlDirectory \"settings.xml\"\nNew-Item -Path $xmlDirectory -ItemType Directory\nSet-Content -Path $xmlPath -Value \"Fake_XML\"\n"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "overwrite-settings": false,
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate that settings.xml is not overwritten",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\n$content = Get-Content -Path $xmlPath -Raw\nWrite-Host $content\n\nif ($content -notlike \"*Fake_XML*\") {\n  throw \"settings.xml file was overwritten but it should not be\"\n}\n"
              }
            ]
          },
          "test-publishing-custom-location": {
            "name": "settings.xml in custom location",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v2"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE",
                  "settings-path": "${{ runner.temp }}"
                }
              },
              {
                "name": "Validate settings.xml location",
                "run": "$path = Join-Path $env:RUNNER_TEMP \"settings.xml\"\nif (-not (Test-Path $path)) {\n  throw \"settings.xml file is not found in expected location\"\n}"
              }
            ]
          }
        }
      }
    },
    "2022-12-15T15-10-53Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d4f63c07-47ed-5f2f-b1db-2ee834d3fdc1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2022-12-15T15-10-53Z__1eb7169fc24a3cdc2c700068a228886350f8fb37.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 20,
                  "startColumn": 5,
                  "endLine": 54,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bf9d8dca61516f8:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-96bca227-1d55-5046-8f5b-1b09b1e62bbe",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2022-12-15T15-10-53Z__1eb7169fc24a3cdc2c700068a228886350f8fb37.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1eed3861c6c0bde8:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b533acc7-9c04-5069-bc76-274dfb69f2ae",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2022-12-15T15-10-53Z__1eb7169fc24a3cdc2c700068a228886350f8fb37.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 127,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "526145f30a450673:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9a90c08d-9760-5763-9436-1714e5f9589a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2022-12-15T15-10-53Z__1eb7169fc24a3cdc2c700068a228886350f8fb37.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 128,
                  "startColumn": 5,
                  "endLine": 153,
                  "endColumn": 12
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "98d2c15b1b0fd463:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "e2e-publishing__2022-12-15T15-10-53Z__1eb7169fc24a3cdc2c700068a228886350f8fb37.yml",
          "workflow_name": "Validate publishing functionality",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": {
            "run": {
              "shell": "pwsh"
            }
          },
          "line_count": 153,
          "num_jobs": 4,
          "steps_per_job": {
            "setup-java-publishing": 3,
            "test-publishing-overwrite": 4,
            "test-publishing-skip-overwrite": 4,
            "test-publishing-custom-location": 3
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 4,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 4,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "setup-java-publishing": 3,
              "test-publishing-overwrite": 4,
              "test-publishing-skip-overwrite": 4,
              "test-publishing-custom-location": 3
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 8,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 6,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Validate publishing functionality",
        "true": {
          "push": {
            "branches": [
              "main",
              "releases/*"
            ],
            "paths-ignore": [
              "**.md"
            ]
          },
          "pull_request": {
            "paths-ignore": [
              "**.md"
            ]
          }
        },
        "defaults": {
          "run": {
            "shell": "pwsh"
          }
        },
        "jobs": {
          "setup-java-publishing": {
            "name": "Validate settings.xml",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate settings.xml",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\nGet-Content $xmlPath | ForEach-Object { Write-Host $_ }\n\n[xml]$xml = Get-Content $xmlPath\n$servers = $xml.settings.servers.server\nif (($servers[0].id -ne 'maven') -or ($servers[0].username -ne '${env.MAVEN_USERNAME}') -or ($servers[0].password -ne '${env.MAVEN_CENTRAL_TOKEN}')) {\n  throw \"Generated XML file is incorrect\"\n}\n\nif (($servers[1].id -ne 'gpg.passphrase') -or ($servers[1].passphrase -ne '${env.MAVEN_GPG_PASSPHRASE}')) {\n  throw \"Generated XML file is incorrect\"\n}\n"
              }
            ]
          },
          "test-publishing-overwrite": {
            "name": "settings.xml is overwritten if flag is true",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Create fake settings.xml",
                "run": "$xmlDirectory = Join-Path $HOME \".m2\"\n$xmlPath = Join-Path $xmlDirectory \"settings.xml\"\nNew-Item -Path $xmlDirectory -ItemType Directory\nSet-Content -Path $xmlPath -Value \"Fake_XML\"\n"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate settings.xml is overwritten",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\nGet-Content $xmlPath | ForEach-Object { Write-Host $_ }\n\n$content = Get-Content $xmlPath -Raw\nif ($content -notlike '*maven*') {\n  throw \"settings.xml file is not overwritten\"\n}\n"
              }
            ]
          },
          "test-publishing-skip-overwrite": {
            "name": "settings.xml is not overwritten if flag is false",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Create fake settings.xml",
                "run": "$xmlDirectory = Join-Path $HOME \".m2\"\n$xmlPath = Join-Path $xmlDirectory \"settings.xml\"\nNew-Item -Path $xmlDirectory -ItemType Directory\nSet-Content -Path $xmlPath -Value \"Fake_XML\"\n"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "overwrite-settings": false,
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate that settings.xml is not overwritten",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\n$content = Get-Content -Path $xmlPath -Raw\nWrite-Host $content\n\nif ($content -notlike \"*Fake_XML*\") {\n  throw \"settings.xml file was overwritten but it should not be\"\n}\n"
              }
            ]
          },
          "test-publishing-custom-location": {
            "name": "settings.xml in custom location",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE",
                  "settings-path": "${{ runner.temp }}"
                }
              },
              {
                "name": "Validate settings.xml location",
                "run": "$path = Join-Path $env:RUNNER_TEMP \"settings.xml\"\nif (-not (Test-Path $path)) {\n  throw \"settings.xml file is not found in expected location\"\n}"
              }
            ]
          }
        }
      }
    },
    "2022-04-07T10-25-49Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6d73884a-06d7-5547-b346-a8ea5c14fa21",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2022-04-07T10-25-49Z__cd3510900760be04f0473489ef80509989c22cf3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 19,
                  "startColumn": 5,
                  "endLine": 53,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bf9d8dca61516f8:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c43bafb3-33f5-5726-a90d-76e85625a254",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2022-04-07T10-25-49Z__cd3510900760be04f0473489ef80509989c22cf3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 54,
                  "startColumn": 5,
                  "endLine": 89,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1eed3861c6c0bde8:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-889d61ee-14f7-578c-9971-54e790c56632",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2022-04-07T10-25-49Z__cd3510900760be04f0473489ef80509989c22cf3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 90,
                  "startColumn": 5,
                  "endLine": 126,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "526145f30a450673:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c21ee859-7b86-57c3-8dba-00466b03b1cc",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2022-04-07T10-25-49Z__cd3510900760be04f0473489ef80509989c22cf3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 127,
                  "startColumn": 5,
                  "endLine": 152,
                  "endColumn": 12
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "98d2c15b1b0fd463:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "e2e-publishing__2022-04-07T10-25-49Z__cd3510900760be04f0473489ef80509989c22cf3.yml",
          "workflow_name": "Validate publishing functionality",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": {
            "run": {
              "shell": "pwsh"
            }
          },
          "line_count": 152,
          "num_jobs": 4,
          "steps_per_job": {
            "setup-java-publishing": 3,
            "test-publishing-overwrite": 4,
            "test-publishing-skip-overwrite": 4,
            "test-publishing-custom-location": 3
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 4,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 4,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "setup-java-publishing": 3,
              "test-publishing-overwrite": 4,
              "test-publishing-skip-overwrite": 4,
              "test-publishing-custom-location": 3
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 8,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 6,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Validate publishing functionality",
        "true": {
          "push": {
            "branches": [
              "main",
              "releases/*"
            ],
            "paths-ignore": [
              "**.md"
            ]
          },
          "pull_request": {
            "paths-ignore": [
              "**.md"
            ]
          }
        },
        "defaults": {
          "run": {
            "shell": "pwsh"
          }
        },
        "jobs": {
          "setup-java-publishing": {
            "name": "Validate settings.xml",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate settings.xml",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\nGet-Content $xmlPath | ForEach-Object { Write-Host $_ }\n\n[xml]$xml = Get-Content $xmlPath\n$servers = $xml.settings.servers.server\nif (($servers[0].id -ne 'maven') -or ($servers[0].username -ne '${env.MAVEN_USERNAME}') -or ($servers[0].password -ne '${env.MAVEN_CENTRAL_TOKEN}')) {\n  throw \"Generated XML file is incorrect\"\n}\n\nif (($servers[1].id -ne 'gpg.passphrase') -or ($servers[1].passphrase -ne '${env.MAVEN_GPG_PASSPHRASE}')) {\n  throw \"Generated XML file is incorrect\"\n}\n"
              }
            ]
          },
          "test-publishing-overwrite": {
            "name": "settings.xml is overwritten if flag is true",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Create fake settings.xml",
                "run": "$xmlDirectory = Join-Path $HOME \".m2\"\n$xmlPath = Join-Path $xmlDirectory \"settings.xml\"\nNew-Item -Path $xmlDirectory -ItemType Directory\nSet-Content -Path $xmlPath -Value \"Fake_XML\"\n"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate settings.xml is overwritten",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\nGet-Content $xmlPath | ForEach-Object { Write-Host $_ }\n\n$content = Get-Content $xmlPath -Raw\nif ($content -notlike '*maven*') {\n  throw \"settings.xml file is not overwritten\"\n}\n"
              }
            ]
          },
          "test-publishing-skip-overwrite": {
            "name": "settings.xml is not overwritten if flag is false",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Create fake settings.xml",
                "run": "$xmlDirectory = Join-Path $HOME \".m2\"\n$xmlPath = Join-Path $xmlDirectory \"settings.xml\"\nNew-Item -Path $xmlDirectory -ItemType Directory\nSet-Content -Path $xmlPath -Value \"Fake_XML\"\n"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "overwrite-settings": false,
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate that settings.xml is not overwritten",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\n$content = Get-Content -Path $xmlPath -Raw\nWrite-Host $content\n\nif ($content -notlike \"*Fake_XML*\") {\n  throw \"settings.xml file was overwritten but it should not be\"\n}\n"
              }
            ]
          },
          "test-publishing-custom-location": {
            "name": "settings.xml in custom location",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE",
                  "settings-path": "${{ runner.temp }}"
                }
              },
              {
                "name": "Validate settings.xml location",
                "run": "$path = Join-Path $env:RUNNER_TEMP \"settings.xml\"\nif (-not (Test-Path $path)) {\n  throw \"settings.xml file is not found in expected location\"\n}"
              }
            ]
          }
        }
      }
    },
    "2023-03-09T12-49-35Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9ae98fde-a4a6-5e37-afbe-dd4ba93c7c0a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2023-03-09T12-49-35Z__0de5c66fc0305485b7204d217714170639dcb8fc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 20,
                  "startColumn": 5,
                  "endLine": 54,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bf9d8dca61516f8:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c9dfa316-0989-50bf-b668-6f6ef30daf4a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2023-03-09T12-49-35Z__0de5c66fc0305485b7204d217714170639dcb8fc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1eed3861c6c0bde8:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d3be9285-b046-5081-ae4e-90e0134d29fa",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2023-03-09T12-49-35Z__0de5c66fc0305485b7204d217714170639dcb8fc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 127,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "526145f30a450673:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4c59bee0-e4ed-581c-a074-c135ef33e10e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2023-03-09T12-49-35Z__0de5c66fc0305485b7204d217714170639dcb8fc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 128,
                  "startColumn": 5,
                  "endLine": 153,
                  "endColumn": 13
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "98d2c15b1b0fd463:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "e2e-publishing__2023-03-09T12-49-35Z__0de5c66fc0305485b7204d217714170639dcb8fc.yml",
          "workflow_name": "Validate publishing functionality",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": {
            "run": {
              "shell": "pwsh"
            }
          },
          "line_count": 153,
          "num_jobs": 4,
          "steps_per_job": {
            "setup-java-publishing": 3,
            "test-publishing-overwrite": 4,
            "test-publishing-skip-overwrite": 4,
            "test-publishing-custom-location": 3
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 4,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 4,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "setup-java-publishing": 3,
              "test-publishing-overwrite": 4,
              "test-publishing-skip-overwrite": 4,
              "test-publishing-custom-location": 3
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 8,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 6,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Validate publishing functionality",
        "true": {
          "push": {
            "branches": [
              "main",
              "releases/*"
            ],
            "paths-ignore": [
              "**.md"
            ]
          },
          "pull_request": {
            "paths-ignore": [
              "**.md"
            ]
          }
        },
        "defaults": {
          "run": {
            "shell": "pwsh"
          }
        },
        "jobs": {
          "setup-java-publishing": {
            "name": "Validate settings.xml",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate settings.xml",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\nGet-Content $xmlPath | ForEach-Object { Write-Host $_ }\n\n[xml]$xml = Get-Content $xmlPath\n$servers = $xml.settings.servers.server\nif (($servers[0].id -ne 'maven') -or ($servers[0].username -ne '${env.MAVEN_USERNAME}') -or ($servers[0].password -ne '${env.MAVEN_CENTRAL_TOKEN}')) {\n  throw \"Generated XML file is incorrect\"\n}\n\nif (($servers[1].id -ne 'gpg.passphrase') -or ($servers[1].passphrase -ne '${env.MAVEN_GPG_PASSPHRASE}')) {\n  throw \"Generated XML file is incorrect\"\n}\n"
              }
            ]
          },
          "test-publishing-overwrite": {
            "name": "settings.xml is overwritten if flag is true",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Create fake settings.xml",
                "run": "$xmlDirectory = Join-Path $HOME \".m2\"\n$xmlPath = Join-Path $xmlDirectory \"settings.xml\"\nNew-Item -Path $xmlDirectory -ItemType Directory\nSet-Content -Path $xmlPath -Value \"Fake_XML\"\n"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate settings.xml is overwritten",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\nGet-Content $xmlPath | ForEach-Object { Write-Host $_ }\n\n$content = Get-Content $xmlPath -Raw\nif ($content -notlike '*maven*') {\n  throw \"settings.xml file is not overwritten\"\n}\n"
              }
            ]
          },
          "test-publishing-skip-overwrite": {
            "name": "settings.xml is not overwritten if flag is false",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Create fake settings.xml",
                "run": "$xmlDirectory = Join-Path $HOME \".m2\"\n$xmlPath = Join-Path $xmlDirectory \"settings.xml\"\nNew-Item -Path $xmlDirectory -ItemType Directory\nSet-Content -Path $xmlPath -Value \"Fake_XML\"\n"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "overwrite-settings": false,
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate that settings.xml is not overwritten",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\n$content = Get-Content -Path $xmlPath -Raw\nWrite-Host $content\n\nif ($content -notlike \"*Fake_XML*\") {\n  throw \"settings.xml file was overwritten but it should not be\"\n}\n"
              }
            ]
          },
          "test-publishing-custom-location": {
            "name": "settings.xml in custom location",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE",
                  "settings-path": "${{ runner.temp }}"
                }
              },
              {
                "name": "Validate settings.xml location",
                "run": "$path = Join-Path $env:RUNNER_TEMP \"settings.xml\"\nif (-not (Test-Path $path)) {\n  throw \"settings.xml file is not found in expected location\"\n}\n"
              }
            ]
          }
        }
      }
    },
    "2023-12-01T10-16-32Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6068ca76-9907-5501-a282-fd3f13d9bc41",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2023-12-01T10-16-32Z__a2374547dfdd276b7bd9e4ba2c6ba50647d9c8a7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 20,
                  "startColumn": 5,
                  "endLine": 54,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bf9d8dca61516f8:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-41c7334c-4bec-5c88-8c32-38f20464b5fc",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2023-12-01T10-16-32Z__a2374547dfdd276b7bd9e4ba2c6ba50647d9c8a7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1eed3861c6c0bde8:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d1aea111-ac65-5d67-b481-5942903d1515",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2023-12-01T10-16-32Z__a2374547dfdd276b7bd9e4ba2c6ba50647d9c8a7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 127,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "526145f30a450673:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-70bd48f8-4436-5af4-9abe-711b90b96d05",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2023-12-01T10-16-32Z__a2374547dfdd276b7bd9e4ba2c6ba50647d9c8a7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 128,
                  "startColumn": 5,
                  "endLine": 153,
                  "endColumn": 13
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "98d2c15b1b0fd463:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "e2e-publishing__2023-12-01T10-16-32Z__a2374547dfdd276b7bd9e4ba2c6ba50647d9c8a7.yml",
          "workflow_name": "Validate publishing functionality",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": {
            "run": {
              "shell": "pwsh"
            }
          },
          "line_count": 153,
          "num_jobs": 4,
          "steps_per_job": {
            "setup-java-publishing": 3,
            "test-publishing-overwrite": 4,
            "test-publishing-skip-overwrite": 4,
            "test-publishing-custom-location": 3
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 4,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 4,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "setup-java-publishing": 3,
              "test-publishing-overwrite": 4,
              "test-publishing-skip-overwrite": 4,
              "test-publishing-custom-location": 3
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 8,
            "actions_used": [
              "./",
              "actions/checkout@v4"
            ],
            "num_run_commands": 6,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Validate publishing functionality",
        "true": {
          "push": {
            "branches": [
              "main",
              "releases/*"
            ],
            "paths-ignore": [
              "**.md"
            ]
          },
          "pull_request": {
            "paths-ignore": [
              "**.md"
            ]
          }
        },
        "defaults": {
          "run": {
            "shell": "pwsh"
          }
        },
        "jobs": {
          "setup-java-publishing": {
            "name": "Validate settings.xml",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate settings.xml",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\nGet-Content $xmlPath | ForEach-Object { Write-Host $_ }\n\n[xml]$xml = Get-Content $xmlPath\n$servers = $xml.settings.servers.server\nif (($servers[0].id -ne 'maven') -or ($servers[0].username -ne '${env.MAVEN_USERNAME}') -or ($servers[0].password -ne '${env.MAVEN_CENTRAL_TOKEN}')) {\n  throw \"Generated XML file is incorrect\"\n}\n\nif (($servers[1].id -ne 'gpg.passphrase') -or ($servers[1].passphrase -ne '${env.MAVEN_GPG_PASSPHRASE}')) {\n  throw \"Generated XML file is incorrect\"\n}\n"
              }
            ]
          },
          "test-publishing-overwrite": {
            "name": "settings.xml is overwritten if flag is true",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Create fake settings.xml",
                "run": "$xmlDirectory = Join-Path $HOME \".m2\"\n$xmlPath = Join-Path $xmlDirectory \"settings.xml\"\nNew-Item -Path $xmlDirectory -ItemType Directory\nSet-Content -Path $xmlPath -Value \"Fake_XML\"\n"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate settings.xml is overwritten",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\nGet-Content $xmlPath | ForEach-Object { Write-Host $_ }\n\n$content = Get-Content $xmlPath -Raw\nif ($content -notlike '*maven*') {\n  throw \"settings.xml file is not overwritten\"\n}\n"
              }
            ]
          },
          "test-publishing-skip-overwrite": {
            "name": "settings.xml is not overwritten if flag is false",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Create fake settings.xml",
                "run": "$xmlDirectory = Join-Path $HOME \".m2\"\n$xmlPath = Join-Path $xmlDirectory \"settings.xml\"\nNew-Item -Path $xmlDirectory -ItemType Directory\nSet-Content -Path $xmlPath -Value \"Fake_XML\"\n"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "overwrite-settings": false,
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate that settings.xml is not overwritten",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\n$content = Get-Content -Path $xmlPath -Raw\nWrite-Host $content\n\nif ($content -notlike \"*Fake_XML*\") {\n  throw \"settings.xml file was overwritten but it should not be\"\n}\n"
              }
            ]
          },
          "test-publishing-custom-location": {
            "name": "settings.xml in custom location",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE",
                  "settings-path": "${{ runner.temp }}"
                }
              },
              {
                "name": "Validate settings.xml location",
                "run": "$path = Join-Path $env:RUNNER_TEMP \"settings.xml\"\nif (-not (Test-Path $path)) {\n  throw \"settings.xml file is not found in expected location\"\n}\n"
              }
            ]
          }
        }
      }
    },
    "2025-08-21T02-56-38Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bc7a2b26-bb0f-5a2d-a467-ee29b27dd805",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2025-08-21T02-56-38Z__dded0888837ed1f317902acf8a20df0ad188d165.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 20,
                  "startColumn": 5,
                  "endLine": 54,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bf9d8dca61516f8:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3ab9ce7e-d489-55ef-a3ab-e7c6216c4509",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2025-08-21T02-56-38Z__dded0888837ed1f317902acf8a20df0ad188d165.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1eed3861c6c0bde8:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5c9e9c7e-07ab-5233-ae02-659b81865937",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2025-08-21T02-56-38Z__dded0888837ed1f317902acf8a20df0ad188d165.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 127,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "526145f30a450673:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fc32b339-7354-58a7-b395-7d52f3c6a656",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/e2e-publishing__2025-08-21T02-56-38Z__dded0888837ed1f317902acf8a20df0ad188d165.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 128,
                  "startColumn": 5,
                  "endLine": 153,
                  "endColumn": 13
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "98d2c15b1b0fd463:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "e2e-publishing__2025-08-21T02-56-38Z__dded0888837ed1f317902acf8a20df0ad188d165.yml",
          "workflow_name": "Validate publishing functionality",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": {
            "run": {
              "shell": "pwsh"
            }
          },
          "line_count": 153,
          "num_jobs": 4,
          "steps_per_job": {
            "setup-java-publishing": 3,
            "test-publishing-overwrite": 4,
            "test-publishing-skip-overwrite": 4,
            "test-publishing-custom-location": 3
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 4,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 4,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "setup-java-publishing": 3,
              "test-publishing-overwrite": 4,
              "test-publishing-skip-overwrite": 4,
              "test-publishing-custom-location": 3
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 8,
            "actions_used": [
              "./",
              "actions/checkout@v5"
            ],
            "num_run_commands": 6,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Validate publishing functionality",
        "true": {
          "push": {
            "branches": [
              "main",
              "releases/*"
            ],
            "paths-ignore": [
              "**.md"
            ]
          },
          "pull_request": {
            "paths-ignore": [
              "**.md"
            ]
          }
        },
        "defaults": {
          "run": {
            "shell": "pwsh"
          }
        },
        "jobs": {
          "setup-java-publishing": {
            "name": "Validate settings.xml",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v5"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate settings.xml",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\nGet-Content $xmlPath | ForEach-Object { Write-Host $_ }\n\n[xml]$xml = Get-Content $xmlPath\n$servers = $xml.settings.servers.server\nif (($servers[0].id -ne 'maven') -or ($servers[0].username -ne '${env.MAVEN_USERNAME}') -or ($servers[0].password -ne '${env.MAVEN_CENTRAL_TOKEN}')) {\n  throw \"Generated XML file is incorrect\"\n}\n\nif (($servers[1].id -ne 'gpg.passphrase') -or ($servers[1].passphrase -ne '${env.MAVEN_GPG_PASSPHRASE}')) {\n  throw \"Generated XML file is incorrect\"\n}\n"
              }
            ]
          },
          "test-publishing-overwrite": {
            "name": "settings.xml is overwritten if flag is true",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v5"
              },
              {
                "name": "Create fake settings.xml",
                "run": "$xmlDirectory = Join-Path $HOME \".m2\"\n$xmlPath = Join-Path $xmlDirectory \"settings.xml\"\nNew-Item -Path $xmlDirectory -ItemType Directory\nSet-Content -Path $xmlPath -Value \"Fake_XML\"\n"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate settings.xml is overwritten",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\nGet-Content $xmlPath | ForEach-Object { Write-Host $_ }\n\n$content = Get-Content $xmlPath -Raw\nif ($content -notlike '*maven*') {\n  throw \"settings.xml file is not overwritten\"\n}\n"
              }
            ]
          },
          "test-publishing-skip-overwrite": {
            "name": "settings.xml is not overwritten if flag is false",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v5"
              },
              {
                "name": "Create fake settings.xml",
                "run": "$xmlDirectory = Join-Path $HOME \".m2\"\n$xmlPath = Join-Path $xmlDirectory \"settings.xml\"\nNew-Item -Path $xmlDirectory -ItemType Directory\nSet-Content -Path $xmlPath -Value \"Fake_XML\"\n"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "overwrite-settings": false,
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE"
                }
              },
              {
                "name": "Validate that settings.xml is not overwritten",
                "run": "$xmlPath = Join-Path $HOME \".m2\" \"settings.xml\"\n$content = Get-Content -Path $xmlPath -Raw\nWrite-Host $content\n\nif ($content -notlike \"*Fake_XML*\") {\n  throw \"settings.xml file was overwritten but it should not be\"\n}\n"
              }
            ]
          },
          "test-publishing-custom-location": {
            "name": "settings.xml in custom location",
            "runs-on": "${{ matrix.os }}",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "os": [
                  "macos-latest",
                  "windows-latest",
                  "ubuntu-latest"
                ]
              }
            },
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v5"
              },
              {
                "name": "setup-java",
                "uses": "./",
                "id": "setup-java",
                "with": {
                  "distribution": "adopt",
                  "java-version": "11",
                  "server-id": "maven",
                  "server-username": "MAVEN_USERNAME",
                  "server-password": "MAVEN_CENTRAL_TOKEN",
                  "gpg-passphrase": "MAVEN_GPG_PASSPHRASE",
                  "settings-path": "${{ runner.temp }}"
                }
              },
              {
                "name": "Validate settings.xml location",
                "run": "$path = Join-Path $env:RUNNER_TEMP \"settings.xml\"\nif (-not (Test-Path $path)) {\n  throw \"settings.xml file is not found in expected location\"\n}\n"
              }
            ]
          }
        }
      }
    }
  }
}