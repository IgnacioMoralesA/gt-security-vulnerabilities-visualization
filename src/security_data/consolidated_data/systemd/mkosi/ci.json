{
  "repo_owner": "systemd",
  "repo_name": "mkosi",
  "workflow_name": "ci",
  "history": {
    "2020-07-26T12-45-46Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9cac1bb3-3db6-559f-b1bf-2473a4b9b6d6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-07-26T12-45-46Z__4e077d8fb9cd503142255cab28406239157a4b34.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 229,
                  "endColumn": 33
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-07-26T12-45-46Z__4e077d8fb9cd503142255cab28406239157a4b34.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 229,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "actions/checkout@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 3,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get --assume-yes --no-install-recommends install asciidoc check debootstrap e2fsprogs libarchive-dev libcppunit-dev libcurl4-openssl-dev libjson-c-dev libgpgme-dev libmagic-dev librpm-dev libsmartcols-dev libyaml-dev libzstd-dev meson ninja-build python3-gpg python3-rpm python3-sphinx squashfs-tools swig systemd-container xfsprogs xsltproc"
              },
              {
                "name": "Install dependencies (Arch Linux)",
                "if": "matrix.distro == 'arch'",
                "run": "wget https://sources.archlinux.org/other/pacman/pacman-$PACMAN_VERSION.tar.gz\ntar xf pacman-$PACMAN_VERSION.tar.gz\n\nmeson \\\n  -Dbuildtype=release \\\n  -Ddoc=disabled \\\n  -Dscriptlet-shell=/usr/bin/bash \\\n  -Dldconfig=/usr/bin/ldconfig \\\n  build/pacman \\\n  pacman-$PACMAN_VERSION\nsudo meson install -C build/pacman\n\nwget https://sources.archlinux.org/other/archlinux-keyring/archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\ntar xf archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\n\nsudo make -C archlinux-keyring-$ARCHLINUX_KEYRING_VERSION PREFIX=/usr install\nsudo pacman-key --init\nsudo pacman-key --populate archlinux\n\nwget https://git.archlinux.org/arch-install-scripts.git/snapshot/arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\ntar xf arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\n\nsudo make -C arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION PREFIX=/usr install\n",
                "env": {
                  "PACMAN_VERSION": "5.2.2",
                  "ARCHLINUX_KEYRING_VERSION": "20200622",
                  "ARCH_INSTALL_SCRIPTS_VERSION": "23"
                }
              },
              {
                "name": "Install dependencies (CentOS Linux)",
                "if": "startsWith(matrix.distro, 'centos') || matrix.distro == 'fedora' || matrix.distro == 'openmandriva'",
                "run": "wget https://github.com/rpm-software-management/libcomps/archive/libcomps-$LIBCOMPS_VERSION.tar.gz\ntar xf libcomps-$LIBCOMPS_VERSION.tar.gz\n\ncmake \\\n    -S libcomps-libcomps-$LIBCOMPS_VERSION/libcomps \\\n    -B build/libcomps \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DPYTHON_DESIRED=3 \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -Wno-dev\ncmake --build build/libcomps\nsudo cmake --install build/libcomps\n\nwget https://github.com/rpm-software-management/librepo/archive/$LIBREPO_VERSION.tar.gz\ntar xf $LIBREPO_VERSION.tar.gz\n\ncmake \\\n    -S librepo-$LIBREPO_VERSION \\\n    -B build/librepo \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON\ncmake --build build/librepo\nsudo cmake --install build/librepo\n\nwget https://github.com/fedora-modularity/libmodulemd/archive/libmodulemd-$LIBMODULEMD_VERSION.tar.gz\ntar xf libmodulemd-$LIBMODULEMD_VERSION.tar.gz\n\nmeson \\\n    --prefix /usr \\\n    -Dbuildtype=release \\\n    -Dlibdir=lib/x86_64-linux-gnu \\\n    -Ddeveloper_build=false \\\n    -Dwith_docs=false \\\n    -Dwith_manpages=disabled \\\n    -Dskip_introspection=true \\\n    -Dgobject_overrides_dir_py3=override \\\n    build/libmodulemd \\\n    libmodulemd-libmodulemd-$LIBMODULEMD_VERSION\nsudo meson install -C build/libmodulemd\n\nwget https://github.com/openSUSE/libsolv/archive/$LIBSOLV_VERSION.tar.gz\ntar xf $LIBSOLV_VERSION.tar.gz\n\ncmake \\\n    -S libsolv-$LIBSOLV_VERSION \\\n    -B build/libsolv \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_RPMDB=ON \\\n    -DENABLE_RPMPKG=ON \\\n    -DENABLE_PUBKEY=ON \\\n    -DENABLE_RPMDB_BYRPMHEADER=ON \\\n    -DENABLE_RPMDB_LIBRPM=ON \\\n    -DENABLE_RPMPKG_LIBRPM=ON \\\n    -DENABLE_RPMMD=ON \\\n    -DENABLE_COMPS=ON \\\n    -DENABLE_MDKREPO=ON \\\n    -DENABLE_COMPLEX_DEPS=ON \\\n    -DENABLE_APPDATA=ON \\\n    -DENABLE_LZMA_COMPRESSION=ON \\\n    -DENABLE_BZIP2_COMPRESSION=ON \\\n    -DENABLE_ZSTD_COMPRESSION=ON\ncmake --build build/libsolv\nsudo cmake --install build/libsolv\n\nwget https://github.com/rpm-software-management/libdnf/archive/$LIBDNF_VERSION.tar.gz\ntar xf $LIBDNF_VERSION.tar.gz\n\ncp /usr/share/cmake/Modules/FindLibSolv.cmake libdnf-$LIBDNF_VERSION/cmake/modules\n\ncmake \\\n    -S libdnf-$LIBDNF_VERSION \\\n    -B build/libdnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DWITH_GTKDOC=OFF \\\n    -DWITH_HTML=OFF \\\n    -DWITH_MAN=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -DCMAKE_CXX_FLAGS=\"-pthread\" \\\n    -DPYTHON_DESIRED=3\ncmake --build build/libdnf\nsudo cmake --install build/libdnf\n\nwget https://github.com/rpm-software-management/dnf/archive/$DNF_VERSION.tar.gz\ntar xf $DNF_VERSION.tar.gz\n\ncmake \\\n    -S dnf-$DNF_VERSION \\\n    -B build/dnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DPYTHON_DESIRED=3 \\\n    -DWITH_MAN=0\ncmake --build build/dnf\nsudo cmake --install build/dnf\n\nsudo ln -s /usr/bin/dnf-3 /usr/bin/dnf\n",
                "env": {
                  "CMAKE_GENERATOR": "Ninja",
                  "LIBCOMPS_VERSION": "0.1.15",
                  "LIBREPO_VERSION": "1.12.0",
                  "LIBMODULEMD_VERSION": "2.9.4",
                  "LIBSOLV_VERSION": "0.7.14",
                  "LIBDNF_VERSION": "0.48.0",
                  "DNF_VERSION": "4.2.23"
                }
              },
              {
                "name": "Install swupd-extract (Clear Linux)",
                "if": "matrix.distro == 'clear'",
                "run": "go get -u github.com/clearlinux/mixer-tools/swupd-extract\nsudo ln -s ~/go/bin/swupd-extract /usr/bin/swupd-extract\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --default /dev/null"
              }
            ]
          }
        }
      }
    },
    "2020-07-19T10-11-40Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-18d35708-6501-5114-8909-0d8e21bdbef7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-07-19T10-11-40Z__5ddf909fe1eebea1d4ff5d9c3fb5a1e5a2671fd3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 228,
                  "endColumn": 33
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-07-19T10-11-40Z__5ddf909fe1eebea1d4ff5d9c3fb5a1e5a2671fd3.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 228,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "actions/checkout@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 3,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get --assume-yes --no-install-recommends install asciidoc check debootstrap e2fsprogs libarchive-dev libcppunit-dev libcurl4-openssl-dev libjson-c-dev libgpgme-dev libmagic-dev librpm-dev libsmartcols-dev libyaml-dev libzstd-dev meson ninja-build python3-gpg python3-rpm python3-sphinx squashfs-tools swig systemd-container xfsprogs xsltproc"
              },
              {
                "name": "Install dependencies (Arch Linux)",
                "if": "matrix.distro == 'arch'",
                "run": "wget https://sources.archlinux.org/other/pacman/pacman-$PACMAN_VERSION.tar.gz\ntar xf pacman-$PACMAN_VERSION.tar.gz\n\nmeson \\\n  -Dbuildtype=release \\\n  -Ddoc=disabled \\\n  -Dscriptlet-shell=/usr/bin/bash \\\n  -Dldconfig=/usr/bin/ldconfig \\\n  build/pacman \\\n  pacman-$PACMAN_VERSION\nsudo meson install -C build/pacman\n\nwget https://sources.archlinux.org/other/archlinux-keyring/archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\ntar xf archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\n\nsudo make -C archlinux-keyring-$ARCHLINUX_KEYRING_VERSION PREFIX=/usr install\nsudo pacman-key --init\nsudo pacman-key --populate archlinux\n\nwget https://git.archlinux.org/arch-install-scripts.git/snapshot/arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\ntar xf arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\n\nsudo make -C arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION PREFIX=/usr install\n",
                "env": {
                  "PACMAN_VERSION": "5.2.2",
                  "ARCHLINUX_KEYRING_VERSION": "20200622",
                  "ARCH_INSTALL_SCRIPTS_VERSION": "23"
                }
              },
              {
                "name": "Install dependencies (CentOS Linux)",
                "if": "startsWith(matrix.distro, 'centos') || matrix.distro == 'fedora'",
                "run": "wget https://github.com/rpm-software-management/libcomps/archive/libcomps-$LIBCOMPS_VERSION.tar.gz\ntar xf libcomps-$LIBCOMPS_VERSION.tar.gz\n\ncmake \\\n    -S libcomps-libcomps-$LIBCOMPS_VERSION/libcomps \\\n    -B build/libcomps \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DPYTHON_DESIRED=3 \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -Wno-dev\ncmake --build build/libcomps\nsudo cmake --install build/libcomps\n\nwget https://github.com/rpm-software-management/librepo/archive/$LIBREPO_VERSION.tar.gz\ntar xf $LIBREPO_VERSION.tar.gz\n\ncmake \\\n    -S librepo-$LIBREPO_VERSION \\\n    -B build/librepo \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON\ncmake --build build/librepo\nsudo cmake --install build/librepo\n\nwget https://github.com/fedora-modularity/libmodulemd/archive/libmodulemd-$LIBMODULEMD_VERSION.tar.gz\ntar xf libmodulemd-$LIBMODULEMD_VERSION.tar.gz\n\nmeson \\\n    --prefix /usr \\\n    -Dbuildtype=release \\\n    -Dlibdir=lib/x86_64-linux-gnu \\\n    -Ddeveloper_build=false \\\n    -Dwith_docs=false \\\n    -Dwith_manpages=disabled \\\n    -Dskip_introspection=true \\\n    -Dgobject_overrides_dir_py3=override \\\n    build/libmodulemd \\\n    libmodulemd-libmodulemd-$LIBMODULEMD_VERSION\nsudo meson install -C build/libmodulemd\n\nwget https://github.com/openSUSE/libsolv/archive/$LIBSOLV_VERSION.tar.gz\ntar xf $LIBSOLV_VERSION.tar.gz\n\ncmake \\\n    -S libsolv-$LIBSOLV_VERSION \\\n    -B build/libsolv \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_RPMDB=ON \\\n    -DENABLE_RPMPKG=ON \\\n    -DENABLE_PUBKEY=ON \\\n    -DENABLE_RPMDB_BYRPMHEADER=ON \\\n    -DENABLE_RPMDB_LIBRPM=ON \\\n    -DENABLE_RPMPKG_LIBRPM=ON \\\n    -DENABLE_RPMMD=ON \\\n    -DENABLE_COMPS=ON \\\n    -DENABLE_MDKREPO=ON \\\n    -DENABLE_COMPLEX_DEPS=ON \\\n    -DENABLE_APPDATA=ON \\\n    -DENABLE_LZMA_COMPRESSION=ON \\\n    -DENABLE_BZIP2_COMPRESSION=ON \\\n    -DENABLE_ZSTD_COMPRESSION=ON\ncmake --build build/libsolv\nsudo cmake --install build/libsolv\n\nwget https://github.com/rpm-software-management/libdnf/archive/$LIBDNF_VERSION.tar.gz\ntar xf $LIBDNF_VERSION.tar.gz\n\ncp /usr/share/cmake/Modules/FindLibSolv.cmake libdnf-$LIBDNF_VERSION/cmake/modules\n\ncmake \\\n    -S libdnf-$LIBDNF_VERSION \\\n    -B build/libdnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DWITH_GTKDOC=OFF \\\n    -DWITH_HTML=OFF \\\n    -DWITH_MAN=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -DCMAKE_CXX_FLAGS=\"-pthread\" \\\n    -DPYTHON_DESIRED=3\ncmake --build build/libdnf\nsudo cmake --install build/libdnf\n\nwget https://github.com/rpm-software-management/dnf/archive/$DNF_VERSION.tar.gz\ntar xf $DNF_VERSION.tar.gz\n\ncmake \\\n    -S dnf-$DNF_VERSION \\\n    -B build/dnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DPYTHON_DESIRED=3 \\\n    -DWITH_MAN=0\ncmake --build build/dnf\nsudo cmake --install build/dnf\n\nsudo ln -s /usr/bin/dnf-3 /usr/bin/dnf\n",
                "env": {
                  "CMAKE_GENERATOR": "Ninja",
                  "LIBCOMPS_VERSION": "0.1.15",
                  "LIBREPO_VERSION": "1.12.0",
                  "LIBMODULEMD_VERSION": "2.9.4",
                  "LIBSOLV_VERSION": "0.7.14",
                  "LIBDNF_VERSION": "0.48.0",
                  "DNF_VERSION": "4.2.23"
                }
              },
              {
                "name": "Install swupd-extract (Clear Linux)",
                "if": "matrix.distro == 'clear'",
                "run": "go get -u github.com/clearlinux/mixer-tools/swupd-extract\nsudo ln -s ~/go/bin/swupd-extract /usr/bin/swupd-extract\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --default /dev/null"
              }
            ]
          }
        }
      }
    },
    "2020-07-28T20-24-51Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-93368eb5-f6ff-59a1-bf6b-58411908b6fe",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-07-28T20-24-51Z__40263ed2cb9ac7e63332edaa991ddd122244381d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 231,
                  "endColumn": 43
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-07-28T20-24-51Z__40263ed2cb9ac7e63332edaa991ddd122244381d.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 231,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "actions/checkout@v2"
            ],
            "num_run_commands": 6,
            "steps_with_conditionals": 3,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Update",
                "run": "sudo apt-get update"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get --assume-yes --no-install-recommends install asciidoc check debootstrap e2fsprogs libarchive-dev libcppunit-dev libcurl4-openssl-dev libjson-c-dev libgpgme-dev libmagic-dev librpm-dev libsmartcols-dev libyaml-dev libzstd-dev meson ninja-build python3-gpg python3-rpm python3-sphinx squashfs-tools swig systemd-container xfsprogs xsltproc"
              },
              {
                "name": "Install dependencies (Arch Linux)",
                "if": "matrix.distro == 'arch'",
                "run": "wget https://sources.archlinux.org/other/pacman/pacman-$PACMAN_VERSION.tar.gz\ntar xf pacman-$PACMAN_VERSION.tar.gz\n\nmeson \\\n  -Dbuildtype=release \\\n  -Ddoc=disabled \\\n  -Dscriptlet-shell=/usr/bin/bash \\\n  -Dldconfig=/usr/bin/ldconfig \\\n  build/pacman \\\n  pacman-$PACMAN_VERSION\nsudo meson install -C build/pacman\n\nwget https://sources.archlinux.org/other/archlinux-keyring/archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\ntar xf archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\n\nsudo make -C archlinux-keyring-$ARCHLINUX_KEYRING_VERSION PREFIX=/usr install\nsudo pacman-key --init\nsudo pacman-key --populate archlinux\n\nwget https://git.archlinux.org/arch-install-scripts.git/snapshot/arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\ntar xf arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\n\nsudo make -C arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION PREFIX=/usr install\n",
                "env": {
                  "PACMAN_VERSION": "5.2.2",
                  "ARCHLINUX_KEYRING_VERSION": "20200622",
                  "ARCH_INSTALL_SCRIPTS_VERSION": "23"
                }
              },
              {
                "name": "Install dependencies (CentOS Linux)",
                "if": "startsWith(matrix.distro, 'centos') || matrix.distro == 'fedora' || matrix.distro == 'openmandriva'",
                "run": "wget https://github.com/rpm-software-management/libcomps/archive/libcomps-$LIBCOMPS_VERSION.tar.gz\ntar xf libcomps-$LIBCOMPS_VERSION.tar.gz\n\ncmake \\\n    -S libcomps-libcomps-$LIBCOMPS_VERSION/libcomps \\\n    -B build/libcomps \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DPYTHON_DESIRED=3 \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -Wno-dev\ncmake --build build/libcomps\nsudo cmake --install build/libcomps\n\nwget https://github.com/rpm-software-management/librepo/archive/$LIBREPO_VERSION.tar.gz\ntar xf $LIBREPO_VERSION.tar.gz\n\ncmake \\\n    -S librepo-$LIBREPO_VERSION \\\n    -B build/librepo \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON\ncmake --build build/librepo\nsudo cmake --install build/librepo\n\nwget https://github.com/fedora-modularity/libmodulemd/archive/libmodulemd-$LIBMODULEMD_VERSION.tar.gz\ntar xf libmodulemd-$LIBMODULEMD_VERSION.tar.gz\n\nmeson \\\n    --prefix /usr \\\n    -Dbuildtype=release \\\n    -Dlibdir=lib/x86_64-linux-gnu \\\n    -Ddeveloper_build=false \\\n    -Dwith_docs=false \\\n    -Dwith_manpages=disabled \\\n    -Dskip_introspection=true \\\n    -Dgobject_overrides_dir_py3=override \\\n    build/libmodulemd \\\n    libmodulemd-libmodulemd-$LIBMODULEMD_VERSION\nsudo meson install -C build/libmodulemd\n\nwget https://github.com/openSUSE/libsolv/archive/$LIBSOLV_VERSION.tar.gz\ntar xf $LIBSOLV_VERSION.tar.gz\n\ncmake \\\n    -S libsolv-$LIBSOLV_VERSION \\\n    -B build/libsolv \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_RPMDB=ON \\\n    -DENABLE_RPMPKG=ON \\\n    -DENABLE_PUBKEY=ON \\\n    -DENABLE_RPMDB_BYRPMHEADER=ON \\\n    -DENABLE_RPMDB_LIBRPM=ON \\\n    -DENABLE_RPMPKG_LIBRPM=ON \\\n    -DENABLE_RPMMD=ON \\\n    -DENABLE_COMPS=ON \\\n    -DENABLE_MDKREPO=ON \\\n    -DENABLE_COMPLEX_DEPS=ON \\\n    -DENABLE_APPDATA=ON \\\n    -DENABLE_LZMA_COMPRESSION=ON \\\n    -DENABLE_BZIP2_COMPRESSION=ON \\\n    -DENABLE_ZSTD_COMPRESSION=ON\ncmake --build build/libsolv\nsudo cmake --install build/libsolv\n\nwget https://github.com/rpm-software-management/libdnf/archive/$LIBDNF_VERSION.tar.gz\ntar xf $LIBDNF_VERSION.tar.gz\n\ncp /usr/share/cmake/Modules/FindLibSolv.cmake libdnf-$LIBDNF_VERSION/cmake/modules\n\ncmake \\\n    -S libdnf-$LIBDNF_VERSION \\\n    -B build/libdnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DWITH_GTKDOC=OFF \\\n    -DWITH_HTML=OFF \\\n    -DWITH_MAN=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -DCMAKE_CXX_FLAGS=\"-pthread\" \\\n    -DPYTHON_DESIRED=3\ncmake --build build/libdnf\nsudo cmake --install build/libdnf\n\nwget https://github.com/rpm-software-management/dnf/archive/$DNF_VERSION.tar.gz\ntar xf $DNF_VERSION.tar.gz\n\ncmake \\\n    -S dnf-$DNF_VERSION \\\n    -B build/dnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DPYTHON_DESIRED=3 \\\n    -DWITH_MAN=0\ncmake --build build/dnf\nsudo cmake --install build/dnf\n\nsudo ln -s /usr/bin/dnf-3 /usr/bin/dnf\n",
                "env": {
                  "CMAKE_GENERATOR": "Ninja",
                  "LIBCOMPS_VERSION": "0.1.15",
                  "LIBREPO_VERSION": "1.12.0",
                  "LIBMODULEMD_VERSION": "2.9.4",
                  "LIBSOLV_VERSION": "0.7.14",
                  "LIBDNF_VERSION": "0.48.0",
                  "DNF_VERSION": "4.2.23"
                }
              },
              {
                "name": "Install swupd-extract (Clear Linux)",
                "if": "matrix.distro == 'clear'",
                "run": "go get -u github.com/clearlinux/mixer-tools/swupd-extract\nsudo ln -s ~/go/bin/swupd-extract /usr/bin/swupd-extract\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }}"
              }
            ]
          }
        }
      }
    },
    "2020-07-26T13-41-12Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-459583da-9445-51af-9535-b070cd4ab39d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-07-26T13-41-12Z__8a2e47cf736330b747bc65db007b2e633a4cb5ff.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 232,
                  "endColumn": 33
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-07-26T13-41-12Z__8a2e47cf736330b747bc65db007b2e633a4cb5ff.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 232,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "actions/checkout@v2"
            ],
            "num_run_commands": 6,
            "steps_with_conditionals": 3,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Update",
                "run": "sudo apt-get update"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get --assume-yes --no-install-recommends install asciidoc check debootstrap e2fsprogs libarchive-dev libcppunit-dev libcurl4-openssl-dev libjson-c-dev libgpgme-dev libmagic-dev librpm-dev libsmartcols-dev libyaml-dev libzstd-dev meson ninja-build python3-gpg python3-rpm python3-sphinx squashfs-tools swig systemd-container xfsprogs xsltproc"
              },
              {
                "name": "Install dependencies (Arch Linux)",
                "if": "matrix.distro == 'arch'",
                "run": "wget https://sources.archlinux.org/other/pacman/pacman-$PACMAN_VERSION.tar.gz\ntar xf pacman-$PACMAN_VERSION.tar.gz\n\nmeson \\\n  -Dbuildtype=release \\\n  -Ddoc=disabled \\\n  -Dscriptlet-shell=/usr/bin/bash \\\n  -Dldconfig=/usr/bin/ldconfig \\\n  build/pacman \\\n  pacman-$PACMAN_VERSION\nsudo meson install -C build/pacman\n\nwget https://sources.archlinux.org/other/archlinux-keyring/archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\ntar xf archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\n\nsudo make -C archlinux-keyring-$ARCHLINUX_KEYRING_VERSION PREFIX=/usr install\nsudo pacman-key --init\nsudo pacman-key --populate archlinux\n\nwget https://git.archlinux.org/arch-install-scripts.git/snapshot/arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\ntar xf arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\n\nsudo make -C arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION PREFIX=/usr install\n",
                "env": {
                  "PACMAN_VERSION": "5.2.2",
                  "ARCHLINUX_KEYRING_VERSION": "20200622",
                  "ARCH_INSTALL_SCRIPTS_VERSION": "23"
                }
              },
              {
                "name": "Install dependencies (CentOS Linux)",
                "if": "startsWith(matrix.distro, 'centos') || matrix.distro == 'fedora' || matrix.distro == 'openmandriva'",
                "run": "wget https://github.com/rpm-software-management/libcomps/archive/libcomps-$LIBCOMPS_VERSION.tar.gz\ntar xf libcomps-$LIBCOMPS_VERSION.tar.gz\n\ncmake \\\n    -S libcomps-libcomps-$LIBCOMPS_VERSION/libcomps \\\n    -B build/libcomps \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DPYTHON_DESIRED=3 \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -Wno-dev\ncmake --build build/libcomps\nsudo cmake --install build/libcomps\n\nwget https://github.com/rpm-software-management/librepo/archive/$LIBREPO_VERSION.tar.gz\ntar xf $LIBREPO_VERSION.tar.gz\n\ncmake \\\n    -S librepo-$LIBREPO_VERSION \\\n    -B build/librepo \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON\ncmake --build build/librepo\nsudo cmake --install build/librepo\n\nwget https://github.com/fedora-modularity/libmodulemd/archive/libmodulemd-$LIBMODULEMD_VERSION.tar.gz\ntar xf libmodulemd-$LIBMODULEMD_VERSION.tar.gz\n\nmeson \\\n    --prefix /usr \\\n    -Dbuildtype=release \\\n    -Dlibdir=lib/x86_64-linux-gnu \\\n    -Ddeveloper_build=false \\\n    -Dwith_docs=false \\\n    -Dwith_manpages=disabled \\\n    -Dskip_introspection=true \\\n    -Dgobject_overrides_dir_py3=override \\\n    build/libmodulemd \\\n    libmodulemd-libmodulemd-$LIBMODULEMD_VERSION\nsudo meson install -C build/libmodulemd\n\nwget https://github.com/openSUSE/libsolv/archive/$LIBSOLV_VERSION.tar.gz\ntar xf $LIBSOLV_VERSION.tar.gz\n\ncmake \\\n    -S libsolv-$LIBSOLV_VERSION \\\n    -B build/libsolv \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_RPMDB=ON \\\n    -DENABLE_RPMPKG=ON \\\n    -DENABLE_PUBKEY=ON \\\n    -DENABLE_RPMDB_BYRPMHEADER=ON \\\n    -DENABLE_RPMDB_LIBRPM=ON \\\n    -DENABLE_RPMPKG_LIBRPM=ON \\\n    -DENABLE_RPMMD=ON \\\n    -DENABLE_COMPS=ON \\\n    -DENABLE_MDKREPO=ON \\\n    -DENABLE_COMPLEX_DEPS=ON \\\n    -DENABLE_APPDATA=ON \\\n    -DENABLE_LZMA_COMPRESSION=ON \\\n    -DENABLE_BZIP2_COMPRESSION=ON \\\n    -DENABLE_ZSTD_COMPRESSION=ON\ncmake --build build/libsolv\nsudo cmake --install build/libsolv\n\nwget https://github.com/rpm-software-management/libdnf/archive/$LIBDNF_VERSION.tar.gz\ntar xf $LIBDNF_VERSION.tar.gz\n\ncp /usr/share/cmake/Modules/FindLibSolv.cmake libdnf-$LIBDNF_VERSION/cmake/modules\n\ncmake \\\n    -S libdnf-$LIBDNF_VERSION \\\n    -B build/libdnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DWITH_GTKDOC=OFF \\\n    -DWITH_HTML=OFF \\\n    -DWITH_MAN=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -DCMAKE_CXX_FLAGS=\"-pthread\" \\\n    -DPYTHON_DESIRED=3\ncmake --build build/libdnf\nsudo cmake --install build/libdnf\n\nwget https://github.com/rpm-software-management/dnf/archive/$DNF_VERSION.tar.gz\ntar xf $DNF_VERSION.tar.gz\n\ncmake \\\n    -S dnf-$DNF_VERSION \\\n    -B build/dnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DPYTHON_DESIRED=3 \\\n    -DWITH_MAN=0\ncmake --build build/dnf\nsudo cmake --install build/dnf\n\nsudo ln -s /usr/bin/dnf-3 /usr/bin/dnf\n",
                "env": {
                  "CMAKE_GENERATOR": "Ninja",
                  "LIBCOMPS_VERSION": "0.1.15",
                  "LIBREPO_VERSION": "1.12.0",
                  "LIBMODULEMD_VERSION": "2.9.4",
                  "LIBSOLV_VERSION": "0.7.14",
                  "LIBDNF_VERSION": "0.48.0",
                  "DNF_VERSION": "4.2.23"
                }
              },
              {
                "name": "Install swupd-extract (Clear Linux)",
                "if": "matrix.distro == 'clear'",
                "run": "go get -u github.com/clearlinux/mixer-tools/swupd-extract\nsudo ln -s ~/go/bin/swupd-extract /usr/bin/swupd-extract\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --default /dev/null"
              }
            ]
          }
        }
      }
    },
    "2020-07-30T16-13-28Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-93bb8f25-9576-57b7-8926-0bda6378fc8a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-07-30T16-13-28Z__c039e5ac6f4d9917296cc5071349c2882c5ba94a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 232,
                  "endColumn": 43
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-07-30T16-13-28Z__c039e5ac6f4d9917296cc5071349c2882c5ba94a.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 232,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "actions/checkout@v2"
            ],
            "num_run_commands": 6,
            "steps_with_conditionals": 3,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Update",
                "run": "sudo apt-get update"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get --assume-yes --no-install-recommends install asciidoc check debootstrap e2fsprogs libarchive-dev libcppunit-dev libcurl4-openssl-dev libjson-c-dev libgpgme-dev libmagic-dev librpm-dev libsmartcols-dev libyaml-dev libzstd-dev meson ninja-build python3-gpg python3-rpm python3-sphinx squashfs-tools swig systemd-container xfsprogs xsltproc"
              },
              {
                "name": "Install dependencies (Arch Linux)",
                "if": "matrix.distro == 'arch'",
                "run": "wget https://sources.archlinux.org/other/pacman/pacman-$PACMAN_VERSION.tar.gz\ntar xf pacman-$PACMAN_VERSION.tar.gz\n\nmeson \\\n  -Dbuildtype=release \\\n  -Ddoc=disabled \\\n  -Dscriptlet-shell=/usr/bin/bash \\\n  -Dldconfig=/usr/bin/ldconfig \\\n  build/pacman \\\n  pacman-$PACMAN_VERSION\nsudo meson install -C build/pacman\n\nwget https://sources.archlinux.org/other/archlinux-keyring/archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\ntar xf archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\n\nsudo make -C archlinux-keyring-$ARCHLINUX_KEYRING_VERSION PREFIX=/usr install\nsudo pacman-key --init\nsudo pacman-key --populate archlinux\n\nwget https://git.archlinux.org/arch-install-scripts.git/snapshot/arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\ntar xf arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\n\nsudo make -C arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION PREFIX=/usr install\n",
                "env": {
                  "PACMAN_VERSION": "5.2.2",
                  "ARCHLINUX_KEYRING_VERSION": "20200622",
                  "ARCH_INSTALL_SCRIPTS_VERSION": "23"
                }
              },
              {
                "name": "Install dependencies (CentOS Linux)",
                "if": "startsWith(matrix.distro, 'centos') || matrix.distro == 'fedora' || matrix.distro == 'openmandriva' || matrix.distro == 'mageia'",
                "run": "wget https://github.com/rpm-software-management/libcomps/archive/libcomps-$LIBCOMPS_VERSION.tar.gz\ntar xf libcomps-$LIBCOMPS_VERSION.tar.gz\n\ncmake \\\n    -S libcomps-libcomps-$LIBCOMPS_VERSION/libcomps \\\n    -B build/libcomps \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DPYTHON_DESIRED=3 \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -Wno-dev\ncmake --build build/libcomps\nsudo cmake --install build/libcomps\n\nwget https://github.com/rpm-software-management/librepo/archive/$LIBREPO_VERSION.tar.gz\ntar xf $LIBREPO_VERSION.tar.gz\n\ncmake \\\n    -S librepo-$LIBREPO_VERSION \\\n    -B build/librepo \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON\ncmake --build build/librepo\nsudo cmake --install build/librepo\n\nwget https://github.com/fedora-modularity/libmodulemd/archive/libmodulemd-$LIBMODULEMD_VERSION.tar.gz\ntar xf libmodulemd-$LIBMODULEMD_VERSION.tar.gz\n\nmeson \\\n    --prefix /usr \\\n    -Dbuildtype=release \\\n    -Dlibdir=lib/x86_64-linux-gnu \\\n    -Ddeveloper_build=false \\\n    -Dwith_docs=false \\\n    -Dwith_manpages=disabled \\\n    -Dskip_introspection=true \\\n    -Dgobject_overrides_dir_py3=override \\\n    build/libmodulemd \\\n    libmodulemd-libmodulemd-$LIBMODULEMD_VERSION\nsudo meson install -C build/libmodulemd\n\nwget https://github.com/openSUSE/libsolv/archive/$LIBSOLV_VERSION.tar.gz\ntar xf $LIBSOLV_VERSION.tar.gz\n\ncmake \\\n    -S libsolv-$LIBSOLV_VERSION \\\n    -B build/libsolv \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_RPMDB=ON \\\n    -DENABLE_RPMPKG=ON \\\n    -DENABLE_PUBKEY=ON \\\n    -DENABLE_RPMDB_BYRPMHEADER=ON \\\n    -DENABLE_RPMDB_LIBRPM=ON \\\n    -DENABLE_RPMPKG_LIBRPM=ON \\\n    -DENABLE_RPMMD=ON \\\n    -DENABLE_COMPS=ON \\\n    -DENABLE_MDKREPO=ON \\\n    -DENABLE_COMPLEX_DEPS=ON \\\n    -DENABLE_APPDATA=ON \\\n    -DENABLE_LZMA_COMPRESSION=ON \\\n    -DENABLE_BZIP2_COMPRESSION=ON \\\n    -DENABLE_ZSTD_COMPRESSION=ON\ncmake --build build/libsolv\nsudo cmake --install build/libsolv\n\nwget https://github.com/rpm-software-management/libdnf/archive/$LIBDNF_VERSION.tar.gz\ntar xf $LIBDNF_VERSION.tar.gz\n\ncp /usr/share/cmake/Modules/FindLibSolv.cmake libdnf-$LIBDNF_VERSION/cmake/modules\n\ncmake \\\n    -S libdnf-$LIBDNF_VERSION \\\n    -B build/libdnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DWITH_GTKDOC=OFF \\\n    -DWITH_HTML=OFF \\\n    -DWITH_MAN=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -DCMAKE_CXX_FLAGS=\"-pthread\" \\\n    -DPYTHON_DESIRED=3\ncmake --build build/libdnf\nsudo cmake --install build/libdnf\n\nwget https://github.com/rpm-software-management/dnf/archive/$DNF_VERSION.tar.gz\ntar xf $DNF_VERSION.tar.gz\n\ncmake \\\n    -S dnf-$DNF_VERSION \\\n    -B build/dnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DPYTHON_DESIRED=3 \\\n    -DWITH_MAN=0\ncmake --build build/dnf\nsudo cmake --install build/dnf\n\nsudo ln -s /usr/bin/dnf-3 /usr/bin/dnf\n",
                "env": {
                  "CMAKE_GENERATOR": "Ninja",
                  "LIBCOMPS_VERSION": "0.1.15",
                  "LIBREPO_VERSION": "1.12.0",
                  "LIBMODULEMD_VERSION": "2.9.4",
                  "LIBSOLV_VERSION": "0.7.14",
                  "LIBDNF_VERSION": "0.48.0",
                  "DNF_VERSION": "4.2.23"
                }
              },
              {
                "name": "Install swupd-extract (Clear Linux)",
                "if": "matrix.distro == 'clear'",
                "run": "go get -u github.com/clearlinux/mixer-tools/swupd-extract\nsudo ln -s ~/go/bin/swupd-extract /usr/bin/swupd-extract\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }}"
              }
            ]
          }
        }
      }
    },
    "2020-07-30T18-08-01Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f7f6f976-ecb1-5625-8706-04da230b1c00",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-07-30T18-08-01Z__187416e8c9afdbe4afc8ca02d9711a78abb2196c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 233,
                  "endColumn": 43
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-07-30T18-08-01Z__187416e8c9afdbe4afc8ca02d9711a78abb2196c.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 233,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "actions/checkout@v2"
            ],
            "num_run_commands": 6,
            "steps_with_conditionals": 3,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Update",
                "run": "sudo apt-get update"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get --assume-yes --no-install-recommends install asciidoc check debootstrap e2fsprogs libarchive-dev libcppunit-dev libcurl4-openssl-dev libjson-c-dev libgpgme-dev libmagic-dev librpm-dev libsmartcols-dev libyaml-dev libzstd-dev meson ninja-build python3-gpg python3-rpm python3-sphinx squashfs-tools swig systemd-container xfsprogs xsltproc docbook-xsl"
              },
              {
                "name": "Install dependencies (Arch Linux)",
                "if": "matrix.distro == 'arch'",
                "run": "wget https://sources.archlinux.org/other/pacman/pacman-$PACMAN_VERSION.tar.gz\ntar xf pacman-$PACMAN_VERSION.tar.gz\n\nmeson \\\n  -Dbuildtype=release \\\n  -Ddoc=disabled \\\n  -Dscriptlet-shell=/usr/bin/bash \\\n  -Dldconfig=/usr/bin/ldconfig \\\n  build/pacman \\\n  pacman-$PACMAN_VERSION\nsudo meson install -C build/pacman\n\nwget https://sources.archlinux.org/other/archlinux-keyring/archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\ntar xf archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\n\nsudo make -C archlinux-keyring-$ARCHLINUX_KEYRING_VERSION PREFIX=/usr install\nsudo pacman-key --init\nsudo pacman-key --populate archlinux\n\nwget https://git.archlinux.org/arch-install-scripts.git/snapshot/arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\ntar xf arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\n\nsudo make -C arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION PREFIX=/usr install\n",
                "env": {
                  "PACMAN_VERSION": "5.2.2",
                  "ARCHLINUX_KEYRING_VERSION": "20200622",
                  "ARCH_INSTALL_SCRIPTS_VERSION": "23"
                }
              },
              {
                "name": "Install dependencies (CentOS Linux)",
                "if": "startsWith(matrix.distro, 'centos') || matrix.distro == 'fedora' || matrix.distro == 'openmandriva' || matrix.distro == 'mageia'",
                "run": "wget https://github.com/rpm-software-management/libcomps/archive/libcomps-$LIBCOMPS_VERSION.tar.gz\ntar xf libcomps-$LIBCOMPS_VERSION.tar.gz\n\ncmake \\\n    -S libcomps-libcomps-$LIBCOMPS_VERSION/libcomps \\\n    -B build/libcomps \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DPYTHON_DESIRED=3 \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -Wno-dev\ncmake --build build/libcomps\nsudo cmake --install build/libcomps\n\nwget https://github.com/rpm-software-management/librepo/archive/$LIBREPO_VERSION.tar.gz\ntar xf $LIBREPO_VERSION.tar.gz\n\ncmake \\\n    -S librepo-$LIBREPO_VERSION \\\n    -B build/librepo \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON\ncmake --build build/librepo\nsudo cmake --install build/librepo\n\nwget https://github.com/fedora-modularity/libmodulemd/archive/libmodulemd-$LIBMODULEMD_VERSION.tar.gz\ntar xf libmodulemd-$LIBMODULEMD_VERSION.tar.gz\n\nmeson \\\n    --prefix /usr \\\n    -Dbuildtype=release \\\n    -Dlibdir=lib/x86_64-linux-gnu \\\n    -Ddeveloper_build=false \\\n    -Dwith_docs=false \\\n    -Dwith_manpages=disabled \\\n    -Dskip_introspection=true \\\n    -Dgobject_overrides_dir_py3=override \\\n    build/libmodulemd \\\n    libmodulemd-libmodulemd-$LIBMODULEMD_VERSION\nsudo meson install -C build/libmodulemd\n\nwget https://github.com/openSUSE/libsolv/archive/$LIBSOLV_VERSION.tar.gz\ntar xf $LIBSOLV_VERSION.tar.gz\n\ncmake \\\n    -S libsolv-$LIBSOLV_VERSION \\\n    -B build/libsolv \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_RPMDB=ON \\\n    -DENABLE_RPMPKG=ON \\\n    -DENABLE_PUBKEY=ON \\\n    -DENABLE_RPMDB_BYRPMHEADER=ON \\\n    -DENABLE_RPMDB_LIBRPM=ON \\\n    -DENABLE_RPMPKG_LIBRPM=ON \\\n    -DENABLE_RPMMD=ON \\\n    -DENABLE_COMPS=ON \\\n    -DENABLE_MDKREPO=ON \\\n    -DENABLE_COMPLEX_DEPS=ON \\\n    -DENABLE_APPDATA=ON \\\n    -DENABLE_LZMA_COMPRESSION=ON \\\n    -DENABLE_BZIP2_COMPRESSION=ON \\\n    -DENABLE_ZSTD_COMPRESSION=ON\ncmake --build build/libsolv\nsudo cmake --install build/libsolv\n\nwget https://github.com/rpm-software-management/libdnf/archive/$LIBDNF_VERSION.tar.gz\ntar xf $LIBDNF_VERSION.tar.gz\n\ncp /usr/share/cmake/Modules/FindLibSolv.cmake libdnf-$LIBDNF_VERSION/cmake/modules\n\ncmake \\\n    -S libdnf-$LIBDNF_VERSION \\\n    -B build/libdnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DWITH_GTKDOC=OFF \\\n    -DWITH_HTML=OFF \\\n    -DWITH_MAN=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -DCMAKE_CXX_FLAGS=\"-pthread\" \\\n    -DPYTHON_DESIRED=3\ncmake --build build/libdnf\nsudo cmake --install build/libdnf\n\nwget https://github.com/rpm-software-management/dnf/archive/$DNF_VERSION.tar.gz\ntar xf $DNF_VERSION.tar.gz\n\ncmake \\\n    -S dnf-$DNF_VERSION \\\n    -B build/dnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DPYTHON_DESIRED=3 \\\n    -DWITH_MAN=0\ncmake --build build/dnf\nsudo cmake --install build/dnf\n\nsudo ln -s /usr/bin/dnf-3 /usr/bin/dnf\n",
                "env": {
                  "CMAKE_GENERATOR": "Ninja",
                  "LIBCOMPS_VERSION": "0.1.15",
                  "LIBREPO_VERSION": "1.12.0",
                  "LIBMODULEMD_VERSION": "2.9.4",
                  "LIBSOLV_VERSION": "0.7.14",
                  "LIBDNF_VERSION": "0.48.0",
                  "DNF_VERSION": "4.2.23"
                }
              },
              {
                "name": "Install swupd-extract (Clear Linux)",
                "if": "matrix.distro == 'clear'",
                "run": "go get -u github.com/clearlinux/mixer-tools/swupd-extract\nsudo ln -s ~/go/bin/swupd-extract /usr/bin/swupd-extract\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }}"
              }
            ]
          }
        }
      }
    },
    "2020-07-31T17-22-21Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-aa3f8c4a-3730-53cd-94a2-3dd49c6c50b7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-07-31T17-22-21Z__a1aa10082374b2ec05143630453b18b8b5132b18.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 238,
                  "endColumn": 43
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-07-31T17-22-21Z__a1aa10082374b2ec05143630453b18b8b5132b18.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 238,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 8
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 8
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "actions/checkout@v2"
            ],
            "num_run_commands": 7,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Update",
                "run": "sudo apt-get update"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get --assume-yes --no-install-recommends install asciidoc check debootstrap e2fsprogs libarchive-dev libcppunit-dev libcurl4-openssl-dev libjson-c-dev libgpgme-dev libmagic-dev librpm-dev libsmartcols-dev libyaml-dev libzstd-dev meson ninja-build python3-gpg python3-rpm python3-sphinx squashfs-tools swig systemd-container xfsprogs xsltproc docbook-xsl"
              },
              {
                "name": "Install dependencies (Arch Linux)",
                "if": "matrix.distro == 'arch'",
                "run": "wget https://sources.archlinux.org/other/pacman/pacman-$PACMAN_VERSION.tar.gz\ntar xf pacman-$PACMAN_VERSION.tar.gz\n\nmeson \\\n  -Dbuildtype=release \\\n  -Ddoc=disabled \\\n  -Dscriptlet-shell=/usr/bin/bash \\\n  -Dldconfig=/usr/bin/ldconfig \\\n  build/pacman \\\n  pacman-$PACMAN_VERSION\nsudo meson install -C build/pacman\n\nwget https://sources.archlinux.org/other/archlinux-keyring/archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\ntar xf archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\n\nsudo make -C archlinux-keyring-$ARCHLINUX_KEYRING_VERSION PREFIX=/usr install\nsudo pacman-key --init\nsudo pacman-key --populate archlinux\n\nwget https://git.archlinux.org/arch-install-scripts.git/snapshot/arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\ntar xf arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\n\nsudo make -C arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION PREFIX=/usr install\n",
                "env": {
                  "PACMAN_VERSION": "5.2.2",
                  "ARCHLINUX_KEYRING_VERSION": "20200622",
                  "ARCH_INSTALL_SCRIPTS_VERSION": "23"
                }
              },
              {
                "name": "Install dependencies (CentOS Linux)",
                "if": "startsWith(matrix.distro, 'centos') || matrix.distro == 'fedora' || matrix.distro == 'openmandriva' || matrix.distro == 'mageia'",
                "run": "wget https://github.com/rpm-software-management/libcomps/archive/libcomps-$LIBCOMPS_VERSION.tar.gz\ntar xf libcomps-$LIBCOMPS_VERSION.tar.gz\n\ncmake \\\n    -S libcomps-libcomps-$LIBCOMPS_VERSION/libcomps \\\n    -B build/libcomps \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DPYTHON_DESIRED=3 \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -Wno-dev\ncmake --build build/libcomps\nsudo cmake --install build/libcomps\n\nwget https://github.com/rpm-software-management/librepo/archive/$LIBREPO_VERSION.tar.gz\ntar xf $LIBREPO_VERSION.tar.gz\n\ncmake \\\n    -S librepo-$LIBREPO_VERSION \\\n    -B build/librepo \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON\ncmake --build build/librepo\nsudo cmake --install build/librepo\n\nwget https://github.com/fedora-modularity/libmodulemd/archive/libmodulemd-$LIBMODULEMD_VERSION.tar.gz\ntar xf libmodulemd-$LIBMODULEMD_VERSION.tar.gz\n\nmeson \\\n    --prefix /usr \\\n    -Dbuildtype=release \\\n    -Dlibdir=lib/x86_64-linux-gnu \\\n    -Ddeveloper_build=false \\\n    -Dwith_docs=false \\\n    -Dwith_manpages=disabled \\\n    -Dskip_introspection=true \\\n    -Dgobject_overrides_dir_py3=override \\\n    build/libmodulemd \\\n    libmodulemd-libmodulemd-$LIBMODULEMD_VERSION\nsudo meson install -C build/libmodulemd\n\nwget https://github.com/openSUSE/libsolv/archive/$LIBSOLV_VERSION.tar.gz\ntar xf $LIBSOLV_VERSION.tar.gz\n\ncmake \\\n    -S libsolv-$LIBSOLV_VERSION \\\n    -B build/libsolv \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_RPMDB=ON \\\n    -DENABLE_RPMPKG=ON \\\n    -DENABLE_PUBKEY=ON \\\n    -DENABLE_RPMDB_BYRPMHEADER=ON \\\n    -DENABLE_RPMDB_LIBRPM=ON \\\n    -DENABLE_RPMPKG_LIBRPM=ON \\\n    -DENABLE_RPMMD=ON \\\n    -DENABLE_COMPS=ON \\\n    -DENABLE_MDKREPO=ON \\\n    -DENABLE_COMPLEX_DEPS=ON \\\n    -DENABLE_APPDATA=ON \\\n    -DENABLE_LZMA_COMPRESSION=ON \\\n    -DENABLE_BZIP2_COMPRESSION=ON \\\n    -DENABLE_ZSTD_COMPRESSION=ON\ncmake --build build/libsolv\nsudo cmake --install build/libsolv\n\nwget https://github.com/rpm-software-management/libdnf/archive/$LIBDNF_VERSION.tar.gz\ntar xf $LIBDNF_VERSION.tar.gz\n\ncp /usr/share/cmake/Modules/FindLibSolv.cmake libdnf-$LIBDNF_VERSION/cmake/modules\n\ncmake \\\n    -S libdnf-$LIBDNF_VERSION \\\n    -B build/libdnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DWITH_GTKDOC=OFF \\\n    -DWITH_HTML=OFF \\\n    -DWITH_MAN=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -DCMAKE_CXX_FLAGS=\"-pthread\" \\\n    -DPYTHON_DESIRED=3\ncmake --build build/libdnf\nsudo cmake --install build/libdnf\n\nwget https://github.com/rpm-software-management/dnf/archive/$DNF_VERSION.tar.gz\ntar xf $DNF_VERSION.tar.gz\n\ncmake \\\n    -S dnf-$DNF_VERSION \\\n    -B build/dnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DPYTHON_DESIRED=3 \\\n    -DWITH_MAN=0\ncmake --build build/dnf\nsudo cmake --install build/dnf\n\nsudo ln -s /usr/bin/dnf-3 /usr/bin/dnf\n",
                "env": {
                  "CMAKE_GENERATOR": "Ninja",
                  "LIBCOMPS_VERSION": "0.1.15",
                  "LIBREPO_VERSION": "1.12.0",
                  "LIBMODULEMD_VERSION": "2.9.4",
                  "LIBSOLV_VERSION": "0.7.14",
                  "LIBDNF_VERSION": "0.48.0",
                  "DNF_VERSION": "4.2.23"
                }
              },
              {
                "name": "Install swupd-extract (Clear Linux)",
                "if": "matrix.distro == 'clear'",
                "run": "go get -u github.com/clearlinux/mixer-tools/swupd-extract\nsudo ln -s ~/go/bin/swupd-extract /usr/bin/swupd-extract\n"
              },
              {
                "name": "Install zypper (OpenSuse)",
                "if": "matrix.distro == 'opensuse'",
                "run": "sudo apt-get --assume-yes --no-install-recommends install zypper"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }}"
              }
            ]
          }
        }
      }
    },
    "2020-08-03T11-14-20Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3305afdb-36dc-5121-a2d7-75408bded381",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-08-03T11-14-20Z__c36a6becbd6c9347ea524303a614f51ee8a93e10.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 268,
                  "endColumn": 21
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-08-03T11-14-20Z__c36a6becbd6c9347ea524303a614f51ee8a93e10.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 268,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "actions/checkout@v2"
            ],
            "num_run_commands": 9,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "clear",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Update",
                "run": "sudo apt-get update"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get --assume-yes --no-install-recommends install asciidoc check debootstrap e2fsprogs libarchive-dev libcppunit-dev libcurl4-openssl-dev libjson-c-dev libgpgme-dev libmagic-dev librpm-dev libsmartcols-dev libyaml-dev libzstd-dev meson ninja-build python3-gpg python3-rpm python3-sphinx squashfs-tools swig systemd-container xfsprogs xsltproc docbook-xsl"
              },
              {
                "name": "Install dependencies (Arch Linux)",
                "if": "matrix.distro == 'arch'",
                "run": "wget https://sources.archlinux.org/other/pacman/pacman-$PACMAN_VERSION.tar.gz\ntar xf pacman-$PACMAN_VERSION.tar.gz\n\nmeson \\\n  -Dbuildtype=release \\\n  -Ddoc=disabled \\\n  -Dscriptlet-shell=/usr/bin/bash \\\n  -Dldconfig=/usr/bin/ldconfig \\\n  build/pacman \\\n  pacman-$PACMAN_VERSION\nsudo meson install -C build/pacman\n\nwget https://sources.archlinux.org/other/archlinux-keyring/archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\ntar xf archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\n\nsudo make -C archlinux-keyring-$ARCHLINUX_KEYRING_VERSION PREFIX=/usr install\nsudo pacman-key --init\nsudo pacman-key --populate archlinux\n\nwget https://git.archlinux.org/arch-install-scripts.git/snapshot/arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\ntar xf arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\n\nsudo make -C arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION PREFIX=/usr install\n",
                "env": {
                  "PACMAN_VERSION": "5.2.2",
                  "ARCHLINUX_KEYRING_VERSION": "20200622",
                  "ARCH_INSTALL_SCRIPTS_VERSION": "23"
                }
              },
              {
                "name": "Install dependencies (CentOS Linux)",
                "if": "startsWith(matrix.distro, 'centos') || matrix.distro == 'fedora' || matrix.distro == 'openmandriva' || matrix.distro == 'mageia'",
                "run": "wget https://github.com/rpm-software-management/libcomps/archive/libcomps-$LIBCOMPS_VERSION.tar.gz\ntar xf libcomps-$LIBCOMPS_VERSION.tar.gz\n\ncmake \\\n    -S libcomps-libcomps-$LIBCOMPS_VERSION/libcomps \\\n    -B build/libcomps \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DPYTHON_DESIRED=3 \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -Wno-dev\ncmake --build build/libcomps\nsudo cmake --install build/libcomps\n\nwget https://github.com/rpm-software-management/librepo/archive/$LIBREPO_VERSION.tar.gz\ntar xf $LIBREPO_VERSION.tar.gz\n\ncmake \\\n    -S librepo-$LIBREPO_VERSION \\\n    -B build/librepo \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON\ncmake --build build/librepo\nsudo cmake --install build/librepo\n\nwget https://github.com/fedora-modularity/libmodulemd/archive/libmodulemd-$LIBMODULEMD_VERSION.tar.gz\ntar xf libmodulemd-$LIBMODULEMD_VERSION.tar.gz\n\nmeson \\\n    --prefix /usr \\\n    -Dbuildtype=release \\\n    -Dlibdir=lib/x86_64-linux-gnu \\\n    -Ddeveloper_build=false \\\n    -Dwith_docs=false \\\n    -Dwith_manpages=disabled \\\n    -Dskip_introspection=true \\\n    -Dgobject_overrides_dir_py3=override \\\n    build/libmodulemd \\\n    libmodulemd-libmodulemd-$LIBMODULEMD_VERSION\nsudo meson install -C build/libmodulemd\n\nwget https://github.com/openSUSE/libsolv/archive/$LIBSOLV_VERSION.tar.gz\ntar xf $LIBSOLV_VERSION.tar.gz\n\ncmake \\\n    -S libsolv-$LIBSOLV_VERSION \\\n    -B build/libsolv \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_RPMDB=ON \\\n    -DENABLE_RPMPKG=ON \\\n    -DENABLE_PUBKEY=ON \\\n    -DENABLE_RPMDB_BYRPMHEADER=ON \\\n    -DENABLE_RPMDB_LIBRPM=ON \\\n    -DENABLE_RPMPKG_LIBRPM=ON \\\n    -DENABLE_RPMMD=ON \\\n    -DENABLE_COMPS=ON \\\n    -DENABLE_MDKREPO=ON \\\n    -DENABLE_COMPLEX_DEPS=ON \\\n    -DENABLE_APPDATA=ON \\\n    -DENABLE_LZMA_COMPRESSION=ON \\\n    -DENABLE_BZIP2_COMPRESSION=ON \\\n    -DENABLE_ZSTD_COMPRESSION=ON\ncmake --build build/libsolv\nsudo cmake --install build/libsolv\n\nwget https://github.com/rpm-software-management/libdnf/archive/$LIBDNF_VERSION.tar.gz\ntar xf $LIBDNF_VERSION.tar.gz\n\ncp /usr/share/cmake/Modules/FindLibSolv.cmake libdnf-$LIBDNF_VERSION/cmake/modules\n\ncmake \\\n    -S libdnf-$LIBDNF_VERSION \\\n    -B build/libdnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DWITH_GTKDOC=OFF \\\n    -DWITH_HTML=OFF \\\n    -DWITH_MAN=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -DCMAKE_CXX_FLAGS=\"-pthread\" \\\n    -DPYTHON_DESIRED=3\ncmake --build build/libdnf\nsudo cmake --install build/libdnf\n\nwget https://github.com/rpm-software-management/dnf/archive/$DNF_VERSION.tar.gz\ntar xf $DNF_VERSION.tar.gz\n\ncmake \\\n    -S dnf-$DNF_VERSION \\\n    -B build/dnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DPYTHON_DESIRED=3 \\\n    -DWITH_MAN=0\ncmake --build build/dnf\nsudo cmake --install build/dnf\n\nsudo ln -s /usr/bin/dnf-3 /usr/bin/dnf\n",
                "env": {
                  "CMAKE_GENERATOR": "Ninja",
                  "LIBCOMPS_VERSION": "0.1.15",
                  "LIBREPO_VERSION": "1.12.0",
                  "LIBMODULEMD_VERSION": "2.9.4",
                  "LIBSOLV_VERSION": "0.7.14",
                  "LIBDNF_VERSION": "0.48.0",
                  "DNF_VERSION": "4.2.23"
                }
              },
              {
                "name": "Install swupd-extract (Clear Linux)",
                "if": "matrix.distro == 'clear'",
                "run": "go get -u github.com/clearlinux/mixer-tools/swupd-extract\nsudo ln -s ~/go/bin/swupd-extract /usr/bin/swupd-extract\n"
              },
              {
                "name": "Install zypper (OpenSuse)",
                "if": "matrix.distro == 'opensuse'",
                "run": "sudo apt-get --assume-yes --no-install-recommends install zypper"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }}"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && matrix.format != 'plain_squashfs' && (matrix.distro != 'clear' || matrix.format != 'gpt_squashfs')",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols uefi --force"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && !contains(matrix.format, 'squashfs')",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols bios --force"
              }
            ]
          }
        }
      }
    },
    "2020-08-04T22-33-46Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-dad85383-d96f-52b6-a284-050e80033d07",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-08-04T22-33-46Z__e5875138e4b4543c66d1b6cfcededb276acab540.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 265,
                  "endColumn": 21
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-08-04T22-33-46Z__e5875138e4b4543c66d1b6cfcededb276acab540.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 265,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "actions/checkout@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "clear",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Update",
                "run": "sudo apt-get update"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get --assume-yes --no-install-recommends install asciidoc check debootstrap e2fsprogs libarchive-dev libcppunit-dev libcurl4-openssl-dev libjson-c-dev libgpgme-dev libmagic-dev librpm-dev libsmartcols-dev libyaml-dev libzstd-dev meson ninja-build python3-gpg python3-rpm python3-sphinx squashfs-tools swig systemd-container xfsprogs xsltproc docbook-xsl zypper"
              },
              {
                "name": "Install dependencies (Arch Linux)",
                "if": "matrix.distro == 'arch'",
                "run": "wget https://sources.archlinux.org/other/pacman/pacman-$PACMAN_VERSION.tar.gz\ntar xf pacman-$PACMAN_VERSION.tar.gz\n\nmeson \\\n  -Dbuildtype=release \\\n  -Ddoc=disabled \\\n  -Dscriptlet-shell=/usr/bin/bash \\\n  -Dldconfig=/usr/bin/ldconfig \\\n  build/pacman \\\n  pacman-$PACMAN_VERSION\nsudo meson install -C build/pacman\n\nwget https://sources.archlinux.org/other/archlinux-keyring/archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\ntar xf archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\n\nsudo make -C archlinux-keyring-$ARCHLINUX_KEYRING_VERSION PREFIX=/usr install\nsudo pacman-key --init\nsudo pacman-key --populate archlinux\n\nwget https://git.archlinux.org/arch-install-scripts.git/snapshot/arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\ntar xf arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\n\nsudo make -C arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION PREFIX=/usr install\n",
                "env": {
                  "PACMAN_VERSION": "5.2.2",
                  "ARCHLINUX_KEYRING_VERSION": "20200622",
                  "ARCH_INSTALL_SCRIPTS_VERSION": "23"
                }
              },
              {
                "name": "Install dependencies (CentOS Linux)",
                "if": "startsWith(matrix.distro, 'centos') || matrix.distro == 'fedora' || matrix.distro == 'openmandriva' || matrix.distro == 'mageia'",
                "run": "wget https://github.com/rpm-software-management/libcomps/archive/libcomps-$LIBCOMPS_VERSION.tar.gz\ntar xf libcomps-$LIBCOMPS_VERSION.tar.gz\n\ncmake \\\n    -S libcomps-libcomps-$LIBCOMPS_VERSION/libcomps \\\n    -B build/libcomps \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DPYTHON_DESIRED=3 \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -Wno-dev\ncmake --build build/libcomps\nsudo cmake --install build/libcomps\n\nwget https://github.com/rpm-software-management/librepo/archive/$LIBREPO_VERSION.tar.gz\ntar xf $LIBREPO_VERSION.tar.gz\n\ncmake \\\n    -S librepo-$LIBREPO_VERSION \\\n    -B build/librepo \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON\ncmake --build build/librepo\nsudo cmake --install build/librepo\n\nwget https://github.com/fedora-modularity/libmodulemd/archive/libmodulemd-$LIBMODULEMD_VERSION.tar.gz\ntar xf libmodulemd-$LIBMODULEMD_VERSION.tar.gz\n\nmeson \\\n    --prefix /usr \\\n    -Dbuildtype=release \\\n    -Dlibdir=lib/x86_64-linux-gnu \\\n    -Ddeveloper_build=false \\\n    -Dwith_docs=false \\\n    -Dwith_manpages=disabled \\\n    -Dskip_introspection=true \\\n    -Dgobject_overrides_dir_py3=override \\\n    build/libmodulemd \\\n    libmodulemd-libmodulemd-$LIBMODULEMD_VERSION\nsudo meson install -C build/libmodulemd\n\nwget https://github.com/openSUSE/libsolv/archive/$LIBSOLV_VERSION.tar.gz\ntar xf $LIBSOLV_VERSION.tar.gz\n\ncmake \\\n    -S libsolv-$LIBSOLV_VERSION \\\n    -B build/libsolv \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_RPMDB=ON \\\n    -DENABLE_RPMPKG=ON \\\n    -DENABLE_PUBKEY=ON \\\n    -DENABLE_RPMDB_BYRPMHEADER=ON \\\n    -DENABLE_RPMDB_LIBRPM=ON \\\n    -DENABLE_RPMPKG_LIBRPM=ON \\\n    -DENABLE_RPMMD=ON \\\n    -DENABLE_COMPS=ON \\\n    -DENABLE_MDKREPO=ON \\\n    -DENABLE_COMPLEX_DEPS=ON \\\n    -DENABLE_APPDATA=ON \\\n    -DENABLE_LZMA_COMPRESSION=ON \\\n    -DENABLE_BZIP2_COMPRESSION=ON \\\n    -DENABLE_ZSTD_COMPRESSION=ON\ncmake --build build/libsolv\nsudo cmake --install build/libsolv\n\nwget https://github.com/rpm-software-management/libdnf/archive/$LIBDNF_VERSION.tar.gz\ntar xf $LIBDNF_VERSION.tar.gz\n\ncp /usr/share/cmake/Modules/FindLibSolv.cmake libdnf-$LIBDNF_VERSION/cmake/modules\n\ncmake \\\n    -S libdnf-$LIBDNF_VERSION \\\n    -B build/libdnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DWITH_GTKDOC=OFF \\\n    -DWITH_HTML=OFF \\\n    -DWITH_MAN=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -DCMAKE_CXX_FLAGS=\"-pthread\" \\\n    -DPYTHON_DESIRED=3\ncmake --build build/libdnf\nsudo cmake --install build/libdnf\n\nwget https://github.com/rpm-software-management/dnf/archive/$DNF_VERSION.tar.gz\ntar xf $DNF_VERSION.tar.gz\n\ncmake \\\n    -S dnf-$DNF_VERSION \\\n    -B build/dnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DPYTHON_DESIRED=3 \\\n    -DWITH_MAN=0\ncmake --build build/dnf\nsudo cmake --install build/dnf\n\nsudo ln -s /usr/bin/dnf-3 /usr/bin/dnf\n",
                "env": {
                  "CMAKE_GENERATOR": "Ninja",
                  "LIBCOMPS_VERSION": "0.1.15",
                  "LIBREPO_VERSION": "1.12.0",
                  "LIBMODULEMD_VERSION": "2.9.4",
                  "LIBSOLV_VERSION": "0.7.14",
                  "LIBDNF_VERSION": "0.48.0",
                  "DNF_VERSION": "4.2.23"
                }
              },
              {
                "name": "Install swupd-extract (Clear Linux)",
                "if": "matrix.distro == 'clear'",
                "run": "go get -u github.com/clearlinux/mixer-tools/swupd-extract\nsudo ln -s ~/go/bin/swupd-extract /usr/bin/swupd-extract\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }}"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && matrix.format != 'plain_squashfs' && (matrix.distro != 'clear' || matrix.format != 'gpt_squashfs')",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols uefi --force"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && !contains(matrix.format, 'squashfs')",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols bios --force"
              }
            ]
          }
        }
      }
    },
    "2020-08-04T23-01-45Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6c5b519b-4494-5766-9551-38db98a60358",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-08-04T23-01-45Z__d76edcf5cdae11bc8998155b85ac42b64f7ed9a1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 269,
                  "endColumn": 21
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-08-04T23-01-45Z__d76edcf5cdae11bc8998155b85ac42b64f7ed9a1.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 269,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "actions/checkout@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "clear",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Update",
                "run": "sudo apt-get update"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get --assume-yes --no-install-recommends install asciidoc check debootstrap e2fsprogs libarchive-dev libcppunit-dev libcurl4-openssl-dev libjson-c-dev libgpgme-dev libmagic-dev librpm-dev libsmartcols-dev libyaml-dev libzstd-dev meson ninja-build python3-gpg python3-rpm python3-sphinx squashfs-tools swig systemd-container xfsprogs xsltproc docbook-xsl zypper"
              },
              {
                "name": "Build pacman",
                "if": "matrix.distro == 'arch'",
                "run": "wget https://sources.archlinux.org/other/pacman/pacman-$PACMAN_VERSION.tar.gz\ntar xf pacman-$PACMAN_VERSION.tar.gz\n\nmeson \\\n  -Dbuildtype=release \\\n  -Ddoc=disabled \\\n  -Dscriptlet-shell=/usr/bin/bash \\\n  -Dldconfig=/usr/bin/ldconfig \\\n  build/pacman \\\n  pacman-$PACMAN_VERSION\nsudo meson install -C build/pacman\n\nwget https://sources.archlinux.org/other/archlinux-keyring/archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\ntar xf archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\n\nsudo make -C archlinux-keyring-$ARCHLINUX_KEYRING_VERSION PREFIX=/usr install\nsudo pacman-key --init\nsudo pacman-key --populate archlinux\n\nwget https://git.archlinux.org/arch-install-scripts.git/snapshot/arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\ntar xf arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\n\nsudo make -C arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION PREFIX=/usr install\n",
                "env": {
                  "PACMAN_VERSION": "5.2.2",
                  "ARCHLINUX_KEYRING_VERSION": "20200622",
                  "ARCH_INSTALL_SCRIPTS_VERSION": "23"
                }
              },
              {
                "name": "Build dnf",
                "if": "startsWith(matrix.distro, 'centos') || matrix.distro == 'fedora' || matrix.distro == 'openmandriva' || matrix.distro == 'mageia' || matrix.distro == 'photon'",
                "run": "wget https://github.com/rpm-software-management/libcomps/archive/libcomps-$LIBCOMPS_VERSION.tar.gz\ntar xf libcomps-$LIBCOMPS_VERSION.tar.gz\n\ncmake \\\n    -S libcomps-libcomps-$LIBCOMPS_VERSION/libcomps \\\n    -B build/libcomps \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DPYTHON_DESIRED=3 \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -Wno-dev\ncmake --build build/libcomps\nsudo cmake --install build/libcomps\n\nwget https://github.com/rpm-software-management/librepo/archive/$LIBREPO_VERSION.tar.gz\ntar xf $LIBREPO_VERSION.tar.gz\n\ncmake \\\n    -S librepo-$LIBREPO_VERSION \\\n    -B build/librepo \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON\ncmake --build build/librepo\nsudo cmake --install build/librepo\n\nwget https://github.com/fedora-modularity/libmodulemd/archive/libmodulemd-$LIBMODULEMD_VERSION.tar.gz\ntar xf libmodulemd-$LIBMODULEMD_VERSION.tar.gz\n\nmeson \\\n    --prefix /usr \\\n    -Dbuildtype=release \\\n    -Dlibdir=lib/x86_64-linux-gnu \\\n    -Ddeveloper_build=false \\\n    -Dwith_docs=false \\\n    -Dwith_manpages=disabled \\\n    -Dskip_introspection=true \\\n    -Dgobject_overrides_dir_py3=override \\\n    build/libmodulemd \\\n    libmodulemd-libmodulemd-$LIBMODULEMD_VERSION\nsudo meson install -C build/libmodulemd\n\nwget https://github.com/openSUSE/libsolv/archive/$LIBSOLV_VERSION.tar.gz\ntar xf $LIBSOLV_VERSION.tar.gz\n\ncmake \\\n    -S libsolv-$LIBSOLV_VERSION \\\n    -B build/libsolv \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_RPMDB=ON \\\n    -DENABLE_RPMPKG=ON \\\n    -DENABLE_PUBKEY=ON \\\n    -DENABLE_RPMDB_BYRPMHEADER=ON \\\n    -DENABLE_RPMDB_LIBRPM=ON \\\n    -DENABLE_RPMPKG_LIBRPM=ON \\\n    -DENABLE_RPMMD=ON \\\n    -DENABLE_COMPS=ON \\\n    -DENABLE_MDKREPO=ON \\\n    -DENABLE_COMPLEX_DEPS=ON \\\n    -DENABLE_APPDATA=ON \\\n    -DENABLE_LZMA_COMPRESSION=ON \\\n    -DENABLE_BZIP2_COMPRESSION=ON \\\n    -DENABLE_ZSTD_COMPRESSION=ON\ncmake --build build/libsolv\nsudo cmake --install build/libsolv\n\nwget https://github.com/rpm-software-management/libdnf/archive/$LIBDNF_VERSION.tar.gz\ntar xf $LIBDNF_VERSION.tar.gz\n\ncp /usr/share/cmake/Modules/FindLibSolv.cmake libdnf-$LIBDNF_VERSION/cmake/modules\n\ncmake \\\n    -S libdnf-$LIBDNF_VERSION \\\n    -B build/libdnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DWITH_GTKDOC=OFF \\\n    -DWITH_HTML=OFF \\\n    -DWITH_MAN=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -DCMAKE_CXX_FLAGS=\"-pthread\" \\\n    -DPYTHON_DESIRED=3\ncmake --build build/libdnf\nsudo cmake --install build/libdnf\n\nwget https://github.com/rpm-software-management/dnf/archive/$DNF_VERSION.tar.gz\ntar xf $DNF_VERSION.tar.gz\n\ncmake \\\n    -S dnf-$DNF_VERSION \\\n    -B build/dnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DPYTHON_DESIRED=3 \\\n    -DWITH_MAN=0\ncmake --build build/dnf\nsudo cmake --install build/dnf\n\nsudo ln -s /usr/bin/dnf-3 /usr/bin/dnf\n",
                "env": {
                  "CMAKE_GENERATOR": "Ninja",
                  "LIBCOMPS_VERSION": "0.1.15",
                  "LIBREPO_VERSION": "1.12.0",
                  "LIBMODULEMD_VERSION": "2.9.4",
                  "LIBSOLV_VERSION": "0.7.14",
                  "LIBDNF_VERSION": "0.48.0",
                  "DNF_VERSION": "4.2.23"
                }
              },
              {
                "name": "Install swupd-extract (Clear Linux)",
                "if": "matrix.distro == 'clear'",
                "run": "go get -u github.com/clearlinux/mixer-tools/swupd-extract\nsudo ln -s ~/go/bin/swupd-extract /usr/bin/swupd-extract\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }}"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && matrix.format != 'plain_squashfs' && (matrix.distro != 'clear' || matrix.format != 'gpt_squashfs')",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols uefi --force"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && !contains(matrix.format, 'squashfs')",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols bios --force"
              }
            ]
          }
        }
      }
    },
    "2020-08-04T23-43-24Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6ab2751b-ccbc-52dc-a16f-845ea577c676",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-08-04T23-43-24Z__f06b436899ea4502634e868e64ab53ee5407db08.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 296,
                  "endColumn": 21
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-08-04T23-43-24Z__f06b436899ea4502634e868e64ab53ee5407db08.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 296,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "actions/checkout@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia",
                  "opensuse",
                  "photon"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "clear",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "photon",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Update",
                "run": "sudo apt-get update"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get --assume-yes --no-install-recommends install asciidoc check debootstrap e2fsprogs libarchive-dev libcppunit-dev libcurl4-openssl-dev libjson-c-dev libgpgme-dev libmagic-dev librpm-dev libsmartcols-dev libyaml-dev libzstd-dev meson ninja-build python3-gpg python3-rpm python3-sphinx squashfs-tools swig systemd-container xfsprogs xsltproc docbook-xsl zypper"
              },
              {
                "name": "Build pacman",
                "if": "matrix.distro == 'arch'",
                "run": "wget https://sources.archlinux.org/other/pacman/pacman-$PACMAN_VERSION.tar.gz\ntar xf pacman-$PACMAN_VERSION.tar.gz\n\nmeson \\\n  -Dbuildtype=release \\\n  -Ddoc=disabled \\\n  -Dscriptlet-shell=/usr/bin/bash \\\n  -Dldconfig=/usr/bin/ldconfig \\\n  build/pacman \\\n  pacman-$PACMAN_VERSION\nsudo meson install -C build/pacman\n\nwget https://sources.archlinux.org/other/archlinux-keyring/archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\ntar xf archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\n\nsudo make -C archlinux-keyring-$ARCHLINUX_KEYRING_VERSION PREFIX=/usr install\nsudo pacman-key --init\nsudo pacman-key --populate archlinux\n\nwget https://git.archlinux.org/arch-install-scripts.git/snapshot/arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\ntar xf arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION.tar.gz\n\nsudo make -C arch-install-scripts-$ARCH_INSTALL_SCRIPTS_VERSION PREFIX=/usr install\n",
                "env": {
                  "PACMAN_VERSION": "5.2.2",
                  "ARCHLINUX_KEYRING_VERSION": "20200622",
                  "ARCH_INSTALL_SCRIPTS_VERSION": "23"
                }
              },
              {
                "name": "Build dnf",
                "if": "startsWith(matrix.distro, 'centos') || matrix.distro == 'fedora' || matrix.distro == 'openmandriva' || matrix.distro == 'mageia' || matrix.distro == 'photon'",
                "run": "wget https://github.com/rpm-software-management/libcomps/archive/libcomps-$LIBCOMPS_VERSION.tar.gz\ntar xf libcomps-$LIBCOMPS_VERSION.tar.gz\n\ncmake \\\n    -S libcomps-libcomps-$LIBCOMPS_VERSION/libcomps \\\n    -B build/libcomps \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DPYTHON_DESIRED=3 \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -Wno-dev\ncmake --build build/libcomps\nsudo cmake --install build/libcomps\n\nwget https://github.com/rpm-software-management/librepo/archive/$LIBREPO_VERSION.tar.gz\ntar xf $LIBREPO_VERSION.tar.gz\n\ncmake \\\n    -S librepo-$LIBREPO_VERSION \\\n    -B build/librepo \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON\ncmake --build build/librepo\nsudo cmake --install build/librepo\n\nwget https://github.com/fedora-modularity/libmodulemd/archive/libmodulemd-$LIBMODULEMD_VERSION.tar.gz\ntar xf libmodulemd-$LIBMODULEMD_VERSION.tar.gz\n\nmeson \\\n    --prefix /usr \\\n    -Dbuildtype=release \\\n    -Dlibdir=lib/x86_64-linux-gnu \\\n    -Ddeveloper_build=false \\\n    -Dwith_docs=false \\\n    -Dwith_manpages=disabled \\\n    -Dskip_introspection=true \\\n    -Dgobject_overrides_dir_py3=override \\\n    build/libmodulemd \\\n    libmodulemd-libmodulemd-$LIBMODULEMD_VERSION\nsudo meson install -C build/libmodulemd\n\nwget https://github.com/openSUSE/libsolv/archive/$LIBSOLV_VERSION.tar.gz\ntar xf $LIBSOLV_VERSION.tar.gz\n\ncmake \\\n    -S libsolv-$LIBSOLV_VERSION \\\n    -B build/libsolv \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_RPMDB=ON \\\n    -DENABLE_RPMPKG=ON \\\n    -DENABLE_PUBKEY=ON \\\n    -DENABLE_RPMDB_BYRPMHEADER=ON \\\n    -DENABLE_RPMDB_LIBRPM=ON \\\n    -DENABLE_RPMPKG_LIBRPM=ON \\\n    -DENABLE_RPMMD=ON \\\n    -DENABLE_COMPS=ON \\\n    -DENABLE_MDKREPO=ON \\\n    -DENABLE_COMPLEX_DEPS=ON \\\n    -DENABLE_APPDATA=ON \\\n    -DENABLE_LZMA_COMPRESSION=ON \\\n    -DENABLE_BZIP2_COMPRESSION=ON \\\n    -DENABLE_ZSTD_COMPRESSION=ON\ncmake --build build/libsolv\nsudo cmake --install build/libsolv\n\nwget https://github.com/rpm-software-management/libdnf/archive/$LIBDNF_VERSION.tar.gz\ntar xf $LIBDNF_VERSION.tar.gz\n\ncp /usr/share/cmake/Modules/FindLibSolv.cmake libdnf-$LIBDNF_VERSION/cmake/modules\n\ncmake \\\n    -S libdnf-$LIBDNF_VERSION \\\n    -B build/libdnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DWITH_GTKDOC=OFF \\\n    -DWITH_HTML=OFF \\\n    -DWITH_MAN=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -DCMAKE_CXX_FLAGS=\"-pthread\" \\\n    -DPYTHON_DESIRED=3\ncmake --build build/libdnf\nsudo cmake --install build/libdnf\n\nwget https://github.com/rpm-software-management/dnf/archive/$DNF_VERSION.tar.gz\ntar xf $DNF_VERSION.tar.gz\n\ncmake \\\n    -S dnf-$DNF_VERSION \\\n    -B build/dnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DPYTHON_DESIRED=3 \\\n    -DWITH_MAN=0\ncmake --build build/dnf\nsudo cmake --install build/dnf\n\nsudo ln -s /usr/bin/dnf-3 /usr/bin/dnf\n\nwget https://github.com/metalink-dev/libmetalink/archive/release-$LIBMETALINK_VERSION.tar.gz\ntar xf release-$LIBMETALINK_VERSION.tar.gz\n\npushd libmetalink-release-$LIBMETALINK_VERSION\n./buildconf\n./configure --prefix /usr\nmake\nsudo make install\npopd\n\nwget https://github.com/vmware/tdnf/archive/v$TDNF_VERSION.tar.gz\ntar xf v$TDNF_VERSION.tar.gz\n\ncmake \\\n  -S tdnf-$TDNF_VERSION \\\n  -B build/tdnf \\\n  -DCMAKE_BUILD_TYPE=Release \\\n  -DCMAKE_INSTALL_PREFIX=/usr\ncmake --build build/tdnf\nsudo cmake --install build/tdnf\n",
                "env": {
                  "CMAKE_GENERATOR": "Ninja",
                  "LIBCOMPS_VERSION": "0.1.15",
                  "LIBREPO_VERSION": "1.12.0",
                  "LIBMODULEMD_VERSION": "2.9.4",
                  "LIBSOLV_VERSION": "0.7.14",
                  "LIBDNF_VERSION": "0.48.0",
                  "DNF_VERSION": "4.2.23",
                  "LIBMETALINK_VERSION": "0.1.3",
                  "TDNF_VERSION": "2.1.1"
                }
              },
              {
                "name": "Install swupd-extract (Clear Linux)",
                "if": "matrix.distro == 'clear'",
                "run": "go get -u github.com/clearlinux/mixer-tools/swupd-extract\nsudo ln -s ~/go/bin/swupd-extract /usr/bin/swupd-extract\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }}"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && matrix.format != 'plain_squashfs' && (matrix.distro != 'clear' || matrix.format != 'gpt_squashfs') && matrix.distro != 'photon'",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols uefi --force"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && !contains(matrix.format, 'squashfs')",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols bios --force"
              }
            ]
          }
        }
      }
    },
    "2020-08-07T22-38-50Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-97842541-0326-5976-9eb7-771d11cef717",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-08-07T22-38-50Z__c50b1b29483f3c2c35c3aadf50f442892b927076.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 291,
                  "endColumn": 21
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-08-07T22-38-50Z__c50b1b29483f3c2c35c3aadf50f442892b927076.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 291,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "actions/checkout@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia",
                  "opensuse",
                  "photon"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "clear",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "photon",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Update",
                "run": "sudo apt-get update"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get --assume-yes --no-install-recommends install asciidoc check debootstrap e2fsprogs libarchive-dev libcppunit-dev libcurl4-openssl-dev libjson-c-dev libgpgme-dev libmagic-dev librpm-dev libsmartcols-dev libyaml-dev libzstd-dev meson ninja-build python3-gpg python3-rpm python3-sphinx squashfs-tools swig systemd-container xfsprogs xsltproc docbook-xsl zypper"
              },
              {
                "name": "Build pacman",
                "if": "matrix.distro == 'arch'",
                "run": "wget https://sources.archlinux.org/other/pacman/pacman-$PACMAN_VERSION.tar.gz\ntar xf pacman-$PACMAN_VERSION.tar.gz\n\nmeson \\\n  -Dbuildtype=release \\\n  -Ddoc=disabled \\\n  -Dscriptlet-shell=/usr/bin/bash \\\n  -Dldconfig=/usr/bin/ldconfig \\\n  build/pacman \\\n  pacman-$PACMAN_VERSION\nsudo meson install -C build/pacman\n\nwget https://sources.archlinux.org/other/archlinux-keyring/archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\ntar xf archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\n\nsudo make -C archlinux-keyring-$ARCHLINUX_KEYRING_VERSION PREFIX=/usr install\nsudo pacman-key --init\nsudo pacman-key --populate archlinux\n",
                "env": {
                  "PACMAN_VERSION": "5.2.2",
                  "ARCHLINUX_KEYRING_VERSION": "20200622"
                }
              },
              {
                "name": "Build dnf",
                "if": "startsWith(matrix.distro, 'centos') || matrix.distro == 'fedora' || matrix.distro == 'openmandriva' || matrix.distro == 'mageia' || matrix.distro == 'photon'",
                "run": "wget https://github.com/rpm-software-management/libcomps/archive/libcomps-$LIBCOMPS_VERSION.tar.gz\ntar xf libcomps-$LIBCOMPS_VERSION.tar.gz\n\ncmake \\\n    -S libcomps-libcomps-$LIBCOMPS_VERSION/libcomps \\\n    -B build/libcomps \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DPYTHON_DESIRED=3 \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -Wno-dev\ncmake --build build/libcomps\nsudo cmake --install build/libcomps\n\nwget https://github.com/rpm-software-management/librepo/archive/$LIBREPO_VERSION.tar.gz\ntar xf $LIBREPO_VERSION.tar.gz\n\ncmake \\\n    -S librepo-$LIBREPO_VERSION \\\n    -B build/librepo \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON\ncmake --build build/librepo\nsudo cmake --install build/librepo\n\nwget https://github.com/fedora-modularity/libmodulemd/archive/libmodulemd-$LIBMODULEMD_VERSION.tar.gz\ntar xf libmodulemd-$LIBMODULEMD_VERSION.tar.gz\n\nmeson \\\n    --prefix /usr \\\n    -Dbuildtype=release \\\n    -Dlibdir=lib/x86_64-linux-gnu \\\n    -Ddeveloper_build=false \\\n    -Dwith_docs=false \\\n    -Dwith_manpages=disabled \\\n    -Dskip_introspection=true \\\n    -Dgobject_overrides_dir_py3=override \\\n    build/libmodulemd \\\n    libmodulemd-libmodulemd-$LIBMODULEMD_VERSION\nsudo meson install -C build/libmodulemd\n\nwget https://github.com/openSUSE/libsolv/archive/$LIBSOLV_VERSION.tar.gz\ntar xf $LIBSOLV_VERSION.tar.gz\n\ncmake \\\n    -S libsolv-$LIBSOLV_VERSION \\\n    -B build/libsolv \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_RPMDB=ON \\\n    -DENABLE_RPMPKG=ON \\\n    -DENABLE_PUBKEY=ON \\\n    -DENABLE_RPMDB_BYRPMHEADER=ON \\\n    -DENABLE_RPMDB_LIBRPM=ON \\\n    -DENABLE_RPMPKG_LIBRPM=ON \\\n    -DENABLE_RPMMD=ON \\\n    -DENABLE_COMPS=ON \\\n    -DENABLE_MDKREPO=ON \\\n    -DENABLE_COMPLEX_DEPS=ON \\\n    -DENABLE_APPDATA=ON \\\n    -DENABLE_LZMA_COMPRESSION=ON \\\n    -DENABLE_BZIP2_COMPRESSION=ON \\\n    -DENABLE_ZSTD_COMPRESSION=ON\ncmake --build build/libsolv\nsudo cmake --install build/libsolv\n\nwget https://github.com/rpm-software-management/libdnf/archive/$LIBDNF_VERSION.tar.gz\ntar xf $LIBDNF_VERSION.tar.gz\n\ncp /usr/share/cmake/Modules/FindLibSolv.cmake libdnf-$LIBDNF_VERSION/cmake/modules\n\ncmake \\\n    -S libdnf-$LIBDNF_VERSION \\\n    -B build/libdnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DWITH_GTKDOC=OFF \\\n    -DWITH_HTML=OFF \\\n    -DWITH_MAN=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -DCMAKE_CXX_FLAGS=\"-pthread\" \\\n    -DPYTHON_DESIRED=3\ncmake --build build/libdnf\nsudo cmake --install build/libdnf\n\nwget https://github.com/rpm-software-management/dnf/archive/$DNF_VERSION.tar.gz\ntar xf $DNF_VERSION.tar.gz\n\ncmake \\\n    -S dnf-$DNF_VERSION \\\n    -B build/dnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DPYTHON_DESIRED=3 \\\n    -DWITH_MAN=0\ncmake --build build/dnf\nsudo cmake --install build/dnf\n\nsudo ln -s /usr/bin/dnf-3 /usr/bin/dnf\n\nwget https://github.com/metalink-dev/libmetalink/archive/release-$LIBMETALINK_VERSION.tar.gz\ntar xf release-$LIBMETALINK_VERSION.tar.gz\n\npushd libmetalink-release-$LIBMETALINK_VERSION\n./buildconf\n./configure --prefix /usr\nmake\nsudo make install\npopd\n\nwget https://github.com/vmware/tdnf/archive/v$TDNF_VERSION.tar.gz\ntar xf v$TDNF_VERSION.tar.gz\n\ncmake \\\n  -S tdnf-$TDNF_VERSION \\\n  -B build/tdnf \\\n  -DCMAKE_BUILD_TYPE=Release \\\n  -DCMAKE_INSTALL_PREFIX=/usr\ncmake --build build/tdnf\nsudo cmake --install build/tdnf\n",
                "env": {
                  "CMAKE_GENERATOR": "Ninja",
                  "LIBCOMPS_VERSION": "0.1.15",
                  "LIBREPO_VERSION": "1.12.0",
                  "LIBMODULEMD_VERSION": "2.9.4",
                  "LIBSOLV_VERSION": "0.7.14",
                  "LIBDNF_VERSION": "0.48.0",
                  "DNF_VERSION": "4.2.23",
                  "LIBMETALINK_VERSION": "0.1.3",
                  "TDNF_VERSION": "2.1.1"
                }
              },
              {
                "name": "Install swupd-extract (Clear Linux)",
                "if": "matrix.distro == 'clear'",
                "run": "go get -u github.com/clearlinux/mixer-tools/swupd-extract\nsudo ln -s ~/go/bin/swupd-extract /usr/bin/swupd-extract\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }}"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && matrix.format != 'plain_squashfs' && (matrix.distro != 'clear' || matrix.format != 'gpt_squashfs') && matrix.distro != 'photon'",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols uefi --force"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && !contains(matrix.format, 'squashfs')",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols bios --force"
              }
            ]
          }
        }
      }
    },
    "2020-08-08T13-50-41Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8413fb2f-0bc0-57e6-a809-10f36aed74ed",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-08-08T13-50-41Z__5c9faf85fd6cc3101bbed9c506bfcce612102eae.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 291,
                  "endColumn": 21
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-08-08T13-50-41Z__5c9faf85fd6cc3101bbed9c506bfcce612102eae.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 291,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "actions/checkout@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia",
                  "opensuse",
                  "photon"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "clear",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "photon",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Update",
                "run": "sudo apt-get update"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get --assume-yes --no-install-recommends install asciidoc check debootstrap e2fsprogs libarchive-dev libcppunit-dev libcurl4-openssl-dev libjson-c-dev libgpgme-dev libmagic-dev librpm-dev libsmartcols-dev libyaml-dev libzstd-dev meson ninja-build python3-gpg python3-rpm python3-sphinx squashfs-tools swig systemd-container xfsprogs xsltproc docbook-xsl zypper"
              },
              {
                "name": "Build pacman",
                "if": "matrix.distro == 'arch'",
                "run": "wget https://sources.archlinux.org/other/pacman/pacman-$PACMAN_VERSION.tar.gz\ntar xf pacman-$PACMAN_VERSION.tar.gz\n\nmeson \\\n  -Dbuildtype=release \\\n  -Ddoc=disabled \\\n  -Dscriptlet-shell=/usr/bin/bash \\\n  -Dldconfig=/usr/bin/ldconfig \\\n  build/pacman \\\n  pacman-$PACMAN_VERSION\nsudo meson install -C build/pacman\n\nwget https://sources.archlinux.org/other/archlinux-keyring/archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\ntar xf archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\n\nsudo make -C archlinux-keyring-$ARCHLINUX_KEYRING_VERSION PREFIX=/usr install\nsudo pacman-key --init\nsudo pacman-key --populate archlinux\n",
                "env": {
                  "PACMAN_VERSION": "5.2.2",
                  "ARCHLINUX_KEYRING_VERSION": "20200622"
                }
              },
              {
                "name": "Build dnf",
                "if": "startsWith(matrix.distro, 'centos') || matrix.distro == 'fedora' || matrix.distro == 'openmandriva' || matrix.distro == 'mageia' || matrix.distro == 'photon'",
                "run": "wget https://github.com/rpm-software-management/libcomps/archive/libcomps-$LIBCOMPS_VERSION.tar.gz\ntar xf libcomps-$LIBCOMPS_VERSION.tar.gz\n\ncmake \\\n    -S libcomps-libcomps-$LIBCOMPS_VERSION/libcomps \\\n    -B build/libcomps \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DPYTHON_DESIRED=3 \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -Wno-dev\ncmake --build build/libcomps\nsudo cmake --install build/libcomps\n\nwget https://github.com/rpm-software-management/librepo/archive/$LIBREPO_VERSION.tar.gz\ntar xf $LIBREPO_VERSION.tar.gz\n\ncmake \\\n    -S librepo-$LIBREPO_VERSION \\\n    -B build/librepo \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON\ncmake --build build/librepo\nsudo cmake --install build/librepo\n\nwget https://github.com/fedora-modularity/libmodulemd/archive/libmodulemd-$LIBMODULEMD_VERSION.tar.gz\ntar xf libmodulemd-$LIBMODULEMD_VERSION.tar.gz\n\nmeson \\\n    --prefix /usr \\\n    -Dbuildtype=release \\\n    -Dlibdir=lib/x86_64-linux-gnu \\\n    -Ddeveloper_build=false \\\n    -Dwith_docs=false \\\n    -Dwith_manpages=disabled \\\n    -Dskip_introspection=true \\\n    -Dgobject_overrides_dir_py3=override \\\n    build/libmodulemd \\\n    libmodulemd-libmodulemd-$LIBMODULEMD_VERSION\nsudo meson install -C build/libmodulemd\n\nwget https://github.com/openSUSE/libsolv/archive/$LIBSOLV_VERSION.tar.gz\ntar xf $LIBSOLV_VERSION.tar.gz\n\ncmake \\\n    -S libsolv-$LIBSOLV_VERSION \\\n    -B build/libsolv \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_RPMDB=ON \\\n    -DENABLE_RPMPKG=ON \\\n    -DENABLE_PUBKEY=ON \\\n    -DENABLE_RPMDB_BYRPMHEADER=ON \\\n    -DENABLE_RPMDB_LIBRPM=ON \\\n    -DENABLE_RPMPKG_LIBRPM=ON \\\n    -DENABLE_RPMMD=ON \\\n    -DENABLE_COMPS=ON \\\n    -DENABLE_MDKREPO=ON \\\n    -DENABLE_COMPLEX_DEPS=ON \\\n    -DENABLE_APPDATA=ON \\\n    -DENABLE_LZMA_COMPRESSION=ON \\\n    -DENABLE_BZIP2_COMPRESSION=ON \\\n    -DENABLE_ZSTD_COMPRESSION=ON\ncmake --build build/libsolv\nsudo cmake --install build/libsolv\n\nwget https://github.com/rpm-software-management/libdnf/archive/$LIBDNF_VERSION.tar.gz\ntar xf $LIBDNF_VERSION.tar.gz\n\ncp /usr/share/cmake/Modules/FindLibSolv.cmake libdnf-$LIBDNF_VERSION/cmake/modules\n\ncmake \\\n    -S libdnf-$LIBDNF_VERSION \\\n    -B build/libdnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DWITH_GTKDOC=OFF \\\n    -DWITH_HTML=OFF \\\n    -DWITH_MAN=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -DCMAKE_CXX_FLAGS=\"-pthread\" \\\n    -DPYTHON_DESIRED=3\ncmake --build build/libdnf\nsudo cmake --install build/libdnf\n\nwget https://github.com/rpm-software-management/dnf/archive/$DNF_VERSION.tar.gz\ntar xf $DNF_VERSION.tar.gz\n\ncmake \\\n    -S dnf-$DNF_VERSION \\\n    -B build/dnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DPYTHON_DESIRED=3 \\\n    -DWITH_MAN=0\ncmake --build build/dnf\nsudo cmake --install build/dnf\n\nsudo ln -s /usr/bin/dnf-3 /usr/bin/dnf\n\nwget https://github.com/metalink-dev/libmetalink/archive/release-$LIBMETALINK_VERSION.tar.gz\ntar xf release-$LIBMETALINK_VERSION.tar.gz\n\npushd libmetalink-release-$LIBMETALINK_VERSION\n./buildconf\n./configure --prefix /usr\nmake\nsudo make install\npopd\n\nwget https://github.com/vmware/tdnf/archive/v$TDNF_VERSION.tar.gz\ntar xf v$TDNF_VERSION.tar.gz\n\ncmake \\\n  -S tdnf-$TDNF_VERSION \\\n  -B build/tdnf \\\n  -DCMAKE_BUILD_TYPE=Release \\\n  -DCMAKE_INSTALL_PREFIX=/usr\ncmake --build build/tdnf\nsudo cmake --install build/tdnf\n",
                "env": {
                  "CMAKE_GENERATOR": "Ninja",
                  "LIBCOMPS_VERSION": "0.1.15",
                  "LIBREPO_VERSION": "1.12.0",
                  "LIBMODULEMD_VERSION": "2.9.4",
                  "LIBSOLV_VERSION": "0.7.14",
                  "LIBDNF_VERSION": "0.48.0",
                  "DNF_VERSION": "4.2.23",
                  "LIBMETALINK_VERSION": "0.1.3",
                  "TDNF_VERSION": "2.1.1"
                }
              },
              {
                "name": "Install swupd-extract (Clear Linux)",
                "if": "matrix.distro == 'clear'",
                "run": "go get -u github.com/clearlinux/mixer-tools/swupd-extract\nsudo ln -s ~/go/bin/swupd-extract /usr/bin/swupd-extract\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }}"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && matrix.format != 'plain_squashfs' && (matrix.distro != 'clear' || matrix.format != 'gpt_squashfs') && matrix.distro != 'photon'",
                "run": "sudo python3 -m mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols uefi --force"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && !contains(matrix.format, 'squashfs')",
                "run": "sudo python3 -m mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols bios --force"
              }
            ]
          }
        }
      }
    },
    "2020-08-08T22-27-24Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c11ec2ef-7a27-59ee-85be-60c68cd1aa64",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-08-08T22-27-24Z__e374653959d34d241250f84447d5d03dc3bee945.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 291,
                  "endColumn": 21
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-08-08T22-27-24Z__e374653959d34d241250f84447d5d03dc3bee945.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 291,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "actions/checkout@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia",
                  "opensuse",
                  "photon"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "clear",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "photon",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Update",
                "run": "sudo apt-get update"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get --assume-yes --no-install-recommends install asciidoc check debootstrap e2fsprogs libarchive-dev libcppunit-dev libcurl4-openssl-dev libjson-c-dev libgpgme-dev libmagic-dev librpm-dev libsmartcols-dev libyaml-dev libzstd-dev meson ninja-build python3-gpg python3-rpm python3-sphinx squashfs-tools swig systemd-container xfsprogs xsltproc docbook-xsl zypper"
              },
              {
                "name": "Build pacman",
                "if": "matrix.distro == 'arch'",
                "run": "wget https://sources.archlinux.org/other/pacman/pacman-$PACMAN_VERSION.tar.gz\ntar xf pacman-$PACMAN_VERSION.tar.gz\n\nmeson \\\n  -Dbuildtype=release \\\n  -Ddoc=disabled \\\n  -Dscriptlet-shell=/usr/bin/bash \\\n  -Dldconfig=/usr/bin/ldconfig \\\n  build/pacman \\\n  pacman-$PACMAN_VERSION\nsudo meson install -C build/pacman\n\nwget https://sources.archlinux.org/other/archlinux-keyring/archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\ntar xf archlinux-keyring-$ARCHLINUX_KEYRING_VERSION.tar.gz\n\nsudo make -C archlinux-keyring-$ARCHLINUX_KEYRING_VERSION PREFIX=/usr install\nsudo pacman-key --init\nsudo pacman-key --populate archlinux\n",
                "env": {
                  "PACMAN_VERSION": "5.2.2",
                  "ARCHLINUX_KEYRING_VERSION": "20200622"
                }
              },
              {
                "name": "Build dnf",
                "if": "startsWith(matrix.distro, 'centos') || matrix.distro == 'fedora' || matrix.distro == 'openmandriva' || matrix.distro == 'mageia' || matrix.distro == 'photon'",
                "run": "wget https://github.com/rpm-software-management/libcomps/archive/libcomps-$LIBCOMPS_VERSION.tar.gz\ntar xf libcomps-$LIBCOMPS_VERSION.tar.gz\n\ncmake \\\n    -S libcomps-libcomps-$LIBCOMPS_VERSION/libcomps \\\n    -B build/libcomps \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DPYTHON_DESIRED=3 \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -Wno-dev\ncmake --build build/libcomps\nsudo cmake --install build/libcomps\n\nwget https://github.com/rpm-software-management/librepo/archive/$LIBREPO_VERSION.tar.gz\ntar xf $LIBREPO_VERSION.tar.gz\n\ncmake \\\n    -S librepo-$LIBREPO_VERSION \\\n    -B build/librepo \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_TESTS=OFF \\\n    -DENABLE_DOCS=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON\ncmake --build build/librepo\nsudo cmake --install build/librepo\n\nwget https://github.com/fedora-modularity/libmodulemd/archive/libmodulemd-$LIBMODULEMD_VERSION.tar.gz\ntar xf libmodulemd-$LIBMODULEMD_VERSION.tar.gz\n\nmeson \\\n    --prefix /usr \\\n    -Dbuildtype=release \\\n    -Dlibdir=lib/x86_64-linux-gnu \\\n    -Ddeveloper_build=false \\\n    -Dwith_docs=false \\\n    -Dwith_manpages=disabled \\\n    -Dskip_introspection=true \\\n    -Dgobject_overrides_dir_py3=override \\\n    build/libmodulemd \\\n    libmodulemd-libmodulemd-$LIBMODULEMD_VERSION\nsudo meson install -C build/libmodulemd\n\nwget https://github.com/openSUSE/libsolv/archive/$LIBSOLV_VERSION.tar.gz\ntar xf $LIBSOLV_VERSION.tar.gz\n\ncmake \\\n    -S libsolv-$LIBSOLV_VERSION \\\n    -B build/libsolv \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DENABLE_RPMDB=ON \\\n    -DENABLE_RPMPKG=ON \\\n    -DENABLE_PUBKEY=ON \\\n    -DENABLE_RPMDB_BYRPMHEADER=ON \\\n    -DENABLE_RPMDB_LIBRPM=ON \\\n    -DENABLE_RPMPKG_LIBRPM=ON \\\n    -DENABLE_RPMMD=ON \\\n    -DENABLE_COMPS=ON \\\n    -DENABLE_MDKREPO=ON \\\n    -DENABLE_COMPLEX_DEPS=ON \\\n    -DENABLE_APPDATA=ON \\\n    -DENABLE_LZMA_COMPRESSION=ON \\\n    -DENABLE_BZIP2_COMPRESSION=ON \\\n    -DENABLE_ZSTD_COMPRESSION=ON\ncmake --build build/libsolv\nsudo cmake --install build/libsolv\n\nwget https://github.com/rpm-software-management/libdnf/archive/$LIBDNF_VERSION.tar.gz\ntar xf $LIBDNF_VERSION.tar.gz\n\ncp /usr/share/cmake/Modules/FindLibSolv.cmake libdnf-$LIBDNF_VERSION/cmake/modules\n\ncmake \\\n    -S libdnf-$LIBDNF_VERSION \\\n    -B build/libdnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DCMAKE_INSTALL_LIBDIR=lib/x86_64-linux-gnu \\\n    -DWITH_GTKDOC=OFF \\\n    -DWITH_HTML=OFF \\\n    -DWITH_MAN=OFF \\\n    -DWITH_ZCHUNK=OFF \\\n    -DBUILD_SHARED_LIBS=ON \\\n    -DCMAKE_CXX_FLAGS=\"-pthread\" \\\n    -DPYTHON_DESIRED=3\ncmake --build build/libdnf\nsudo cmake --install build/libdnf\n\nwget https://github.com/rpm-software-management/dnf/archive/$DNF_VERSION.tar.gz\ntar xf $DNF_VERSION.tar.gz\n\ncmake \\\n    -S dnf-$DNF_VERSION \\\n    -B build/dnf \\\n    -DCMAKE_BUILD_TYPE=Release \\\n    -DCMAKE_INSTALL_PREFIX=/usr \\\n    -DPYTHON_DESIRED=3 \\\n    -DWITH_MAN=0\ncmake --build build/dnf\nsudo cmake --install build/dnf\n\nsudo ln -s /usr/bin/dnf-3 /usr/bin/dnf\n\nwget https://github.com/metalink-dev/libmetalink/archive/release-$LIBMETALINK_VERSION.tar.gz\ntar xf release-$LIBMETALINK_VERSION.tar.gz\n\npushd libmetalink-release-$LIBMETALINK_VERSION\n./buildconf\n./configure --prefix /usr\nmake\nsudo make install\npopd\n\nwget https://github.com/vmware/tdnf/archive/v$TDNF_VERSION.tar.gz\ntar xf v$TDNF_VERSION.tar.gz\n\ncmake \\\n  -S tdnf-$TDNF_VERSION \\\n  -B build/tdnf \\\n  -DCMAKE_BUILD_TYPE=Release \\\n  -DCMAKE_INSTALL_PREFIX=/usr\ncmake --build build/tdnf\nsudo cmake --install build/tdnf\n",
                "env": {
                  "CMAKE_GENERATOR": "Ninja",
                  "LIBCOMPS_VERSION": "0.1.15",
                  "LIBREPO_VERSION": "1.12.0",
                  "LIBMODULEMD_VERSION": "2.9.4",
                  "LIBSOLV_VERSION": "0.7.14",
                  "LIBDNF_VERSION": "0.48.0",
                  "DNF_VERSION": "4.2.23",
                  "LIBMETALINK_VERSION": "0.1.3",
                  "TDNF_VERSION": "2.1.1"
                }
              },
              {
                "name": "Install swupd-extract (Clear Linux)",
                "if": "matrix.distro == 'clear'",
                "run": "go get -u github.com/clearlinux/mixer-tools/swupd-extract\nsudo ln -s ~/go/bin/swupd-extract /usr/bin/swupd-extract\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }}"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && matrix.format != 'plain_squashfs' && (matrix.distro != 'clear' || matrix.format != 'gpt_squashfs') && matrix.distro != 'photon'",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols uefi --force"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && !contains(matrix.format, 'squashfs')",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols bios --force"
              }
            ]
          }
        }
      }
    },
    "2020-08-14T07-26-20Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-30ae77a6-c4b7-5ed5-8f14-8ba9a9bf9043",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-08-14T07-26-20Z__147664f58d073dfa65c8db924b6329aa5f6eb17c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 79,
                  "endColumn": 21
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-08-14T07-26-20Z__147664f58d073dfa65c8db924b6329aa5f6eb17c.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 79,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./.github/actions/setup-mkosi",
              "actions/checkout@v2"
            ],
            "num_run_commands": 3,
            "steps_with_conditionals": 2,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia",
                  "opensuse",
                  "photon"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "clear",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "photon",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./.github/actions/setup-mkosi"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }}"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && matrix.format != 'plain_squashfs' && (matrix.distro != 'clear' || matrix.format != 'gpt_squashfs') && matrix.distro != 'photon'",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols uefi --force"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && !contains(matrix.format, 'squashfs')",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols bios --force"
              }
            ]
          }
        }
      }
    },
    "2020-08-16T16-27-07Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c7994090-3daa-53cf-a66c-21a59f64b586",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-08-16T16-27-07Z__f53186b11729282bee0f7bee693474de2ad320aa.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 98,
                  "endColumn": 21
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-08-16T16-27-07Z__f53186b11729282bee0f7bee693474de2ad320aa.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 98,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./.github/actions/setup-mkosi",
              "actions/checkout@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 3,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia",
                  "opensuse",
                  "photon"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "clear",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "photon",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./.github/actions/setup-mkosi"
              },
              {
                "name": "Install pexpect",
                "run": "sudo apt-get install python3-pexpect"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\n# Set to empty password if we ever get opensuse to work with empty root password.\n# See https://github.com/systemd/mkosi/pull/514.\nPassword=root\nEOF\n\nsudo ./mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.distro != 'photon'",
                "run": "sudo ./tests/pexpect/boot.py ./mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && matrix.format != 'plain_squashfs' && (matrix.distro != 'clear' || matrix.format != 'gpt_squashfs') && matrix.distro != 'photon'",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols uefi --force"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && !contains(matrix.format, 'squashfs')",
                "run": "sudo ./mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols bios --force"
              }
            ]
          }
        }
      }
    },
    "2020-08-19T13-22-27Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a23ae293-17bd-55bd-8a29-43f95852f460",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-08-19T13-22-27Z__0ad47cd0afc2e74d534bf85cf80a5185840532e6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 98,
                  "endColumn": 21
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-08-19T13-22-27Z__0ad47cd0afc2e74d534bf85cf80a5185840532e6.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 98,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./.github/actions/setup-mkosi",
              "actions/checkout@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 3,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia",
                  "opensuse",
                  "photon"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "clear",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "photon",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./.github/actions/setup-mkosi"
              },
              {
                "name": "Install pexpect",
                "run": "sudo apt-get install python3-pexpect"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\n# Set to empty password if we ever get opensuse to work with empty root password.\n# See https://github.com/systemd/mkosi/pull/514.\nPassword=root\nEOF\n\nsudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.distro != 'photon'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && matrix.format != 'plain_squashfs' && (matrix.distro != 'clear' || matrix.format != 'gpt_squashfs') && matrix.distro != 'photon'",
                "run": "sudo python3 -m mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols uefi --force"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && !contains(matrix.format, 'squashfs')",
                "run": "sudo python3 -m mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols bios --force"
              }
            ]
          }
        }
      }
    },
    "2020-08-25T07-33-52Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f6c79cff-3019-52d4-aedb-d9909a70d73b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-08-25T07-33-52Z__c22fddc1c7fe428bebb32c907b11b7b6d5e3beb3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 21
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-08-25T07-33-52Z__c22fddc1c7fe428bebb32c907b11b7b6d5e3beb3.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 102,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./.github/actions/setup-mkosi",
              "actions/checkout@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia",
                  "opensuse",
                  "photon"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "clear",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "photon",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./.github/actions/setup-mkosi",
                "if": "matrix.distro != 'debian' && matrix.distro != 'ubuntu'"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends debootstrap python3-pexpect systemd-container"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\n# Set to empty password if we ever get opensuse to work with empty root password.\n# See https://github.com/systemd/mkosi/pull/514.\nPassword=root\nEOF\n\nsudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.distro != 'photon'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && matrix.format != 'plain_squashfs' && (matrix.distro != 'clear' || matrix.format != 'gpt_squashfs') && matrix.distro != 'photon'",
                "run": "sudo python3 -m mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols uefi --force"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'tar' && !contains(matrix.format, 'squashfs')",
                "run": "sudo python3 -m mkosi --debug run --distribution ${{ matrix.distro }} --format ${{ matrix.format }} --bootable --boot-protocols bios --force"
              }
            ]
          }
        }
      }
    },
    "2020-08-25T07-35-06Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-54406df8-54b1-5cbb-bfaf-63505fffd02d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-08-25T07-35-06Z__1be01b8d0ba01aaee01d518b29c5f8d2d8de4802.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 196,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-08-25T07-35-06Z__1be01b8d0ba01aaee01d518b29c5f8d2d8de4802.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 196,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 11
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./.github/actions/setup-mkosi",
              "actions/checkout@v2"
            ],
            "num_run_commands": 9,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia",
                  "opensuse",
                  "photon"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "clear",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "photon",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./.github/actions/setup-mkosi",
                "if": "matrix.distro != 'debian' && matrix.distro != 'ubuntu'"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends debootstrap ovmf python3-pexpect qemu-system-x86-64 systemd-container"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.distro != 'photon'",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\nEOF\n\nsudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.distro != 'photon'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.distro != 'clear' && matrix.distro != 'openmandriva' && matrix.distro != 'photon'",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=uefi\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.distro != 'clear' && matrix.distro != 'openmandriva' && matrix.distro != 'photon' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=bios\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2020-11-30T20-35-09Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-aa1c7de9-0867-50e7-91d9-aa9d37f9b364",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-11-30T20-35-09Z__8f158f1a3cb112c23bd74f98117c8d16090cea90.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 197,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-11-30T20-35-09Z__8f158f1a3cb112c23bd74f98117c8d16090cea90.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 197,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 11
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 9,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia",
                  "opensuse",
                  "photon"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "clear",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "photon",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./",
                "if": "matrix.distro != 'debian' && matrix.distro != 'ubuntu'"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends debootstrap ovmf python3-pexpect qemu-system-x86-64 systemd-container"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.distro != 'photon'",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\nEOF\n\nsudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.distro != 'photon' && matrix.distro != 'openmandriva'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.distro != 'clear' && matrix.distro != 'openmandriva' && matrix.distro != 'photon'",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=uefi\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.distro != 'clear' && matrix.distro != 'openmandriva' && matrix.distro != 'photon' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=bios\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2020-08-25T19-08-36Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f29ad55f-3701-5dca-bb7e-52e19c5ae6a7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-08-25T19-08-36Z__fc51f441acd1e3059f4fb5e37bd7a88d411f771a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 196,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3ca3c595bc11:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-08-25T19-08-36Z__fc51f441acd1e3059f4fb5e37bd7a88d411f771a.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 196,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 11
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 9,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "clear",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "openmandriva",
                  "mageia",
                  "opensuse",
                  "photon"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "clear",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "photon",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./",
                "if": "matrix.distro != 'debian' && matrix.distro != 'ubuntu'"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends debootstrap ovmf python3-pexpect qemu-system-x86-64 systemd-container"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.distro != 'photon'",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\nEOF\n\nsudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.distro != 'photon'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.distro != 'clear' && matrix.distro != 'openmandriva' && matrix.distro != 'photon'",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=uefi\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.distro != 'clear' && matrix.distro != 'openmandriva' && matrix.distro != 'photon' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=bios\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2020-12-02T19-57-48Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-25155cae-738a-5b99-b23c-5bf9247844c7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-12-02T19-57-48Z__0f167a2205070096e182222a84ddc954a6c23997.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 176,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3f3931aff729:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-12-02T19-57-48Z__0f167a2205070096e182222a84ddc954a6c23997.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 176,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 11
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 9,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./",
                "if": "matrix.distro != 'debian' && matrix.distro != 'ubuntu'"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends debootstrap ovmf python3-pexpect qemu-system-x86-64 systemd-container"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar'",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\nEOF\n\nsudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar'",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=uefi\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=bios\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2020-12-12T14-11-41Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f4302908-d50e-5a09-896d-36b694a95874",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-12-12T14-11-41Z__09e2c8ff2b86ccefd1db8d8622b4d764fc16d1fb.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 169,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3f3931aff729:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cd77a976-1567-50ec-8875-08f59f2c6978",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-12-12T14-11-41Z__62e1ef69b6bddb956a876fbcc236f036bc0a2f41.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 175,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3f3931aff729:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-12-12T14-11-41Z__62e1ef69b6bddb956a876fbcc236f036bc0a2f41.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 175,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 11
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 9,
            "steps_with_conditionals": 8,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./",
                "if": "matrix.distro != 'debian' && matrix.distro != 'ubuntu'"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends debootstrap ovmf python3-pexpect qemu-system-x86-64 systemd-container"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\nEOF\n\nsudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar'",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=uefi\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=bios\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2020-12-12T19-43-13Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3fa7624c-328f-5e71-aa6d-0d5ce7b29c5c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-12-12T19-43-13Z__f2809e8f3f5d66490ec7e78ef033cd5dba3f7b8a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 173,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3f3931aff729:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-12-12T19-43-13Z__f2809e8f3f5d66490ec7e78ef033cd5dba3f7b8a.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 173,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 12
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 12
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 10,
            "steps_with_conditionals": 7,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\nEOF\n\nsudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar'",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=uefi\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=bios\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2020-12-17T22-09-03Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8975eafe-f397-54e7-b2e7-f3b0910708de",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-12-17T22-09-03Z__74d2d42ce2d170c32269118cf29c664f73abf0a5.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 168,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3f3931aff729:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-12-17T22-09-03Z__74d2d42ce2d170c32269118cf29c664f73abf0a5.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 168,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 12
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 12
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 10,
            "steps_with_conditionals": 7,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\nEOF\n\nsudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar'",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=uefi\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar'",
                "run": "tee mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Validation]\nPassword=\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2020-12-27T14-39-32Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fee31590-4833-598f-8e49-7103eeba2f97",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-12-27T14-39-32Z__4a01c77f703cf350e523c5eb5e766d8b30480c54.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 154,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5458c4c6e65bf8e9:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ccd8aa01-b1b7-5274-989a-20bbebcb69de",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-12-27T14-39-32Z__d464c55b2e349bc3b789e141db11a2e299708d6c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 157,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "938e3f3931aff729:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f09c44bf-c6f0-5729-a7ef-d80bcbd4fcde",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2020-12-27T14-39-32Z__960addc0a8029e2d60e20d43fe998a82a9c89f6a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 156,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5458c4c6e65bf8e9:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2020-12-27T14-39-32Z__d464c55b2e349bc3b789e141db11a2e299708d6c.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 157,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 13
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 13
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 7,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "master"
            ]
          },
          "pull_request": {
            "branches": [
              "master"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "sudo systemctl start systemd-networkd\n\nmkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default << EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetworkVeth=yes\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar'",
                "run": "tee mkosi.default << EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default << EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar'",
                "run": "tee mkosi.default << EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2021-01-24T12-50-30Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2e7ecd92-dfa2-544a-8411-f9c528090cc0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2021-01-24T12-50-30Z__b8368d8de0169600b6ac2a078e692012e03c9ce9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 154,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5458c4c6e65bf8e9:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2021-01-24T12-50-30Z__b8368d8de0169600b6ac2a078e692012e03c9ce9.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 154,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 13
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 13
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 7,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetworkVeth=yes\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2021-02-26T15-38-47Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b4bca38c-b27c-572d-a643-a1fc707904d9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2021-02-26T15-38-47Z__daaf2e8204a480af69757c0afa090c57595aeadb.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 168,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5458c4c6e65bf8e9:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2021-02-26T15-38-47Z__daaf2e8204a480af69757c0afa090c57595aeadb.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 168,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 14
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 14
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 8,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora"
                ],
                "format": [
                  "directory",
                  "tar",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetworkVeth=yes\nEOF\n"
              },
              {
                "name": "Update systemd-nspawn",
                "if": "${{ matrix.distro == 'arch' }}",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt update\nsudo apt build-dep systemd\ngit clone https://github.com/systemd/systemd --depth=1 && cd systemd\nmeson build\nninja -C build\nsudo ln -svf $PWD/build/systemd-nspawn `which systemd-nspawn`\nsystemd-nspawn --version\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2021-09-15T10-00-06Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-87503657-082f-5e06-afa9-98d843aa2ffa",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2021-09-15T10-00-06Z__fa296001d1858881e91e9a4d20c0630b5674b967.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 183,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5458c4c6e65bf8e9:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2021-09-15T10-00-06Z__fa296001d1858881e91e9a4d20c0630b5674b967.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 183,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 14
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 14
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 8,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetworkVeth=yes\nEOF\n"
              },
              {
                "name": "Update systemd-nspawn",
                "if": "${{ matrix.distro == 'arch' }}",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt update\nsudo apt build-dep systemd\ngit clone https://github.com/systemd/systemd --depth=1 && cd systemd\nmeson build\nninja -C build\nsudo ln -svf $PWD/build/systemd-nspawn `which systemd-nspawn`\nsystemd-nspawn --version\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2021-06-11T07-37-16Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8a73a03c-ebe5-56b0-bf9b-c0617810c8b4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2021-06-11T07-37-16Z__55ec552d3cf2357a04cdce117ea1da324c5746af.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 176,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5458c4c6e65bf8e9:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2021-06-11T07-37-16Z__55ec552d3cf2357a04cdce117ea1da324c5746af.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 176,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 14
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 14
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 8,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetworkVeth=yes\nEOF\n"
              },
              {
                "name": "Update systemd-nspawn",
                "if": "${{ matrix.distro == 'arch' }}",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt update\nsudo apt build-dep systemd\ngit clone https://github.com/systemd/systemd --depth=1 && cd systemd\nmeson build\nninja -C build\nsudo ln -svf $PWD/build/systemd-nspawn `which systemd-nspawn`\nsystemd-nspawn --version\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2021-10-21T09-51-13Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f7218cb5-450d-5c64-8121-404b18c1924c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2021-10-21T09-51-13Z__c4243b5b72c9f7ba08d3644586e49d2bbc0f8457.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 230,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5458c4c6e65bf8e9:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2021-10-21T09-51-13Z__c4243b5b72c9f7ba08d3644586e49d2bbc0f8457.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 230,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 13,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetworkVeth=yes\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n"
              },
              {
                "name": "Update systemd-nspawn",
                "if": "${{ matrix.distro == 'arch' }}",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt update\nsudo apt build-dep systemd\ngit clone https://github.com/systemd/systemd --depth=1 && cd systemd\nmeson build\nninja -C build\nsudo ln -svf $PWD/build/systemd-nspawn `which systemd-nspawn`\nsystemd-nspawn --version\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2021-09-21T09-38-12Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2aaba32e-0c79-5a80-9c21-fc732b9d2eb7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2021-09-21T09-38-12Z__cfa942faf0730915593ecdf7798f5b1686eb7d87.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 190,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5458c4c6e65bf8e9:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2021-09-21T09-38-12Z__cfa942faf0730915593ecdf7798f5b1686eb7d87.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 190,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 14
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 14
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 8,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetworkVeth=yes\nEOF\n"
              },
              {
                "name": "Update systemd-nspawn",
                "if": "${{ matrix.distro == 'arch' }}",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt update\nsudo apt build-dep systemd\ngit clone https://github.com/systemd/systemd --depth=1 && cd systemd\nmeson build\nninja -C build\nsudo ln -svf $PWD/build/systemd-nspawn `which systemd-nspawn`\nsystemd-nspawn --version\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2021-10-21T19-31-58Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-501c60bf-3839-547e-b848-2c03748274f8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2021-10-21T19-31-58Z__20945a55d267c28a181ca5ea2ac9399e8f0dc641.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 190,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5458c4c6e65bf8e9:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2021-10-21T19-31-58Z__20945a55d267c28a181ca5ea2ac9399e8f0dc641.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 190,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 14
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 14
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 8,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetworkVeth=yes\nEOF\n"
              },
              {
                "name": "Update systemd-nspawn",
                "if": "${{ matrix.distro == 'arch' }}",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt update\nsudo apt build-dep systemd\ngit clone https://github.com/systemd/systemd --depth=1 && cd systemd\nmeson build\nninja -C build\nsudo ln -svf $PWD/build/systemd-nspawn `which systemd-nspawn`\nsystemd-nspawn --version\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2021-10-21T19-36-35Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cb0563e0-bda4-5e60-96c9-87a33fc58b38",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2021-10-21T19-36-35Z__847cbad563bc047fd5a30d81f9057b52ae2dc46b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 230,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5458c4c6e65bf8e9:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2021-10-21T19-36-35Z__847cbad563bc047fd5a30d81f9057b52ae2dc46b.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 230,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 13,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetworkVeth=yes\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n"
              },
              {
                "name": "Update systemd-nspawn",
                "if": "${{ matrix.distro == 'arch' }}",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt update\nsudo apt build-dep systemd\ngit clone https://github.com/systemd/systemd --depth=1 && cd systemd\nmeson build\nninja -C build\nsudo ln -svf $PWD/build/systemd-nspawn `which systemd-nspawn`\nsystemd-nspawn --version\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2021-11-12T15-14-18Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-17067d1a-e7df-5508-84f1-731425d1ce19",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2021-11-12T15-14-18Z__ac036224a93be71ccc00454e7b2482f66a7afc6a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 233,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "9270166d6baedd4b:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2021-11-12T15-14-18Z__ac036224a93be71ccc00454e7b2482f66a7afc6a.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 233,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 13,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "gpt_xfs",
                  "gpt_btrfs",
                  "gpt_squashfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetworkVeth=yes\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n"
              },
              {
                "name": "Update systemd-nspawn",
                "if": "${{ matrix.distro == 'arch' }}",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt update\nsudo apt build-dep systemd\ngit clone https://github.com/systemd/systemd --depth=1 && cd systemd\nmeson build\nninja -C build\nsudo ln -svf $PWD/build/systemd-nspawn `which systemd-nspawn`\nsystemd-nspawn --version\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2021-12-08T17-04-03Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2adbb708-e298-5e77-a3c6-8f101a47c249",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2021-12-08T17-04-03Z__fe2e09cd1cefc14b6394eeb0f9bc8f428f7dfcf3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 230,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "9270166d6baedd4b:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2021-12-08T17-04-03Z__fe2e09cd1cefc14b6394eeb0f9bc8f428f7dfcf3.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 230,
          "num_jobs": 1,
          "steps_per_job": {
            "ci": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "ci": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 13,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "ci": {
            "runs-on": "ubuntu-20.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_btrfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetworkVeth=yes\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n"
              },
              {
                "name": "Update systemd-nspawn",
                "if": "${{ matrix.distro == 'arch' }}",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt update\nsudo apt build-dep systemd\ngit clone https://github.com/systemd/systemd --depth=1 && cd systemd\nmeson build\nninja -C build\nsudo ln -svf $PWD/build/systemd-nspawn `which systemd-nspawn`\nsystemd-nspawn --version\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2022-02-02T15-13-26Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-44ed8e98-3e75-50da-aa25-0bbc9dd123e9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-02-02T15-13-26Z__c1dcd2b22754bbf5c7c076a33c989115bb7368af.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b50319f6-e61f-5a48-8603-ca0b77fee61d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-02-02T15-13-26Z__c1dcd2b22754bbf5c7c076a33c989115bb7368af.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 318,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-02-02T15-13-26Z__c1dcd2b22754bbf5c7c076a33c989115bb7368af.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 318,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 31,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-20.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'set globstar; shellcheck mkosi/**/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_btrfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetworkVeth=yes\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n"
              },
              {
                "name": "Update systemd-nspawn",
                "if": "${{ matrix.distro == 'arch' }}",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt update\nsudo apt build-dep systemd\ngit clone https://github.com/systemd/systemd --depth=1 && cd systemd\nmeson build\nninja -C build\nsudo ln -svf $PWD/build/systemd-nspawn `which systemd-nspawn`\nsystemd-nspawn --version\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2022-02-02T18-00-55Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6dbb9f38-375c-50d8-9f66-987269c7d54a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-02-02T18-00-55Z__7fe99a46c2e2eea2fe892388bcaa9e9e8f9e696e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c04dc789-2de4-545b-9ef5-da1bd9151450",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-02-02T18-00-55Z__7fe99a46c2e2eea2fe892388bcaa9e9e8f9e696e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 318,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-02-02T18-00-55Z__7fe99a46c2e2eea2fe892388bcaa9e9e8f9e696e.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 318,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 31,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-20.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "sudo python3 -m pytest"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'set globstar; shellcheck mkosi/**/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_btrfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetworkVeth=yes\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n"
              },
              {
                "name": "Update systemd-nspawn",
                "if": "${{ matrix.distro == 'arch' }}",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt update\nsudo apt build-dep systemd\ngit clone https://github.com/systemd/systemd --depth=1 && cd systemd\nmeson build\nninja -C build\nsudo ln -svf $PWD/build/systemd-nspawn `which systemd-nspawn`\nsystemd-nspawn --version\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2022-02-09T09-55-35Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1ad12223-3f12-5d67-aaa8-1213616fd1ea",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-02-09T09-55-35Z__404ef8395fcda1af1ad874d5f61601a256bbdf26.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e04a317b-0b32-5c11-a06d-81de263df9d4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-02-09T09-55-35Z__404ef8395fcda1af1ad874d5f61601a256bbdf26.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 116,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a5551a3bffae9248:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d0cc6fe4-e1ee-53bd-b35f-ef2b9c6b2240",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-02-09T09-55-35Z__404ef8395fcda1af1ad874d5f61601a256bbdf26.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 117,
                  "startColumn": 5,
                  "endLine": 335,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-02-09T09-55-35Z__404ef8395fcda1af1ad874d5f61601a256bbdf26.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 335,
          "num_jobs": 3,
          "steps_per_job": {
            "unit-test": 19,
            "python-integration-test": 4,
            "integration-test": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 3,
            "num_dependencies_between_jobs": 2,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "python-integration-test": 4,
              "integration-test": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 33,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-20.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'set globstar; shellcheck mkosi/**/*.sh'\n"
              }
            ]
          },
          "python-integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Run integration tests",
                "run": "sudo python3 -m pytest tests"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_btrfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetworkVeth=yes\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n"
              },
              {
                "name": "Update systemd-nspawn",
                "if": "${{ matrix.distro == 'arch' }}",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt update\nsudo apt build-dep systemd\ngit clone https://github.com/systemd/systemd --depth=1 && cd systemd\nmeson build\nninja -C build\nsudo ln -svf $PWD/build/systemd-nspawn `which systemd-nspawn`\nsystemd-nspawn --version\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2022-02-17T12-58-43Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ed89788b-0668-55b7-b360-7f2a75688153",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-02-17T12-58-43Z__e7c619e8ecde7df142b93bd93b41b28cd1dba4cc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e31959f9-be61-5408-b389-1b34e06f009e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-02-17T12-58-43Z__e7c619e8ecde7df142b93bd93b41b28cd1dba4cc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 130,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a5551a3bffae9248:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1fc26891-7d8a-5014-98aa-2e605e625a9c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-02-17T12-58-43Z__e7c619e8ecde7df142b93bd93b41b28cd1dba4cc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 131,
                  "startColumn": 5,
                  "endLine": 349,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-02-17T12-58-43Z__e7c619e8ecde7df142b93bd93b41b28cd1dba4cc.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 349,
          "num_jobs": 3,
          "steps_per_job": {
            "unit-test": 19,
            "python-integration-test": 5,
            "integration-test": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 3,
            "num_dependencies_between_jobs": 2,
            "num_matrix_strategies": 2,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "python-integration-test": 5,
              "integration-test": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 34,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-20.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'set globstar; shellcheck mkosi/**/*.sh'\n"
              }
            ]
          },
          "python-integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "matrix": {
                "distro": [
                  "fedora"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Configure test distribution",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/test-distribution.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\nEOF\n"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Run integration tests",
                "run": "sudo python3 -m pytest -m integration tests"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_btrfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetworkVeth=yes\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n"
              },
              {
                "name": "Update systemd-nspawn",
                "if": "${{ matrix.distro == 'arch' }}",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt update\nsudo apt build-dep systemd\ngit clone https://github.com/systemd/systemd --depth=1 && cd systemd\nmeson build\nninja -C build\nsudo ln -svf $PWD/build/systemd-nspawn `which systemd-nspawn`\nsystemd-nspawn --version\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2022-02-23T16-23-41Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-203f8333-a130-5574-8f5f-2d962bb92951",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-02-23T16-23-41Z__309b0573dd8ac41ea92f85d6019f69af9b7d8041.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-07bf1f8b-5d05-5641-8e0a-e2682ca8e8bf",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-02-23T16-23-41Z__309b0573dd8ac41ea92f85d6019f69af9b7d8041.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 130,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a5551a3bffae9248:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2353d905-face-5507-9e74-f034b92d9d39",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-02-23T16-23-41Z__309b0573dd8ac41ea92f85d6019f69af9b7d8041.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 131,
                  "startColumn": 5,
                  "endLine": 349,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-02-23T16-23-41Z__309b0573dd8ac41ea92f85d6019f69af9b7d8041.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 349,
          "num_jobs": 3,
          "steps_per_job": {
            "unit-test": 19,
            "python-integration-test": 5,
            "integration-test": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 3,
            "num_dependencies_between_jobs": 2,
            "num_matrix_strategies": 2,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "python-integration-test": 5,
              "integration-test": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 34,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-20.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'set globstar; shellcheck mkosi/**/*.sh'\n"
              }
            ]
          },
          "python-integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "matrix": {
                "distro": [
                  "fedora"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Configure test distribution",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/test-distribution.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\nEOF\n"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Run integration tests",
                "run": "sudo python3 -m pytest -m integration tests"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_btrfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetdev=yes\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n"
              },
              {
                "name": "Update systemd-nspawn",
                "if": "${{ matrix.distro == 'arch' }}",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt update\nsudo apt build-dep systemd\ngit clone https://github.com/systemd/systemd --depth=1 && cd systemd\nmeson build\nninja -C build\nsudo ln -svf $PWD/build/systemd-nspawn `which systemd-nspawn`\nsystemd-nspawn --version\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2022-02-25T11-00-35Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-210733f3-4e2f-5eaf-8b76-63a558c6aaf8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-02-25T11-00-35Z__a20c0b02bc470ace4ed33f179342beb32c18f13a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c6e4e14f-d545-5034-a371-f30e05ba832c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-02-25T11-00-35Z__a20c0b02bc470ace4ed33f179342beb32c18f13a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 130,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a5551a3bffae9248:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c72337cd-092d-5503-ade3-7e84f8e99764",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-02-25T11-00-35Z__a20c0b02bc470ace4ed33f179342beb32c18f13a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 131,
                  "startColumn": 5,
                  "endLine": 335,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-02-25T11-00-35Z__a20c0b02bc470ace4ed33f179342beb32c18f13a.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 335,
          "num_jobs": 3,
          "steps_per_job": {
            "unit-test": 19,
            "python-integration-test": 5,
            "integration-test": 14
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 3,
            "num_dependencies_between_jobs": 2,
            "num_matrix_strategies": 2,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "python-integration-test": 5,
              "integration-test": 14
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 33,
            "steps_with_conditionals": 8,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-20.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'set globstar; shellcheck mkosi/**/*.sh'\n"
              }
            ]
          },
          "python-integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "matrix": {
                "distro": [
                  "fedora"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Configure test distribution",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/test-distribution.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\nEOF\n"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Run integration tests",
                "run": "sudo python3 -m pytest -m integration tests"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_btrfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetdev=yes\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2022-03-04T16-13-20Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-67980d6c-680a-59cd-85d1-f1d0b1a5ab76",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-04T16-13-20Z__add1564990c6de58464f344b0cab92b98c0e978d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0586be6e-72e0-5c53-aef9-1faa7f2cbcf0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-04T16-13-20Z__add1564990c6de58464f344b0cab92b98c0e978d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 132,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a5551a3bffae9248:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-79241926-6cdc-5af2-9067-d78fa1c73003",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-04T16-13-20Z__add1564990c6de58464f344b0cab92b98c0e978d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 133,
                  "startColumn": 5,
                  "endLine": 337,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-03-04T16-13-20Z__add1564990c6de58464f344b0cab92b98c0e978d.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 337,
          "num_jobs": 3,
          "steps_per_job": {
            "unit-test": 19,
            "python-integration-test": 5,
            "integration-test": 14
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 3,
            "num_dependencies_between_jobs": 2,
            "num_matrix_strategies": 2,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "python-integration-test": 5,
              "integration-test": 14
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 33,
            "steps_with_conditionals": 8,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-20.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'set globstar; shellcheck mkosi/**/*.sh'\n"
              }
            ]
          },
          "python-integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "matrix": {
                "distro": [
                  "fedora"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Configure test distribution",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/test-distribution.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\nEOF\n"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Run integration tests",
                "run": "MKOSI_TEST_DEFAULT_VERB=qemu sudo python3 -m pytest -m integration tests\nMKOSI_TEST_DEFAULT_VERB=boot sudo python3 -m pytest -m integration tests\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_btrfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetdev=yes\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2022-03-01T15-56-40Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6d9190c7-7c5e-5f4e-baca-25ee968d6cac",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-01T15-56-40Z__50ea7a8e5b7c350e28131696bbb2ca9e37106ff1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-21a0dcbe-3f6f-5914-9a90-0524b1b3fcf3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-01T15-56-40Z__50ea7a8e5b7c350e28131696bbb2ca9e37106ff1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 130,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a5551a3bffae9248:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b455d45b-152f-5a3a-a4ad-31d420e05d96",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-01T15-56-40Z__50ea7a8e5b7c350e28131696bbb2ca9e37106ff1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 131,
                  "startColumn": 5,
                  "endLine": 335,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-03-01T15-56-40Z__50ea7a8e5b7c350e28131696bbb2ca9e37106ff1.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 335,
          "num_jobs": 3,
          "steps_per_job": {
            "unit-test": 19,
            "python-integration-test": 5,
            "integration-test": 14
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 3,
            "num_dependencies_between_jobs": 2,
            "num_matrix_strategies": 2,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "python-integration-test": 5,
              "integration-test": 14
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 33,
            "steps_with_conditionals": 8,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-20.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'set globstar; shellcheck mkosi/**/*.sh'\n"
              }
            ]
          },
          "python-integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "matrix": {
                "distro": [
                  "fedora"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Configure test distribution",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/test-distribution.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\nEOF\n"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Run integration tests",
                "run": "sudo python3 -m pytest -m integration tests"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_btrfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetdev=yes\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2022-03-09T16-09-11Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-29c7247f-1e64-5762-9590-c932cdd8e1cb",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-09T16-09-11Z__e1b66aec2d46e5b1fa23f482857e463da8bd4c89.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9684a1a7-1464-5fcb-b9d4-707f2ab3634d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-09T16-09-11Z__e1b66aec2d46e5b1fa23f482857e463da8bd4c89.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 133,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "a5551a3bffae9248:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b617fcd4-e90f-5550-bbef-2b751c9a7737",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-09T16-09-11Z__e1b66aec2d46e5b1fa23f482857e463da8bd4c89.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 134,
                  "startColumn": 5,
                  "endLine": 338,
                  "endColumn": 63
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-03-09T16-09-11Z__e1b66aec2d46e5b1fa23f482857e463da8bd4c89.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 338,
          "num_jobs": 3,
          "steps_per_job": {
            "unit-test": 19,
            "python-integration-test": 5,
            "integration-test": 14
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 3,
            "num_dependencies_between_jobs": 2,
            "num_matrix_strategies": 2,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "python-integration-test": 5,
              "integration-test": 14
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 33,
            "steps_with_conditionals": 8,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-20.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'set globstar; shellcheck mkosi/**/*.sh'\n"
              }
            ]
          },
          "python-integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "matrix": {
                "distro": [
                  "fedora"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Configure test distribution",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/test-distribution.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\nEOF\n"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Run integration tests",
                "run": "MKOSI_TEST_DEFAULT_VERB=qemu sudo python3 -m pytest -m integration tests\nMKOSI_TEST_DEFAULT_VERB=boot sudo python3 -m pytest -m integration tests\nMKOSI_TEST_DEFAULT_VERB=shell sudo python3 -m pytest -m integration tests\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_btrfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Write shared mkosi config",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Validation]\nPassword=\n\n[Host]\nSsh=yes\nNetdev=yes\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "if": "matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi boot"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'gpt_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && !(matrix.distro == 'ubuntu' && matrix.format == 'gpt_squashfs')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format != 'directory' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar' && ( matrix.distro == 'arch' || matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma' || matrix.distro == 'fedora' || matrix.distro == 'gentoo')",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'tar' && matrix.format != 'cpio'",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootable=yes\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuHeadless=yes\nEOF\n\nsudo python3 -m mkosi --force build\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format != 'directory' && matrix.format != 'gpt_squashfs' && matrix.format != 'plain_squashfs' && matrix.format != 'cpio' && matrix.format != 'tar'",
                "run": "sudo ./tests/pexpect/boot.py python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2022-03-24T14-02-45Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f41c1f17-f7f8-5c6d-976a-8bc7db911e1e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-24T14-02-45Z__ce9dc361b572e4a5bcc5ab50958fc4724ffc664b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3fa556cf-1037-581b-8d0c-91097200f81f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-24T14-02-45Z__ce9dc361b572e4a5bcc5ab50958fc4724ffc664b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 229,
                  "endColumn": 82
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-03-24T14-02-45Z__ce9dc361b572e4a5bcc5ab50958fc4724ffc664b.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 229,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 25,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-20.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'set globstar; shellcheck mkosi/**/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_btrfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n\nMKOSI_TEST_DEFAULT_VERB=boot sudo python3 -m pytest -m integration tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nEOF\n\nMKOSI_TEST_DEFAULT_VERB=qemu sudo python3 -m pytest -m integration tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\nEOF\n\nMKOSI_TEST_DEFAULT_VERB=qemu sudo python3 -m pytest -m integration tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=bios\nWithUnifiedKernelImages=no\nEOF\n\nMKOSI_TEST_DEFAULT_VERB=qemu sudo python3 -m pytest -m integration tests\n"
              }
            ]
          }
        }
      }
    },
    "2022-03-25T12-04-07Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-265733f1-9e9b-5973-b86c-9519f77a3c4f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-25T12-04-07Z__b766d973b741a75a7ef88f652e16e43859f359fb.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 94,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-24a1dc6e-a375-5e82-b3c1-443effc3570e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-25T12-04-07Z__b766d973b741a75a7ef88f652e16e43859f359fb.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 95,
                  "startColumn": 5,
                  "endLine": 224,
                  "endColumn": 82
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-03-25T12-04-07Z__b766d973b741a75a7ef88f652e16e43859f359fb.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 224,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 18,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 18,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-20.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_btrfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n\nMKOSI_TEST_DEFAULT_VERB=boot sudo python3 -m pytest -m integration tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nEOF\n\nMKOSI_TEST_DEFAULT_VERB=qemu sudo python3 -m pytest -m integration tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\nEOF\n\nMKOSI_TEST_DEFAULT_VERB=qemu sudo python3 -m pytest -m integration tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=bios\nWithUnifiedKernelImages=no\nEOF\n\nMKOSI_TEST_DEFAULT_VERB=qemu sudo python3 -m pytest -m integration tests\n"
              }
            ]
          }
        }
      }
    },
    "2022-03-25T13-07-22Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-79aa3b9d-309d-544b-9733-6d237cfceefa",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-25T13-07-22Z__fcc82b1167713b5b8abb5a2518e516315b39e88e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9b0f1b08-de92-509a-b3ae-714db397a053",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-03-25T13-07-22Z__fcc82b1167713b5b8abb5a2518e516315b39e88e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 229,
                  "endColumn": 82
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-03-25T13-07-22Z__fcc82b1167713b5b8abb5a2518e516315b39e88e.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 229,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 25,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-20.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_btrfs",
                  "plain_squashfs"
                ],
                "exclude": [
                  {
                    "distro": "centos",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "centos_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "rocky_epel",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma",
                    "format": "gpt_btrfs"
                  },
                  {
                    "distro": "alma_epel",
                    "format": "gpt_btrfs"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n\nMKOSI_TEST_DEFAULT_VERB=boot sudo python3 -m pytest -m integration tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nEOF\n\nMKOSI_TEST_DEFAULT_VERB=qemu sudo python3 -m pytest -m integration tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\nEOF\n\nMKOSI_TEST_DEFAULT_VERB=qemu sudo python3 -m pytest -m integration tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=bios\nWithUnifiedKernelImages=no\nEOF\n\nMKOSI_TEST_DEFAULT_VERB=qemu sudo python3 -m pytest -m integration tests\n"
              }
            ]
          }
        }
      }
    },
    "2022-04-14T20-35-40Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-136a6408-2750-51d1-b92e-5f1f6f820ef5",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-14T20-35-40Z__c3856e79b553969490d1bc764ae4f14be23f1801.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-95528f27-816f-5aa9-ac84-60a171f8df69",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-14T20-35-40Z__6e18fd8b2926a4d10ad34632e11d2f4b5336f2c6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ad9f6f50-0754-504a-b359-4fce5ac33ec3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-14T20-35-40Z__6e18fd8b2926a4d10ad34632e11d2f4b5336f2c6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 213,
                  "endColumn": 82
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e5e15da5-3fcb-5b00-9408-512f9ba3b41a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-14T20-35-40Z__c3856e79b553969490d1bc764ae4f14be23f1801.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 213,
                  "endColumn": 85
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-12400136-9376-57eb-9611-52013d37964c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-14T20-35-40Z__cc4bfa4fe49e79770b7a1bb68637b36f72784b86.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0882f7dc-bf91-5b69-8995-4ba7115a53f2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-14T20-35-40Z__cc4bfa4fe49e79770b7a1bb68637b36f72784b86.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 229,
                  "endColumn": 82
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f256bc3f-40c5-5b52-b783-014ec73ce34c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-14T20-35-40Z__deec80f46d3df90792320efde47000d4e81c4135.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-49a4370f-b46b-5066-84b1-10eb86d4c664",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-04-14T20-35-40Z__deec80f46d3df90792320efde47000d4e81c4135.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 215,
                  "endColumn": 82
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-04-14T20-35-40Z__deec80f46d3df90792320efde47000d4e81c4135.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 215,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 25,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-20.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=boot python3 -m pytest -m integration tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n# Boot with systemd.volatile=overlay so squashfs images can write to the filesystem\nKernelCommandLine=systemd.volatile=overlay\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=bios\nWithUnifiedKernelImages=no\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration tests\n"
              }
            ]
          }
        }
      }
    },
    "2022-06-20T10-48-17Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ae5a03ea-9721-5714-8d4f-ffac49fde4b6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-06-20T10-48-17Z__44dfd9e719b1b0563a93e4e1695598921cc4c263.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-922ca8b8-656b-5247-baa7-5137936399b5",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-06-20T10-48-17Z__44dfd9e719b1b0563a93e4e1695598921cc4c263.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 213,
                  "endColumn": 85
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-06-20T10-48-17Z__44dfd9e719b1b0563a93e4e1695598921cc4c263.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 213,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 25,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -v tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=boot python3 -m pytest -m integration -v tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -v tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nWithUnifiedKernelImages=no\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -v tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=bios\nWithUnifiedKernelImages=no\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -v tests\n"
              }
            ]
          }
        }
      }
    },
    "2022-06-20T11-25-03Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2aa9fc93-ba22-5622-8d55-ef05a0ee4e09",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-06-20T11-25-03Z__42e6ba58e601913989e8ea5296b9ae274740dedb.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ed9c515b-c906-589e-bbbd-b70bead272f3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-06-20T11-25-03Z__42e6ba58e601913989e8ea5296b9ae274740dedb.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 213,
                  "endColumn": 85
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-06-20T11-25-03Z__42e6ba58e601913989e8ea5296b9ae274740dedb.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 213,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 25,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -v tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=boot python3 -m pytest -m integration -v tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -v tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nWithUnifiedKernelImages=no\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -v tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=bios\nWithUnifiedKernelImages=no\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -v tests\n"
              }
            ]
          }
        }
      }
    },
    "2022-06-20T12-51-10Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-faf71385-f5b2-54cf-8fb2-daf05eb28aad",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-06-20T12-51-10Z__d55cb4db0372f222289667dd812d8fe42f6bf53f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "bd8f3ef3d32071db:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0a2f3c73-36cf-5e13-bbaa-2cefb6e724fe",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-06-20T12-51-10Z__d55cb4db0372f222289667dd812d8fe42f6bf53f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 213,
                  "endColumn": 86
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "da1bf7e753649089:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-06-20T12-51-10Z__d55cb4db0372f222289667dd812d8fe42f6bf53f.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 213,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 25,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-20.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-20.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=boot python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nWithUnifiedKernelImages=no\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=bios\nWithUnifiedKernelImages=no\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              }
            ]
          }
        }
      }
    },
    "2022-06-20T18-26-21Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2eb8a580-2d19-582f-973d-7e809df3d1ea",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-06-20T18-26-21Z__d169e79aa275f72f8cdd75ef90803acbb0faad88.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b050c8b2-5825-5b12-95b1-eb5704e3574f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-06-20T18-26-21Z__d169e79aa275f72f8cdd75ef90803acbb0faad88.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 213,
                  "endColumn": 86
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-06-20T18-26-21Z__d169e79aa275f72f8cdd75ef90803acbb0faad88.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 213,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 25,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=boot python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nWithUnifiedKernelImages=no\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=bios\nWithUnifiedKernelImages=no\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              }
            ]
          }
        }
      }
    },
    "2022-06-21T00-48-01Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-576caa1b-979f-52fc-b8cf-a4bcedce630c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-06-21T00-48-01Z__855377b92f59c12e99e5d05f772f759c166e4af7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f474aeef-758b-5330-87b2-6a9c7dce31cc",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-06-21T00-48-01Z__855377b92f59c12e99e5d05f772f759c166e4af7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 235,
                  "endColumn": 86
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-06-21T00-48-01Z__855377b92f59c12e99e5d05f772f759c166e4af7.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 235,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 26,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=boot python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\n\n[Host]\nQemuBoot=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=bios\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format}} QEMU Linux Boot",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=linux\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=linux\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              }
            ]
          }
        }
      }
    },
    "2022-07-13T09-48-27Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-209a8610-6784-5be2-be35-2faf1dd9af79",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-13T09-48-27Z__541bdcdc1f03cddd5b8591e1e73203c8d83197c0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b7b09aa5-84fb-51cc-aafe-82816022c3fc",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-13T09-48-27Z__541bdcdc1f03cddd5b8591e1e73203c8d83197c0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 235,
                  "endColumn": 86
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-07-13T09-48-27Z__541bdcdc1f03cddd5b8591e1e73203c8d83197c0.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 235,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 26,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright@1.1.258\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=boot python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\n\n[Host]\nQemuBoot=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=bios\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format}} QEMU Linux Boot",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=linux\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=linux\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              }
            ]
          }
        }
      }
    },
    "2022-07-27T06-49-49Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7b898943-2797-5315-a0d5-2c15bab1eab1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-27T06-49-49Z__0fabb995117dc65cbbe05d8a98d1547f849596c8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1798aee1-4675-582d-814e-54e6949a1efc",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-27T06-49-49Z__0fabb995117dc65cbbe05d8a98d1547f849596c8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 236,
                  "endColumn": 86
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-07-27T06-49-49Z__0fabb995117dc65cbbe05d8a98d1547f849596c8.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 236,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 26,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright@1.1.258\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=boot python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\n\n[Host]\nQemuBoot=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=bios\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format}} QEMU Linux Boot",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=linux\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=linux\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              }
            ]
          }
        }
      }
    },
    "2022-07-27T11-19-28Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-10a349c0-c936-5940-8ac0-6501e0d1f6b7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-27T11-19-28Z__f9ebc563877583d9d49d8d566ea0a65c33f01b7d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3144290b-37fc-5967-be69-eec0b1352fac",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-27T11-19-28Z__f9ebc563877583d9d49d8d566ea0a65c33f01b7d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 245,
                  "endColumn": 86
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-07-27T11-19-28Z__f9ebc563877583d9d49d8d566ea0a65c33f01b7d.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 245,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 11
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 27,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright@1.1.258\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=boot python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UsrOnly",
                "run": "tee mkosi.default <<- EOF\n[Output]\nUsrOnly=True\nEOF\n\nsudo mkosi --force build\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\n\n[Host]\nQemuBoot=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=bios\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format}} QEMU Linux Boot",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=linux\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=linux\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest -m integration -sv tests\n"
              }
            ]
          }
        }
      }
    },
    "2022-07-28T18-20-01Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-94df78f6-26bc-5ce9-8c8f-1fb94db7e93d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-28T18-20-01Z__1a8d372d46d73b864ac2f3de769c4e849f80d6d5.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-80b36f12-364e-5e7e-891e-6d2622da7da6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-07-28T18-20-01Z__1a8d372d46d73b864ac2f3de769c4e849f80d6d5.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 245,
                  "endColumn": 98
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-07-28T18-20-01Z__1a8d372d46d73b864ac2f3de769c4e849f80d6d5.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 245,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 11
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 27,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright@1.1.258\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.default.d\n\ntee mkosi.default.d/mkosi.default <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=boot python3 -m pytest --exitfirst -m integration -sv tests\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UsrOnly",
                "run": "tee mkosi.default <<- EOF\n[Output]\nUsrOnly=True\nEOF\n\nsudo mkosi --force build\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\n\n[Host]\nQemuBoot=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest --exitfirst -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest --exitfirst -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=bios\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest --exitfirst -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format}} QEMU Linux Boot",
                "run": "tee mkosi.default <<- EOF\n[Output]\nBootProtocols=linux\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=linux\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest --exitfirst -m integration -sv tests\n"
              }
            ]
          }
        }
      }
    },
    "2022-08-06T11-16-30Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8fb34942-1993-5069-900c-fbc31123f09b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-08-06T11-16-30Z__7b9bd98d15c0c580085c6e2ad59342caf7c2b4c2.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5d5881ad-0b69-5574-87bd-bb53fb09a610",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-08-06T11-16-30Z__7b9bd98d15c0c580085c6e2ad59342caf7c2b4c2.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 245,
                  "endColumn": 98
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-08-06T11-16-30Z__7b9bd98d15c0c580085c6e2ad59342caf7c2b4c2.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 245,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 11
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 27,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright@1.1.258\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.conf.d\n\ntee mkosi.conf.d/mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=boot python3 -m pytest --exitfirst -m integration -sv tests\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UsrOnly",
                "run": "tee mkosi.conf <<- EOF\n[Output]\nUsrOnly=True\nEOF\n\nsudo mkosi --force build\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "run": "tee mkosi.conf <<- EOF\n[Output]\nBootProtocols=uefi\n\n[Host]\nQemuBoot=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest --exitfirst -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "run": "tee mkosi.conf <<- EOF\n[Output]\nBootProtocols=uefi\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest --exitfirst -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "run": "tee mkosi.conf <<- EOF\n[Output]\nBootProtocols=bios\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=bios\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest --exitfirst -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format}} QEMU Linux Boot",
                "run": "tee mkosi.conf <<- EOF\n[Output]\nBootProtocols=linux\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=linux\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest --exitfirst -m integration -sv tests\n"
              }
            ]
          }
        }
      }
    },
    "2022-08-29T09-15-54Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3e804431-fcd3-575a-b4fd-1adc2d9c6af1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-08-29T09-15-54Z__2db9f7ff41cda0d6387c571947d5a95938958078.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-aacbf721-a705-5ad4-a30e-17d97dcff538",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-08-29T09-15-54Z__2db9f7ff41cda0d6387c571947d5a95938958078.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 227,
                  "endColumn": 98
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-08-29T09-15-54Z__2db9f7ff41cda0d6387c571947d5a95938958078.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 227,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 26,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright@1.1.258\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.conf.d\n\ntee mkosi.conf.d/mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=boot python3 -m pytest --exitfirst -m integration -sv tests\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UsrOnly",
                "run": "tee mkosi.conf <<- EOF\n[Output]\nUsrOnly=True\nEOF\n\nsudo mkosi --force build\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "run": "tee mkosi.conf <<- EOF\n[Host]\nQemuBoot=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest --exitfirst -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "run": "tee mkosi.conf <<- EOF\n[Output]\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest --exitfirst -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format}} QEMU Linux Boot",
                "run": "tee mkosi.conf <<- EOF\n[Output]\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=linux\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest --exitfirst -m integration -sv tests\n"
              }
            ]
          }
        }
      }
    },
    "2022-11-24T14-51-33Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f2188bfc-7126-5ff1-8425-7ccc741dc3b9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-24T14-51-33Z__73f62a0c68521821b88cd3df6a13ca0b08618a34.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fdeb565b-39be-5f79-b22e-6b0f8f67f669",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-11-24T14-51-33Z__73f62a0c68521821b88cd3df6a13ca0b08618a34.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 227,
                  "endColumn": 98
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-11-24T14-51-33Z__73f62a0c68521821b88cd3df6a13ca0b08618a34.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 227,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 26,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "gpt_ext4",
                  "plain_squashfs"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "${{ matrix.distro == 'gentoo' }}",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.conf.d\n\ntee mkosi.conf.d/mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=boot python3 -m pytest --exitfirst -m integration -sv tests\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }} UsrOnly",
                "run": "tee mkosi.conf <<- EOF\n[Output]\nUsrOnly=True\nEOF\n\nsudo mkosi --force build\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI UKI",
                "run": "tee mkosi.conf <<- EOF\n[Host]\nQemuBoot=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest --exitfirst -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "run": "tee mkosi.conf <<- EOF\n[Output]\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=uefi\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest --exitfirst -m integration -sv tests\n"
              },
              {
                "name": "Build/Boot ${{ matrix.distro }}/${{ matrix.format}} QEMU Linux Boot",
                "run": "tee mkosi.conf <<- EOF\n[Output]\nWithUnifiedKernelImages=no\n\n[Host]\nQemuBoot=linux\nEOF\n\nsudo MKOSI_TEST_DEFAULT_VERB=qemu python3 -m pytest --exitfirst -m integration -sv tests\n"
              }
            ]
          }
        }
      }
    },
    "2023-01-11T14-18-23Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3c832e5a-2ed8-5faf-a31c-e20ecd8275f1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-01-11T14-18-23Z__a1d5e5adc62b17ddd4436d9fa468898ae0ec854d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-03b7a5ea-a661-5fe0-b524-a0cb5c93f021",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-01-11T14-18-23Z__a1d5e5adc62b17ddd4436d9fa468898ae0ec854d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 213,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-01-11T14-18-23Z__a1d5e5adc62b17ddd4436d9fa468898ae0ec854d.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 213,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 11
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 27,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.conf.d\n\ntee mkosi.conf.d/mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nKernelCommandLine=systemd.unit=mkosi-check-and-shutdown.service\n                  !quiet\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nAutologin=yes\nQemuHeadless=yes\n\n[Content]\nExtraTrees=.github/mkosi.extra\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "sudo timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2022-12-21T13-44-23Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-893f4ee3-c8d4-5ab1-9839-ef70ad46d085",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-12-21T13-44-23Z__26f29a197107fcc450a6257658b068757e8215b2.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5ae772bb-5483-54d5-ae4a-f91d6a6c0200",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2022-12-21T13-44-23Z__26f29a197107fcc450a6257658b068757e8215b2.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 221,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2022-12-21T13-44-23Z__26f29a197107fcc450a6257658b068757e8215b2.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 221,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 13
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 13
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 29,
            "steps_with_conditionals": 7,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.conf.d\n\ntee mkosi.conf.d/mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nKernelCommandLine=systemd.unit=mkosi-check-and-shutdown.service\n                  !quiet\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nAutologin=yes\nQemuHeadless=yes\n\n[Content]\nExtraTrees=.github/mkosi.extra\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/main\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "sudo timeout -k 30 10m python3 -m mkosi --qemu-boot=uefi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format}} QEMU Linux Boot",
                "if": "matrix.format == 'disk'",
                "run": "sudo timeout -k 30 10m python3 -m mkosi --qemu-boot=linux qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} QEMU Linux Boot",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-01-12T13-30-53Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b5c7e951-6eb1-5766-908d-f31caf692c82",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-01-12T13-30-53Z__d1f5db41929afd8e41622ce89250c93302dd23b7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9a37bbe0-1b18-5d1e-8726-643500d14d33",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-01-12T13-30-53Z__d1f5db41929afd8e41622ce89250c93302dd23b7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 212,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-01-12T13-30-53Z__d1f5db41929afd8e41622ce89250c93302dd23b7.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 212,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 11
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 27,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.conf.d\n\ntee mkosi.conf.d/mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nKernelCommandLine=systemd.unit=mkosi-check-and-shutdown.service\n                  !quiet\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nAutologin=yes\nQemuHeadless=yes\n\n[Content]\nExtraTrees=.github/mkosi.extra\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/master\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "sudo timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-01-12T15-03-42Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-815e14bf-b4a3-5930-b932-8d7dd802e73c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-01-12T15-03-42Z__a8478824f4ab6213ca8ab059d28b9a069b111380.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e97f11e2-70e8-52bf-a4ee-2d7e2efada56",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-01-12T15-03-42Z__a8478824f4ab6213ca8ab059d28b9a069b111380.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 213,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-01-12T15-03-42Z__a8478824f4ab6213ca8ab059d28b9a069b111380.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 213,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 11
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v2"
            ],
            "num_run_commands": 27,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v2"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.conf.d\n\ntee mkosi.conf.d/mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nKernelCommandLine=systemd.unit=mkosi-check-and-shutdown.service\n                  !quiet\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nAutologin=yes\nQemuHeadless=yes\n\n[Content]\nExtraTrees=.github/mkosi.extra\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/master\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "sudo timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-01-13T14-19-03Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d6dc3d44-9845-5c91-b09f-3ab5fa1839b6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-01-13T14-19-03Z__967fccbac92822d4d4d97d10297307b1230f3f8c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b4535748-f3eb-52ed-bc92-8d85112dee87",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-01-13T14-19-03Z__967fccbac92822d4d4d97d10297307b1230f3f8c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 212,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-01-13T14-19-03Z__967fccbac92822d4d4d97d10297307b1230f3f8c.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 212,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 11
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 27,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos_epel",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky_epel",
                  "alma_epel",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.conf.d\n\ntee mkosi.conf.d/mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nKernelCommandLine=systemd.unit=mkosi-check-and-shutdown.service\n                  !quiet\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nAutologin=yes\nQemuHeadless=yes\n\n[Content]\nExtraTrees=.github/mkosi.extra\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/master\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "sudo timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-01-13T15-20-29Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-136b9cd3-56fd-5e4f-b957-2aa58b73571d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-01-13T15-20-29Z__30c1624820792ac941790cf13f74b205ba5c16aa.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ec1a5ab1-5839-58d3-8faf-26f701cb68a2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-01-13T15-20-29Z__30c1624820792ac941790cf13f74b205ba5c16aa.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 220,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-47835ede-ce2e-599d-bab0-142dbfe6416e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-01-13T15-20-29Z__58db029bac7d7f337d2af46ee1d526740a20e47e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-de29f27d-29f5-519d-8735-583eca3e16c3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-01-13T15-20-29Z__58db029bac7d7f337d2af46ee1d526740a20e47e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 220,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-01-13T15-20-29Z__58db029bac7d7f337d2af46ee1d526740a20e47e.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 220,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 12
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 12
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 28,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "gentoo"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.conf.d\n\ntee mkosi.conf.d/mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nKernelCommandLine=systemd.unit=mkosi-check-and-shutdown.service\n                  !quiet\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nAutologin=yes\nQemuHeadless=yes\n\n[Content]\nExtraTrees=.github/mkosi.extra\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/master\nEOF\n"
              },
              {
                "name": "Configure EPEL",
                "if": "matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma'",
                "run": "tee mkosi.conf.d/mkosi.conf <<- EOF\n[Distribution]\nRepositories=epel\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "sudo timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-01-15T19-23-48Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-02572123-7369-5a26-8f32-0ae1d18bcf81",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-01-15T19-23-48Z__ab2aff830096e681da1950a7d29f277caa89516c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bfa3c5b5-081f-50f5-a4df-168c49093750",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-01-15T19-23-48Z__ab2aff830096e681da1950a7d29f277caa89516c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 221,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-01-15T19-23-48Z__ab2aff830096e681da1950a7d29f277caa89516c.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 221,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 12
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 12
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 28,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "gentoo",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.conf.d\n\ntee mkosi.conf.d/mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nKernelCommandLine=systemd.unit=mkosi-check-and-shutdown.service\n                  !quiet\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nAutologin=yes\nQemuHeadless=yes\n\n[Content]\nExtraTrees=.github/mkosi.extra\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/master\nEOF\n"
              },
              {
                "name": "Configure EPEL",
                "if": "matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma'",
                "run": "tee mkosi.conf.d/epel.conf <<- EOF\n[Distribution]\nRepositories=epel\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "sudo python3 -m mkosi build"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "sudo timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-02-09T08-48-06Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5428f224-9b9a-51ae-8a52-72726f50cfee",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-02-09T08-48-06Z__fdecbf74e9d8a9b1e1c32e4c16b15d7be07fdf5a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b60d9f99-f5f4-57bb-9625-7cc1e2f1898f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-02-09T08-48-06Z__fdecbf74e9d8a9b1e1c32e4c16b15d7be07fdf5a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 228,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-02-09T08-48-06Z__fdecbf74e9d8a9b1e1c32e4c16b15d7be07fdf5a.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 228,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 13
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 13
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 29,
            "steps_with_conditionals": 7,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.conf.d\n\ntee mkosi.conf.d/mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nKernelCommandLine=systemd.unit=mkosi-check-and-shutdown.service\n                  !quiet\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nAutologin=yes\nQemuHeadless=yes\n\n[Content]\nExtraTrees=.github/mkosi.extra\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/master\nEOF\n"
              },
              {
                "name": "Configure EPEL",
                "if": "matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma'",
                "run": "tee mkosi.conf.d/epel.conf <<- EOF\n[Distribution]\nRepositories=epel\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root mkosi.output/${{ matrix.distro }}~*/image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-03-10T14-43-17Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d70dfa6c-92c3-5a24-9bda-df14347ab0fa",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-10T14-43-17Z__d0ac2eb9bcb5f94f10dab50ca2f3a4a082f8b8c0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-61f4ac1e-875a-5585-96aa-0b7e6dd480c6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-10T14-43-17Z__d0ac2eb9bcb5f94f10dab50ca2f3a4a082f8b8c0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 248,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-03-10T14-43-17Z__d0ac2eb9bcb5f94f10dab50ca2f3a4a082f8b8c0.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 248,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 31,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ matrix.prebuilt-initrd }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ],
                "prebuilt-initrd": [
                  false,
                  true
                ],
                "exclude": [
                  {
                    "distro": "debian",
                    "prebuilt-initrd": true
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build ${{ matrix.distro }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "python3 -m mkosi -d ${{ matrix.distro }} -t cpio -p systemd -p udev -p kmod -o $PWD/initrd build"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.conf.d\n\ntee mkosi.conf.d/mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nKernelCommandLine=systemd.unit=mkosi-check-and-shutdown.service\n                  !quiet\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nAutologin=yes\nQemuHeadless=yes\n\n[Content]\nExtraTrees=.github/mkosi.extra\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/master\nEOF\n"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "tee mkosi.conf.d/initrd.conf <<- EOF\n[Distribution]\nInitrd=initrd.zst\nEOF\n"
              },
              {
                "name": "Configure EPEL",
                "if": "matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma'",
                "run": "tee mkosi.conf.d/epel.conf <<- EOF\n[Distribution]\nRepositories=epel\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root mkosi.output/${{ matrix.distro }}~*/image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-03-29T08-39-10Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f2f57484-29c1-565b-92ec-6b85a81e8e5d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-29T08-39-10Z__36638fb37e0ccbb97bbaa573d158dcea3a5f9bde.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-38d4daa8-be10-534b-9050-c1b2d224bc3e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-29T08-39-10Z__36638fb37e0ccbb97bbaa573d158dcea3a5f9bde.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 249,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-03-29T08-39-10Z__36638fb37e0ccbb97bbaa573d158dcea3a5f9bde.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 249,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 31,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ matrix.prebuilt-initrd }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "gentoo",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ],
                "prebuilt-initrd": [
                  false,
                  true
                ],
                "exclude": [
                  {
                    "distro": "debian",
                    "prebuilt-initrd": true
                  },
                  {
                    "distro": "gentoo",
                    "prebuilt-initrd": true
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build ${{ matrix.distro }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "python3 -m mkosi -d ${{ matrix.distro }} -t cpio -p systemd -p udev -p kmod -o $PWD/initrd build"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.conf.d\n\ntee mkosi.conf.d/mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nKernelCommandLine=systemd.unit=mkosi-check-and-shutdown.service\n                  !quiet\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nAutologin=yes\n\n[Content]\nExtraTrees=.github/mkosi.extra\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/master\nEOF\n"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "tee mkosi.conf.d/initrd.conf <<- EOF\n[Distribution]\nInitrd=initrd.zst\nEOF\n"
              },
              {
                "name": "Configure EPEL",
                "if": "matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma'",
                "run": "tee mkosi.conf.d/epel.conf <<- EOF\n[Distribution]\nRepositories=epel\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root mkosi.output/${{ matrix.distro }}~*/image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-03-12T16-37-58Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-95c54987-4603-5ddc-9f83-488d73fd72e0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-12T16-37-58Z__3e13bde7eff3442b5c64a2f4ed47a37e550da6d4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-efe82704-64d7-5a77-bf9b-e8d742e98ade",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-03-12T16-37-58Z__3e13bde7eff3442b5c64a2f4ed47a37e550da6d4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 250,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-03-12T16-37-58Z__3e13bde7eff3442b5c64a2f4ed47a37e550da6d4.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 250,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 31,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ matrix.prebuilt-initrd }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "gentoo",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ],
                "prebuilt-initrd": [
                  false,
                  true
                ],
                "exclude": [
                  {
                    "distro": "debian",
                    "prebuilt-initrd": true
                  },
                  {
                    "distro": "gentoo",
                    "prebuilt-initrd": true
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build ${{ matrix.distro }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "python3 -m mkosi -d ${{ matrix.distro }} -t cpio -p systemd -p udev -p kmod -o $PWD/initrd build"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.conf.d\n\ntee mkosi.conf.d/mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nKernelCommandLine=systemd.unit=mkosi-check-and-shutdown.service\n                  !quiet\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nAutologin=yes\nQemuHeadless=yes\n\n[Content]\nExtraTrees=.github/mkosi.extra\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/master\nEOF\n"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "tee mkosi.conf.d/initrd.conf <<- EOF\n[Distribution]\nInitrd=initrd.zst\nEOF\n"
              },
              {
                "name": "Configure EPEL",
                "if": "matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma'",
                "run": "tee mkosi.conf.d/epel.conf <<- EOF\n[Distribution]\nRepositories=epel\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root mkosi.output/${{ matrix.distro }}~*/image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-04-06T18-36-38Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b6f87935-49bc-5710-b270-6987b3dc9a01",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-04-06T18-36-38Z__e1bbc39754ef37b8657e231118cec0dff9110896.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5f7b6cd7-f512-579e-bf60-d63eaebf7df2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-04-06T18-36-38Z__e1bbc39754ef37b8657e231118cec0dff9110896.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 248,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-04-06T18-36-38Z__e1bbc39754ef37b8657e231118cec0dff9110896.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 248,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 31,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ matrix.prebuilt-initrd }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "gentoo",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ],
                "prebuilt-initrd": [
                  false,
                  true
                ],
                "exclude": [
                  {
                    "distro": "debian",
                    "prebuilt-initrd": true
                  },
                  {
                    "distro": "gentoo",
                    "prebuilt-initrd": true
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install ."
              },
              {
                "name": "Build ${{ matrix.distro }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "python3 -m mkosi -d ${{ matrix.distro }} -t cpio -p systemd -p udev -p kmod -o $PWD/initrd build"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkdir -p mkosi.conf.d\n\ntee mkosi.conf.d/mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nBootable=yes\nKernelCommandLine=systemd.unit=mkosi-check-and-shutdown.service\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nAutologin=yes\n\n[Content]\nExtraTrees=.github/mkosi.extra\nEOF\n\nmkdir -p mkosi.skeleton/etc/portage\n\ntee mkosi.skeleton/etc/portage/binrepos.conf <<- EOF\n[binhost]\nsync-uri = https://raw.githubusercontent.com/257/binpkgs/master\nEOF\n"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "tee mkosi.conf.d/initrd.conf <<- EOF\n[Distribution]\nInitrds=initrd.zst\nEOF\n"
              },
              {
                "name": "Configure EPEL",
                "if": "matrix.distro == 'centos' || matrix.distro == 'rocky' || matrix.distro == 'alma'",
                "run": "tee mkosi.conf.d/epel.conf <<- EOF\n[Distribution]\nRepositories=epel\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root mkosi.output/${{ matrix.distro }}~*/image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-04-12T14-40-20Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-616d9c04-b0ea-547f-a137-f575bdf9ae4c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-04-12T14-40-20Z__6170991739c96d1ffee29f705599d097d8b00ae7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7cd222af-4f05-55d5-93ce-f654a0cabc2a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-04-12T14-40-20Z__6170991739c96d1ffee29f705599d097d8b00ae7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 222,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-04-12T14-40-20Z__6170991739c96d1ffee29f705599d097d8b00ae7.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 222,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 14
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 14
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 30,
            "steps_with_conditionals": 8,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ matrix.prebuilt-initrd }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "gentoo",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ],
                "prebuilt-initrd": [
                  false,
                  true
                ],
                "exclude": [
                  {
                    "distro": "gentoo",
                    "prebuilt-initrd": true
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install .."
              },
              {
                "name": "Build ${{ matrix.distro }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "python3 -m mkosi -d ${{ matrix.distro }} -t cpio -p systemd -p udev -p kmod -o $PWD/initrd build",
                "working-directory": "./.github/workflows"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "tee mkosi.conf.d/00-initrd.conf <<- EOF\n[Distribution]\nInitrds=workflows/initrd.zst\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-04-21T19-45-28Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a0648ab4-5894-5bd3-a17a-46fa66b25b96",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-04-21T19-45-28Z__616adf54ef01e8034b6d73701de75fca5860dcc6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8f4d4700-90ba-599f-8276-c66569b18d2a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-04-21T19-45-28Z__616adf54ef01e8034b6d73701de75fca5860dcc6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 226,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-04-21T19-45-28Z__616adf54ef01e8034b6d73701de75fca5860dcc6.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 226,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 31,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ matrix.prebuilt-initrd }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "gentoo",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ],
                "prebuilt-initrd": [
                  false,
                  true
                ],
                "exclude": [
                  {
                    "distro": "gentoo",
                    "prebuilt-initrd": true
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install .."
              },
              {
                "name": "Build ${{ matrix.distro }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "python3 -m mkosi -d ${{ matrix.distro }} -t cpio -p systemd -p udev -p kmod --make-initrd -o $PWD/initrd build",
                "working-directory": "./.github/workflows"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "tee mkosi.conf.d/00-initrd.conf <<- EOF\n[Distribution]\nInitrds=workflows/initrd.zst\nEOF\n"
              },
              {
                "name": "Resolve Arch geo mirror location",
                "if": "matrix.distro == 'arch'",
                "run": "curl -I geo.mirror.pkgbuild.com"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-04-14T08-03-20Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-67c7cb8c-72c9-592c-bd60-355db3a899ec",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-04-14T08-03-20Z__9370067ee46fc5412d2c63869b14ec658d79bf44.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e19d60b4-8a4e-503a-a59f-9311e404903c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-04-14T08-03-20Z__9370067ee46fc5412d2c63869b14ec658d79bf44.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 5,
                  "endLine": 226,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-04-14T08-03-20Z__9370067ee46fc5412d2c63869b14ec658d79bf44.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 226,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 19,
            "integration-test": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 19,
              "integration-test": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 31,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test user installation (sudo call)",
                "run": "python3 -m pip install --user .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation (sudo call)",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\nsudo $HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ matrix.prebuilt-initrd }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "gentoo",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ],
                "prebuilt-initrd": [
                  false,
                  true
                ],
                "exclude": [
                  {
                    "distro": "gentoo",
                    "prebuilt-initrd": true
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install .."
              },
              {
                "name": "Build ${{ matrix.distro }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "python3 -m mkosi -d ${{ matrix.distro }} -t cpio -p systemd -p udev -p kmod -o $PWD/initrd build",
                "working-directory": "./.github/workflows"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "tee mkosi.conf.d/00-initrd.conf <<- EOF\n[Distribution]\nInitrds=workflows/initrd.zst\nEOF\n"
              },
              {
                "name": "Resolve Arch geo mirror location",
                "if": "matrix.distro == 'arch'",
                "run": "curl -I geo.mirror.pkgbuild.com"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-04-24T09-06-07Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-60ed098c-8a12-5c71-8d41-71f05b8b4af3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-04-24T09-06-07Z__04d5c247e22f1c02f5311677c342982ac8c7a792.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1ec6e876-d5be-5031-bb3b-045b43846cae",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-04-24T09-06-07Z__04d5c247e22f1c02f5311677c342982ac8c7a792.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 214,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-04-24T09-06-07Z__04d5c247e22f1c02f5311677c342982ac8c7a792.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 214,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 29,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright ."
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck **/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ matrix.prebuilt-initrd }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "gentoo",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ],
                "prebuilt-initrd": [
                  false,
                  true
                ],
                "exclude": [
                  {
                    "distro": "gentoo",
                    "prebuilt-initrd": true
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install .."
              },
              {
                "name": "Build ${{ matrix.distro }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "python3 -m mkosi -d ${{ matrix.distro }} -t cpio -p systemd -p udev -p kmod --make-initrd -o $PWD/initrd build",
                "working-directory": "./.github/workflows"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "tee mkosi.conf.d/00-initrd.conf <<- EOF\n[Distribution]\nInitrds=workflows/initrd.zst\nEOF\n"
              },
              {
                "name": "Resolve Arch geo mirror location",
                "if": "matrix.distro == 'arch'",
                "run": "curl -I geo.mirror.pkgbuild.com"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-04-25T11-04-18Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0f0aa515-7aa6-505a-a408-227b574756fa",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-04-25T11-04-18Z__fa61b6278623637aa35f67ccffcc97ea6f6defb7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 20,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-04-25T11-04-18Z__fa61b6278623637aa35f67ccffcc97ea6f6defb7.yml",
          "workflow_name": "CI",
          "triggers": {
            "pull_request": {},
            "push": {}
          },
          "permissions": {},
          "defaults": {
            "run": "",
            "working-directory": "./.github",
            "strategy": "",
            "fail-fast": "false",
            "matrix": "",
            "distro": "",
            "format": "",
            "prebuilt-initrd": "yes",
            "exclude": ""
          },
          "concurrency": {
            "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ matrix.prebuilt-initrd }}-${{ github.ref }}",
            "cancel-in-progress": "true",
            "defaults": "",
            "run": "",
            "working-directory": "./.github",
            "strategy": "",
            "fail-fast": "false",
            "matrix": "",
            "distro": "",
            "format": "",
            "prebuilt-initrd": "yes",
            "exclude": ""
          },
          "line_count": 231,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 18,
            "integration-test": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 2,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 2
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 18,
              "integration-test": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 0,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {}
    },
    "2023-04-26T14-02-59Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5bfd9542-2cfb-58b8-ab68-18ceb63f1022",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-04-26T14-02-59Z__d94bd95f5989ad5beab45c7c80407d3ca4f1d804.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5b33d2cc-c85b-5d02-b54d-08ad3d70e8c4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-04-26T14-02-59Z__d94bd95f5989ad5beab45c7c80407d3ca4f1d804.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 102,
                  "startColumn": 5,
                  "endLine": 228,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-04-26T14-02-59Z__d94bd95f5989ad5beab45c7c80407d3ca4f1d804.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 228,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 18,
            "integration-test": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 18,
              "integration-test": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 30,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Update systemd-analyze",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt-get update\nsudo apt-get build-dep systemd\n\ngit clone https://github.com/systemd/systemd --depth=1\nmeson setup systemd/build systemd\n\nninja -C systemd/build systemd-analyze\n\nsudo ln -svf $PWD/systemd/build/systemd-analyze /usr/bin/systemd-analyze\nsystemd-analyze --version\n"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ matrix.prebuilt-initrd }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "gentoo",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ],
                "prebuilt-initrd": [
                  false,
                  true
                ],
                "exclude": [
                  {
                    "distro": "gentoo",
                    "prebuilt-initrd": true
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install .."
              },
              {
                "name": "Build ${{ matrix.distro }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "python3 -m mkosi -d ${{ matrix.distro }} -t cpio -p systemd -p udev -p kmod --make-initrd -o $PWD/initrd build",
                "working-directory": "./.github/workflows"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }} initrd",
                "if": "matrix.prebuilt-initrd == 'yes'",
                "run": "tee mkosi.conf.d/00-initrd.conf <<- EOF\n[Distribution]\nInitrds=workflows/initrd.zst\nEOF\n"
              },
              {
                "name": "Resolve Arch geo mirror location",
                "if": "matrix.distro == 'arch'",
                "run": "curl -I geo.mirror.pkgbuild.com"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-04-25T12-21-08Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7289ba5f-0976-575f-883c-fbc3a302f350",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-04-25T12-21-08Z__8ef5db5a21fdb429976600de097de00c9183b2e5.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 20,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-04-25T12-21-08Z__8ef5db5a21fdb429976600de097de00c9183b2e5.yml",
          "workflow_name": "CI",
          "triggers": {
            "pull_request": {},
            "push": {}
          },
          "permissions": {},
          "defaults": {
            "run": "",
            "working-directory": "./.github",
            "strategy": "",
            "fail-fast": "false",
            "matrix": "",
            "distro": "",
            "format": "",
            "prebuilt-initrd": "yes",
            "exclude": ""
          },
          "concurrency": {
            "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ matrix.prebuilt-initrd }}-${{ github.ref }}",
            "cancel-in-progress": "true",
            "defaults": "",
            "run": "",
            "working-directory": "./.github",
            "strategy": "",
            "fail-fast": "false",
            "matrix": "",
            "distro": "",
            "format": "",
            "prebuilt-initrd": "yes",
            "exclude": ""
          },
          "line_count": 230,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 18,
            "integration-test": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 2,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 2
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 18,
              "integration-test": 15
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 0,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {}
    },
    "2023-05-04T10-18-45Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-17b0500c-1c13-5ee6-9b0c-cf50cf0eccfa",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-05-04T10-18-45Z__f4414bee11c97a5872a74931f8bb78995b2e98c2.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d2ea70a0-d929-5199-886b-e29757778380",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-05-04T10-18-45Z__f4414bee11c97a5872a74931f8bb78995b2e98c2.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 102,
                  "startColumn": 5,
                  "endLine": 247,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-05-04T10-18-45Z__f4414bee11c97a5872a74931f8bb78995b2e98c2.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 247,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 18,
            "integration-test": 16
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 18,
              "integration-test": 16
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 31,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Update systemd-analyze",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt-get update\nsudo apt-get build-dep systemd\n\ngit clone https://github.com/systemd/systemd --depth=1\nmeson setup systemd/build systemd\n\nninja -C systemd/build systemd-analyze\n\nsudo ln -svf $PWD/systemd/build/systemd-analyze /usr/bin/systemd-analyze\nsystemd-analyze --version\n"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install .."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }} repart",
                "if": "matrix.format == 'disk'",
                "run": "tee mkosi.conf.d/01-repart.conf <<- EOF\n[Output]\nSplitArtifacts=yes\nCompressOutput=xz\n\n[Validation]\nChecksum=yes\nEOF\n"
              },
              {
                "name": "Resolve Arch geo mirror location",
                "if": "matrix.distro == 'arch'",
                "run": "curl -I geo.mirror.pkgbuild.com"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi build"
              },
              {
                "name": "Confirm ${{ matrix.distro }}/${{ matrix.format }} repart output",
                "if": "matrix.format == 'disk'",
                "run": "# Check for SHA256SUMS file. It cannot have a prefix.\n[ -f SHA256SUMS ]\n\n# Check for a compressed raw disk image\ngrep -q image.raw.xz SHA256SUMS\n\n# Check for a compressed root split image\ngrep -q image.root-x86-64.raw.xz SHA256SUMS\n"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Decompress ${{ matrix.distro }}/${{ matrix.format }} artifacts",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "if [ -f mkosi.conf.d/01-repart.conf ] ; then rm mkosi.conf.d/01-repart.conf ; fi\n\nif [ -f mkosi.output/image.efi.xz  ] ; then xz --decompress mkosi.output/image.efi.xz  ; fi\nif [ -f mkosi.output/image.efi.zst ] ; then zst -d --rm     mkosi.output/image.efi.zst ; fi\n\nif [ -f mkosi.output/image.raw.xz  ] ; then xz --decompress mkosi.output/image.raw.xz  ; fi\nif [ -f mkosi.output/image.raw.zst ] ; then zst -d --rm     mkosi.output/image.raw.zst ; fi\n"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-05-01T08-09-19Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-04695eb0-7f37-5983-961d-096328e90b4f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-05-01T08-09-19Z__7f820b740730fe073d274181d3dd3843c96aa706.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-28f6dda1-4bc3-56e2-b972-4928f229d95c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-05-01T08-09-19Z__7f820b740730fe073d274181d3dd3843c96aa706.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 102,
                  "startColumn": 5,
                  "endLine": 209,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-05-01T08-09-19Z__7f820b740730fe073d274181d3dd3843c96aa706.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 209,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 18,
            "integration-test": 13
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 18,
              "integration-test": 13
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 28,
            "steps_with_conditionals": 7,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Update systemd-analyze",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt-get update\nsudo apt-get build-dep systemd\n\ngit clone https://github.com/systemd/systemd --depth=1\nmeson setup systemd/build systemd\n\nninja -C systemd/build systemd-analyze\n\nsudo ln -svf $PWD/systemd/build/systemd-analyze /usr/bin/systemd-analyze\nsystemd-analyze --version\n"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install .."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Resolve Arch geo mirror location",
                "if": "matrix.distro == 'arch'",
                "run": "curl -I geo.mirror.pkgbuild.com"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-05-04T17-51-25Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f1d186fa-2f12-5505-a8cb-bb60895e7ad1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-05-04T17-51-25Z__18c1d6c09511968aea00d7eedfdb28267da276c9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3ce05d55-1b6b-5ce8-90af-def1007b45e2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-05-04T17-51-25Z__18c1d6c09511968aea00d7eedfdb28267da276c9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 102,
                  "startColumn": 5,
                  "endLine": 209,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-05-04T17-51-25Z__18c1d6c09511968aea00d7eedfdb28267da276c9.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 209,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 18,
            "integration-test": 13
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 18,
              "integration-test": 13
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 28,
            "steps_with_conditionals": 7,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Update systemd-analyze",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt-get update\nsudo apt-get build-dep systemd\n\ngit clone https://github.com/systemd/systemd --depth=1\nmeson setup systemd/build systemd\n\nninja -C systemd/build systemd-analyze\n\nsudo ln -svf $PWD/systemd/build/systemd-analyze /usr/bin/systemd-analyze\nsystemd-analyze --version\n"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install .."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Resolve Arch geo mirror location",
                "if": "matrix.distro == 'arch'",
                "run": "curl -I geo.mirror.pkgbuild.com"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-05-05T14-04-16Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-315cbe13-27de-5c1c-ab70-058ff8f2fa38",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-05-05T14-04-16Z__87efe396b932878afc13771bd377a313be1eb2b8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-402d7325-0544-5ee7-a539-b6480388a500",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-05-05T14-04-16Z__87efe396b932878afc13771bd377a313be1eb2b8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 210,
                  "endColumn": 104
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-05-05T14-04-16Z__87efe396b932878afc13771bd377a313be1eb2b8.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 210,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 18,
            "integration-test": 13
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 18,
              "integration-test": 13
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 28,
            "steps_with_conditionals": 7,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Update systemd-analyze",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt-get update\nsudo apt-get build-dep systemd\nsudo apt-get install pandoc\n\ngit clone https://github.com/systemd/systemd --depth=1\nmeson setup systemd/build systemd\n\nninja -C systemd/build systemd-analyze\n\nsudo ln -svf $PWD/systemd/build/systemd-analyze /usr/bin/systemd-analyze\nsystemd-analyze --version\n"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install .."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Resolve Arch geo mirror location",
                "if": "matrix.distro == 'arch'",
                "run": "curl -I geo.mirror.pkgbuild.com"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi qemu"
              },
              {
                "name": "Check ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi shell bash -c \"[[ -e /testok ]] || { cat /failed-services; exit 1; }\""
              }
            ]
          }
        }
      }
    },
    "2023-06-01T10-45-02Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-dbb27e31-6dbe-5488-bbd2-c5ce50c0ad2f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-06-01T10-45-02Z__aaa3caa41c7a52ec175abea8fa650483f82cf657.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-baf8e89d-dd33-50a6-a30b-bc4eab2e8c09",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-06-01T10-45-02Z__aaa3caa41c7a52ec175abea8fa650483f82cf657.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 202,
                  "endColumn": 60
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-06-01T10-45-02Z__aaa3caa41c7a52ec175abea8fa650483f82cf657.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 202,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 18,
            "integration-test": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 18,
              "integration-test": 11
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 26,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Update systemd-analyze",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt-get update\nsudo apt-get build-dep systemd\nsudo apt-get install pandoc\n\ngit clone https://github.com/systemd/systemd --depth=1\nmeson setup systemd/build systemd\n\nninja -C systemd/build systemd-analyze\n\nsudo ln -svf $PWD/systemd/build/systemd-analyze /usr/bin/systemd-analyze\nsystemd-analyze --version\n"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install .."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Resolve Arch geo mirror location",
                "if": "matrix.distro == 'arch'",
                "run": "curl -I geo.mirror.pkgbuild.com"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi --debug qemu"
              }
            ]
          }
        }
      }
    },
    "2023-05-11T11-53-15Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d00f98a2-3a03-5daa-ab4c-a92b76d658d3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-05-11T11-53-15Z__31147fa979ca5cffc7091de16ae232a9fbd6d54d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2b734020-24c3-52a8-a3c4-c9a20f324a1a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-05-11T11-53-15Z__31147fa979ca5cffc7091de16ae232a9fbd6d54d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 202,
                  "endColumn": 52
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-05-11T11-53-15Z__31147fa979ca5cffc7091de16ae232a9fbd6d54d.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 202,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 18,
            "integration-test": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 18,
              "integration-test": 11
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 26,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Update systemd-analyze",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt-get update\nsudo apt-get build-dep systemd\nsudo apt-get install pandoc\n\ngit clone https://github.com/systemd/systemd --depth=1\nmeson setup systemd/build systemd\n\nninja -C systemd/build systemd-analyze\n\nsudo ln -svf $PWD/systemd/build/systemd-analyze /usr/bin/systemd-analyze\nsystemd-analyze --version\n"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install .."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Resolve Arch geo mirror location",
                "if": "matrix.distro == 'arch'",
                "run": "curl -I geo.mirror.pkgbuild.com"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi qemu"
              }
            ]
          }
        }
      }
    },
    "2023-06-23T13-31-40Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b40af2ef-e3c3-58e2-b20f-fb708ddf8325",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-06-23T13-31-40Z__8586f03c4432587e7aee9d7d09c54b4f625bfeb5.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9e50053f-b712-5844-96b4-17f5c7daec39",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-06-23T13-31-40Z__8586f03c4432587e7aee9d7d09c54b4f625bfeb5.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 171,
                  "endColumn": 60
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0bc06214-79d2-57f1-bc10-39cd3be08274",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-06-23T13-31-40Z__ebd54cede30baf18e97269b1868674586ff42937.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bba8ef48-2499-5d20-bc0b-6e501f837a68",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-06-23T13-31-40Z__ebd54cede30baf18e97269b1868674586ff42937.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 201,
                  "endColumn": 60
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-06-23T13-31-40Z__ebd54cede30baf18e97269b1868674586ff42937.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 201,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 18,
            "integration-test": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 18,
              "integration-test": 11
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 26,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Update systemd-analyze",
                "run": "echo \"deb-src http://archive.ubuntu.com/ubuntu/ $(lsb_release -cs) main restricted universe multiverse\" | sudo tee -a /etc/apt/sources.list\nsudo apt-get update\nsudo apt-get build-dep systemd\nsudo apt-get install pandoc\n\ngit clone https://github.com/systemd/systemd --depth=1\nmeson setup systemd/build systemd\n\nninja -C systemd/build systemd-analyze\n\nsudo ln -svf $PWD/systemd/build/systemd-analyze /usr/bin/systemd-analyze\nsystemd-analyze --version\n"
              },
              {
                "name": "Install",
                "run": "python3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "gentoo",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install Gentoo dependencies (portage)",
                "if": "matrix.distro == 'gentoo'",
                "run": "sudo tee /usr/lib/sysusers.d/acct-user-portage.conf > /dev/null <<- EOF\n# /usr/lib/sysusers.d/portage.conf\nu portage - \"Portage system user\" /var/lib/portage/home -\nEOF\nsudo systemd-sysusers --no-pager\n\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/db/repos\nsudo install --owner=portage --group=portage --mode=0755 --directory /etc/portage/repos.conf\nsudo install --owner=portage --group=portage --mode=0755 --directory /var/cache/binpkgs\nsudo tee /etc/portage/repos.conf/eselect-repo.conf > /dev/null <<- EOF\n[gentoo]\nlocation = /var/db/repos/gentoo\nsync-type = git\nsync-uri = https://anongit.gentoo.org/git/repo/gentoo.git\nEOF\n\ngit clone https://anongit.gentoo.org/git/proj/portage.git --depth=1\ncd portage\ntee setup.cfg > /dev/null <<- EOF\n[build_ext]\nportage-ext-modules=true\nEOF\n\nsudo python setup.py install\n\nsudo ln -s --relative /var/db/repos/gentoo/profiles/default/linux/amd64/17.1/no-multilib/systemd/merged-usr /etc/portage/make.profile\n"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install .."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Resolve Arch geo mirror location",
                "if": "matrix.distro == 'arch'",
                "run": "curl -I geo.mirror.pkgbuild.com"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi --debug qemu"
              }
            ]
          }
        }
      }
    },
    "2023-07-12T13-37-06Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-36a8f642-500e-5862-a2d4-40ada4a51b20",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-07-12T13-37-06Z__521af6e7c4dbeabb2c23ca898b3f921f6ce4d852.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 89,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-12401c77-7163-5d70-a0f1-0f3bf1d40a83",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-07-12T13-37-06Z__521af6e7c4dbeabb2c23ca898b3f921f6ce4d852.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 90,
                  "startColumn": 5,
                  "endLine": 158,
                  "endColumn": 60
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-07-12T13-37-06Z__521af6e7c4dbeabb2c23ca898b3f921f6ce4d852.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 158,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "gentoo",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install .."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Resolve Arch geo mirror location",
                "if": "matrix.distro == 'arch'",
                "run": "curl -I geo.mirror.pkgbuild.com"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi --debug qemu"
              }
            ]
          }
        }
      }
    },
    "2023-08-05T18-02-47Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bb2e2afe-d4a4-5bc4-9f1c-cdc267c8018b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-05T18-02-47Z__1e2a7cc42acad2b151abba1e0488b1d21bf56865.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 89,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-64beaaf3-7320-5d3f-8621-a062d115c873",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-05T18-02-47Z__1e2a7cc42acad2b151abba1e0488b1d21bf56865.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 90,
                  "startColumn": 5,
                  "endLine": 154,
                  "endColumn": 60
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-08-05T18-02-47Z__1e2a7cc42acad2b151abba1e0488b1d21bf56865.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 154,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 23,
            "steps_with_conditionals": 3,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test user installation",
                "run": "python3 -m pip install --user .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test editable user installation",
                "run": "python3 -m pip install --user --no-use-pep517 --editable .\n$HOME/.local/bin/mkosi -h\npython3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test venv installation (sudo call)",
                "run": "sudo testvenv/bin/mkosi -h\n"
              },
              {
                "name": "Test system installation",
                "run": "sudo python3 -m pip install .\nsudo mkosi -h\nsudo python3 -m pip uninstall --yes mkosi\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "gentoo",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install dependencies",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends python3-pexpect python3-pytest"
              },
              {
                "name": "Install",
                "run": "sudo python3 -m pip install .."
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "python3 -m mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo python3 -m mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m python3 -m mkosi --debug qemu"
              }
            ]
          }
        }
      }
    },
    "2023-08-08T10-09-07Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c30ac4cd-fffa-5a7e-8b60-e9671c2fd922",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-08T10-09-07Z__92c4e55ce1cac6e40cc914e86b5b2104d68b13b2.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 78,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4cd7086e-68d4-5e9e-bd26-cee76b46bcce",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-08T10-09-07Z__92c4e55ce1cac6e40cc914e86b5b2104d68b13b2.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 79,
                  "startColumn": 5,
                  "endLine": 141,
                  "endColumn": 49
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-08-08T10-09-07Z__92c4e55ce1cac6e40cc914e86b5b2104d68b13b2.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 141,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 8
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 8
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 19,
            "steps_with_conditionals": 3,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "gentoo",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug qemu"
              }
            ]
          }
        }
      }
    },
    "2023-08-08T11-56-34Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-84318b9d-a20d-55f5-8559-faab4461e91e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-08T11-56-34Z__7bb87d7d011162f503b842b02bbe9e157cb6f116.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 78,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a48cb3f1-130f-5f71-8955-45cf3d2a5b0b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-08T11-56-34Z__7bb87d7d011162f503b842b02bbe9e157cb6f116.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 79,
                  "startColumn": 5,
                  "endLine": 140,
                  "endColumn": 49
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-08-08T11-56-34Z__7bb87d7d011162f503b842b02bbe9e157cb6f116.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 140,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 8
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 8
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 19,
            "steps_with_conditionals": 3,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug qemu"
              }
            ]
          }
        }
      }
    },
    "2023-08-09T15-09-07Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-98da264b-76b1-5290-a2c8-e90cd9c13015",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-09T15-09-07Z__530dbd865c7054c953df7507b410fa3001b9e86d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-15100a84-9fd9-58db-8114-37929f324ca8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-09T15-09-07Z__530dbd865c7054c953df7507b410fa3001b9e86d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 143,
                  "endColumn": 49
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-08-09T15-09-07Z__530dbd865c7054c953df7507b410fa3001b9e86d.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 143,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 15,
            "integration-test": 8
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "integration-test": 8
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 20,
            "steps_with_conditionals": 3,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug qemu"
              }
            ]
          }
        }
      }
    },
    "2023-08-21T10-35-34Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a65e979e-342d-50b0-9187-233753334819",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-21T10-35-34Z__010314ce4c48eb38867f1a1b5e36b9056d8720bf.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e0ac4081-99af-5e45-b5ec-42636fc9e365",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-08-21T10-35-34Z__010314ce4c48eb38867f1a1b5e36b9056d8720bf.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 147,
                  "endColumn": 61
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-08-21T10-35-34Z__010314ce4c48eb38867f1a1b5e36b9056d8720bf.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 147,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 15,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 21,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug qemu"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug --qemu-bios qemu"
              }
            ]
          }
        }
      }
    },
    "2023-09-01T14-03-15Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-04c21cc7-b9b7-5e58-8603-181c1dd1b44f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-01T14-03-15Z__a2b69625cdc80d4315478b9bd62a65182391c108.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-199cd82c-f448-5666-a9ae-95855a475545",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-01T14-03-15Z__a2b69625cdc80d4315478b9bd62a65182391c108.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 147,
                  "endColumn": 70
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-09-01T14-03-15Z__a2b69625cdc80d4315478b9bd62a65182391c108.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 147,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 15,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 21,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug qemu"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug --qemu-firmware bios qemu"
              }
            ]
          }
        }
      }
    },
    "2023-09-02T18-21-57Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-dd3faec1-cdfe-5a1f-ae6a-6c4ea7f5c964",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-02T18-21-57Z__b6167c2047facda41aa73bd37907ba012e5c5e8a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ee74cd0f-92ab-5093-9bd6-e8ea2f037c78",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-02T18-21-57Z__b6167c2047facda41aa73bd37907ba012e5c5e8a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 151,
                  "endColumn": 70
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-09-02T18-21-57Z__b6167c2047facda41aa73bd37907ba012e5c5e8a.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 151,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 15,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 22,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Enable proposed-updates",
                "run": "sudo mkdir -p /etc/apt/sources.list.d/\necho 'deb http://azure.archive.ubuntu.com/ubuntu jammy-proposed restricted main universe' | sudo tee /etc/apt/sources.list.d/proposed.list\n"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} UEFI",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug qemu"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug --qemu-firmware bios qemu"
              }
            ]
          }
        }
      }
    },
    "2023-09-07T17-00-33Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-48568365-9b4d-5ecf-9dd6-6f49466926f3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-07T17-00-33Z__88fd416a2f6af4a0f19ab79262c4f311ea1154ac.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a2062b5c-6ccd-5023-91ea-beeb7a268471",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-07T17-00-33Z__88fd416a2f6af4a0f19ab79262c4f311ea1154ac.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 152,
                  "endColumn": 70
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-09-07T17-00-33Z__88fd416a2f6af4a0f19ab79262c4f311ea1154ac.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 152,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 15,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 22,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk",
                  "uki"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Enable proposed-updates",
                "run": "sudo mkdir -p /etc/apt/sources.list.d/\necho 'deb http://azure.archive.ubuntu.com/ubuntu jammy-proposed restricted main universe' | sudo tee /etc/apt/sources.list.d/proposed.list\n"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} QEMU",
                "if": "matrix.format == 'disk' || matrix.format == 'uki' || matrix.format == 'cpio'",
                "run": "timeout -k 30 10m mkosi --debug qemu"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug --qemu-firmware bios qemu"
              }
            ]
          }
        }
      }
    },
    "2023-09-21T13-13-07Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8f9787a7-a32a-553c-b37e-e3cd4dac00b2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-21T13-13-07Z__4cec733f9186edec10904c30b4afd3d1c8857d9d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5f947495-f452-5cfc-a927-da227567ade3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-21T13-13-07Z__4cec733f9186edec10904c30b4afd3d1c8857d9d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 148,
                  "endColumn": 70
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-09-21T13-13-07Z__4cec733f9186edec10904c30b4afd3d1c8857d9d.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 148,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 15,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 21,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk",
                  "uki"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} QEMU",
                "if": "matrix.format == 'disk' || matrix.format == 'uki' || matrix.format == 'cpio'",
                "run": "timeout -k 30 10m mkosi --debug qemu"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug --qemu-firmware bios qemu"
              }
            ]
          }
        }
      }
    },
    "2023-09-29T15-44-27Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0ef432a4-a1ec-5ef7-9a96-f9e1210b5576",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-29T15-44-27Z__5d09baca949e71be7246bc766857623c98a362f8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-40b8889c-98c2-5bd4-9d33-248391e7ab6b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-09-29T15-44-27Z__5d09baca949e71be7246bc766857623c98a362f8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 152,
                  "endColumn": 70
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-09-29T15-44-27Z__5d09baca949e71be7246bc766857623c98a362f8.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 152,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 15,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 21,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "defaults": {
              "run": {
                "working-directory": "./.github"
              }
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk",
                  "uki"
                ],
                "exclude": [
                  {
                    "distro": "rhel-ubi",
                    "format": "uki"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf.d/00-ci.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} QEMU",
                "if": "matrix.distro != 'rhel-ubi' && (matrix.format == 'disk' || matrix.format == 'uki' || matrix.format == 'cpio')",
                "run": "timeout -k 30 10m mkosi --debug qemu"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.distro != 'rhel-ubi' && matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug --qemu-firmware bios qemu"
              }
            ]
          }
        }
      }
    },
    "2023-10-18T20-06-08Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2b73cce3-4a27-57d7-94b3-379d72b456b0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-10-18T20-06-08Z__0bbf1a1a6cf753f3c46358309c3e35b9a9682e63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a3d8db4f-a266-50c6-afbc-7fd3f9b251e3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-10-18T20-06-08Z__0bbf1a1a6cf753f3c46358309c3e35b9a9682e63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 159,
                  "endColumn": 70
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-10-18T20-06-08Z__0bbf1a1a6cf753f3c46358309c3e35b9a9682e63.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 159,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 15,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 21,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk",
                  "uki"
                ],
                "exclude": [
                  {
                    "distro": "rhel-ubi",
                    "format": "uki"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Content]\nKernelCommandLine=console=ttyS0\n                  systemd.unit=mkosi-check-and-shutdown.service\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nQemuVsock=yes\nQemuMem=4G\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root mkosi.output/image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} QEMU",
                "if": "matrix.distro != 'rhel-ubi' && (matrix.format == 'disk' || matrix.format == 'uki' || matrix.format == 'cpio')",
                "run": "timeout -k 30 10m mkosi --debug qemu"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.distro != 'rhel-ubi' && matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug --qemu-firmware bios qemu"
              }
            ]
          }
        }
      }
    },
    "2023-10-18T11-12-08Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0cb9d9ae-c649-5367-8482-1767349d3e59",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-10-18T11-12-08Z__cf44cc3dd07326fb93c80c8969df4d9308035077.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4b82a4e0-7fb3-50e8-9c2e-0dbc0accdc1c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-10-18T11-12-08Z__cf44cc3dd07326fb93c80c8969df4d9308035077.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 149,
                  "endColumn": 70
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-10-18T11-12-08Z__cf44cc3dd07326fb93c80c8969df4d9308035077.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 149,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 15,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 21,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk",
                  "uki"
                ],
                "exclude": [
                  {
                    "distro": "rhel-ubi",
                    "format": "uki"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root mkosi.output/image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} QEMU",
                "if": "matrix.distro != 'rhel-ubi' && (matrix.format == 'disk' || matrix.format == 'uki' || matrix.format == 'cpio')",
                "run": "timeout -k 30 10m mkosi --debug qemu"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.distro != 'rhel-ubi' && matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug --qemu-firmware bios qemu"
              }
            ]
          }
        }
      }
    },
    "2023-10-31T10-35-21Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3ae026e2-861a-5536-8f4a-6bae63405b41",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-10-31T10-35-21Z__3dbb7a2790eff86767c4b5f62c1cf2344dc99454.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c8b9943e-6496-57fd-9d9b-98314493a067",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-10-31T10-35-21Z__3dbb7a2790eff86767c4b5f62c1cf2344dc99454.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 159,
                  "endColumn": 70
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-10-31T10-35-21Z__3dbb7a2790eff86767c4b5f62c1cf2344dc99454.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 159,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 15,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 21,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk",
                  "uki"
                ],
                "exclude": [
                  {
                    "distro": "rhel-ubi",
                    "format": "uki"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Content]\nKernelCommandLine=console=ttyS0\n                  systemd.unit=mkosi-check-and-shutdown.service\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nQemuVsock=yes\nQemuMem=4G\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root mkosi.output/image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} QEMU",
                "if": "matrix.distro != 'rhel-ubi' && (matrix.format == 'disk' || matrix.format == 'uki' || matrix.format == 'cpio')",
                "run": "timeout -k 30 10m mkosi --debug qemu"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.distro != 'rhel-ubi' && matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug --qemu-firmware bios qemu"
              }
            ]
          }
        }
      }
    },
    "2023-11-08T16-54-52Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c5932ebd-264b-5287-b362-12b4d408792a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-11-08T16-54-52Z__bce6b59669494268a672f9aeddbf9e0887f22b5a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d0e0df16-e464-5413-8f98-3c0ede98c74b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-11-08T16-54-52Z__bce6b59669494268a672f9aeddbf9e0887f22b5a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 112,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7bd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-87e0b764-bbe6-5c32-9bfc-7c4a2df42405",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-11-08T16-54-52Z__bce6b59669494268a672f9aeddbf9e0887f22b5a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 113,
                  "startColumn": 5,
                  "endLine": 190,
                  "endColumn": 70
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-11-08T16-54-52Z__bce6b59669494268a672f9aeddbf9e0887f22b5a.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 190,
          "num_jobs": 3,
          "steps_per_job": {
            "unit-test": 15,
            "mkosi-initrd": 4,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 3,
            "num_dependencies_between_jobs": 2,
            "num_matrix_strategies": 2,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "mkosi-initrd": 4,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 23,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "mkosi-initrd": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Build ${{ matrix.distro }}",
                "run": "mkosi --directory \"\" -d ${{ matrix.distro }} --include mkosi-initrd build"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk",
                  "uki"
                ],
                "exclude": [
                  {
                    "distro": "rhel-ubi",
                    "format": "uki"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Content]\nKernelCommandLine=console=ttyS0\n                  systemd.unit=mkosi-check-and-shutdown.service\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nQemuVsock=yes\nQemuMem=4G\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root mkosi.output/image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} QEMU",
                "if": "matrix.distro != 'rhel-ubi' && (matrix.format == 'disk' || matrix.format == 'uki' || matrix.format == 'cpio')",
                "run": "timeout -k 30 10m mkosi --debug qemu"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.distro != 'rhel-ubi' && matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug --qemu-firmware bios qemu"
              }
            ]
          }
        }
      }
    },
    "2023-11-09T15-42-42Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a3cb465f-7ba8-5b23-a66f-050256ab79f8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-11-09T15-42-42Z__b3cb942036d88ccbd6e76bf16ad289b9095be512.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f56e2a4b-6642-529f-9f79-b1d89e3cc005",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-11-09T15-42-42Z__b3cb942036d88ccbd6e76bf16ad289b9095be512.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 112,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7bd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-edb1961e-d9c8-5456-90a9-076829073d33",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-11-09T15-42-42Z__b3cb942036d88ccbd6e76bf16ad289b9095be512.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 113,
                  "startColumn": 5,
                  "endLine": 193,
                  "endColumn": 70
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-11-09T15-42-42Z__b3cb942036d88ccbd6e76bf16ad289b9095be512.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 193,
          "num_jobs": 3,
          "steps_per_job": {
            "unit-test": 15,
            "mkosi-initrd": 4,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 3,
            "num_dependencies_between_jobs": 2,
            "num_matrix_strategies": 2,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "mkosi-initrd": 4,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 23,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "mkosi-initrd": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Build ${{ matrix.distro }}",
                "run": "mkosi --directory \"\" -d ${{ matrix.distro }} --include mkosi-initrd build"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk",
                  "uki",
                  "esp"
                ],
                "exclude": [
                  {
                    "distro": "rhel-ubi",
                    "format": "uki"
                  },
                  {
                    "distro": "rhel-ubi",
                    "format": "esp"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Content]\nKernelCommandLine=console=ttyS0\n                  systemd.unit=mkosi-check-and-shutdown.service\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nQemuVsock=yes\nQemuMem=4G\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root mkosi.output/image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} QEMU",
                "if": "matrix.distro != 'rhel-ubi' && matrix.format != 'directory' && matrix.format != 'tar'",
                "run": "timeout -k 30 10m mkosi --debug qemu"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.distro != 'rhel-ubi' && matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug --qemu-firmware bios qemu"
              }
            ]
          }
        }
      }
    },
    "2023-11-29T16-30-27Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ac8e3b59-f52d-5cae-971c-0973ee7bf67e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-11-29T16-30-27Z__95474bd10f5951c54df05e4d5f439b9b32c3a7af.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c8e5f3b5-2c69-5cb4-92c1-c56c44d209da",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-11-29T16-30-27Z__95474bd10f5951c54df05e4d5f439b9b32c3a7af.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 112,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7bd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ac7b67a9-524d-57a2-b87a-f5ef62f77f30",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-11-29T16-30-27Z__95474bd10f5951c54df05e4d5f439b9b32c3a7af.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 113,
                  "startColumn": 5,
                  "endLine": 193,
                  "endColumn": 70
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-11-29T16-30-27Z__95474bd10f5951c54df05e4d5f439b9b32c3a7af.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 193,
          "num_jobs": 3,
          "steps_per_job": {
            "unit-test": 15,
            "mkosi-initrd": 4,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 3,
            "num_dependencies_between_jobs": 2,
            "num_matrix_strategies": 2,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "mkosi-initrd": 4,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 23,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "mkosi-initrd": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Build ${{ matrix.distro }}",
                "run": "mkosi --directory \"\" -d ${{ matrix.distro }} --include mkosi-initrd build"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk",
                  "uki",
                  "esp"
                ],
                "exclude": [
                  {
                    "distro": "rhel-ubi",
                    "format": "uki"
                  },
                  {
                    "distro": "rhel-ubi",
                    "format": "esp"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Content]\nKernelCommandLine=console=ttyS0\n                  systemd.unit=mkosi-check-and-shutdown.service\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nQemuVsock=yes\nQemuMem=4G\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root mkosi.output/image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} QEMU",
                "if": "matrix.distro != 'rhel-ubi' && matrix.format != 'directory' && matrix.format != 'tar'",
                "run": "timeout -k 30 10m mkosi --debug qemu"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.distro != 'rhel-ubi' && matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug --qemu-firmware bios qemu"
              }
            ]
          }
        }
      }
    },
    "2023-11-19T09-26-06Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-257fa0ca-0386-5d76-a730-e9073a719709",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-11-19T09-26-06Z__698834c7794f0100eba8ff17125cffc8f6ac8a63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b669ca71-50d6-512b-81fa-1bde661bf51a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-11-19T09-26-06Z__698834c7794f0100eba8ff17125cffc8f6ac8a63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 116,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7bd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5fe628e4-d377-53b0-844c-a5ae5f7a34fa",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-11-19T09-26-06Z__698834c7794f0100eba8ff17125cffc8f6ac8a63.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 117,
                  "startColumn": 5,
                  "endLine": 201,
                  "endColumn": 70
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-11-19T09-26-06Z__698834c7794f0100eba8ff17125cffc8f6ac8a63.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 201,
          "num_jobs": 3,
          "steps_per_job": {
            "unit-test": 15,
            "mkosi-initrd": 5,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 3,
            "num_dependencies_between_jobs": 2,
            "num_matrix_strategies": 2,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "mkosi-initrd": 5,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 25,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install pytest mypy types-cryptography isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "mkosi-initrd": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Enable proposed-updates",
                "run": "sudo mkdir -p /etc/apt/sources.list.d/\necho 'deb http://azure.archive.ubuntu.com/ubuntu jammy-proposed restricted main universe' | sudo tee /etc/apt/sources.list.d/proposed.list\n"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Build ${{ matrix.distro }}",
                "run": "mkosi --directory \"\" -d ${{ matrix.distro }} --include mkosi-initrd build"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ],
                "format": [
                  "directory",
                  "tar",
                  "cpio",
                  "disk",
                  "uki",
                  "esp"
                ],
                "exclude": [
                  {
                    "distro": "rhel-ubi",
                    "format": "uki"
                  },
                  {
                    "distro": "rhel-ubi",
                    "format": "esp"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Enable proposed-updates",
                "run": "sudo mkdir -p /etc/apt/sources.list.d/\necho 'deb http://azure.archive.ubuntu.com/ubuntu jammy-proposed restricted main universe' | sudo tee /etc/apt/sources.list.d/proposed.list\n"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "tee mkosi.conf <<- EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nFormat=${{ matrix.format }}\n\n[Content]\nKernelCommandLine=console=ttyS0\n                  systemd.unit=mkosi-check-and-shutdown.service\n                  systemd.log_target=console\n                  systemd.default_standard_output=journal+console\n\n[Host]\nQemuVsock=yes\nQemuMem=4G\nEOF\n"
              },
              {
                "name": "Build ${{ matrix.distro }}/${{ matrix.format }}",
                "run": "mkosi --debug build"
              },
              {
                "name": "Mask systemd-resolved",
                "if": "matrix.format == 'directory'",
                "run": "sudo systemctl --root mkosi.output/image mask systemd-resolved"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} systemd-nspawn",
                "if": "matrix.format == 'disk' || matrix.format == 'directory'",
                "run": "sudo mkosi --debug boot"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} QEMU",
                "if": "matrix.distro != 'rhel-ubi' && matrix.format != 'directory' && matrix.format != 'tar'",
                "run": "timeout -k 30 10m mkosi --debug qemu"
              },
              {
                "name": "Boot ${{ matrix.distro }}/${{ matrix.format }} BIOS",
                "if": "matrix.distro != 'rhel-ubi' && matrix.format == 'disk'",
                "run": "timeout -k 30 10m mkosi --debug --qemu-firmware bios qemu"
              }
            ]
          }
        }
      }
    },
    "2023-12-01T12-31-18Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0a7f0d30-2dd0-5b9e-b0ac-771a98d05921",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-01T12-31-18Z__b5b9963298900453446ca407d45cdc0085ef1649.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6a1aa70c-1a83-5e3e-81a9-44f918543e89",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-01T12-31-18Z__b5b9963298900453446ca407d45cdc0085ef1649.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 112,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7bd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fa720e15-e708-5b64-aaec-cd7f8a51b549",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-01T12-31-18Z__b5b9963298900453446ca407d45cdc0085ef1649.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 113,
                  "startColumn": 5,
                  "endLine": 154,
                  "endColumn": 55
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-12-01T12-31-18Z__b5b9963298900453446ca407d45cdc0085ef1649.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 154,
          "num_jobs": 3,
          "steps_per_job": {
            "unit-test": 15,
            "mkosi-initrd": 4,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 3,
            "num_dependencies_between_jobs": 2,
            "num_matrix_strategies": 2,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "mkosi-initrd": 4,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 19,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests/"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "mkosi-initrd": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Build ${{ matrix.distro }}",
                "run": "mkosi --directory \"\" -d ${{ matrix.distro }} --include mkosi-initrd build"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<- EOF\n[Host]\nQemuKvm=no\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 10m python3 -m pytest --tb=no -sv -m integration tests/",
                "env": {
                  "MKOSI_TEST_DISTRIBUTION": "${{ matrix.distro }}"
                }
              }
            ]
          }
        }
      }
    },
    "2023-12-01T13-12-14Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-06bcb410-3c76-5260-9b4c-1ce713df30fb",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-01T13-12-14Z__8af585195e50a6fd489f3f638c4f6a76b845309f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ea5aae07-3a3f-55af-ae74-6e504d7d7bb5",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-01T13-12-14Z__8af585195e50a6fd489f3f638c4f6a76b845309f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 112,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7bd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-40ee71f5-559b-57ab-a678-444409fa7935",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-01T13-12-14Z__8af585195e50a6fd489f3f638c4f6a76b845309f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 113,
                  "startColumn": 5,
                  "endLine": 154,
                  "endColumn": 55
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-12-01T13-12-14Z__8af585195e50a6fd489f3f638c4f6a76b845309f.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 154,
          "num_jobs": 3,
          "steps_per_job": {
            "unit-test": 15,
            "mkosi-initrd": 4,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 3,
            "num_dependencies_between_jobs": 2,
            "num_matrix_strategies": 2,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "mkosi-initrd": 4,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 19,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests/"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "mkosi-initrd": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Build ${{ matrix.distro }}",
                "run": "mkosi --directory \"\" -d ${{ matrix.distro }} --include mkosi-initrd build"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<- EOF\n[Host]\nQemuKvm=no\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env timeout -k 30 10m python3 -m pytest --tb=no -sv -m integration tests/",
                "env": {
                  "MKOSI_TEST_DISTRIBUTION": "${{ matrix.distro }}"
                }
              }
            ]
          }
        }
      }
    },
    "2023-12-01T13-31-57Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c7d07340-4e2c-57d0-8b4b-2c8c05768b9a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-01T13-31-57Z__2bbd30267a4fe64432c9108b34682f20bc66ac94.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-43b2436a-2dd7-5610-a4f3-5f6c65887409",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-01T13-31-57Z__2bbd30267a4fe64432c9108b34682f20bc66ac94.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 112,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7bd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0f94b33c-be58-5036-be64-e65acae5bd05",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-01T13-31-57Z__2bbd30267a4fe64432c9108b34682f20bc66ac94.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 113,
                  "startColumn": 5,
                  "endLine": 154,
                  "endColumn": 55
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-12-01T13-31-57Z__2bbd30267a4fe64432c9108b34682f20bc66ac94.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 154,
          "num_jobs": 3,
          "steps_per_job": {
            "unit-test": 15,
            "mkosi-initrd": 4,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 3,
            "num_dependencies_between_jobs": 2,
            "num_matrix_strategies": 2,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "mkosi-initrd": 4,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 19,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests/"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "mkosi-initrd": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Build ${{ matrix.distro }}",
                "run": "mkosi --directory \"\" -d ${{ matrix.distro }} --include mkosi-initrd build"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<- EOF\n[Host]\nQemuKvm=no\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env timeout -k 30 1h python3 -m pytest --tb=no -sv -m integration tests/",
                "env": {
                  "MKOSI_TEST_DISTRIBUTION": "${{ matrix.distro }}"
                }
              }
            ]
          }
        }
      }
    },
    "2023-12-04T13-21-46Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c0680a84-ffd3-58ee-a92a-4dd0c91c366a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-04T13-21-46Z__407ac5b33c50f5711b99d8936f9bd90aa29881e9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-048f2a24-b0e3-55a0-955e-3f0c58b21f31",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-04T13-21-46Z__407ac5b33c50f5711b99d8936f9bd90aa29881e9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 123,
                  "endColumn": 55
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-12-04T13-21-46Z__407ac5b33c50f5711b99d8936f9bd90aa29881e9.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 123,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 15,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests/"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<- EOF\n[Host]\nQemuKvm=no\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env timeout -k 30 1h python3 -m pytest --tb=no -sv -m integration tests/",
                "env": {
                  "MKOSI_TEST_DISTRIBUTION": "${{ matrix.distro }}"
                }
              }
            ]
          }
        }
      }
    },
    "2023-12-05T12-47-52Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ba4c9d88-160e-555b-b6cf-17e24c633fde",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-05T12-47-52Z__deeb0194c6994f6bdeda71680af49b4cfaaddf22.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 81,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-da7540d4-9432-540b-917e-dec21a013b22",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-05T12-47-52Z__deeb0194c6994f6bdeda71680af49b4cfaaddf22.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 5,
                  "endLine": 133,
                  "endColumn": 55
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-12-05T12-47-52Z__deeb0194c6994f6bdeda71680af49b4cfaaddf22.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 133,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 15,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy isort pyflakes\nnpm install -g pyright\n"
              },
              {
                "name": "Check that imports are sorted",
                "run": "python3 -m isort --verbose --check-only mkosi/"
              },
              {
                "name": "Run pyflakes",
                "run": "python3 -m pyflakes mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests/"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Host]\nQemuKvm=no\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env timeout -k 30 1h python3 -m pytest --tb=no -sv -m integration tests/",
                "env": {
                  "MKOSI_TEST_DISTRIBUTION": "${{ matrix.distro }}"
                }
              }
            ]
          }
        }
      }
    },
    "2023-12-09T11-26-02Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5fceb30c-18fe-5f97-8f21-ad947b0319a1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-09T11-26-02Z__9ad229f8ce3926e81f2134215617c1bb71bdd2a8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 86,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-dbe57920-9ea1-54ec-8aae-7cadbfcb722a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-09T11-26-02Z__9ad229f8ce3926e81f2134215617c1bb71bdd2a8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 87,
                  "startColumn": 5,
                  "endLine": 138,
                  "endColumn": 55
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-12-09T11-26-02Z__9ad229f8ce3926e81f2134215617c1bb71bdd2a8.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 138,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 16,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Host]\nQemuKvm=no\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env timeout -k 30 1h python3 -m pytest --tb=no -sv -m integration tests/",
                "env": {
                  "MKOSI_TEST_DISTRIBUTION": "${{ matrix.distro }}"
                }
              }
            ]
          }
        }
      }
    },
    "2023-12-09T11-23-41Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-eaff6e2e-8363-5568-b1aa-4daa7cca8663",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-09T11-23-41Z__53f2aaa020e8acb149232e9f6a842643ecefcd3b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 78,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6158e429-5581-5fc0-b6e0-6c75729fd031",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-09T11-23-41Z__53f2aaa020e8acb149232e9f6a842643ecefcd3b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 79,
                  "startColumn": 5,
                  "endLine": 130,
                  "endColumn": 55
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-12-09T11-23-41Z__53f2aaa020e8acb149232e9f6a842643ecefcd3b.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 130,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 16,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff mkosi/ tests/"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy mkosi/ tests/"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright mkosi/ tests/"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest -sv tests/"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Host]\nQemuKvm=no\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env timeout -k 30 1h python3 -m pytest --tb=no -sv -m integration tests/",
                "env": {
                  "MKOSI_TEST_DISTRIBUTION": "${{ matrix.distro }}"
                }
              }
            ]
          }
        }
      }
    },
    "2023-12-13T08-51-11Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-71a10c7f-4e35-53fc-81f4-0ea9e2e75942",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-13T08-51-11Z__3d6dd598424cc5675330f7ca9fdb20807de8d2d9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 86,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-72bf6db3-ada1-5da3-ad89-ad51f3189aa7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-13T08-51-11Z__3d6dd598424cc5675330f7ca9fdb20807de8d2d9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 87,
                  "startColumn": 5,
                  "endLine": 138,
                  "endColumn": 55
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-12-13T08-51-11Z__3d6dd598424cc5675330f7ca9fdb20807de8d2d9.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 138,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 16,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Host]\nQemuKvm=no\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env timeout -k 30 1h python3 -m pytest --tb=no -sv -m integration tests/",
                "env": {
                  "MKOSI_TEST_DISTRIBUTION": "${{ matrix.distro }}"
                }
              }
            ]
          }
        }
      }
    },
    "2023-12-18T11-18-53Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e701daac-e1c2-51ed-aa5e-2435922c9286",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-18T11-18-53Z__4ad47d01d1a527177ca8f7f023ccddfa0215cde1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 86,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-400acee4-2162-52d2-a92e-4a1dc15506ab",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-18T11-18-53Z__4ad47d01d1a527177ca8f7f023ccddfa0215cde1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 87,
                  "startColumn": 5,
                  "endLine": 136,
                  "endColumn": 125
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-12-18T11-18-53Z__4ad47d01d1a527177ca8f7f023ccddfa0215cde1.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 136,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 16,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.format }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "rhel-ubi",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "rocky",
                  "alma",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Host]\nQemuKvm=no\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env timeout -k 30 1h python3 -m pytest --tb=no -sv -m integration -D ${{ matrix.distro }} tests/"
              }
            ]
          }
        }
      }
    },
    "2023-12-18T13-55-31Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a799e845-5a4d-5c49-9bbe-7b8d79178ea3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-18T13-55-31Z__7493dfaf29007adcbdb7d8b9f30c4438ac566905.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 86,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-259ada8b-4181-55b1-856a-80053fb8d2f1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-18T13-55-31Z__7493dfaf29007adcbdb7d8b9f30c4438ac566905.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 87,
                  "startColumn": 5,
                  "endLine": 136,
                  "endColumn": 125
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7bd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9735e1aa-c162-54b5-bdef-e04a942545f6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-18T13-55-31Z__9c70cfb770ecac52a2ebc45b52e6e992e4add94b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 86,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7a5b46ed-f836-5122-890e-06915c74b268",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-18T13-55-31Z__9c70cfb770ecac52a2ebc45b52e6e992e4add94b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 87,
                  "startColumn": 5,
                  "endLine": 133,
                  "endColumn": 125
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7bd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-12-18T13-55-31Z__9c70cfb770ecac52a2ebc45b52e6e992e4add94b.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 133,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 16,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "ubuntu",
                  "fedora",
                  "opensuse"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Host]\nQemuKvm=no\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env timeout -k 30 1h python3 -m pytest --tb=no -sv -m integration -D ${{ matrix.distro }} tests/"
              }
            ]
          }
        }
      }
    },
    "2023-12-18T16-53-00Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5791ab92-cb7f-53a5-9b30-f4081fb7ca97",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-18T16-53-00Z__ea833cc254b546ef45cdbf7d3f6d6ce3987ef353.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 86,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-916e6822-1bb3-5b4e-9d67-37a2b42f4e9e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-18T16-53-00Z__ea833cc254b546ef45cdbf7d3f6d6ce3987ef353.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 87,
                  "startColumn": 5,
                  "endLine": 190,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-12-18T16-53-00Z__ea833cc254b546ef45cdbf7d3f6d6ce3987ef353.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 190,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 16,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "",
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "fedora",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "opensuse",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "arch"
                  },
                  {
                    "distro": "debian",
                    "tools": "fedora"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "debian"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "fedora"
                  },
                  {
                    "distro": "fedora",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Host]\nQemuKvm=no\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    $([[ -n \"${{ matrix.tools }}\" ]] && echo --tools-tree-distribution=${{ matrix.tools }}) \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2023-12-21T12-30-05Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-60e5b476-ce47-56be-aaf8-5876d056653b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-21T12-30-05Z__75a6e8bfc842acc14562cf56f568c1e767439860.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 86,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bfe737f1-baf2-56c7-aa02-bbb48829e772",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-21T12-30-05Z__75a6e8bfc842acc14562cf56f568c1e767439860.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 87,
                  "startColumn": 5,
                  "endLine": 182,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-12-21T12-30-05Z__75a6e8bfc842acc14562cf56f568c1e767439860.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 182,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 16,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "",
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "arch"
                  },
                  {
                    "distro": "debian",
                    "tools": "fedora"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "debian"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "fedora"
                  },
                  {
                    "distro": "fedora",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Host]\nQemuKvm=no\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    $([[ -n \"${{ matrix.tools }}\" ]] && echo --tools-tree-distribution=${{ matrix.tools }}) \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2023-12-21T15-45-00Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-71c0496a-949a-505a-b4ae-4f4337c2a5d7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-21T15-45-00Z__723381ef4747288847481edebd3f7f158a29b125.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 86,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-55bc5263-4ac5-52be-8b97-2bd6b7b37abe",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2023-12-21T15-45-00Z__723381ef4747288847481edebd3f7f158a29b125.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 87,
                  "startColumn": 5,
                  "endLine": 177,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2023-12-21T15-45-00Z__723381ef4747288847481edebd3f7f158a29b125.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 177,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 16,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "",
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "arch"
                  },
                  {
                    "distro": "debian",
                    "tools": "fedora"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "debian"
                  },
                  {
                    "distro": "fedora",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Host]\nQemuKvm=no\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    $([[ -n \"${{ matrix.tools }}\" ]] && echo --tools-tree-distribution=${{ matrix.tools }}) \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-01-04T15-18-39Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9622a029-6346-55a2-93f9-42ef6be841c9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-01-04T15-18-39Z__cb47cdfde00afee49fd4799062d49a78ee0defb1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 86,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-99f36660-75e2-5644-8764-fd78768d0229",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-01-04T15-18-39Z__cb47cdfde00afee49fd4799062d49a78ee0defb1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 87,
                  "startColumn": 5,
                  "endLine": 178,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-01-04T15-18-39Z__cb47cdfde00afee49fd4799062d49a78ee0defb1.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 178,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 16,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "",
                  "debian",
                  "fedora",
                  "opensuse"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "arch"
                  },
                  {
                    "distro": "debian",
                    "tools": "fedora"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "debian"
                  },
                  {
                    "distro": "fedora",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Host]\nQemuKvm=no\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    $([[ -n \"${{ matrix.tools }}\" ]] && echo --tools-tree-distribution=${{ matrix.tools }}) \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-01-05T11-45-21Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-91c56cfe-8780-582c-bdd7-9a874688e420",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-01-05T11-45-21Z__bb1bf18f2e3ce6c1920e0d9953eeabb751deebf6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ab8890ee-21ac-5b3d-9e6d-938616a4894e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-01-05T11-45-21Z__bb1bf18f2e3ce6c1920e0d9953eeabb751deebf6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 179,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-01-05T11-45-21Z__bb1bf18f2e3ce6c1920e0d9953eeabb751deebf6.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 179,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 16,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "",
                  "debian",
                  "fedora",
                  "opensuse"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "arch"
                  },
                  {
                    "distro": "debian",
                    "tools": "fedora"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "debian"
                  },
                  {
                    "distro": "fedora",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Host]\nQemuKvm=no\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    $([[ -n \"${{ matrix.tools }}\" ]] && echo --tools-tree-distribution=${{ matrix.tools }}) \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-01-08T11-41-35Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b0386664-2e0f-506f-bac4-6d2f57a631ff",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-01-08T11-41-35Z__fc5f950236be52344c75784fe3e274f000868744.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bb2e4023-9469-5a1c-8da0-94add06b6195",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-01-08T11-41-35Z__fc5f950236be52344c75784fe3e274f000868744.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 168,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-01-08T11-41-35Z__fc5f950236be52344c75784fe3e274f000868744.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 168,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 16,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "debian",
                  "fedora",
                  "opensuse"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "fedora",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Host]\nQemuKvm=no\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-01-07T14-38-04Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e2efada7-4a82-54e3-8f77-c528365c9543",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-01-07T14-38-04Z__00db6697a4aaa3e31adb70ddc9d851ee2737136c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-09b3768b-22bb-5e55-b35c-58f9fe861d9c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-01-07T14-38-04Z__00db6697a4aaa3e31adb70ddc9d851ee2737136c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 178,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-01-07T14-38-04Z__00db6697a4aaa3e31adb70ddc9d851ee2737136c.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 178,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 16,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "debian",
                  "fedora",
                  "opensuse"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "arch"
                  },
                  {
                    "distro": "debian",
                    "tools": "fedora"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "debian"
                  },
                  {
                    "distro": "fedora",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Host]\nQemuKvm=no\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-01-11T15-35-01Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b4759cce-6a92-5615-83be-4adfd930853c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-01-11T15-35-01Z__a009765b3ffbd3c27a293c5e48dd7522edff1018.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2d2788de-ae9f-5689-ac32-738374ce0c36",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-01-11T15-35-01Z__a009765b3ffbd3c27a293c5e48dd7522edff1018.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 169,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-01-11T15-35-01Z__a009765b3ffbd3c27a293c5e48dd7522edff1018.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 169,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 16,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "debian",
                  "fedora",
                  "opensuse"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "fedora",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=no\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-01-11T18-40-34Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ccd7dcef-adff-5dc3-b01c-433f1b81fb92",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-01-11T18-40-34Z__d7e5da770e4aff1d21e0a400de1aba22774a0e64.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8dfe0de3-5af1-5fc4-8e51-fd51a4ab4975",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-01-11T18-40-34Z__d7e5da770e4aff1d21e0a400de1aba22774a0e64.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 178,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-01-11T18-40-34Z__d7e5da770e4aff1d21e0a400de1aba22774a0e64.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 178,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 16,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "debian",
                  "fedora",
                  "opensuse"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "fedora",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=no\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-01-16T10-58-53Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cd66bde7-39d9-5dff-b12b-93aa0cb1265d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-01-16T10-58-53Z__a73a140f6f1c741f849b035a4ff73412a2465983.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5656e29b-289a-523b-b335-7ab02194c34f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-01-16T10-58-53Z__a73a140f6f1c741f849b035a4ff73412a2465983.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 177,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-01-16T10-58-53Z__a73a140f6f1c741f849b035a4ff73412a2465983.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 177,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 5
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 5
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 16,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "fedora",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=no\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-02-08T14-33-19Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0611b161-8dc4-5d6e-b84d-95d73ab13d06",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-02-08T14-33-19Z__373ab9cae0e2eb56f484b7e607939f38d4a9de2a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-111748e7-8758-5372-b6cd-0fa0abc63de8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-02-08T14-33-19Z__373ab9cae0e2eb56f484b7e607939f38d4a9de2a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 182,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-02-08T14-33-19Z__373ab9cae0e2eb56f484b7e607939f38d4a9de2a.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 182,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "fedora",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo rm -rf /usr/local\nsudo rm -rf /opt/hostedtoolcache\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=no\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-02-16T08-44-00Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f2cbb6c4-1a03-5cf3-8e54-17adddd774ca",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-02-16T08-44-00Z__6fa9ff16a0832b38aa5839b446d70af86f86a0ac.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-000aff47-967c-5f68-91bf-bae499c09c23",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-02-16T08-44-00Z__6fa9ff16a0832b38aa5839b446d70af86f86a0ac.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 185,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-02-16T08-44-00Z__6fa9ff16a0832b38aa5839b446d70af86f86a0ac.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 185,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "fedora",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "debian"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo rm -rf /usr/local\nsudo rm -rf /opt/hostedtoolcache\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=no\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-02-18T15-33-16Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-14f671bb-0829-5a3f-8f61-2b3f74c6931d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-02-18T15-33-16Z__9ecb80d259615aecf75022ebb70ea7d7ec264c6b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6f6e7f56-3e90-514b-b0b6-8db9a6e68e6f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-02-18T15-33-16Z__9ecb80d259615aecf75022ebb70ea7d7ec264c6b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 179,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-02-18T15-33-16Z__9ecb80d259615aecf75022ebb70ea7d7ec264c6b.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 179,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo rm -rf /usr/local\nsudo rm -rf /opt/hostedtoolcache\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=no\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-02-19T14-39-47Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7ab747a5-dea6-5fb6-bbb5-efa2687f104d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-02-19T14-39-47Z__2563fe4e9993bf9a885799a2fddfd6afce6e0b17.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6e08aee3-9c62-5e1f-b5f3-1cd8a99047ad",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-02-19T14-39-47Z__2563fe4e9993bf9a885799a2fddfd6afce6e0b17.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 180,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-02-19T14-39-47Z__2563fe4e9993bf9a885799a2fddfd6afce6e0b17.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 180,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo rm -rf /usr/local\nsudo rm -rf /opt/hostedtoolcache\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=no\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-03-13T16-07-20Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-04a55458-f1c5-5076-a57c-7a1f648f8c19",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-13T16-07-20Z__b1df7631faabe020f8d8c1aa78682b1482ba15e6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-16414430-deee-5c35-bf15-f099e4af35f6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-13T16-07-20Z__b1df7631faabe020f8d8c1aa78682b1482ba15e6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 180,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-03-13T16-07-20Z__b1df7631faabe020f8d8c1aa78682b1482ba15e6.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 180,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo rm -rf /usr/local\nsudo rm -rf /opt/hostedtoolcache\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-03-13T21-52-48Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e49e2ff7-01b5-5ce2-9828-8815599ed665",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-13T21-52-48Z__d0be3a37b703bba3933582c27434449faeea6ee6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ada12c57-25eb-5703-9f6b-3ccb48089e76",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-13T21-52-48Z__d0be3a37b703bba3933582c27434449faeea6ee6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 195,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-03-13T21-52-48Z__d0be3a37b703bba3933582c27434449faeea6ee6.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 195,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 18,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo rm -rf /usr/local\nsudo rm -rf /opt/hostedtoolcache\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Btrfs",
                "run": "truncate --size=20G btrfs.raw\nmkfs.btrfs btrfs.raw\nsudo mkdir -p /mnt/mkosi\nLOOP=\"$(sudo losetup --find --show --direct-io=on btrfs.raw)\"\nsudo mount \"$LOOP\" /mnt/mkosi --options compress=zstd,user_subvol_rm_allowed\nsudo chown \"$(id -u):$(id -g)\" /mnt/mkosi\n"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\nUseSubvolumes=yes\n\nCacheDirectory=/mnt/mkosi/mkosi.cache\nPackageCacheDirectory=/mnt/mkosi/mkosi.cache\nWorkspaceDirectory=/mnt/mkosi\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo TMPDIR=/mnt/mkosi \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-03-13T22-46-55Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-adeca8d3-c8f2-52e6-bf4b-58a7d5d293cd",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-13T22-46-55Z__84524c847379d52df803c00dcc20a81e2bf62f03.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5d5bbe67-1730-5b65-99e2-82b414fbdfe7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-13T22-46-55Z__84524c847379d52df803c00dcc20a81e2bf62f03.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 199,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-03-13T22-46-55Z__84524c847379d52df803c00dcc20a81e2bf62f03.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 199,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 18,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Btrfs",
                "run": "truncate --size=20G btrfs.raw\nmkfs.btrfs btrfs.raw\nsudo mkdir -p /mnt/mkosi\nLOOP=\"$(sudo losetup --find --show --direct-io=on btrfs.raw)\"\nsudo mount \"$LOOP\" /mnt/mkosi --options compress=zstd,user_subvol_rm_allowed\nsudo chown \"$(id -u):$(id -g)\" /mnt/mkosi\n"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\nUseSubvolumes=yes\n\nCacheDirectory=/mnt/mkosi/mkosi.cache\nPackageCacheDirectory=/mnt/mkosi/mkosi.cache\nWorkspaceDirectory=/mnt/mkosi\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo TMPDIR=/mnt/mkosi \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-03-13T22-53-20Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2dbb7587-69e5-5c28-a7ce-19b74fe328ec",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-13T22-53-20Z__0d602ce40f02ae4d980eb8f2b525e3c38a45531c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4c548f59-eea4-5ff4-803f-3b39eeed7a22",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-13T22-53-20Z__0d602ce40f02ae4d980eb8f2b525e3c38a45531c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 199,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-03-13T22-53-20Z__0d602ce40f02ae4d980eb8f2b525e3c38a45531c.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 199,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 18,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Btrfs",
                "run": "truncate --size=20G btrfs.raw\nmkfs.btrfs btrfs.raw\nsudo mkdir -p /mnt/mkosi\nLOOP=\"$(sudo losetup --find --show --direct-io=on btrfs.raw)\"\nsudo mount \"$LOOP\" /mnt/mkosi --options compress=zstd:1,user_subvol_rm_allowed,noatime,discard=async,space_cache=v2\nsudo chown \"$(id -u):$(id -g)\" /mnt/mkosi\n"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\nUseSubvolumes=yes\n\nCacheDirectory=/mnt/mkosi/mkosi.cache\nPackageCacheDirectory=/mnt/mkosi/mkosi.cache\nWorkspaceDirectory=/mnt/mkosi\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo TMPDIR=/mnt/mkosi \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-03-14T08-30-37Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0cb49665-f362-592d-9375-7ddbb8a1b7c9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-14T08-30-37Z__08bd0309f39e915dcf392ea0823c2a998f01b446.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1cbae136-56da-56ab-9f42-753bcb875816",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-14T08-30-37Z__08bd0309f39e915dcf392ea0823c2a998f01b446.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 184,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-03-14T08-30-37Z__08bd0309f39e915dcf392ea0823c2a998f01b446.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 184,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-03-14T08-31-28Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-79eb973a-9788-588d-983d-b39faecefaaa",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-14T08-31-28Z__3eebd34ba04fb2655d213e7c6fe97ca82c98fb00.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a2603f55-748f-5619-be9d-ba0b713e4e24",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-14T08-31-28Z__3eebd34ba04fb2655d213e7c6fe97ca82c98fb00.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 185,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-03-14T08-31-28Z__3eebd34ba04fb2655d213e7c6fe97ca82c98fb00.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 185,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-03-17T15-00-00Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ec9b5715-9462-5040-adcd-31d96945267d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-17T15-00-00Z__feb3ec3fbef43b5e874a48c10f71cdab7f188c20.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1ebd8c56-867d-5b57-ba99-ce9e6f9648ee",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-17T15-00-00Z__feb3ec3fbef43b5e874a48c10f71cdab7f188c20.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 187,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-03-17T15-00-00Z__feb3ec3fbef43b5e874a48c10f71cdab7f188c20.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 187,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    $([ \"${{ matrix.distro }}\" = \"debian\" ] && echo --release=unstable) \\\n    $([ \"${{ matrix.tools }}\" = \"debian\" ] && echo --tools-tree-release=unstable) \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-03-19T21-21-20Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-14a34674-952e-599c-8a5c-90643e048c74",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-19T21-21-20Z__3fc9239a81fa17ed17533be8fb99680b9e8204fc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cd039299-bb4a-5992-bb18-d4ea83deea61",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-19T21-21-20Z__3fc9239a81fa17ed17533be8fb99680b9e8204fc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 187,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-03-19T21-21-20Z__3fc9239a81fa17ed17533be8fb99680b9e8204fc.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 187,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@9bb56186c3b09b4f86b1c65136769dd318469633"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@9bb56186c3b09b4f86b1c65136769dd318469633"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@9bb56186c3b09b4f86b1c65136769dd318469633"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    $([ \"${{ matrix.distro }}\" = \"debian\" ] && echo --release=unstable) \\\n    $([ \"${{ matrix.tools }}\" = \"debian\" ] && echo --tools-tree-release=unstable) \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-03-25T12-29-43Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5cacdf57-99ef-5cca-8a9a-72dda3036b9b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-25T12-29-43Z__4604084074252cc29ad5976296eecead74507988.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8b2dc120-62d8-57a1-b503-9406cb7ba812",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-25T12-29-43Z__4604084074252cc29ad5976296eecead74507988.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 187,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-03-25T12-29-43Z__4604084074252cc29ad5976296eecead74507988.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 187,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@9bb56186c3b09b4f86b1c65136769dd318469633"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@9bb56186c3b09b4f86b1c65136769dd318469633"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@9bb56186c3b09b4f86b1c65136769dd318469633"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    $([ \"${{ matrix.distro }}\" = \"debian\" ] && echo --release=unstable) \\\n    $([ \"${{ matrix.tools }}\" = \"debian\" ] && echo --tools-tree-release=unstable) \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-03-26T12-49-22Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-626a99b6-dc39-553b-a517-904cdd487362",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-26T12-49-22Z__56bcf5979e2be6063e39493cd219f2223325fe26.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 87,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-db6a3d6c-7c18-559c-82e2-ebd22400204d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-03-26T12-49-22Z__56bcf5979e2be6063e39493cd219f2223325fe26.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 5,
                  "endLine": 188,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-03-26T12-49-22Z__56bcf5979e2be6063e39493cd219f2223325fe26.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 188,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@9bb56186c3b09b4f86b1c65136769dd318469633"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@9bb56186c3b09b4f86b1c65136769dd318469633"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  },
                  {
                    "distro": "arch",
                    "tools": "debian"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@9bb56186c3b09b4f86b1c65136769dd318469633"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-04-24T15-59-09Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6003468a-dad9-5cc7-9066-771d8688addc",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-04-24T15-59-09Z__0348233ac07766e2372be27d451ab17b4b8c07ca.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 89,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-df22af7d-9428-50b4-be97-a99eff5ffec3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-04-24T15-59-09Z__0348233ac07766e2372be27d451ab17b4b8c07ca.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 90,
                  "startColumn": 5,
                  "endLine": 190,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-04-24T15-59-09Z__0348233ac07766e2372be27d451ab17b4b8c07ca.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 190,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@9bb56186c3b09b4f86b1c65136769dd318469633"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@9bb56186c3b09b4f86b1c65136769dd318469633"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  },
                  {
                    "distro": "arch",
                    "tools": "debian"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@9bb56186c3b09b4f86b1c65136769dd318469633"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-05-02T08-40-19Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-dc40452c-9922-5293-943f-437c49a425d2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-05-02T08-40-19Z__c8596d39ae67e4ad4ddfc3ee6b396f64a61cd867.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 89,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-34dd3cf1-6469-5d3a-9e41-427a00acbc2d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-05-02T08-40-19Z__c8596d39ae67e4ad4ddfc3ee6b396f64a61cd867.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 90,
                  "startColumn": 5,
                  "endLine": 190,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-05-02T08-40-19Z__c8596d39ae67e4ad4ddfc3ee6b396f64a61cd867.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 190,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@0ad4b8fadaa221de15dcec353f45205ec38ea70b"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@0ad4b8fadaa221de15dcec353f45205ec38ea70b"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  },
                  {
                    "distro": "arch",
                    "tools": "debian"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@0ad4b8fadaa221de15dcec353f45205ec38ea70b"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-05-03T11-07-51Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ffa317d6-9967-5758-b3c9-7411771d3ccf",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-05-03T11-07-51Z__592d039c35a3d78605b0186a6bf5d302d97079eb.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 89,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-61396948-8d42-5dcf-9fa6-181a40c22393",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-05-03T11-07-51Z__592d039c35a3d78605b0186a6bf5d302d97079eb.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 90,
                  "startColumn": 5,
                  "endLine": 187,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-05-03T11-07-51Z__592d039c35a3d78605b0186a6bf5d302d97079eb.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 187,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@0ad4b8fadaa221de15dcec353f45205ec38ea70b"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@0ad4b8fadaa221de15dcec353f45205ec38ea70b"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@0ad4b8fadaa221de15dcec353f45205ec38ea70b"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# Work around for https://src.fedoraproject.org/rpms/grub2/pull-request/61 by disabling obsoletes.\ntee mkosi/resources/mkosi-tools/mkosi.local.conf <<EOF\n[Distribution]\nPackageManagerTrees=mkosi.pkgmngr\nEOF\n\nmkdir -p mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf\necho -e \"[main]\\nobsoletes=0\" > mkosi/resources/mkosi-tools/mkosi.pkgmngr/etc/dnf/dnf.conf\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-05-07T21-09-41Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-24866561-2c5b-500d-852c-3b7de660a53d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-05-07T21-09-41Z__50d6e95f5cbaf659988d25cbfdbea73a0ef44ff9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 89,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d907b60d-c601-5cf1-bf39-df511d302ac4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-05-07T21-09-41Z__50d6e95f5cbaf659988d25cbfdbea73a0ef44ff9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 90,
                  "startColumn": 5,
                  "endLine": 178,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-05-07T21-09-41Z__50d6e95f5cbaf659988d25cbfdbea73a0ef44ff9.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 178,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@0ad4b8fadaa221de15dcec353f45205ec38ea70b"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@0ad4b8fadaa221de15dcec353f45205ec38ea70b"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "centos",
                    "tools": "arch"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@0ad4b8fadaa221de15dcec353f45205ec38ea70b"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-06-02T09-39-27Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c7067f7e-2368-5ab1-a23a-3f16eb2f4586",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-06-02T09-39-27Z__b459fa65e42664c62b80911423d1fc431d796e23.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 89,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cb101165-a22c-5039-b925-907ba25401da",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-06-02T09-39-27Z__b459fa65e42664c62b80911423d1fc431d796e23.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 90,
                  "startColumn": 5,
                  "endLine": 174,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-06-02T09-39-27Z__b459fa65e42664c62b80911423d1fc431d796e23.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 174,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@a5ac7e51b41094c92402da3b24376905380afc29"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@a5ac7e51b41094c92402da3b24376905380afc29"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@a5ac7e51b41094c92402da3b24376905380afc29"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-05-10T12-11-35Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-32e22aed-9543-53a2-8f3b-514382ed0e1d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-05-10T12-11-35Z__96de734103fa22c11cddf1ca56e712821434586b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 89,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "ffd25418f89ea915:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ca1facf7-928f-5d37-803b-baf1b058c328",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-05-10T12-11-35Z__96de734103fa22c11cddf1ca56e712821434586b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 90,
                  "startColumn": 5,
                  "endLine": 174,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1c5f0d0c78e2c7c3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-05-10T12-11-35Z__96de734103fa22c11cddf1ca56e712821434586b.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 174,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@0ad4b8fadaa221de15dcec353f45205ec38ea70b"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-22.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@0ad4b8fadaa221de15dcec353f45205ec38ea70b"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --upgrade setuptools wheel pip\npython3 -m pip install mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-22.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@0ad4b8fadaa221de15dcec353f45205ec38ea70b"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-06-03T13-08-57Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e668623a-6edc-5b5f-b8c4-8608273082dd",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-06-03T13-08-57Z__857838464970f1092cc0107f4b1df714d0744990.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 89,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8d09cce4-0346-5510-8c23-f436c384d6f3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-06-03T13-08-57Z__857838464970f1092cc0107f4b1df714d0744990.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 90,
                  "startColumn": 5,
                  "endLine": 174,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-06-03T13-08-57Z__857838464970f1092cc0107f4b1df714d0744990.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 174,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@a5ac7e51b41094c92402da3b24376905380afc29"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@a5ac7e51b41094c92402da3b24376905380afc29"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@a5ac7e51b41094c92402da3b24376905380afc29"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-07-02T09-01-05Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-09b2a064-ba9a-5067-b8e3-72c3460533b8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-07-02T09-01-05Z__f7f01c503afc876bbf3d95136b06a79be7b31d96.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 89,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-602bdec1-8e6e-5060-a2b3-2bcb977e89ff",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-07-02T09-01-05Z__f7f01c503afc876bbf3d95136b06a79be7b31d96.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 90,
                  "startColumn": 5,
                  "endLine": 174,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-07-02T09-01-05Z__f7f01c503afc876bbf3d95136b06a79be7b31d96.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 174,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Test shell scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-08-01T11-23-25Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7a56deda-8617-531a-9be2-c63567eee832",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-08-01T11-23-25Z__cfdcfca4a526f855d718fcf6cb1efcf863c88baf.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b1ca6ac7-405e-57bd-a26e-1d662981059a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-08-01T11-23-25Z__cfdcfca4a526f855d718fcf6cb1efcf863c88baf.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 193,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-08-01T11-23-25Z__cfdcfca4a526f855d718fcf6cb1efcf863c88baf.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 193,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-07-22T09-16-45Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c60fbdd4-cfc9-5c7e-87a6-06948f239947",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-07-22T09-16-45Z__eff7ff7dfc35c4d3fe6620d08409aac1540c5297.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f0a2bfaa-cd8a-5419-88a1-740c1a8ea20a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-07-22T09-16-45Z__eff7ff7dfc35c4d3fe6620d08409aac1540c5297.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 175,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-07-22T09-16-45Z__eff7ff7dfc35c4d3fe6620d08409aac1540c5297.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 175,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-08-02T07-32-04Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d9754186-3f10-586a-9f99-3058fbbf81e0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-08-02T07-32-04Z__35889a9f63785db1c4e210f8e11a344bb9d363aa.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9f4c469f-2fba-588c-8c12-cfbbb12ce820",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-08-02T07-32-04Z__35889a9f63785db1c4e210f8e11a344bb9d363aa.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 183,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-08-02T07-32-04Z__35889a9f63785db1c4e210f8e11a344bb9d363aa.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 183,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Drop once distribution-gpg-keys is in noble-backports.\nif [[ \"${{ matrix.tools }}\" =~ opensuse|fedora|ubuntu ]]; then\n    tee --append mkosi.local.conf <<EOF\n[Distribution]\nRepositoryKeyFetch=yes\nEOF\nfi\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-08-02T08-03-42Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-35a9dece-6262-5311-ac4a-9e2e6d0292ca",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-08-02T08-03-42Z__a376bc6ec18b9fcb04bbd7b4b6700b8167a8fe2c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-72ecd5ed-b241-5624-ad4f-42707682e993",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-08-02T08-03-42Z__a376bc6ec18b9fcb04bbd7b4b6700b8167a8fe2c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 201,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-08-02T08-03-42Z__a376bc6ec18b9fcb04bbd7b4b6700b8167a8fe2c.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 201,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Drop once distribution-gpg-keys is in noble-backports.\nif [[ \"${{ matrix.tools }}\" =~ opensuse|fedora|ubuntu ]]; then\n    tee --append mkosi.local.conf <<EOF\n[Distribution]\nRepositoryKeyFetch=yes\nEOF\nfi\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-08-02T18-41-52Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-907a0f1a-3318-5ed3-901c-f71c080fd3aa",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-08-02T18-41-52Z__8139abc7263a684df7a9a5ebdd0c8ae95a9fbdef.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-43ad485b-feed-559a-a908-8f3d10480ce7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-08-02T18-41-52Z__8139abc7263a684df7a9a5ebdd0c8ae95a9fbdef.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 193,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-08-02T18-41-52Z__8139abc7263a684df7a9a5ebdd0c8ae95a9fbdef.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 193,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-08-19T08-20-24Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-619b34f9-cff2-5205-a3cd-e1a284e536ea",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-08-19T08-20-24Z__d48fa5846121805e389075579a9a4d2bec3a5990.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d3b3c9d9-f240-5a54-baa3-e2a3cb1c9c33",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-08-19T08-20-24Z__d48fa5846121805e389075579a9a4d2bec3a5990.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 193,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-08-19T08-20-24Z__d48fa5846121805e389075579a9a4d2bec3a5990.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 193,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-08-19T08-20-26Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d048569e-f9d5-5e47-a8f1-a7a4b6316fc9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-08-19T08-20-26Z__0797d0ff981b1ba3279ce2f10f00f51c15069a95.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cd7bffa1-0273-5757-b6e6-02341bed7efd",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-08-19T08-20-26Z__0797d0ff981b1ba3279ce2f10f00f51c15069a95.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 195,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-08-19T08-20-26Z__0797d0ff981b1ba3279ce2f10f00f51c15069a95.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 195,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-08-22T09-47-03Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d705087d-da1a-5f06-8037-56d881937de4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-08-22T09-47-03Z__0b57b822b01725980371436f42f1551fa7915dd7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b749326c-7fae-5e34-a913-8719772a8ed4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-08-22T09-47-03Z__0b57b822b01725980371436f42f1551fa7915dd7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 196,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-08-22T09-47-03Z__0b57b822b01725980371436f42f1551fa7915dd7.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 196,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-08-22T13-15-10Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-54ac295f-b651-589d-85f9-b5f558fa403d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-08-22T13-15-10Z__25148d9a15fd498fd6ddc17234a048e5dff264df.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7921aec6-a131-5679-9a45-c4b425af0d1e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-08-22T13-15-10Z__25148d9a15fd498fd6ddc17234a048e5dff264df.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 200,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-08-22T13-15-10Z__25148d9a15fd498fd6ddc17234a048e5dff264df.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 200,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "pandoc -s mkosi.md -o mkosi.1"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-09-05T09-20-06Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-61dcc91f-ee58-56b8-a4a6-dadb6ca3fc03",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-09-05T09-20-06Z__6e21cceb03b211625e72b60c727c7712d1122ba2.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 90,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-217099ec-81eb-5360-beed-6f49784ed114",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-09-05T09-20-06Z__6e21cceb03b211625e72b60c727c7712d1122ba2.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 91,
                  "startColumn": 5,
                  "endLine": 200,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-09-05T09-20-06Z__6e21cceb03b211625e72b60c727c7712d1122ba2.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 200,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 14,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 14,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
            ],
            "num_run_commands": 17,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-09-18T11-36-01Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d7f0b11c-3f9c-53c4-a1ab-a41c075638a2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-09-18T11-36-01Z__1b9f94f37d1aa1d517d8e9581838f72e733077f0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 95,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-07175fac-ab4e-5978-8386-d7fd3ce64869",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-09-18T11-36-01Z__1b9f94f37d1aa1d517d8e9581838f72e733077f0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 96,
                  "startColumn": 5,
                  "endLine": 205,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-09-18T11-36-01Z__1b9f94f37d1aa1d517d8e9581838f72e733077f0.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 205,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 15,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 15,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
            ],
            "num_run_commands": 18,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-09-18T12-17-29Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8838b648-8046-5d89-8645-5f8ebac4b99b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-09-18T12-17-29Z__46cc99716c5c0429aaec6143993b194a287afddd.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 100,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-891fa776-89be-5a22-a2e6-8f1095d67414",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-09-18T12-17-29Z__46cc99716c5c0429aaec6143993b194a287afddd.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 101,
                  "startColumn": 5,
                  "endLine": 210,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-09-18T12-17-29Z__46cc99716c5c0429aaec6143993b194a287afddd.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 210,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 16,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 16,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
            ],
            "num_run_commands": 19,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-09-21T05-13-22Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fbdeff2d-08a2-5f91-a443-c1b561587a99",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-09-21T05-13-22Z__407ddb39cce768443d85149889a19e25ade592ce.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 105,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-17f3cc6b-bd9a-53e5-b2ab-8f6f0728da70",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-09-21T05-13-22Z__407ddb39cce768443d85149889a19e25ade592ce.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 106,
                  "startColumn": 5,
                  "endLine": 215,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-09-21T05-13-22Z__407ddb39cce768443d85149889a19e25ade592ce.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 215,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
            ],
            "num_run_commands": 20,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nruff format --check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-10-02T06-35-14Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e51edba0-0172-5641-85c9-5bb9d09f407a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-10-02T06-35-14Z__f4d75861490513b2ee5b8d021033e040dbdd45b0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 105,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-67be78b5-0a65-53bc-bfe2-66e2476020f5",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-10-02T06-35-14Z__f4d75861490513b2ee5b8d021033e040dbdd45b0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 106,
                  "startColumn": 5,
                  "endLine": 215,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-10-02T06-35-14Z__f4d75861490513b2ee5b8d021033e040dbdd45b0.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 215,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@d632683dd7b4114ad314bca15554477dd762a938"
            ],
            "num_run_commands": 20,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@d632683dd7b4114ad314bca15554477dd762a938"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nruff format --check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@d632683dd7b4114ad314bca15554477dd762a938"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    --tools-tree-distribution ${{ matrix.tools }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-10-02T16-29-37Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bcdd8aa8-5ef3-514f-b43c-27d4acb2b28b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-10-02T16-29-37Z__8c37154a2bea52879cc9fce9fbdec5881ffeedfe.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 105,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a2fdf4d4-84e4-51a4-a8c1-c6054eb3ac6d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-10-02T16-29-37Z__8c37154a2bea52879cc9fce9fbdec5881ffeedfe.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 106,
                  "startColumn": 5,
                  "endLine": 224,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-10-02T16-29-37Z__8c37154a2bea52879cc9fce9fbdec5881ffeedfe.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 224,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
            ],
            "num_run_commands": 21,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nruff format --check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Build tools tree",
                "run": "# TODO: Remove grub2 hack when https://bugzilla.opensuse.org/show_bug.cgi?id=1227464 is resolved.\nsudo --preserve-env \\\n    mkosi \\\n    --directory \"\" \\\n    --distribution ${{ matrix.tools }} \\\n    --include mkosi-tools \\\n    $( [[ ${{ matrix.tools }} == opensuse ]] && echo --package=grub2)\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-10-02T16-42-19Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4344b305-0f8b-559d-92f3-d7c67692daf7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-10-02T16-42-19Z__5e0b648869c850d8bfc8bdda2aa6f3d4c1d9b6e8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 105,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f26f7e0d-1b1a-5a70-84cf-3823a0140d16",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-10-02T16-42-19Z__5e0b648869c850d8bfc8bdda2aa6f3d4c1d9b6e8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 106,
                  "startColumn": 5,
                  "endLine": 224,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-10-02T16-42-19Z__5e0b648869c850d8bfc8bdda2aa6f3d4c1d9b6e8.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 224,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@d632683dd7b4114ad314bca15554477dd762a938"
            ],
            "num_run_commands": 21,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@d632683dd7b4114ad314bca15554477dd762a938"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nruff format --check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@d632683dd7b4114ad314bca15554477dd762a938"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Build tools tree",
                "run": "# TODO: Remove grub2 hack when https://bugzilla.opensuse.org/show_bug.cgi?id=1227464 is resolved.\nsudo --preserve-env \\\n    mkosi \\\n    --directory \"\" \\\n    --distribution ${{ matrix.tools }} \\\n    --include mkosi-tools \\\n    $( [[ ${{ matrix.tools }} == opensuse ]] && echo --package=grub2)\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-10-04T13-13-25Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0d1fdd31-bf5d-5afc-bfb3-5b491f6c3052",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-10-04T13-13-25Z__be0730fcca708719ec136cbf6e7075ae62a641b3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 105,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d9523479-ef3c-5dc3-afda-9821ac2388b1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-10-04T13-13-25Z__be0730fcca708719ec136cbf6e7075ae62a641b3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 106,
                  "startColumn": 5,
                  "endLine": 224,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-10-04T13-13-25Z__be0730fcca708719ec136cbf6e7075ae62a641b3.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 224,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@d632683dd7b4114ad314bca15554477dd762a938"
            ],
            "num_run_commands": 21,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@d632683dd7b4114ad314bca15554477dd762a938"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nruff format --check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@d632683dd7b4114ad314bca15554477dd762a938"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Build tools tree",
                "run": "# TODO: Remove grub2 hack when https://bugzilla.opensuse.org/show_bug.cgi?id=1227464 is resolved.\nsudo --preserve-env \\\n    mkosi \\\n    --directory \"\" \\\n    --distribution ${{ matrix.tools }} \\\n    --include mkosi-tools \\\n    $( [[ ${{ matrix.tools }} == opensuse ]] && echo --package=grub2)\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-10-16T14-41-45Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b8b44633-1b56-58b6-a3aa-3a396b46c91b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-10-16T14-41-45Z__485da586a89f400ca115168041972417fec4f5b3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 105,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-14e85647-9cae-5af4-86bb-e3895e3ab3d6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-10-16T14-41-45Z__485da586a89f400ca115168041972417fec4f5b3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 106,
                  "startColumn": 5,
                  "endLine": 226,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-10-16T14-41-45Z__485da586a89f400ca115168041972417fec4f5b3.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 226,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@d632683dd7b4114ad314bca15554477dd762a938"
            ],
            "num_run_commands": 21,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@d632683dd7b4114ad314bca15554477dd762a938"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nruff format --check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@d632683dd7b4114ad314bca15554477dd762a938"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Build tools tree",
                "run": "# TODO: Remove grub2 hack when https://bugzilla.opensuse.org/show_bug.cgi?id=1227464 is resolved.\nsudo --preserve-env \\\n    mkosi \\\n    --directory \"\" \\\n    --distribution ${{ matrix.tools }} \\\n    --include mkosi-tools \\\n    $( [[ ${{ matrix.tools }} == opensuse ]] && echo --package=grub2)\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-10-28T13-29-58Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1cd34315-ae11-5a48-a998-709ee277b27c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-10-28T13-29-58Z__f509490ae0e6aadb93fa996a7e036fc2a40c9ed6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 105,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3a264f80-fd1c-56ff-b30d-5d2839dee1cf",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-10-28T13-29-58Z__f509490ae0e6aadb93fa996a7e036fc2a40c9ed6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 106,
                  "startColumn": 5,
                  "endLine": 226,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-10-28T13-29-58Z__f509490ae0e6aadb93fa996a7e036fc2a40c9ed6.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 226,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@d632683dd7b4114ad314bca15554477dd762a938"
            ],
            "num_run_commands": 21,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@d632683dd7b4114ad314bca15554477dd762a938"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nruff format --check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@d632683dd7b4114ad314bca15554477dd762a938"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs sqop\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Build tools tree",
                "run": "# TODO: Remove grub2 hack when https://bugzilla.opensuse.org/show_bug.cgi?id=1227464 is resolved.\nsudo --preserve-env \\\n    mkosi \\\n    --directory \"\" \\\n    --distribution ${{ matrix.tools }} \\\n    --include mkosi-tools \\\n    $( [[ ${{ matrix.tools }} == opensuse ]] && echo --package=grub2)\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-11-20T11-53-02Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-15c032cc-0181-545e-a752-4608f2d5d80e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-11-20T11-53-02Z__ff75b8bd6170991798940d8758811305e3ac91d2.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 109,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-270c2453-5fd5-5936-815e-705e98637e38",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-11-20T11-53-02Z__ff75b8bd6170991798940d8758811305e3ac91d2.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 110,
                  "startColumn": 5,
                  "endLine": 230,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-11-20T11-53-02Z__ff75b8bd6170991798940d8758811305e3ac91d2.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 230,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 21,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/50-mkosi.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/50-mkosi.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs sqop\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Build tools tree",
                "run": "# TODO: Remove grub2 hack when https://bugzilla.opensuse.org/show_bug.cgi?id=1227464 is resolved.\nsudo --preserve-env \\\n    mkosi \\\n    --directory \"\" \\\n    --distribution ${{ matrix.tools }} \\\n    --include mkosi-tools \\\n    $( [[ ${{ matrix.tools }} == opensuse ]] && echo --package=grub2)\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-11-01T23-18-00Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-08a4c1e3-cef5-5303-9b01-f2553e3f385a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-11-01T23-18-00Z__f1f129cef7cebf95af7ceea7c0f6a5e44bbdc0fc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 105,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-00896602-0a64-564b-b42c-55477b9103f0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-11-01T23-18-00Z__f1f129cef7cebf95af7ceea7c0f6a5e44bbdc0fc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 106,
                  "startColumn": 5,
                  "endLine": 226,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-11-01T23-18-00Z__f1f129cef7cebf95af7ceea7c0f6a5e44bbdc0fc.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 226,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 21,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nruff format --check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs sqop\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Build tools tree",
                "run": "# TODO: Remove grub2 hack when https://bugzilla.opensuse.org/show_bug.cgi?id=1227464 is resolved.\nsudo --preserve-env \\\n    mkosi \\\n    --directory \"\" \\\n    --distribution ${{ matrix.tools }} \\\n    --include mkosi-tools \\\n    $( [[ ${{ matrix.tools }} == opensuse ]] && echo --package=grub2)\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-12-13T09-51-48Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-394cc6ae-8165-5a4f-913f-ca3541ffd7b2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-12-13T09-51-48Z__16b1599dd81e259dda1aa40e52312042fc48dc6d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 109,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-aa31eb5f-d3b8-541d-8acd-4c598124d7b5",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-12-13T09-51-48Z__16b1599dd81e259dda1aa40e52312042fc48dc6d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 110,
                  "startColumn": 5,
                  "endLine": 229,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-12-13T09-51-48Z__16b1599dd81e259dda1aa40e52312042fc48dc6d.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 229,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 21,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/50-mkosi.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/50-mkosi.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs sqop\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Build tools tree",
                "run": "# TODO: Remove grub2 hack when https://bugzilla.opensuse.org/show_bug.cgi?id=1227464 is resolved.\nmkosi \\\n  --directory \"\" \\\n  --distribution ${{ matrix.tools }} \\\n  --include mkosi-tools \\\n  $( [[ ${{ matrix.tools }} == opensuse ]] && echo --package=grub2)\n"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-12-13T10-26-26Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e6618be9-463b-5814-9a7e-abf3f8c56ca9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-12-13T10-26-26Z__ad530e0497e931dd0a9ad464a2ca8e2e473e9971.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 109,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3ba79dd5-81e2-53e8-8ad0-b10375af1f8b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-12-13T10-26-26Z__ad530e0497e931dd0a9ad464a2ca8e2e473e9971.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 110,
                  "startColumn": 5,
                  "endLine": 232,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-12-13T10-26-26Z__ad530e0497e931dd0a9ad464a2ca8e2e473e9971.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 232,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 8
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 8
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 22,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/50-mkosi.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/50-mkosi.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs sqop\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Host]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Build tools tree",
                "run": "# TODO: Remove grub2 hack when https://bugzilla.opensuse.org/show_bug.cgi?id=1227464 is resolved.\nmkosi \\\n  --directory \"\" \\\n  --distribution ${{ matrix.tools }} \\\n  --include mkosi-tools \\\n  $( [[ ${{ matrix.tools }} == opensuse ]] && echo --package=grub2)\n"
              },
              {
                "name": "Build image",
                "run": "mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-12-19T10-09-36Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cf384ef6-62af-592a-bc47-80f21ed75a4a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-12-19T10-09-36Z__2fe2ae396ef4a8a5ffdb9c2dbfab544d4e9c852c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 109,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-672134ed-6e69-5404-acd4-a2f5e9fc5c47",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-12-19T10-09-36Z__2fe2ae396ef4a8a5ffdb9c2dbfab544d4e9c852c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 110,
                  "startColumn": 5,
                  "endLine": 232,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-12-19T10-09-36Z__2fe2ae396ef4a8a5ffdb9c2dbfab544d4e9c852c.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 232,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 8
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 8
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 22,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/50-mkosi.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/50-mkosi.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs sqop\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nQemuKvm=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Build tools tree",
                "run": "# TODO: Remove grub2 hack when https://bugzilla.opensuse.org/show_bug.cgi?id=1227464 is resolved.\nmkosi \\\n  --directory \"\" \\\n  --distribution ${{ matrix.tools }} \\\n  --include mkosi-tools \\\n  $( [[ ${{ matrix.tools }} == opensuse ]] && echo --package=grub2)\n"
              },
              {
                "name": "Build image",
                "run": "mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2024-12-30T19-53-56Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-37a229e1-4ef0-5ead-a4b8-ff38c2af888c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-12-30T19-53-56Z__ebcd2efa03af5c04de91434634f2e4a956f7e53c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 109,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-03f6f759-f493-56bd-a5fb-f0684842bf64",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2024-12-30T19-53-56Z__ebcd2efa03af5c04de91434634f2e4a956f7e53c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 110,
                  "startColumn": 5,
                  "endLine": 232,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2024-12-30T19-53-56Z__ebcd2efa03af5c04de91434634f2e4a956f7e53c.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 232,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 8
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 8
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 22,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/50-mkosi.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/50-mkosi.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu",
                  "azure"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs sqop\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Build tools tree",
                "run": "# TODO: Remove grub2 hack when https://bugzilla.opensuse.org/show_bug.cgi?id=1227464 is resolved.\nmkosi \\\n  --directory \"\" \\\n  --distribution ${{ matrix.tools }} \\\n  --include mkosi-tools \\\n  $( [[ ${{ matrix.tools }} == opensuse ]] && echo --package=grub2)\n"
              },
              {
                "name": "Build image",
                "run": "mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2025-01-13T14-46-34Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8521a267-53a1-5187-a6e3-7fc7bf136e19",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-01-13T14-46-34Z__0bf3b4ae87dc71aa91c9f13b1a1f539a63c3b62d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 106,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9c008e4d-0b9c-5da5-a1b5-674daa3677be",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-01-13T14-46-34Z__0bf3b4ae87dc71aa91c9f13b1a1f539a63c3b62d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 107,
                  "startColumn": 5,
                  "endLine": 228,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-01-13T14-46-34Z__0bf3b4ae87dc71aa91c9f13b1a1f539a63c3b62d.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 228,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 8
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 8
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 22,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/50-mkosi.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/50-mkosi.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs sqop\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Build tools tree",
                "run": "# TODO: Remove grub2 hack when https://bugzilla.opensuse.org/show_bug.cgi?id=1227464 is resolved.\nmkosi \\\n  --directory \"\" \\\n  --distribution ${{ matrix.tools }} \\\n  --include mkosi-tools \\\n  $( [[ ${{ matrix.tools }} == opensuse ]] && echo --package=grub2)\n"
              },
              {
                "name": "Build image",
                "run": "mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2025-01-13T11-44-55Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1aa0b173-8950-53c0-b8b8-bdbd80b84ad2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-01-13T11-44-55Z__488fc2dee8980120ec4712e130cc72a7c026dfa9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 109,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4fad45f0-e91e-5aef-aa1f-82f4f9118884",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-01-13T11-44-55Z__488fc2dee8980120ec4712e130cc72a7c026dfa9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 110,
                  "startColumn": 5,
                  "endLine": 231,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-01-13T11-44-55Z__488fc2dee8980120ec4712e130cc72a7c026dfa9.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 231,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 8
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 8
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 22,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "push": {
            "branches": [
              "main"
            ]
          },
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/50-mkosi.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/50-mkosi.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/50-mkosi.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs sqop\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Build tools tree",
                "run": "# TODO: Remove grub2 hack when https://bugzilla.opensuse.org/show_bug.cgi?id=1227464 is resolved.\nmkosi \\\n  --directory \"\" \\\n  --distribution ${{ matrix.tools }} \\\n  --include mkosi-tools \\\n  $( [[ ${{ matrix.tools }} == opensuse ]] && echo --package=grub2)\n"
              },
              {
                "name": "Build image",
                "run": "mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2025-01-19T21-50-03Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-42ce83eb-0d1a-5fae-88d3-8aa4f744be1d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-01-19T21-50-03Z__440bac0cf179fd54da5b9a71ca114db28281bb22.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 106,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a415ca2a-e31d-5fc0-96a4-d5b66e6e89eb",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-01-19T21-50-03Z__440bac0cf179fd54da5b9a71ca114db28281bb22.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 107,
                  "startColumn": 5,
                  "endLine": 228,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-01-19T21-50-03Z__440bac0cf179fd54da5b9a71ca114db28281bb22.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 228,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 8
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 8
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 22,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "arch",
                    "tools": "ubuntu"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs sqop\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Build tools tree",
                "run": "# TODO: Remove grub2 hack when https://bugzilla.opensuse.org/show_bug.cgi?id=1227464 is resolved.\nmkosi \\\n  --directory \"\" \\\n  --distribution ${{ matrix.tools }} \\\n  --include mkosi-tools \\\n  $( [[ ${{ matrix.tools }} == opensuse ]] && echo --package=grub2)\n"
              },
              {
                "name": "Build image",
                "run": "mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2025-01-22T13-11-18Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4d203c89-5efc-55b0-9871-82368b3d72fd",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-01-22T13-11-18Z__28c29f69525053192323d8849d219796985c983f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-62857c64-5212-5816-993f-ad53889ca73d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-01-22T13-11-18Z__28c29f69525053192323d8849d219796985c983f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 222,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-41203b1e-5b70-571d-95e7-ce497edcba6f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-01-22T13-11-18Z__07b9a006525558a612fb78dcef2e89cbbdb0ef96.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4b7d49eb-36ef-5177-9f81-cddee510280b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-01-22T13-11-18Z__07b9a006525558a612fb78dcef2e89cbbdb0ef96.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 226,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-88510e31-ede9-518a-9a5e-53cf4794cf25",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-01-22T13-11-18Z__32411e6e75383bc580787c39c0648ed4e694b8ae.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 106,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-80a9871e-6161-5189-a038-27039aba0163",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-01-22T13-11-18Z__32411e6e75383bc580787c39c0648ed4e694b8ae.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 107,
                  "startColumn": 5,
                  "endLine": 224,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8bbb3e03-d6ea-5f8e-9272-88e2a0619eb9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-01-22T13-11-18Z__c6862f0592c282b8d1acd84d73b18f606dd7a455.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 106,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5617af1b-b96f-59b5-9b9a-e92c67c77bca",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-01-22T13-11-18Z__c6862f0592c282b8d1acd84d73b18f606dd7a455.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 107,
                  "startColumn": 5,
                  "endLine": 232,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7c2c2af1-35ce-59f1-924c-f7a14420197f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-01-22T13-11-18Z__b94c15509c7956ed9e50dd09ae7abde0f06898c7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 106,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c4b94688-69ef-59c2-bb03-f3c49eb0e703",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-01-22T13-11-18Z__b94c15509c7956ed9e50dd09ae7abde0f06898c7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 107,
                  "startColumn": 5,
                  "endLine": 230,
                  "endColumn": 22
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-01-22T13-11-18Z__c6862f0592c282b8d1acd84d73b18f606dd7a455.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 232,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 8
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 8
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 22,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "# This is added by default, and it is often broken, but we don't need anything from it\nsudo rm -f /etc/apt/sources.list.d/microsoft-prod.list\nsudo apt-get update\nsudo apt-get install pandoc python3-pytest\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "sudo apt-get update && sudo apt-get install --no-install-recommends shellcheck\nbash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo apt-get update\nsudo apt-get install python3-pytest lvm2 cryptsetup-bin btrfs-progs sqop\n# Make sure the latest changes from the pull request are used.\nsudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi\n",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Build tools tree",
                "run": "# TODO: Remove grub2 hack when https://bugzilla.opensuse.org/show_bug.cgi?id=1227464 is resolved.\nmkosi \\\n  --directory \"\" \\\n  --distribution ${{ matrix.tools }} \\\n  --include mkosi-tools \\\n  $( [[ ${{ matrix.tools }} == opensuse ]] && echo --package=grub2)\n"
              },
              {
                "name": "Build image",
                "run": "mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "sudo --preserve-env \\\n    timeout -k 30 1h python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\n"
              }
            ]
          }
        }
      }
    },
    "2025-02-12T15-25-41Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b418eac1-cdb4-5e89-bceb-ce11d9af3e10",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-02-12T15-25-41Z__d501139032aa659fa8d34bdb850f4eb6b5f458ed.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8744fa94-0d1e-5b2a-ab1c-3dedfe8742c2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-02-12T15-25-41Z__d501139032aa659fa8d34bdb850f4eb6b5f458ed.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 222,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-02-12T15-25-41Z__d501139032aa659fa8d34bdb850f4eb6b5f458ed.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 222,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 8
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 8
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 22,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTree=default\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f sandbox -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "sudo mkosi sandbox -- \\\n  timeout -k 30 1h \\\n  python3 -m pytest \\\n  --tb=no \\\n  --capture=no \\\n  --verbose \\\n  -m integration \\\n  --distribution ${{ matrix.distro }} \\\n  tests/\n"
              }
            ]
          }
        }
      }
    },
    "2025-03-31T12-49-39Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5ac9dd4e-d4da-5138-9b9e-d5d19a1af5b1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-03-31T12-49-39Z__58980cd318cef4f47509013c8518b3606ecb8bf6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-101bbdbf-0583-56f8-9c83-37a855e01687",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-03-31T12-49-39Z__58980cd318cef4f47509013c8518b3606ecb8bf6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 225,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-03-31T12-49-39Z__58980cd318cef4f47509013c8518b3606ecb8bf6.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 225,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 23,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTree=default\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f sandbox -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "sudo mkosi sandbox -- \\\n  timeout -k 30 1h \\\n  python3 -m pytest \\\n  --tb=no \\\n  --capture=no \\\n  --verbose \\\n  -m integration \\\n  --distribution ${{ matrix.distro }} \\\n  tests/\n"
              }
            ]
          }
        }
      }
    },
    "2025-04-10T15-22-07Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-18c0f991-1968-5069-8d99-f6536094355f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-04-10T15-22-07Z__5410c4c7af649728c16231f2d0492b0e1e1f3aae.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-75f83d8d-ba10-5c45-989a-8fb8003abbaf",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-04-10T15-22-07Z__5410c4c7af649728c16231f2d0492b0e1e1f3aae.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 228,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-04-10T15-22-07Z__5410c4c7af649728c16231f2d0492b0e1e1f3aae.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 228,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTree=default\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Generate key",
                "run": "sudo mkosi genkey"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f sandbox -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "sudo mkosi sandbox -- \\\n  timeout -k 30 1h \\\n  python3 -m pytest \\\n  --tb=no \\\n  --capture=no \\\n  --verbose \\\n  -m integration \\\n  --distribution ${{ matrix.distro }} \\\n  tests/\n"
              }
            ]
          }
        }
      }
    },
    "2025-06-04T13-05-51Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-81879128-22af-5397-887d-d30608e3f6c4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-06-04T13-05-51Z__f899e770ed4b5d370d47706c5f5bb9b26cf035ca.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-96e2d59d-10a5-56f1-a30e-a683fa14f162",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-06-04T13-05-51Z__f899e770ed4b5d370d47706c5f5bb9b26cf035ca.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 230,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-06-04T13-05-51Z__f899e770ed4b5d370d47706c5f5bb9b26cf035ca.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 230,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# TODO: Use $SYSTEMD_REPART_OVERRIDE_FSTYPE_ROOT once we drop support for Ubuntu Noble.\nsed -i 's/return \"btrfs\"/return \"ext4\"/' mkosi/distributions/*.py\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Generate key",
                "run": "sudo mkosi genkey"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f sandbox -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "sudo mkosi sandbox -- \\\n  timeout -k 30 1h \\\n  python3 -m pytest \\\n  --tb=no \\\n  --capture=no \\\n  --verbose \\\n  -m integration \\\n  --distribution ${{ matrix.distro }} \\\n  tests/\n"
              }
            ]
          }
        }
      }
    },
    "2025-04-17T10-51-01Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-124fdadf-ca83-5092-a8a1-9d15eeb2ab14",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-04-17T10-51-01Z__dbb4020beee2cdf250f93a425794f1cf8b0fe693.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cd3bf681-148a-5f29-a1eb-0e24dc265ff2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-04-17T10-51-01Z__dbb4020beee2cdf250f93a425794f1cf8b0fe693.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 227,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-04-17T10-51-01Z__dbb4020beee2cdf250f93a425794f1cf8b0fe693.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 227,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Generate key",
                "run": "sudo mkosi genkey"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f sandbox -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "sudo mkosi sandbox -- \\\n  timeout -k 30 1h \\\n  python3 -m pytest \\\n  --tb=no \\\n  --capture=no \\\n  --verbose \\\n  -m integration \\\n  --distribution ${{ matrix.distro }} \\\n  tests/\n"
              }
            ]
          }
        }
      }
    },
    "2025-07-04T20-45-21Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-feb049ed-a7d0-568b-a266-7eaa101084f1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-07-04T20-45-21Z__f1eab5a783bd3f5f0fb6a1d3dd60e9517cfae353.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-506b3ce0-0d7b-5163-a61b-eeccaedcf5e6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-07-04T20-45-21Z__f1eab5a783bd3f5f0fb6a1d3dd60e9517cfae353.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 230,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-07-04T20-45-21Z__f1eab5a783bd3f5f0fb6a1d3dd60e9517cfae353.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 230,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# TODO: Use $SYSTEMD_REPART_OVERRIDE_FSTYPE_ROOT once we drop support for Ubuntu Noble.\nsed -i 's/return \"btrfs\"/return \"ext4\"/' mkosi/distributions/*.py\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Generate key",
                "run": "sudo mkosi genkey"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f box -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "sudo mkosi box -- \\\n  timeout -k 30 1h \\\n  python3 -m pytest \\\n  --tb=no \\\n  --capture=no \\\n  --verbose \\\n  -m integration \\\n  --distribution ${{ matrix.distro }} \\\n  tests/\n"
              }
            ]
          }
        }
      }
    },
    "2025-07-12T09-25-36Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-37f0cae1-6935-55e4-a30f-0ac64b356978",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-07-12T09-25-36Z__1e52fb61eacbd2c0292088862d7c3fd2f4f36729.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-be6e11f8-563a-5fd1-920f-d6e91d641b7c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-07-12T09-25-36Z__1e52fb61eacbd2c0292088862d7c3fd2f4f36729.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 240,
                  "endColumn": 14
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5cea86f20ebfb111:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cd82db6a-2a47-5a3d-98d6-36c701afb840",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-07-12T09-25-36Z__6973d4a1435ecfa28cb748510b3a98f4f0cd65a0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d89d22a2-55af-58da-a559-65b35163ebe0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-07-12T09-25-36Z__6973d4a1435ecfa28cb748510b3a98f4f0cd65a0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 233,
                  "endColumn": 14
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5ea222319e60fefd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-07-12T09-25-36Z__6973d4a1435ecfa28cb748510b3a98f4f0cd65a0.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 233,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "ubuntu-24.04",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# TODO: Use $SYSTEMD_REPART_OVERRIDE_FSTYPE_ROOT once we drop support for Ubuntu Noble.\nsed -i 's/return \"btrfs\"/return \"ext4\"/' mkosi/distributions/*.py\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Generate key",
                "run": "sudo mkosi genkey"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f box -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "# Without KVM the tests are way too slow and time out\nif [[ -e /dev/kvm ]]; then\n  sudo mkosi box -- \\\n    timeout -k 30 1h \\\n    python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\nfi\n"
              }
            ]
          }
        }
      }
    },
    "2025-07-15T18-07-54Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4445e91a-7e58-50c3-97f3-a13a9e295386",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-07-15T18-07-54Z__801a707231c941a5752811361e976fbf31513937.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e45c5e41-707d-5408-abc0-c32e684dacf4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-07-15T18-07-54Z__801a707231c941a5752811361e976fbf31513937.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 249,
                  "endColumn": 14
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5cea86f20ebfb111:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-07-15T18-07-54Z__801a707231c941a5752811361e976fbf31513937.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 249,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 2,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "${{ matrix.runner }}",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ matrix.runner }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "runner": [
                  "ubuntu-24.04"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ],
                "include": [
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "opensuse",
                    "tools": "opensuse",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "ubuntu",
                    "runner": "ubuntu-24.04-arm"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# TODO: Use $SYSTEMD_REPART_OVERRIDE_FSTYPE_ROOT once we drop support for Ubuntu Noble.\nsed -i 's/return \"btrfs\"/return \"ext4\"/' mkosi/distributions/*.py\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Generate key",
                "run": "sudo mkosi genkey"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f box -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "# Without KVM the tests are way too slow and time out\nif [[ -e /dev/kvm ]]; then\n  sudo mkosi box -- \\\n    timeout -k 30 1h \\\n    python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\nfi\n"
              }
            ]
          }
        }
      }
    },
    "2025-07-15T18-11-31Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bb098896-bd81-5bca-9338-4fac2bcc7adf",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-07-15T18-11-31Z__732bd3cacc1313e16c17e638feab6daa950f655b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-251bac67-e66a-53b7-a51f-b25bdad15f96",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-07-15T18-11-31Z__732bd3cacc1313e16c17e638feab6daa950f655b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 255,
                  "endColumn": 14
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5cea86f20ebfb111:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-07-15T18-11-31Z__732bd3cacc1313e16c17e638feab6daa950f655b.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 255,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 2,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "${{ matrix.runner }}",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ matrix.runner }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "runner": [
                  "ubuntu-24.04"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ],
                "include": [
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "opensuse",
                    "tools": "opensuse",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "ubuntu",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-ppc64le"
                  },
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-ppc64le"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# TODO: Use $SYSTEMD_REPART_OVERRIDE_FSTYPE_ROOT once we drop support for Ubuntu Noble.\nsed -i 's/return \"btrfs\"/return \"ext4\"/' mkosi/distributions/*.py\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Generate key",
                "run": "sudo mkosi genkey"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f box -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "# Without KVM the tests are way too slow and time out\nif [[ -e /dev/kvm ]]; then\n  sudo mkosi box -- \\\n    timeout -k 30 1h \\\n    python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\nfi\n"
              }
            ]
          }
        }
      }
    },
    "2025-07-17T12-24-56Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7885a158-f9be-5c6d-82aa-422cfa4a5b84",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-07-17T12-24-56Z__6261b6c2b2c1dc67f1c2795c4dc64307ae235d62.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bccb4e3d-7df4-51fa-b4a7-f414c1201efd",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-07-17T12-24-56Z__6261b6c2b2c1dc67f1c2795c4dc64307ae235d62.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 255,
                  "endColumn": 14
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5cea86f20ebfb111:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-07-17T12-24-56Z__6261b6c2b2c1dc67f1c2795c4dc64307ae235d62.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 255,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 2,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "${{ matrix.runner }}",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ matrix.runner }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "runner": [
                  "ubuntu-24.04"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ],
                "include": [
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "opensuse",
                    "tools": "opensuse",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "ubuntu",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-ppc64le"
                  },
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-ppc64le"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# TODO: Use $SYSTEMD_REPART_OVERRIDE_FSTYPE_ROOT once we drop support for Ubuntu Noble.\nsed -i 's/return \"btrfs\"/return \"ext4\"/' mkosi/distributions/*.py\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Generate key",
                "run": "sudo mkosi genkey"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f box -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "# Without KVM the tests are way too slow and time out\nif [[ -e /dev/kvm ]]; then\n  sudo mkosi box -- \\\n    timeout -k 30 1h \\\n    python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\nfi\n"
              }
            ]
          }
        }
      }
    },
    "2025-08-06T19-50-07Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ccd1ac65-185c-52e0-8fd6-4b894243634d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-08-06T19-50-07Z__32c3ff4677851085db8d42b140bf9b1cbfe270b6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 106,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e977ce1d-21b4-5dbc-9193-2416a4278f2e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-08-06T19-50-07Z__32c3ff4677851085db8d42b140bf9b1cbfe270b6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 107,
                  "startColumn": 5,
                  "endLine": 259,
                  "endColumn": 14
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5cea86f20ebfb111:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-08-06T19-50-07Z__32c3ff4677851085db8d42b140bf9b1cbfe270b6.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 259,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 2,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check --output-format=github mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nif ! reuse lint\nthen\n    echo \"Hint: If the above output lists unlicensed files tracked in git you might need to adjust REUSE.toml\"\n    exit 1\nfi\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "${{ matrix.runner }}",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ matrix.runner }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "runner": [
                  "ubuntu-24.04"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ],
                "include": [
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "opensuse",
                    "tools": "opensuse",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "ubuntu",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-ppc64le"
                  },
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-ppc64le"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# TODO: Use $SYSTEMD_REPART_OVERRIDE_FSTYPE_ROOT once we drop support for Ubuntu Noble.\nsed -i 's/return \"btrfs\"/return \"ext4\"/' mkosi/distributions/*.py\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Generate key",
                "run": "sudo mkosi genkey"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f box -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "# Without KVM the tests are way too slow and time out\nif [[ -e /dev/kvm ]]; then\n  sudo mkosi box -- \\\n    timeout -k 30 1h \\\n    python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\nfi\n"
              }
            ]
          }
        }
      }
    },
    "2025-07-17T12-25-21Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f308814f-3943-5d23-9d70-be1ca8c64e78",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-07-17T12-25-21Z__39759fce04f1ba2e0f090df517820341c1863c3e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 102,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-77671c1f-c74f-5bad-b902-9310c761ef56",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-07-17T12-25-21Z__39759fce04f1ba2e0f090df517820341c1863c3e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 103,
                  "startColumn": 5,
                  "endLine": 255,
                  "endColumn": 14
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5cea86f20ebfb111:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-07-17T12-25-21Z__39759fce04f1ba2e0f090df517820341c1863c3e.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 255,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 2,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check --output-format=github mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nreuse lint\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "${{ matrix.runner }}",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ matrix.runner }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "runner": [
                  "ubuntu-24.04"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ],
                "include": [
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "opensuse",
                    "tools": "opensuse",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "ubuntu",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-ppc64le"
                  },
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-ppc64le"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# TODO: Use $SYSTEMD_REPART_OVERRIDE_FSTYPE_ROOT once we drop support for Ubuntu Noble.\nsed -i 's/return \"btrfs\"/return \"ext4\"/' mkosi/distributions/*.py\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Generate key",
                "run": "sudo mkosi genkey"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f box -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "# Without KVM the tests are way too slow and time out\nif [[ -e /dev/kvm ]]; then\n  sudo mkosi box -- \\\n    timeout -k 30 1h \\\n    python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\nfi\n"
              }
            ]
          }
        }
      }
    },
    "2025-09-04T07-41-54Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-97c49ff3-d072-5b81-8af4-2eb20538f235",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-09-04T07-41-54Z__928781544d062770f4c63b7746c452c90c603340.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 106,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0cbd412e-8f76-5150-921a-27a1d4837bb1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-09-04T07-41-54Z__928781544d062770f4c63b7746c452c90c603340.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 107,
                  "startColumn": 5,
                  "endLine": 262,
                  "endColumn": 14
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5cea86f20ebfb111:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-09-04T07-41-54Z__928781544d062770f4c63b7746c452c90c603340.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 262,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 2,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check --output-format=github mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nif ! reuse lint\nthen\n    echo \"Hint: If the above output lists unlicensed files tracked in git you might need to adjust REUSE.toml\"\n    exit 1\nfi\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "${{ matrix.runner }}",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ matrix.runner }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "runner": [
                  "ubuntu-24.04"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ],
                "include": [
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "opensuse",
                    "tools": "opensuse",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "ubuntu",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-ppc64le"
                  },
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-ppc64le"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# TODO: Use $SYSTEMD_REPART_OVERRIDE_FSTYPE_ROOT once we drop support for Ubuntu Noble.\nsed -i 's/return \"btrfs\"/return \"ext4\"/' mkosi/distributions/*.py\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Generate key",
                "run": "sudo mkosi genkey"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f box -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi -f"
              },
              {
                "name": "Run integration tests",
                "run": "# Without KVM the tests are way too slow and time out\nif [[ -e /dev/kvm ]]; then\n  sudo mkosi box -- \\\n    timeout -k 30 1h \\\n    python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\nfi\n"
              }
            ]
          }
        }
      }
    },
    "2025-09-11T09-35-36Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b00568b7-e520-5c2a-9888-6b9af71a177e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-09-11T09-35-36Z__e019d2d2a646c2ce391b365eb61d1bde7001010e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 106,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fe3f121c-4dba-5b25-941a-bf607140e5cc",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-09-11T09-35-36Z__e019d2d2a646c2ce391b365eb61d1bde7001010e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 107,
                  "startColumn": 5,
                  "endLine": 260,
                  "endColumn": 14
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5cea86f20ebfb111:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-09-11T09-35-36Z__e019d2d2a646c2ce391b365eb61d1bde7001010e.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 260,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 2,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check --output-format=github mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nif ! reuse lint\nthen\n    echo \"Hint: If the above output lists unlicensed files tracked in git you might need to adjust REUSE.toml\"\n    exit 1\nfi\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "${{ matrix.runner }}",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ matrix.runner }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "runner": [
                  "ubuntu-24.04"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ],
                "include": [
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "opensuse",
                    "tools": "opensuse",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "ubuntu",
                    "runner": "ubuntu-24.04-arm"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# TODO: Use $SYSTEMD_REPART_OVERRIDE_FSTYPE_ROOT once we drop support for Ubuntu Noble.\nsed -i 's/return \"btrfs\"/return \"ext4\"/' mkosi/distributions/*.py\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Generate key",
                "run": "sudo mkosi genkey"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f box -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi --distribution ${{ matrix.distro }} -f"
              },
              {
                "name": "Run integration tests",
                "run": "# Without KVM the tests are way too slow and time out\nif [[ -e /dev/kvm ]]; then\n  sudo mkosi box -- \\\n    timeout -k 30 1h \\\n    python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\nfi\n"
              }
            ]
          }
        }
      }
    },
    "2025-09-11T12-26-01Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4b3fbb66-f718-5309-8068-dc9afbbc1aeb",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-09-11T12-26-01Z__63f43112fbbe828bcfba8e493e460322a695d0e1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 106,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-92363c34-07c4-5ffa-9226-903d4f21f0a1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-09-11T12-26-01Z__63f43112fbbe828bcfba8e493e460322a695d0e1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 107,
                  "startColumn": 5,
                  "endLine": 263,
                  "endColumn": 14
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5cea86f20ebfb111:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-09-11T12-26-01Z__63f43112fbbe828bcfba8e493e460322a695d0e1.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 263,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 2,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check --output-format=github mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nif ! reuse lint\nthen\n    echo \"Hint: If the above output lists unlicensed files tracked in git you might need to adjust REUSE.toml\"\n    exit 1\nfi\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "${{ matrix.runner }}",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ matrix.runner }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "runner": [
                  "ubuntu-24.04"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ],
                "include": [
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "opensuse",
                    "tools": "opensuse",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "ubuntu",
                    "runner": "ubuntu-24.04-arm"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# TODO: Use $SYSTEMD_REPART_OVERRIDE_FSTYPE_ROOT once we drop support for Ubuntu Noble.\nsed -i 's/return \"btrfs\"/return \"ext4\"/' mkosi/distributions/*.py\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Generate key",
                "run": "sudo mkosi genkey"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f box -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi -f"
              },
              {
                "name": "Run integration tests",
                "run": "# Without KVM the tests are way too slow and time out\nif [[ -e /dev/kvm ]]; then\n  sudo mkosi box -- \\\n    timeout -k 30 1h \\\n    python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\nfi\n"
              }
            ]
          }
        }
      }
    },
    "2025-09-15T13-04-19Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-76cf10c5-f3a1-5857-bdcf-656e361255f9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-09-15T13-04-19Z__47f963f40b292dfa0f4aab9c16e8989b15ec423f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 106,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8caff802-8c35-5ad7-b668-50f7dacc9757",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-09-15T13-04-19Z__47f963f40b292dfa0f4aab9c16e8989b15ec423f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 107,
                  "startColumn": 5,
                  "endLine": 262,
                  "endColumn": 14
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5cea86f20ebfb111:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-09-15T13-04-19Z__47f963f40b292dfa0f4aab9c16e8989b15ec423f.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 262,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 2,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check --output-format=github mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nif ! reuse lint\nthen\n    echo \"Hint: If the above output lists unlicensed files tracked in git you might need to adjust REUSE.toml\"\n    exit 1\nfi\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "${{ matrix.runner }}",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ matrix.runner }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "runner": [
                  "ubuntu-24.04"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ],
                "include": [
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "opensuse",
                    "tools": "opensuse",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "ubuntu",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-ppc64le"
                  },
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-ppc64le"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# TODO: Use $SYSTEMD_REPART_OVERRIDE_FSTYPE_ROOT once we drop support for Ubuntu Noble.\nsed -i 's/return \"btrfs\"/return \"ext4\"/' mkosi/distributions/*.py\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Generate key",
                "run": "sudo mkosi genkey"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f box -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi -f"
              },
              {
                "name": "Run integration tests",
                "run": "# Without KVM the tests are way too slow and time out\nif [[ -e /dev/kvm ]]; then\n  sudo mkosi box -- \\\n    timeout -k 30 1h \\\n    python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\nfi\n"
              }
            ]
          }
        }
      }
    },
    "2025-09-23T14-44-11Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e1667b07-395d-5137-a842-e9f8432761a8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-09-23T14-44-11Z__62ab363149cf417b8d801fc242c61565375acbf9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 106,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-825fa7a1-a477-58d8-a408-a1d0411e1d58",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-09-23T14-44-11Z__62ab363149cf417b8d801fc242c61565375acbf9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 107,
                  "startColumn": 5,
                  "endLine": 265,
                  "endColumn": 14
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5cea86f20ebfb111:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-09-23T14-44-11Z__62ab363149cf417b8d801fc242c61565375acbf9.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 265,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 2,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check --output-format=github mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nif ! reuse lint\nthen\n    echo \"Hint: If the above output lists unlicensed files tracked in git you might need to adjust REUSE.toml\"\n    exit 1\nfi\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "${{ matrix.runner }}",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ matrix.runner }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "runner": [
                  "ubuntu-24.04"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ],
                "include": [
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "opensuse",
                    "tools": "opensuse",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "ubuntu",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-ppc64le"
                  },
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-ppc64le"
                  },
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-s390x"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# TODO: Use $SYSTEMD_REPART_OVERRIDE_FSTYPE_ROOT once we drop support for Ubuntu Noble.\nsed -i 's/return \"btrfs\"/return \"ext4\"/' mkosi/distributions/*.py\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Generate key",
                "run": "sudo mkosi genkey"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f box -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi -f"
              },
              {
                "name": "Run integration tests",
                "run": "# Without KVM the tests are way too slow and time out\nif [[ -e /dev/kvm ]]; then\n  sudo mkosi box -- \\\n    timeout -k 30 1h \\\n    python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\nfi\n"
              }
            ]
          }
        }
      }
    },
    "2025-10-02T08-13-33Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-453f61ea-e2fd-5af6-881b-1c1f50544393",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-10-02T08-13-33Z__7d7b26b8c9a29920e2767c3ee4d9d398daa35557.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 5,
                  "endLine": 106,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "4215693e1e1ce04f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-203940c3-c0aa-58ea-9614-62db9aab0f04",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/ci__2025-10-02T08-13-33Z__7d7b26b8c9a29920e2767c3ee4d9d398daa35557.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 107,
                  "startColumn": 5,
                  "endLine": 265,
                  "endColumn": 14
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5cea86f20ebfb111:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "ci__2025-10-02T08-13-33Z__7d7b26b8c9a29920e2767c3ee4d9d398daa35557.yml",
          "workflow_name": "CI",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 265,
          "num_jobs": 2,
          "steps_per_job": {
            "unit-test": 17,
            "integration-test": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 1,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "unit-test": 17,
              "integration-test": 10
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 2,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "./",
              "actions/checkout@08c6903cd8c0fde910a37f88322edcfb5dd907a8"
            ],
            "num_run_commands": 24,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "CI",
        "true": {
          "pull_request": {
            "branches": [
              "main"
            ]
          }
        },
        "jobs": {
          "unit-test": {
            "runs-on": "ubuntu-24.04",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "steps": [
              {
                "uses": "actions/checkout@08c6903cd8c0fde910a37f88322edcfb5dd907a8"
              },
              {
                "name": "Install",
                "run": "sudo apt-get install --assume-yes --no-install-recommends pandoc python3-pytest shellcheck\npython3 -m pip install --break-system-packages --upgrade setuptools wheel pip\npython3 -m pip install --break-system-packages codespell mypy reuse ruff\nnpm install -g pyright\n"
              },
              {
                "name": "Run ruff format",
                "run": "ruff --version\nif ! ruff format --check --quiet mkosi/ tests/ kernel-install/*.install\nthen\n    echo \"Please run 'ruff format' on the above files or apply the diffs below manually\"\n    ruff format --check --quiet --diff mkosi/ tests/ kernel-install/*.install\nfi\n"
              },
              {
                "name": "Run ruff check",
                "run": "ruff --version\nruff check --output-format=github mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Check that tabs are not used in code",
                "run": "sh -c '! git grep -P \"\\\\t\" \"*.py\"'"
              },
              {
                "name": "Spell Checking (codespell)",
                "run": "codespell --version\ncodespell\n"
              },
              {
                "name": "License Checking (reuse)",
                "run": "reuse --version\nif ! reuse lint\nthen\n    echo \"Hint: If the above output lists unlicensed files tracked in git you might need to adjust REUSE.toml\"\n    exit 1\nfi\n"
              },
              {
                "name": "Type Checking (mypy)",
                "run": "python3 -m mypy --version\npython3 -m mypy mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Type Checking (pyright)",
                "run": "pyright --version\npyright mkosi/ tests/ kernel-install/*.install\n"
              },
              {
                "name": "Unit Tests",
                "run": "python3 -m pytest --version\npython3 -m pytest -sv tests/\n"
              },
              {
                "name": "Test execution from current working directory",
                "run": "python3 -m mkosi -h"
              },
              {
                "name": "Test execution from current working directory (sudo call)",
                "run": "sudo python3 -m mkosi -h"
              },
              {
                "name": "Test venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test editable venv installation",
                "run": "python3 -m venv testvenv\ntestvenv/bin/python3 -m pip install --upgrade setuptools wheel pip\ntestvenv/bin/python3 -m pip install --editable .\ntestvenv/bin/mkosi -h\nrm -rf testvenv\n"
              },
              {
                "name": "Test zipapp creation",
                "run": "./tools/generate-zipapp.sh\n./builddir/mkosi -h\n./builddir/mkosi documentation\n"
              },
              {
                "name": "Run shellcheck on scripts",
                "run": "bash -c 'shopt -s globstar; shellcheck bin/mkosi tools/*.sh'\nbin/mkosi completion bash | shellcheck -\n"
              },
              {
                "name": "Test man page generation",
                "run": "tools/make-man-page.sh"
              }
            ]
          },
          "integration-test": {
            "runs-on": "${{ matrix.runner }}",
            "needs": "unit-test",
            "concurrency": {
              "group": "${{ github.workflow }}-${{ matrix.distro }}-${{ matrix.tools }}-${{ matrix.runner }}-${{ github.ref }}",
              "cancel-in-progress": true
            },
            "strategy": {
              "fail-fast": false,
              "matrix": {
                "distro": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "tools": [
                  "arch",
                  "centos",
                  "debian",
                  "fedora",
                  "opensuse",
                  "ubuntu"
                ],
                "runner": [
                  "ubuntu-24.04"
                ],
                "exclude": [
                  {
                    "distro": "arch",
                    "tools": "centos"
                  },
                  {
                    "distro": "debian",
                    "tools": "centos"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "centos"
                  },
                  {
                    "distro": "arch",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "debian",
                    "tools": "opensuse"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "opensuse"
                  }
                ],
                "include": [
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "opensuse",
                    "tools": "opensuse",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "ubuntu",
                    "tools": "ubuntu",
                    "runner": "ubuntu-24.04-arm"
                  },
                  {
                    "distro": "fedora",
                    "tools": "fedora",
                    "runner": "ubuntu-24.04-ppc64le"
                  },
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-ppc64le"
                  },
                  {
                    "distro": "debian",
                    "tools": "debian",
                    "runner": "ubuntu-24.04-s390x"
                  }
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@08c6903cd8c0fde910a37f88322edcfb5dd907a8"
              },
              {
                "uses": "./"
              },
              {
                "name": "Free disk space",
                "run": "sudo mv /usr/local /usr/local.trash\nsudo mv /opt/hostedtoolcache /opt/hostedtoolcache.trash\nsudo systemd-run rm -rf /usr/local.trash /opt/hostedtoolcache.trash\n"
              },
              {
                "name": "Install",
                "run": "sudo ln -svf $PWD/bin/mkosi /usr/bin/mkosi",
                "working-directory": "./"
              },
              {
                "name": "Configure",
                "run": "tee mkosi.local.conf <<EOF\n[Distribution]\nDistribution=${{ matrix.distro }}\n\n[Output]\nManifestFormat=json\n\n[Content]\nKernelCommandLine=systemd.default_device_timeout_sec=180\n\n[Build]\nToolsTreeDistribution=${{ matrix.tools }}\nEnvironment=SYSTEMD_REPART_MKFS_OPTIONS_EROFS=\"--quiet\"\n\n[Runtime]\nKVM=yes\nEOF\n\n# TODO: Remove once all distros have recent enough systemd that knows systemd.default_device_timeout_sec.\nmkdir -p mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d\ntee mkosi-initrd/mkosi.extra/usr/lib/systemd/system.conf.d/device-timeout.conf <<EOF\n[Manager]\nDefaultDeviceTimeoutSec=180\nEOF\n\n# TODO: Use $SYSTEMD_REPART_OVERRIDE_FSTYPE_ROOT once we drop support for Ubuntu Noble.\nsed -i 's/return \"btrfs\"/return \"ext4\"/' mkosi/distributions/*.py\n\n# fail if the script already exists, to avoid hard to debug CI errors\n[[ -f mkosi.configure ]] && exit 1\ntee mkosi.configure <<EOF\n#!/bin/bash\necho \"Hello from inside mkosi.configure!\" >&2\ncat\nEOF\nchmod +x mkosi.configure\n\n# prepare and postinst are already used in CI\nfor script in sync build finalize postoutput clean\ndo\n    [[ -f \"mkosi.${script}\" ]] && exit 1\n    tee \"mkosi.${script}\" <<TOK\n#!/bin/bash\necho \"Hello from inside mkosi.${script}\" >&2\nTOK\n    chmod +x \"mkosi.${script}\"\ndone\n"
              },
              {
                "name": "Generate key",
                "run": "sudo mkosi genkey"
              },
              {
                "name": "Summary",
                "run": "sudo mkosi summary"
              },
              {
                "name": "Build tools tree",
                "run": "sudo mkosi -f box -- true"
              },
              {
                "name": "Build image",
                "run": "sudo mkosi -f"
              },
              {
                "name": "Run integration tests",
                "run": "# Without KVM the tests are way too slow and time out\nif [[ -e /dev/kvm ]]; then\n  sudo mkosi box -- \\\n    timeout -k 30 1h \\\n    python3 -m pytest \\\n    --tb=no \\\n    --capture=no \\\n    --verbose \\\n    -m integration \\\n    --distribution ${{ matrix.distro }} \\\n    tests/\nfi\n"
              }
            ]
          }
        }
      }
    }
  }
}