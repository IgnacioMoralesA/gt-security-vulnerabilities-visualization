{
  "repo_owner": "appleboy",
  "repo_name": "ssh-action",
  "workflow_name": "stable",
  "history": {
    "2024-07-14T09-19-13Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-92aa59ad-7a7c-5597-ab55-8973b892ef0f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-07-14T09-19-13Z__06fa62e61cac6c39015db4efcde64776f56965c4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 42,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ac2628da-cf9c-5226-87b7-6db97b603d7a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-07-14T09-19-13Z__06fa62e61cac6c39015db4efcde64776f56965c4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 43,
                  "startColumn": 5,
                  "endLine": 130,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-01591d79-b30e-53a1-b07e-48437da425ce",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-07-14T09-19-13Z__06fa62e61cac6c39015db4efcde64776f56965c4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 131,
                  "startColumn": 5,
                  "endLine": 212,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8356d3a1-d6a6-5dc3-b73a-0b054171a611",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-07-14T09-19-13Z__06fa62e61cac6c39015db4efcde64776f56965c4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 213,
                  "startColumn": 5,
                  "endLine": 287,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a71b111f-d2bc-5cec-83b5-0b1c7974f1de",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-07-14T09-19-13Z__06fa62e61cac6c39015db4efcde64776f56965c4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 288,
                  "startColumn": 5,
                  "endLine": 341,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7e217da5-5a74-5612-b9d1-d4d167bf21ca",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-07-14T09-19-13Z__06fa62e61cac6c39015db4efcde64776f56965c4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 342,
                  "startColumn": 5,
                  "endLine": 474,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "stable__2024-07-14T09-19-13Z__06fa62e61cac6c39015db4efcde64776f56965c4.yml",
          "workflow_name": "testing stable version",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 474,
          "num_jobs": 6,
          "steps_per_job": {
            "default-user-name-password": 3,
            "check-ssh-key": 7,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 6,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 3,
              "check-ssh-key": 7,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 2,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 22,
            "actions_used": [
              "actions/checkout@v4",
              "appleboy/ssh-action@v1.0.3"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 2
          }
        }
      },
      "workflow_json": {
        "name": "testing stable version",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "stop script if command error",
                "uses": "appleboy/ssh-action@v1.0.3",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script_stop": true,
                  "sync": true,
                  "debug": true,
                  "script": "mkdir abc/def\nls -al\n"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "appleboy/ssh-action@v1.0.3",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script_stop": true,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script_stop": true,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "appleboy/ssh-action@v1.0.3",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "appleboy/ssh-action@v1.0.3",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "appleboy/ssh-action@v1.0.3",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "appleboy/ssh-action@v1.0.3",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "switch to root user",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script_stop": true,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          }
        }
      }
    },
    "2024-10-23T17-25-46Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7993d165-bcb0-50a5-b21c-dd5e8bd38fea",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-10-23T17-25-46Z__2763143a97c8f9c4e85766b7458183ec99341e81.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 45,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-33dd4722-bd7b-5c87-a22f-53358fe763a9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-10-23T17-25-46Z__2763143a97c8f9c4e85766b7458183ec99341e81.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 46,
                  "startColumn": 5,
                  "endLine": 133,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-93b72b95-4277-5cd6-bdd3-b869bce2afb8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-10-23T17-25-46Z__2763143a97c8f9c4e85766b7458183ec99341e81.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 134,
                  "startColumn": 5,
                  "endLine": 215,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-353d3e43-aeba-5a82-a738-61beacb4a6b4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-10-23T17-25-46Z__2763143a97c8f9c4e85766b7458183ec99341e81.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 216,
                  "startColumn": 5,
                  "endLine": 290,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e70d1d43-bff0-5194-b66d-bc6157ba845b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-10-23T17-25-46Z__2763143a97c8f9c4e85766b7458183ec99341e81.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 291,
                  "startColumn": 5,
                  "endLine": 344,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1c0a5fda-89c2-50f4-ad4c-b78f871b1955",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-10-23T17-25-46Z__2763143a97c8f9c4e85766b7458183ec99341e81.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 345,
                  "startColumn": 5,
                  "endLine": 477,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "stable__2024-10-23T17-25-46Z__2763143a97c8f9c4e85766b7458183ec99341e81.yml",
          "workflow_name": "testing stable version",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 477,
          "num_jobs": 6,
          "steps_per_job": {
            "default-user-name-password": 3,
            "check-ssh-key": 7,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 6,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 3,
              "check-ssh-key": 7,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 2,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 22,
            "actions_used": [
              "actions/checkout@v4",
              "appleboy/ssh-action@v1.0.3"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 2
          }
        }
      },
      "workflow_json": {
        "name": "testing stable version",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "stop script if command error",
                "uses": "appleboy/ssh-action@v1.0.3",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script_stop": true,
                  "sync": true,
                  "debug": true,
                  "script": "mkdir abc/def\nls -al\n"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "appleboy/ssh-action@v1.0.3",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script_stop": true,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script_stop": true,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "appleboy/ssh-action@v1.0.3",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "appleboy/ssh-action@v1.0.3",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "appleboy/ssh-action@v1.0.3",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "appleboy/ssh-action@v1.0.3",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "switch to root user",
                "uses": "appleboy/ssh-action@v1.0.3",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script_stop": true,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          }
        }
      }
    },
    "2024-11-17T07-17-02Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-34b849ea-41c9-58f5-993a-b7e62523483d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-11-17T07-17-02Z__8fdfeb034ef6e9033a8a4407975aedbc12a08737.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 45,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e03c29e5-a918-5348-bb5d-5c0214015fc8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-11-17T07-17-02Z__8fdfeb034ef6e9033a8a4407975aedbc12a08737.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 46,
                  "startColumn": 5,
                  "endLine": 133,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-806f88a3-0847-54ee-a7c2-e06ebcff8231",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-11-17T07-17-02Z__8fdfeb034ef6e9033a8a4407975aedbc12a08737.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 134,
                  "startColumn": 5,
                  "endLine": 215,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2a5d4ae6-2df7-5407-9c9a-83f79b837186",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-11-17T07-17-02Z__8fdfeb034ef6e9033a8a4407975aedbc12a08737.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 216,
                  "startColumn": 5,
                  "endLine": 290,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9cac9e7d-752d-5397-aeed-f103d06baf0d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-11-17T07-17-02Z__8fdfeb034ef6e9033a8a4407975aedbc12a08737.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 291,
                  "startColumn": 5,
                  "endLine": 344,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-40ebd113-9244-5984-84ad-f2776669b6aa",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-11-17T07-17-02Z__8fdfeb034ef6e9033a8a4407975aedbc12a08737.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 345,
                  "startColumn": 5,
                  "endLine": 477,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "stable__2024-11-17T07-17-02Z__8fdfeb034ef6e9033a8a4407975aedbc12a08737.yml",
          "workflow_name": "testing stable version",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 477,
          "num_jobs": 6,
          "steps_per_job": {
            "default-user-name-password": 3,
            "check-ssh-key": 7,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 6,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 3,
              "check-ssh-key": 7,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 2,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 22,
            "actions_used": [
              "actions/checkout@v4",
              "appleboy/ssh-action@v1.2.0"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 2
          }
        }
      },
      "workflow_json": {
        "name": "testing stable version",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "stop script if command error",
                "uses": "appleboy/ssh-action@v1.2.0",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script_stop": true,
                  "sync": true,
                  "debug": true,
                  "script": "mkdir abc/def\nls -al\n"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "appleboy/ssh-action@v1.2.0",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script_stop": true,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script_stop": true,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "appleboy/ssh-action@v1.2.0",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "appleboy/ssh-action@v1.2.0",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "appleboy/ssh-action@v1.2.0",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "appleboy/ssh-action@v1.2.0",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "switch to root user",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script_stop": true,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          }
        }
      }
    },
    "2024-11-18T00-57-32Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3e458ff2-d8c4-5f3a-ba96-5e544deab3a9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-11-18T00-57-32Z__43d4ebbb72699ed0e9e8aeead91adfc4eac75ed6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 54,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-696f1206-0047-5faa-9a8d-c6b153d089ca",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-11-18T00-57-32Z__43d4ebbb72699ed0e9e8aeead91adfc4eac75ed6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 142,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c729b45e-e04f-5614-8a92-478cc05d04d9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-11-18T00-57-32Z__43d4ebbb72699ed0e9e8aeead91adfc4eac75ed6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 143,
                  "startColumn": 5,
                  "endLine": 224,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a3623a39-792d-5227-a7b4-7130ea50ba6e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-11-18T00-57-32Z__43d4ebbb72699ed0e9e8aeead91adfc4eac75ed6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 225,
                  "startColumn": 5,
                  "endLine": 299,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4f9f691d-af80-5930-af66-4b728c095180",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-11-18T00-57-32Z__43d4ebbb72699ed0e9e8aeead91adfc4eac75ed6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 300,
                  "startColumn": 5,
                  "endLine": 353,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-52650c89-689a-5cca-a977-bc4081abdca1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-11-18T00-57-32Z__43d4ebbb72699ed0e9e8aeead91adfc4eac75ed6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 354,
                  "startColumn": 5,
                  "endLine": 486,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "stable__2024-11-18T00-57-32Z__43d4ebbb72699ed0e9e8aeead91adfc4eac75ed6.yml",
          "workflow_name": "testing stable version",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 486,
          "num_jobs": 6,
          "steps_per_job": {
            "default-user-name-password": 4,
            "check-ssh-key": 7,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 6,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 4,
              "check-ssh-key": 7,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 2,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 23,
            "actions_used": [
              "actions/checkout@v4",
              "appleboy/ssh-action@v1.2.0"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 2
          }
        }
      },
      "workflow_json": {
        "name": "testing stable version",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              },
              {
                "name": "ssh commands from a file",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script_path": "testdata/test.sh"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "stop script if command error",
                "uses": "appleboy/ssh-action@v1.2.0",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script_stop": true,
                  "sync": true,
                  "debug": true,
                  "script": "mkdir abc/def\nls -al\n"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "appleboy/ssh-action@v1.2.0",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script_stop": true,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script_stop": true,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "appleboy/ssh-action@v1.2.0",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "appleboy/ssh-action@v1.2.0",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "appleboy/ssh-action@v1.2.0",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "appleboy/ssh-action@v1.2.0",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "switch to root user",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script_stop": true,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          }
        }
      }
    },
    "2024-12-02T13-25-26Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6757ceef-bb9e-5278-9d90-b30193976759",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-12-02T13-25-26Z__1c1ad10f6da46db2f81a68133f45b6a29317b741.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 54,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d303bb33-0bd9-5b06-857c-ad189db58920",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-12-02T13-25-26Z__1c1ad10f6da46db2f81a68133f45b6a29317b741.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 126,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e784a2a4-3810-501f-b254-fb1f21c121ab",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-12-02T13-25-26Z__1c1ad10f6da46db2f81a68133f45b6a29317b741.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 127,
                  "startColumn": 5,
                  "endLine": 207,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fac2a57f-ce3c-566f-a504-396ce5cc9bba",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-12-02T13-25-26Z__1c1ad10f6da46db2f81a68133f45b6a29317b741.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 208,
                  "startColumn": 5,
                  "endLine": 281,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ac7a7254-dfe9-52f9-961b-18211e8ef432",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-12-02T13-25-26Z__1c1ad10f6da46db2f81a68133f45b6a29317b741.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 282,
                  "startColumn": 5,
                  "endLine": 335,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8bb27a2c-e086-5554-a70f-35c7746648eb",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2024-12-02T13-25-26Z__1c1ad10f6da46db2f81a68133f45b6a29317b741.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 336,
                  "startColumn": 5,
                  "endLine": 467,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "stable__2024-12-02T13-25-26Z__1c1ad10f6da46db2f81a68133f45b6a29317b741.yml",
          "workflow_name": "testing stable version",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 467,
          "num_jobs": 6,
          "steps_per_job": {
            "default-user-name-password": 4,
            "check-ssh-key": 6,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 6,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 4,
              "check-ssh-key": 6,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 1,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 22,
            "actions_used": [
              "actions/checkout@v4",
              "appleboy/ssh-action@v1.2.0"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 1
          }
        }
      },
      "workflow_json": {
        "name": "testing stable version",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              },
              {
                "name": "ssh commands from a file",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script_path": "testdata/test.sh"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "appleboy/ssh-action@v1.2.0",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "appleboy/ssh-action@v1.2.0",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "appleboy/ssh-action@v1.2.0",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "appleboy/ssh-action@v1.2.0",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "appleboy/ssh-action@v1.2.0",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "switch to root user",
                "uses": "appleboy/ssh-action@v1.2.0",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-02-19T09-50-00Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bb0304fe-d24e-5290-b439-65f78fbb2477",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-02-19T09-50-00Z__8faa84277b88b6cd1455986f459aa66cf72bc8a3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 54,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-087b7b0c-f367-54ea-904e-23c5a9678821",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-02-19T09-50-00Z__8faa84277b88b6cd1455986f459aa66cf72bc8a3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 126,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-870bd485-962c-5558-bcb4-620b6aed1480",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-02-19T09-50-00Z__8faa84277b88b6cd1455986f459aa66cf72bc8a3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 127,
                  "startColumn": 5,
                  "endLine": 207,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6e55f0b9-03bd-51c2-a28a-6ef10075ea7b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-02-19T09-50-00Z__8faa84277b88b6cd1455986f459aa66cf72bc8a3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 208,
                  "startColumn": 5,
                  "endLine": 281,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-409bed61-93fd-588b-917f-87abd78c173b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-02-19T09-50-00Z__8faa84277b88b6cd1455986f459aa66cf72bc8a3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 282,
                  "startColumn": 5,
                  "endLine": 335,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-dcf842ec-cf76-5607-a927-d0c80f0529fb",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-02-19T09-50-00Z__8faa84277b88b6cd1455986f459aa66cf72bc8a3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 336,
                  "startColumn": 5,
                  "endLine": 467,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "stable__2025-02-19T09-50-00Z__8faa84277b88b6cd1455986f459aa66cf72bc8a3.yml",
          "workflow_name": "testing stable version",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 467,
          "num_jobs": 6,
          "steps_per_job": {
            "default-user-name-password": 4,
            "check-ssh-key": 6,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 6,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 4,
              "check-ssh-key": 6,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 1,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 22,
            "actions_used": [
              "actions/checkout@v4",
              "appleboy/ssh-action@v1.2.1"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 1
          }
        }
      },
      "workflow_json": {
        "name": "testing stable version",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "appleboy/ssh-action@v1.2.1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              },
              {
                "name": "ssh commands from a file",
                "uses": "appleboy/ssh-action@v1.2.1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script_path": "testdata/test.sh"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "appleboy/ssh-action@v1.2.1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "appleboy/ssh-action@v1.2.1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "appleboy/ssh-action@v1.2.1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "appleboy/ssh-action@v1.2.1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "appleboy/ssh-action@v1.2.1",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "appleboy/ssh-action@v1.2.1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "appleboy/ssh-action@v1.2.1",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "appleboy/ssh-action@v1.2.1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "appleboy/ssh-action@v1.2.1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "appleboy/ssh-action@v1.2.1",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "appleboy/ssh-action@v1.2.1",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "appleboy/ssh-action@v1.2.1",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "appleboy/ssh-action@v1.2.1",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "switch to root user",
                "uses": "appleboy/ssh-action@v1.2.1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-03-09T14-08-40Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f32fa0b8-ece5-58fd-a7dc-d30bf2358513",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-03-09T14-08-40Z__2ead5e36573f08b82fbfce1504f1a4b05a647c6f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 54,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-32402f21-5ba4-5573-9519-25b65f415bcb",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-03-09T14-08-40Z__2ead5e36573f08b82fbfce1504f1a4b05a647c6f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 126,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8ed29ea2-f3e8-5335-a6fb-535b74c93d2c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-03-09T14-08-40Z__2ead5e36573f08b82fbfce1504f1a4b05a647c6f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 127,
                  "startColumn": 5,
                  "endLine": 207,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e75c9b35-0b72-5ebe-8025-958ebd5f512e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-03-09T14-08-40Z__2ead5e36573f08b82fbfce1504f1a4b05a647c6f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 208,
                  "startColumn": 5,
                  "endLine": 281,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3f09ad85-5a5a-51d6-a04a-aa095f864c26",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-03-09T14-08-40Z__2ead5e36573f08b82fbfce1504f1a4b05a647c6f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 282,
                  "startColumn": 5,
                  "endLine": 335,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a78ab61b-b8ad-5195-bab8-79b30a07b0fa",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-03-09T14-08-40Z__2ead5e36573f08b82fbfce1504f1a4b05a647c6f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 336,
                  "startColumn": 5,
                  "endLine": 467,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "stable__2025-03-09T14-08-40Z__2ead5e36573f08b82fbfce1504f1a4b05a647c6f.yml",
          "workflow_name": "testing stable version",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 467,
          "num_jobs": 6,
          "steps_per_job": {
            "default-user-name-password": 4,
            "check-ssh-key": 6,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 6,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 4,
              "check-ssh-key": 6,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 1,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 22,
            "actions_used": [
              "actions/checkout@v4",
              "appleboy/ssh-action@v1.2.2"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 1
          }
        }
      },
      "workflow_json": {
        "name": "testing stable version",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "appleboy/ssh-action@v1.2.2",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              },
              {
                "name": "ssh commands from a file",
                "uses": "appleboy/ssh-action@v1.2.2",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script_path": "testdata/test.sh"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "appleboy/ssh-action@v1.2.2",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "appleboy/ssh-action@v1.2.2",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "appleboy/ssh-action@v1.2.2",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "appleboy/ssh-action@v1.2.2",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "appleboy/ssh-action@v1.2.2",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "appleboy/ssh-action@v1.2.2",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "appleboy/ssh-action@v1.2.2",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "appleboy/ssh-action@v1.2.2",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "appleboy/ssh-action@v1.2.2",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "appleboy/ssh-action@v1.2.2",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "appleboy/ssh-action@v1.2.2",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "appleboy/ssh-action@v1.2.2",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "appleboy/ssh-action@v1.2.2",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "switch to root user",
                "uses": "appleboy/ssh-action@v1.2.2",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-03-15T06-57-10Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-681404e2-b0d3-55af-a3b0-311919b56758",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-03-15T06-57-10Z__2b3c6504b3e1405c32b38787b6d20b223a1ecebc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 54,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a2eca6ae-2ad6-5a34-a5e0-3e4eb3411229",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-03-15T06-57-10Z__2b3c6504b3e1405c32b38787b6d20b223a1ecebc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 126,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4df96caa-cadf-55b8-ba8c-f0e07caba9cc",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-03-15T06-57-10Z__2b3c6504b3e1405c32b38787b6d20b223a1ecebc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 127,
                  "startColumn": 5,
                  "endLine": 207,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-29dec12a-2d57-5f84-b3b5-961903ccd214",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-03-15T06-57-10Z__2b3c6504b3e1405c32b38787b6d20b223a1ecebc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 208,
                  "startColumn": 5,
                  "endLine": 281,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d5ed3e1d-267e-5d99-8246-26209e0c4713",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-03-15T06-57-10Z__2b3c6504b3e1405c32b38787b6d20b223a1ecebc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 282,
                  "startColumn": 5,
                  "endLine": 335,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-aa8bc35e-aa83-57f1-b1aa-1823c835dac3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/stable__2025-03-15T06-57-10Z__2b3c6504b3e1405c32b38787b6d20b223a1ecebc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 336,
                  "startColumn": 5,
                  "endLine": 467,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "stable__2025-03-15T06-57-10Z__2b3c6504b3e1405c32b38787b6d20b223a1ecebc.yml",
          "workflow_name": "testing stable version",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 467,
          "num_jobs": 6,
          "steps_per_job": {
            "default-user-name-password": 4,
            "check-ssh-key": 6,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 6,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 4,
              "check-ssh-key": 6,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 1,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 22,
            "actions_used": [
              "actions/checkout@v4",
              "appleboy/ssh-action@v1"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 1
          }
        }
      },
      "workflow_json": {
        "name": "testing stable version",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "appleboy/ssh-action@v1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              },
              {
                "name": "ssh commands from a file",
                "uses": "appleboy/ssh-action@v1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script_path": "testdata/test.sh"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "appleboy/ssh-action@v1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "appleboy/ssh-action@v1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "appleboy/ssh-action@v1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "appleboy/ssh-action@v1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "appleboy/ssh-action@v1",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "appleboy/ssh-action@v1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "appleboy/ssh-action@v1",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "appleboy/ssh-action@v1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "appleboy/ssh-action@v1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "appleboy/ssh-action@v1",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "appleboy/ssh-action@v1",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "appleboy/ssh-action@v1",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "appleboy/ssh-action@v1",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "switch to root user",
                "uses": "appleboy/ssh-action@v1",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          }
        }
      }
    }
  }
}