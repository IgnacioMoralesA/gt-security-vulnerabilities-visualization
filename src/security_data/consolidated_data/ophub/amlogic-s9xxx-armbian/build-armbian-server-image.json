{
  "repo_owner": "ophub",
  "repo_name": "amlogic-s9xxx-armbian",
  "workflow_name": "build-armbian-server-image",
  "history": {
    "2025-06-06T07-15-41Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-baedf608-182c-5831-9c67-d245fcce0b99",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-06-06T07-15-41Z__d9a8b4ae3c46afed18500deff4c2cc2d28cba7be.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 250,
                  "startColumn": 5,
                  "endLine": 373,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-06-06T07-15-41Z__d9a8b4ae3c46afed18500deff4c2cc2d28cba7be.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 373,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "jammy",
                "type": "choice",
                "options": [
                  "jammy",
                  "noble",
                  "bookworm",
                  "bullseye"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "s905w_s905x_s905x-b860h_s905x-t95_s905x2_s905x3_s905x3-x88-pro-x3_s912_s912-m8s-pro_s912-phicomm-t1_s912-t95z-plus",
                  "s912-x92_s922x_s922x-ct2000_s922x-reva_seewo-sv21_smart-am40_smart-am60_station-m1_sw799_swan1-w28",
                  "tanix-tx6_tb-ls3399_tn3399_tpm312_tqc-a01_tvi3315a_vplus_wxy-oec_xiaobao_yskj_zcube1-max_zk-r39a_zysj",
                  "a311d",
                  "alark35-3500",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oec",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-06-06T02-29-38Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-83d554f5-8953-5932-aafa-5923b85f424d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-06-06T02-29-38Z__50980f259431f9927e1e94dd9ea730c9e35903e4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 249,
                  "startColumn": 5,
                  "endLine": 372,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-06-06T02-29-38Z__50980f259431f9927e1e94dd9ea730c9e35903e4.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 372,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "jammy",
                "type": "choice",
                "options": [
                  "jammy",
                  "noble",
                  "bookworm",
                  "bullseye"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "s905w_s905x_s905x-b860h_s905x-t95_s905x2_s905x3_s905x3-x88-pro-x3_s912_s912-m8s-pro_s912-phicomm-t1_s912-t95z-plus",
                  "s912-x92_s922x_s922x-ct2000_s922x-reva_seewo-sv21_smart-am40_smart-am60_station-m1_sw799_swan1-w28",
                  "tanix-tx6_tb-ls3399_tn3399_tpm312_tqc-a01_tvi3315a_vplus_wxy-oec_xiaobao_yskj_zcube1-max_zk-r39a_zysj",
                  "a311d",
                  "alark35-3500",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oec",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-06-09T02-26-04Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-02973ca6-8b0e-534d-aaad-4b492f19d458",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-06-09T02-26-04Z__07154d7f358256a4c63f1080b717561a1951d728.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 251,
                  "startColumn": 5,
                  "endLine": 374,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-06-09T02-26-04Z__07154d7f358256a4c63f1080b717561a1951d728.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 374,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "jammy",
                "type": "choice",
                "options": [
                  "jammy",
                  "noble",
                  "bookworm",
                  "bullseye"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "s905w_s905x_s905x-b860h_s905x-t95_s905x2_s905x3_s905x3-x88-pro-x3_s912_s912-m8s-pro_s912-phicomm-t1_s912-t95z-plus",
                  "s912-x92_s922x_s922x-ct2000_s922x-reva_seewo-sv21_smart-am40_smart-am60_station-m1_sw799_swan1-w28",
                  "tanix-tx6_tb-ls3399_tn3399_tpm312_tqc-a01_tvi3315a_vplus_wxy-oec_xiaobao_yskj_zcube1-max_zk-r39a_zysj",
                  "a311d",
                  "alark35-3500",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dc-a588",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oec",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-06-15T14-41-30Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-04822d23-c04e-5dab-ad32-d801c28695a7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-06-15T14-41-30Z__bfb63e07173fd72f43c16e8d0902d18e8ffa4f90.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 252,
                  "startColumn": 5,
                  "endLine": 375,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-06-15T14-41-30Z__bfb63e07173fd72f43c16e8d0902d18e8ffa4f90.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 375,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "jammy",
                "type": "choice",
                "options": [
                  "jammy",
                  "noble",
                  "bookworm",
                  "bullseye"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "s905w_s905x_s905x-b860h_s905x-t95_s905x2_s905x3_s905x3-x88-pro-x3_s912_s912-m8s-pro_s912-phicomm-t1_s912-t95z-plus",
                  "s912-x92_s922x_s922x-ct2000_s922x-reva_seewo-sv21_smart-am40_smart-am60_station-m1_sw799_swan1-w28",
                  "tanix-tx6_tb-ls3399_tn3399_tpm312_tqc-a01_tvi3315a_vplus_wxy-oec_xiaobao_yskj_zcube1-max_zk-r39a_zysj",
                  "a311d",
                  "a311d-oes",
                  "alark35-3500",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dc-a588",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oec",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-06-17T03-30-28Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5e7994a3-e5e7-5032-9c2a-0d107af413a4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-06-17T03-30-28Z__084961a5cf3ab9d9f7518590ff432f2959569332.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 253,
                  "startColumn": 5,
                  "endLine": 376,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-06-17T03-30-28Z__084961a5cf3ab9d9f7518590ff432f2959569332.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 376,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "jammy",
                "type": "choice",
                "options": [
                  "jammy",
                  "noble",
                  "bookworm",
                  "bullseye"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "s905w_s905x_s905x-b860h_s905x-t95_s905x2_s905x3_s905x3-x88-pro-x3_s912_s912-m8s-pro_s912-phicomm-t1_s912-t95z-plus",
                  "s912-x92_s922x_s922x-ct2000_s922x-reva_seewo-sv21_smart-am40_smart-am60_station-m1_sw799_swan1-w28",
                  "tanix-tx6_tb-ls3399_tn3399_tpm312_tqc-a01_tvi3315a_vplus_wxy-oec_xiaobao_yskj_zcube1-max_zk-r39a_zysj",
                  "a311d",
                  "a311d-oes",
                  "alark35-3500",
                  "anas3035",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dc-a588",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oec",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-06-29T12-37-24Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5d993188-e7f4-5395-9e78-4cdaa452f37b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-06-29T12-37-24Z__6887ea5a724581c3874b78ddf0cf61a51d08e184.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 254,
                  "startColumn": 5,
                  "endLine": 377,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-06-29T12-37-24Z__6887ea5a724581c3874b78ddf0cf61a51d08e184.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 377,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "jammy",
                "type": "choice",
                "options": [
                  "jammy",
                  "noble",
                  "bookworm",
                  "bullseye"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "s905w_s905x_s905x-b860h_s905x-t95_s905x2_s905x3_s905x3-x88-pro-x3_s912_s912-m8s-pro_s912-phicomm-t1_s912-t95z-plus",
                  "s912-x92_s922x_s922x-ct2000_s922x-reva_seewo-sv21_smart-am40_smart-am60_station-m1_sw799_swan1-w28_tanix-tx6",
                  "tb-ls3399_tn3399_tpm312_tqc-a01_tvi3315a_vplus_wxy-oect_wxy-oec-replaced_xiaobao_yskj_zcube1-max_zk-r39a_zysj",
                  "a311d",
                  "a311d-oes",
                  "alark35-3500",
                  "anas3035",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dc-a588",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oect",
                  "wxy-oec-replaced",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-07-12T14-35-58Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-07d925d1-bf25-51b3-ba6c-edc6e61437ad",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-07-12T14-35-58Z__47bdc5a09a62b276b0d9bee86a74044d73370db8.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 254,
                  "startColumn": 5,
                  "endLine": 377,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-07-12T14-35-58Z__47bdc5a09a62b276b0d9bee86a74044d73370db8.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 377,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "jammy",
                "type": "choice",
                "options": [
                  "jammy",
                  "noble",
                  "bookworm",
                  "bullseye"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "top50",
                  "rest50",
                  "a311d-oes_s905d_s905x3_s922x-ct2000_wxy-oect",
                  "a311d",
                  "a311d-oes",
                  "alark35-3500",
                  "anas3035",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dc-a588",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oect",
                  "wxy-oec-replaced",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-07-17T13-01-12Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b8f1cfe2-a303-57ed-a4de-29be6cba1a8c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-07-17T13-01-12Z__7590b1c501b2af21a73df42e76e12326ec07563e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 255,
                  "startColumn": 5,
                  "endLine": 378,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-07-17T13-01-12Z__7590b1c501b2af21a73df42e76e12326ec07563e.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 378,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "jammy",
                "type": "choice",
                "options": [
                  "jammy",
                  "noble",
                  "bookworm",
                  "bullseye"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "top50",
                  "rest50",
                  "a311d-oes_s905d_s905x3_s922x-ct2000_wxy-oect",
                  "a311d",
                  "a311d-oes",
                  "alark35-3500",
                  "anas3035",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dc-a588",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-oes-plus",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oect",
                  "wxy-oec-replaced",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-07-25T15-37-04Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-27f54ac5-3de6-5b26-aa16-2e5fe5a159c3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-07-25T15-37-04Z__cef8ee1a5a11e4eb47e7446c6dbdce7a108a321d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 256,
                  "startColumn": 5,
                  "endLine": 379,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-07-25T15-37-04Z__cef8ee1a5a11e4eb47e7446c6dbdce7a108a321d.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 379,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "jammy",
                "type": "choice",
                "options": [
                  "jammy",
                  "noble",
                  "bookworm",
                  "bullseye"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "top50",
                  "rest50",
                  "a311d-oes_s905d_s905x3_s922x-ct2000_wxy-oect",
                  "a311d",
                  "a311d-oes",
                  "alark35-3500",
                  "anas3035",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dc-a588",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "orangepi-5b",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-oes-plus",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oect",
                  "wxy-oect-replaced",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-07-24T09-29-04Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fd93203b-a4c0-58cf-b97f-f1c12eb203f7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-07-24T09-29-04Z__46df4591a2b3914129fc17e5da62345db447bc67.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 255,
                  "startColumn": 5,
                  "endLine": 378,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-07-24T09-29-04Z__46df4591a2b3914129fc17e5da62345db447bc67.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 378,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "jammy",
                "type": "choice",
                "options": [
                  "jammy",
                  "noble",
                  "bookworm",
                  "bullseye"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "top50",
                  "rest50",
                  "a311d-oes_s905d_s905x3_s922x-ct2000_wxy-oect",
                  "a311d",
                  "a311d-oes",
                  "alark35-3500",
                  "anas3035",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dc-a588",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-oes-plus",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oect",
                  "wxy-oect-replaced",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-07-25T23-11-54Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0480e5ea-446f-518d-b6f4-cdf17ca8bd0f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-07-25T23-11-54Z__ddcf1771c03d652a466409515fb21790e5018b35.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 256,
                  "startColumn": 5,
                  "endLine": 379,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-07-25T23-11-54Z__ddcf1771c03d652a466409515fb21790e5018b35.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 379,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "lighthx/amlogic-s9xxx-armbian@main",
              "ncipollo/release-action@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "jammy",
                "type": "choice",
                "options": [
                  "jammy",
                  "noble",
                  "bookworm",
                  "bullseye"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "top50",
                  "rest50",
                  "a311d-oes_s905d_s905x3_s922x-ct2000_wxy-oect",
                  "a311d",
                  "a311d-oes",
                  "alark35-3500",
                  "anas3035",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dc-a588",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "orangepi-5b",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-oes-plus",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oect",
                  "wxy-oect-replaced",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "lighthx/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-07-25T23-55-11Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c2be7752-e356-50cf-bb15-eeb484b53cf1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-07-25T23-55-11Z__2e1661c22090cfc89850d900b6a9fabd11e264aa.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 256,
                  "startColumn": 5,
                  "endLine": 379,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-07-25T23-55-11Z__2e1661c22090cfc89850d900b6a9fabd11e264aa.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 379,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "lighthx/amlogic-s9xxx-armbian@main",
              "ncipollo/release-action@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "jammy",
                "type": "choice",
                "options": [
                  "jammy",
                  "noble",
                  "bookworm",
                  "bullseye"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "top50",
                  "rest50",
                  "a311d-oes_s905d_s905x3_s922x-ct2000_wxy-oect",
                  "a311d",
                  "a311d-oes",
                  "alark35-3500",
                  "anas3035",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dc-a588",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "orangepi-5b",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-oes-plus",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oect",
                  "wxy-oect-replaced",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/lighthx/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "lighthx/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-07-27T06-54-50Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e61c0136-5e17-5627-83d2-ddca404f4d62",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-07-27T06-54-50Z__9e79fe815a31944a43b723119dad4f42de213ab0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 256,
                  "startColumn": 5,
                  "endLine": 379,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-07-27T06-54-50Z__9e79fe815a31944a43b723119dad4f42de213ab0.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 379,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "jammy",
                "type": "choice",
                "options": [
                  "jammy",
                  "noble",
                  "bookworm",
                  "bullseye"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "top50",
                  "rest50",
                  "a311d-oes_s905d_s905x3_s922x-ct2000_wxy-oect",
                  "a311d",
                  "a311d-oes",
                  "alark35-3500",
                  "anas3035",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dc-a588",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "orangepi-5b",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-oes-plus",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oect",
                  "wxy-oect-replaced",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-07-29T06-23-21Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-61efea0d-e768-5a12-a395-79944f0f3f75",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-07-29T06-23-21Z__c73a5d692cf0ae43d9abef7ed665d8902ea033f7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 257,
                  "startColumn": 5,
                  "endLine": 380,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-07-29T06-23-21Z__c73a5d692cf0ae43d9abef7ed665d8902ea033f7.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 380,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "bookworm",
                "type": "choice",
                "options": [
                  "trixie",
                  "bookworm",
                  "bullseye",
                  "noble",
                  "jammy"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "top50",
                  "rest50",
                  "a311d-oes_s905d_s905x3_s922x-ct2000_wxy-oect",
                  "a311d",
                  "a311d-oes",
                  "alark35-3500",
                  "anas3035",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dc-a588",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "orangepi-5b",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-oes-plus",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oect",
                  "wxy-oect-replaced",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-08-16T06-02-24Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-921de339-0d5b-5cd0-a895-abb8336a4ae3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-08-16T06-02-24Z__a2685e35b8065afb0cf34a36fecb606a40b42560.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 258,
                  "startColumn": 5,
                  "endLine": 381,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-08-16T06-02-24Z__a2685e35b8065afb0cf34a36fecb606a40b42560.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 381,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "bookworm",
                "type": "choice",
                "options": [
                  "trixie",
                  "bookworm",
                  "bullseye",
                  "noble",
                  "jammy"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "top50",
                  "rest50",
                  "a311d-oes_s905d_s905x3_s922x-ct2000_wxy-oect",
                  "a311d",
                  "a311d-oes",
                  "alark35-3500",
                  "anas3035",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dc-a588",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "orangepi-5b",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x2-hg680fj",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-oes-plus",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oect",
                  "wxy-oect-replaced",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-09-01T05-12-08Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8d7c02e6-4ead-5400-add9-baf3187dd8ed",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-09-01T05-12-08Z__85643d242aed8a66c9fb0232ca804bbcd9ea638b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 258,
                  "startColumn": 5,
                  "endLine": 383,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-09-01T05-12-08Z__85643d242aed8a66c9fb0232ca804bbcd9ea638b.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 383,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "bookworm",
                "type": "choice",
                "options": [
                  "trixie",
                  "bookworm",
                  "bullseye",
                  "noble",
                  "jammy"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "top50",
                  "rest50",
                  "a311d-oes_s905d_s905x3_s922x-ct2000_wxy-oect",
                  "a311d",
                  "a311d-oes",
                  "alark35-3500",
                  "anas3035",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dc-a588",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "orangepi-5b",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x2-hg680fj",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-oes-plus",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oect",
                  "wxy-oect-replaced",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo -E timedatectl set-timezone \"${TZ}\"\nsudo -E apt-get install -y ntpdate\nsudo -E ntpdate pool.ntp.org\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-09-11T08-30-26Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a2b5453d-a1b1-5a87-8953-e769e46d6b0c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-09-11T08-30-26Z__6f64eee495c52088fef660baf74a4bf029abc536.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 259,
                  "startColumn": 5,
                  "endLine": 384,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-09-11T08-30-26Z__6f64eee495c52088fef660baf74a4bf029abc536.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 384,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "bookworm",
                "type": "choice",
                "options": [
                  "trixie",
                  "bookworm",
                  "bullseye",
                  "noble",
                  "jammy"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "top50",
                  "rest50",
                  "a311d-oes_s905d_s905x3_s922x-ct2000_wxy-oect",
                  "a311d",
                  "a311d-oes",
                  "alark35-3500",
                  "anas3035",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dc-a588",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "orangepi-5b",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x2-hg680fj",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-oes-plus",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wocyber-a3",
                  "wxy-oect",
                  "wxy-oect-replaced",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "Etc/UTC",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo -E timedatectl set-timezone \"${TZ}\"\nsudo -E apt-get install -y ntpdate\nsudo -E ntpdate pool.ntp.org\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-09-01T09-42-48Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2aef23df-a0ca-56ba-9aca-8b2553cc62b5",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-armbian-server-image__2025-09-01T09-42-48Z__3e1dbb2461344ee272d9644b70bceabdfe93c3da.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 258,
                  "startColumn": 5,
                  "endLine": 383,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-armbian-server-image__2025-09-01T09-42-48Z__3e1dbb2461344ee272d9644b70bceabdfe93c3da.yml",
          "workflow_name": "Build Armbian server image",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 383,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 9
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 9
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 6,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build Armbian server image",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "set_release": {
                "description": "Select OS Release.",
                "required": false,
                "default": "bookworm",
                "type": "choice",
                "options": [
                  "trixie",
                  "bookworm",
                  "bullseye",
                  "noble",
                  "jammy"
                ]
              },
              "armbian_board": {
                "description": "Select device board.",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "top50",
                  "rest50",
                  "a311d-oes_s905d_s905x3_s922x-ct2000_wxy-oect",
                  "a311d",
                  "a311d-oes",
                  "alark35-3500",
                  "anas3035",
                  "beikeyun",
                  "chainedbox",
                  "crrc",
                  "dc-a588",
                  "dg3399",
                  "dg-tn3568",
                  "dlfr100",
                  "e20c",
                  "e25",
                  "eaidk-610",
                  "emb3531",
                  "fine3399",
                  "firefly-rk3399",
                  "fmx1-pro",
                  "jp-tvbox",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h88k",
                  "h88k-v3",
                  "h96-max-m2",
                  "hs530r",
                  "hugsun-x99",
                  "ipc-r",
                  "king3399",
                  "kylin3399",
                  "lckfb-tspi",
                  "leez",
                  "lx-r3s",
                  "mrkaio-m68s",
                  "nanopc-t6",
                  "nanopi-r5c",
                  "nanopi-r5s",
                  "orangepi-5-plus",
                  "orangepi-5b",
                  "panther-x2",
                  "r66s",
                  "r68s",
                  "renegade-rk3328",
                  "rk3318-box",
                  "rock5b",
                  "rock5c",
                  "ruisen-box",
                  "s905",
                  "s905-beelink-mini",
                  "s905-mxqpro-plus",
                  "s905d",
                  "s905d-ki-pro",
                  "s905d-sml5442tw",
                  "s905l",
                  "s905l-aurora-1s",
                  "s905l-b860av21u",
                  "s905l-mg101",
                  "s905l2",
                  "s905l2-e900v21e",
                  "s905l2-wojia",
                  "s905l3",
                  "s905l3-cm211",
                  "s905l3-unt400g1",
                  "s905l3-unt402a",
                  "s905l3a",
                  "s905l3a-cm311",
                  "s905l3a-m401a",
                  "s905l3b",
                  "s905l3b-e900v21d",
                  "s905l3b-e900v22d",
                  "s905l3b-e900v22e",
                  "s905l3b-ip103h",
                  "s905l3b-rg020et-ca",
                  "s905l3b-unt403a",
                  "s905lb-ipbs9505",
                  "s905lb-q96-mini",
                  "s905lb-r3300l",
                  "s905mb",
                  "s905w",
                  "s905w-w95",
                  "s905w-x96-mini",
                  "s905w-x96w",
                  "s905x",
                  "s905x-b860h",
                  "s905x-nexbox-a95x",
                  "s905x-t95",
                  "s905x-tbee",
                  "s905x-tx9",
                  "s905x2",
                  "s905x2-km3",
                  "s905x2-x96max-2g",
                  "s905x2-hg680fj",
                  "s905x3",
                  "s905x3-2101",
                  "s905x3-a100",
                  "s905x3-a95xf3",
                  "s905x3-a95xf3-gb",
                  "s905x3-b",
                  "s905x3-h96max",
                  "s905x3-hk1",
                  "s905x3-ip1001m",
                  "s905x3-q1",
                  "s905x3-q2",
                  "s905x3-tx3",
                  "s905x3-tx3-bz",
                  "s905x3-ugoosx3",
                  "s905x3-whale",
                  "s905x3-x88-pro-x3",
                  "s905x3-x96air",
                  "s905x3-x96air-gb",
                  "s905x3-x96max",
                  "s912",
                  "s912-h96pro-plus",
                  "s912-m8s-pro",
                  "s912-nexbox-a1",
                  "s912-nexbox-a2",
                  "s912-onecloudpro",
                  "s912-phicomm-t1",
                  "s912-t95z-plus",
                  "s912-tx8-max",
                  "s912-tx9-pro-2g",
                  "s912-tx9-pro-3g",
                  "s912-x92",
                  "s912-zyxq-fake",
                  "s922x",
                  "s922x-ct2000",
                  "s922x-gtking",
                  "s922x-gtkingpro-h",
                  "s922x-odroid-n2",
                  "s922x-oes-plus",
                  "s922x-reva",
                  "s922x-ugoos-am6",
                  "seewo-sv21",
                  "smart-am40",
                  "smart-am60",
                  "station-m1",
                  "station-m2",
                  "sv-33a6x",
                  "swan1-w28",
                  "sw799",
                  "tanix-tx6",
                  "tb-ls3399",
                  "tn3399",
                  "tpm312",
                  "tqc-a01",
                  "tvi3315a",
                  "vplus",
                  "wxy-oect",
                  "wxy-oect-replaced",
                  "xiaobao",
                  "yskj",
                  "zcube1-max",
                  "zk-r39a",
                  "zysj"
                ]
              },
              "armbian_kernel": {
                "description": "Select kernel version.",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel.",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_repo": {
                "description": "Set the kernel repository.",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel"
                ]
              },
              "kernel_usage": {
                "description": "Set the tags of the stable kernel.",
                "required": false,
                "default": "stable",
                "type": "choice",
                "options": [
                  "stable",
                  "flippy",
                  "dev",
                  "beta"
                ]
              },
              "armbian_fstype": {
                "description": "Select armbian rootfs type.",
                "required": false,
                "default": "ext4",
                "type": "choice",
                "options": [
                  "ext4",
                  "btrfs"
                ]
              },
              "armbian_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set Armbian builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "Etc/UTC",
          "ROOTFS_SCRIPT": "compile-kernel/tools/script/docker/build_armbian_rootfs_file.sh"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo -E timedatectl set-timezone \"${TZ}\"\nsudo -E apt-get install -y ntpdate\nsudo -E ntpdate pool.ntp.org\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download source code",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "df -hT ${PWD}\ngit clone -q --single-branch --depth=1 --branch=main https://github.com/armbian/build.git build\nln -sf /builder/build ${GITHUB_WORKSPACE}/build\nln -sf /builder/build /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/build\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile Armbian [ ${{ inputs.set_release }} ]",
                "id": "compile",
                "working-directory": "/builder",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "run": "# Compile method and parameter description: https://docs.armbian.com/Developer-Guide_Build-Options\ncd build/\n    ./compile.sh RELEASE=${{ inputs.set_release }} BOARD=odroidn2 BRANCH=current BUILD_MINIMAL=no \\\n                 BUILD_ONLY=default HOST=armbian BUILD_DESKTOP=no EXPERT=yes KERNEL_CONFIGURE=no \\\n                 COMPRESS_OUTPUTIMAGE=\"sha\" SHARE_LOG=yes\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Organize files and clear space",
                "id": "clean",
                "if": "${{ steps.compile.outputs.status }} == 'success' && !cancelled()",
                "run": "# Organize and keep essential files, delete unnecessary files\nchmod +x ${ROOTFS_SCRIPT}\n${ROOTFS_SCRIPT} -v ${{ inputs.set_release }} -s true -c true -k true\n\n# Output cleaning result information\ndf -hT ${PWD}\necho \"build_tag=Armbian_${{ inputs.set_release }}_${{ inputs.armbian_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Upload Armbian image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "build/output/images/*",
                  "allowUpdates": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "name": "Rebuild Armbian",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.clean.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "armbian",
                  "armbian_path": "build/output/images/*.img.gz",
                  "armbian_board": "${{ inputs.armbian_board }}",
                  "armbian_kernel": "${{ inputs.armbian_kernel }}",
                  "auto_kernel": "${{ inputs.auto_kernel }}",
                  "kernel_repo": "${{ inputs.kernel_repo }}",
                  "kernel_usage": "${{ inputs.kernel_usage }}",
                  "armbian_fstype": "${{ inputs.armbian_fstype }}",
                  "builder_name": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload Rebuild image to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.clean.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### Armbian Image information\n- Default username: root\n- Default password: 1234\n- Install command: armbian-install\n- Update command: armbian-update\n### Armbian Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    }
  }
}