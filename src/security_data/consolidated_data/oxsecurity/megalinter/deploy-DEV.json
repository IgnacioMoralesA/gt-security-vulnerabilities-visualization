{
  "repo_owner": "oxsecurity",
  "repo_name": "megalinter",
  "workflow_name": "deploy-DEV",
  "history": {
    "2020-10-17T08-23-45Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-46b51291-ea0e-53c6-832c-a52e415062f7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-10-17T08-23-45Z__93f66de38a1de8f45f01b42fba03f054ca5ce99a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 29
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-10-17T08-23-45Z__93f66de38a1de8f45f01b42fba03f054ca5ce99a.yml",
          "workflow_name": "deploy-DEV__2020-10-17T08-23-45Z__93f66de38a1de8f45f01b42fba03f054ca5ce99a",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 99,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "master_megalinter"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"::set-env name=BUILD_DATE::$(date -u +'%Y-%m-%dT%H:%M:%SZ')\""
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e DEFAULT_BRANCH=master_megalinter -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e DEFAULT_BRANCH=master_megalinter -e POST_GITHUB_COMMENT=false -e OUTPUT_DETAILS=detailed -e FILTER_REGEX_EXCLUDE='(\\.automation\\/test\\/)' -e DISABLE_LINTERS=\"BASH_SHFMT,CLOUDFORMATION,PYTHON_BLACK,DOCKERFILE_HADOLINT\" -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-10-17T08-26-44Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3e01fb6f-19c9-5bd4-821b-bfeb69604dab",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-10-17T08-26-44Z__3ae9a7004b45d067c23d68bb9f72c6307e44866c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 99,
                  "endColumn": 29
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-10-17T08-26-44Z__3ae9a7004b45d067c23d68bb9f72c6307e44866c.yml",
          "workflow_name": "deploy-DEV__2020-10-17T08-26-44Z__3ae9a7004b45d067c23d68bb9f72c6307e44866c",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 99,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "master"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"::set-env name=BUILD_DATE::$(date -u +'%Y-%m-%dT%H:%M:%SZ')\""
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e DEFAULT_BRANCH=master -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e DEFAULT_BRANCH=master -e POST_GITHUB_COMMENT=false -e OUTPUT_DETAILS=detailed -e FILTER_REGEX_EXCLUDE='(\\.automation\\/test\\/)' -e DISABLE_LINTERS=\"BASH_SHFMT,CLOUDFORMATION,PYTHON_BLACK,DOCKERFILE_HADOLINT\" -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-10-23T16-14-14Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5d67560e-b840-5960-998a-baf773a407be",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-10-23T16-14-14Z__1009032eef44d0baa5dca2f3c22751590cd206b5.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 34
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-10-23T16-14-14Z__1009032eef44d0baa5dca2f3c22751590cd206b5.yml",
          "workflow_name": "deploy-DEV__2020-10-23T16-14-14Z__1009032eef44d0baa5dca2f3c22751590cd206b5",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 101,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "master"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"::set-env name=BUILD_DATE::$(date -u +'%Y-%m-%dT%H:%M:%SZ')\""
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e DEFAULT_BRANCH=master -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e DEFAULT_BRANCH=master -e POST_GITHUB_COMMENT=false -e OUTPUT_DETAILS=detailed -e FILTER_REGEX_EXCLUDE='(\\.automation\\/test\\/)' -e DISABLE_LINTERS=\"BASH_SHFMT,CLOUDFORMATION,PYTHON_BLACK,DOCKERFILE_HADOLINT\" -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-10-27T15-59-12Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-50f0b6d9-40c2-5116-9116-9bf5263ce31e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-10-27T15-59-12Z__91c9ec708679a2a8846307db82e57dd51511cf7e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 34
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-10-27T15-59-12Z__91c9ec708679a2a8846307db82e57dd51511cf7e.yml",
          "workflow_name": "deploy-DEV__2020-10-27T15-59-12Z__91c9ec708679a2a8846307db82e57dd51511cf7e",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 101,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "master"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"::set-env name=BUILD_DATE::$(date -u +'%Y-%m-%dT%H:%M:%SZ')\""
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e DEFAULT_BRANCH=master -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e DEFAULT_BRANCH=master -e POST_GITHUB_COMMENT=false -e OUTPUT_DETAILS=detailed -e FILTER_REGEX_EXCLUDE='(\\.automation\\/test\\/)' -e DISABLE=\"SPELL\" -e DISABLE_LINTERS=\"BASH_SHFMT,CLOUDFORMATION,PYTHON_BLACK,DOCKERFILE_HADOLINT\" -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-10-28T15-36-14Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-97cbe51b-3b19-58e7-ad34-2efed3408ff8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-10-28T15-36-14Z__ee5106150b3e54d09c9a0952ca4c4691cd08c0b6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 34
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-10-28T15-36-14Z__ee5106150b3e54d09c9a0952ca4c4691cd08c0b6.yml",
          "workflow_name": "deploy-DEV__2020-10-28T15-36-14Z__ee5106150b3e54d09c9a0952ca4c4691cd08c0b6",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 101,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"::set-env name=BUILD_DATE::$(date -u +'%Y-%m-%dT%H:%M:%SZ')\""
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e DEFAULT_BRANCH=master -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e DEFAULT_BRANCH=master -e POST_GITHUB_COMMENT=false -e OUTPUT_DETAILS=detailed -e FILTER_REGEX_EXCLUDE='(\\.automation\\/test\\/)' -e DISABLE=\"SPELL\" -e DISABLE_LINTERS=\"BASH_SHFMT,CLOUDFORMATION,PYTHON_BLACK,DOCKERFILE_HADOLINT\" -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-10-31T12-04-16Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4fdd4da9-2611-5c0f-8f16-3a1998a4c22c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-10-31T12-04-16Z__b9faafa89387a9a5861f237d3ec47609aa62443b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 34
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-10-31T12-04-16Z__b9faafa89387a9a5861f237d3ec47609aa62443b.yml",
          "workflow_name": "deploy-DEV__2020-10-31T12-04-16Z__b9faafa89387a9a5861f237d3ec47609aa62443b",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 101,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"::set-env name=BUILD_DATE::$(date -u +'%Y-%m-%dT%H:%M:%SZ')\""
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e DEFAULT_BRANCH=master -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e DEFAULT_BRANCH=master -e OUTPUT_DETAILS=detailed -e FILTER_REGEX_EXCLUDE='(\\.automation\\/test\\/)' -e DISABLE=\"CLOUDFORMATION,SPELL\" -e DISABLE_LINTERS=\"BASH_SHFMT,PYTHON_BLACK,DOCKERFILE_HADOLINT\" -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-11-05T11-43-51Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8cf2d96f-e914-5144-81d2-230807529c95",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-11-05T11-43-51Z__bd9fae954297fa2b293728168a2d16bee27439b9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 34
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-11-05T11-43-51Z__bd9fae954297fa2b293728168a2d16bee27439b9.yml",
          "workflow_name": "deploy-DEV__2020-11-05T11-43-51Z__bd9fae954297fa2b293728168a2d16bee27439b9",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 101,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"::set-env name=BUILD_DATE::$(date -u +'%Y-%m-%dT%H:%M:%SZ')\""
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e DEFAULT_BRANCH=master -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e DEFAULT_BRANCH=master -e OUTPUT_DETAILS=detailed -e FILTER_REGEX_EXCLUDE='(\\.automation\\/test\\/)' -e DISABLE=\"CLOUDFORMATION,SPELL\" -e DISABLE_LINTERS=\"BASH_SHFMT,DOCKERFILE_HADOLINT,PYTHON_BLACK,PYTHON_ISORT\" -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-11-06T07-40-38Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-be320e63-497f-5bde-b210-024e3f986324",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-11-06T07-40-38Z__30e546824b706d44fee1aac3c220030e44a7080c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 34
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-11-06T07-40-38Z__30e546824b706d44fee1aac3c220030e44a7080c.yml",
          "workflow_name": "deploy-DEV__2020-11-06T07-40-38Z__30e546824b706d44fee1aac3c220030e44a7080c",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 101,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"::set-env name=BUILD_DATE::$(date -u +'%Y-%m-%dT%H:%M:%SZ')\""
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e DEFAULT_BRANCH=master -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e DEFAULT_BRANCH=master -e OUTPUT_DETAILS=detailed -e FILTER_REGEX_EXCLUDE='(\\.automation/test)' -e DISABLE=\"CLOUDFORMATION,SPELL\" -e DISABLE_LINTERS=\"BASH_SHFMT,DOCKERFILE_HADOLINT,PYTHON_BLACK,PYTHON_ISORT\" -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-11-11T15-37-25Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-396e5510-de45-5281-93ad-90203303c4d8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-11-11T15-37-25Z__83475698593cf840c65261561c45ce1daedf2150.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 34
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-11-11T15-37-25Z__83475698593cf840c65261561c45ce1daedf2150.yml",
          "workflow_name": "deploy-DEV__2020-11-11T15-37-25Z__83475698593cf840c65261561c45ce1daedf2150",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 101,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"::set-env name=BUILD_DATE::$(date -u +'%Y-%m-%dT%H:%M:%SZ')\""
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e DEFAULT_BRANCH=master -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e LOG_LEVEL=DEBUG -e DEFAULT_BRANCH=master -e OUTPUT_DETAILS=detailed -e FILTER_REGEX_EXCLUDE='(\\.automation/test)' -e DISABLE=\"CLOUDFORMATION,SPELL\" -e DISABLE_LINTERS=\"BASH_SHFMT,DOCKERFILE_HADOLINT,PYTHON_BLACK,PYTHON_ISORT\" -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-11-11T15-38-43Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cfbdb323-54b7-52e0-bdd7-06bbd9228baa",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-11-11T15-38-43Z__be68c26e81644c8ebb84fea37b71d27f755e45cd.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 34
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-11-11T15-38-43Z__be68c26e81644c8ebb84fea37b71d27f755e45cd.yml",
          "workflow_name": "deploy-DEV__2020-11-11T15-38-43Z__be68c26e81644c8ebb84fea37b71d27f755e45cd",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 101,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"::set-env name=BUILD_DATE::$(date -u +'%Y-%m-%dT%H:%M:%SZ')\""
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e DEFAULT_BRANCH=master -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e DEFAULT_BRANCH=master -e OUTPUT_DETAILS=detailed -e FILTER_REGEX_EXCLUDE='(\\.automation/test)' -e DISABLE=\"CLOUDFORMATION,SPELL\" -e DISABLE_LINTERS=\"BASH_SHFMT,DOCKERFILE_HADOLINT,PYTHON_BLACK,PYTHON_ISORT\" -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-11-13T00-35-20Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f3949467-16d9-52cd-9a9c-fcd070c9c197",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-11-13T00-35-20Z__c6fb9413a49c822d502dd68dda0407f101dfaf80.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 34
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-11-13T00-35-20Z__c6fb9413a49c822d502dd68dda0407f101dfaf80.yml",
          "workflow_name": "deploy-DEV__2020-11-13T00-35-20Z__c6fb9413a49c822d502dd68dda0407f101dfaf80",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 101,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"::set-env name=BUILD_DATE::$(date -u +'%Y-%m-%dT%H:%M:%SZ')\""
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e DEFAULT_BRANCH=master -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e DEFAULT_BRANCH=master -e OUTPUT_DETAILS=detailed -e FILTER_REGEX_EXCLUDE='(\\.automation/test|docs/javascripts)' -e DISABLE=\"CLOUDFORMATION,SPELL\" -e DISABLE_LINTERS=\"BASH_SHFMT,DOCKERFILE_HADOLINT,PYTHON_BLACK,PYTHON_ISORT\" -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-11-15T13-46-36Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-48eac777-ea03-500b-a94d-e64776648f8a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-11-15T13-46-36Z__ff62956a31497b1b3474e16f4d97417ae68a54e5.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 34
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-11-15T13-46-36Z__ff62956a31497b1b3474e16f4d97417ae68a54e5.yml",
          "workflow_name": "deploy-DEV__2020-11-15T13-46-36Z__ff62956a31497b1b3474e16f4d97417ae68a54e5",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 101,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"::set-env name=BUILD_DATE::$(date -u +'%Y-%m-%dT%H:%M:%SZ')\""
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e DEFAULT_BRANCH=master -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e DEFAULT_BRANCH=master -e OUTPUT_DETAILS=detailed -e FILTER_REGEX_EXCLUDE='(\\.automation/test|docs/javascripts|lib/)' -e DISABLE=\"CLOUDFORMATION\" -e DISABLE_LINTERS=\"BASH_SHFMT,DOCKERFILE_HADOLINT,PYTHON_BLACK,PYTHON_ISORT\" -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-11-19T09-56-10Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f4728e41-427d-50d4-8a11-7c34f4d73748",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-11-19T09-56-10Z__a2ff93e5354e41c4890d88f7af56a7781b62c0b0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 34,
                  "startColumn": 5,
                  "endLine": 104,
                  "endColumn": 34
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-11-19T09-56-10Z__a2ff93e5354e41c4890d88f7af56a7781b62c0b0.yml",
          "workflow_name": "deploy-DEV__2020-11-19T09-56-10Z__a2ff93e5354e41c4890d88f7af56a7781b62c0b0",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 104,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "env": {
          "ACTIONS_ALLOW_UNSECURE_COMMANDS": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"::set-env name=BUILD_DATE::$(date -u +'%Y-%m-%dT%H:%M:%SZ')\""
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e DEFAULT_BRANCH=master -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e DEFAULT_BRANCH=master -e OUTPUT_DETAILS=detailed -e FILTER_REGEX_EXCLUDE='(\\.automation/test|docs/javascripts|lib/)' -e DISABLE=\"CLOUDFORMATION,SPELL\" -e DISABLE_LINTERS=\"BASH_SHFMT,DOCKERFILE_HADOLINT,PYTHON_BLACK,PYTHON_ISORT\" -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-11-19T19-21-49Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-aabff640-e628-5a19-a527-69c19cf39b50",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-11-19T19-21-49Z__93937e1242d2abbd6cca4c578dd660585007c762.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 34,
                  "startColumn": 5,
                  "endLine": 104,
                  "endColumn": 34
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-11-19T19-21-49Z__93937e1242d2abbd6cca4c578dd660585007c762.yml",
          "workflow_name": "deploy-DEV__2020-11-19T19-21-49Z__93937e1242d2abbd6cca4c578dd660585007c762",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 104,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "env": {
          "ACTIONS_ALLOW_UNSECURE_COMMANDS": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"::set-env name=BUILD_DATE::$(date -u +'%Y-%m-%dT%H:%M:%SZ')\""
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e DEFAULT_BRANCH=master -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e DEFAULT_BRANCH=master -e OUTPUT_DETAILS=detailed -e FILTER_REGEX_EXCLUDE='(\\.automation/test|docs/javascripts|lib/)' -e DISABLE=\"CLOUDFORMATION,SPELL,TEKTON\" -e DISABLE_LINTERS=\"BASH_SHFMT,DOCKERFILE_HADOLINT,PYTHON_BLACK,PYTHON_ISORT\" -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-11-21T21-07-33Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1ca0c679-0533-510e-a96a-960322dd8ef4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-11-21T21-07-33Z__764e1670f579d723cf27259a301f41b62bf16e7d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 34
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-11-21T21-07-33Z__764e1670f579d723cf27259a301f41b62bf16e7d.yml",
          "workflow_name": "deploy-DEV__2020-11-21T21-07-33Z__764e1670f579d723cf27259a301f41b62bf16e7d",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 101,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e DEFAULT_BRANCH=master -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e DEFAULT_BRANCH=master -e OUTPUT_DETAILS=detailed -e FILTER_REGEX_EXCLUDE='(\\.automation/test|docs/javascripts|lib/)' -e DISABLE=\"CLOUDFORMATION,SPELL,TEKTON\" -e DISABLE_LINTERS=\"BASH_SHFMT,DOCKERFILE_HADOLINT,PYTHON_BLACK,PYTHON_ISORT\" -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-11-22T13-33-51Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-df26ed76-fac0-5360-be2f-4422bba56051",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-11-22T13-33-51Z__0c8b9450c7923ca9b5af64c63a62f3abaa12a6b6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 34
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-11-22T13-33-51Z__0c8b9450c7923ca9b5af64c63a62f3abaa12a6b6.yml",
          "workflow_name": "deploy-DEV__2020-11-22T13-33-51Z__0c8b9450c7923ca9b5af64c63a62f3abaa12a6b6",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 101,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-11-22T22-55-12Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-750e8a1f-bfd5-513b-bf65-f285453166ba",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-11-22T22-55-12Z__36d19ae4897978539ae3c73f99c07c399ec0be9b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 101,
                  "endColumn": 34
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-11-22T22-55-12Z__36d19ae4897978539ae3c73f99c07c399ec0be9b.yml",
          "workflow_name": "deploy-DEV__2020-11-22T22-55-12Z__36d19ae4897978539ae3c73f99c07c399ec0be9b",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 101,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 5,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              }
            ]
          }
        }
      }
    },
    "2020-11-26T22-35-59Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-24c0fe3a-a293-5771-9016-5240918cb131",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-11-26T22-35-59Z__5f3fbbc275424051953a1e18ada830b83934970c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 114,
                  "endColumn": 116
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-11-26T22-35-59Z__5f3fbbc275424051953a1e18ada830b83934970c.yml",
          "workflow_name": "deploy-DEV__2020-11-26T22-35-59Z__5f3fbbc275424051953a1e18ada830b83934970c",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 114,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 10
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/setup-node@v1",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 7,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "Setup Node",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/setup-node@v1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${GITHUB_SHA} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2020-11-27T08-21-07Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6f89f0ec-93cb-5b62-a074-9fd50451f5c1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-11-27T08-21-07Z__c66b0d46e171452cf45d77cc68cad95d375cc14e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 114,
                  "endColumn": 116
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-11-27T08-21-07Z__c66b0d46e171452cf45d77cc68cad95d375cc14e.yml",
          "workflow_name": "deploy-DEV__2020-11-27T08-21-07Z__c66b0d46e171452cf45d77cc68cad95d375cc14e",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 114,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 10
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/setup-node@v2.1.2",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 7,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "Setup Node",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/setup-node@v2.1.2",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${GITHUB_SHA} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2020-11-28T10-33-16Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4b57087c-4f24-5734-a48b-1f3d1b73fe0f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-11-28T10-33-16Z__0d86ce1463eff79fe0d5fc9a471c34311b3af1b0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 5,
                  "endLine": 114,
                  "endColumn": 118
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-11-28T10-33-16Z__0d86ce1463eff79fe0d5fc9a471c34311b3af1b0.yml",
          "workflow_name": "deploy-DEV__2020-11-28T10-33-16Z__0d86ce1463eff79fe0d5fc9a471c34311b3af1b0",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 114,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 10
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/setup-node@v2.1.2",
              "actions/upload-artifact@v2"
            ],
            "num_run_commands": 7,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "Setup Node",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/setup-node@v2.1.2",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{github.sha}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2020-11-29T12-26-32Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e498e58a-decd-5451-9787-13358acf8d14",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-11-29T12-26-32Z__9872bcfa53855cb1d47e31baa90f354243deb34f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 39,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "221a7bb1bdf42d32:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-32d9d963-5c02-5d19-b08b-8fe7f386f982",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-11-29T12-26-32Z__9872bcfa53855cb1d47e31baa90f354243deb34f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 41,
                  "startColumn": 5,
                  "endLine": 124,
                  "endColumn": 118
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-11-29T12-26-32Z__9872bcfa53855cb1d47e31baa90f354243deb34f.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 124,
          "num_jobs": 2,
          "steps_per_job": {
            "cancel_duplicates": 1,
            "build": 10
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "cancel_duplicates": 1,
              "build": 10
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/setup-node@v2.1.2",
              "actions/upload-artifact@v2",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 7,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "cancel_duplicates": {
            "name": "Cancel duplicate jobs",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "Setup Node",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/setup-node@v2.1.2",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{github.sha}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2020-12-03T18-49-04Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b7ec7534-6a44-5b35-b750-cf1b8fb98254",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-12-03T18-49-04Z__0c471e9a077cdd9085ecf2b48afe304c3ea9a0af.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 39,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "221a7bb1bdf42d32:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-56ea6d77-f736-5264-b7e7-346dab4a9510",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-12-03T18-49-04Z__0c471e9a077cdd9085ecf2b48afe304c3ea9a0af.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 41,
                  "startColumn": 5,
                  "endLine": 129,
                  "endColumn": 118
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-12-03T18-49-04Z__0c471e9a077cdd9085ecf2b48afe304c3ea9a0af.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 129,
          "num_jobs": 2,
          "steps_per_job": {
            "cancel_duplicates": 1,
            "build": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "cancel_duplicates": 1,
              "build": 11
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/setup-node@v2.1.2",
              "actions/upload-artifact@v2",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "cancel_duplicates": {
            "name": "Cancel duplicate jobs",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }})",
                "uses": "actions/setup-node@v2.1.2",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }})",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }})",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{github.sha}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2020-12-11T08-00-16Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5db7e704-b90b-523d-b817-bd74a6bcf57d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-12-11T08-00-16Z__15779dd98422954712591abb4a23151e03cea7f6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 39,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "221a7bb1bdf42d32:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-feebb513-1d1f-5919-b410-8e5f6fdf2c31",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-12-11T08-00-16Z__15779dd98422954712591abb4a23151e03cea7f6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 41,
                  "startColumn": 5,
                  "endLine": 129,
                  "endColumn": 118
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-12-11T08-00-16Z__15779dd98422954712591abb4a23151e03cea7f6.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 129,
          "num_jobs": 2,
          "steps_per_job": {
            "cancel_duplicates": 1,
            "build": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "cancel_duplicates": 1,
              "build": 11
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/setup-node@v2.1.3",
              "actions/upload-artifact@v2",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "cancel_duplicates": {
            "name": "Cancel duplicate jobs",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }})",
                "uses": "actions/setup-node@v2.1.3",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }})",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }})",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{github.sha}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2020-12-12T10-56-29Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8b2dd6f4-7527-528a-a247-bd858dae2b31",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-12-12T10-56-29Z__4f25718f084143812e7d1c6aaa51f801bdf7d336.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 39,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "66c637dba5b21f61:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-14c1fefe-2819-5d51-8c2a-06c3807a9194",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-12-12T10-56-29Z__4f25718f084143812e7d1c6aaa51f801bdf7d336.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 41,
                  "startColumn": 5,
                  "endLine": 129,
                  "endColumn": 118
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-12-12T10-56-29Z__4f25718f084143812e7d1c6aaa51f801bdf7d336.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 129,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 11
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/setup-node@v2.1.3",
              "actions/upload-artifact@v2",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }})",
                "uses": "actions/setup-node@v2.1.3",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }})",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }})",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{github.sha}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2020-12-29T07-24-20Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b89c410a-fcba-50fe-8874-0bac02a11ac7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-12-29T07-24-20Z__e5dd19de653b70258f25d06366e83d1b3b571482.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 40,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c47b914c-728e-5128-80a4-cfe95038a027",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2020-12-29T07-24-20Z__e5dd19de653b70258f25d06366e83d1b3b571482.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 5,
                  "endLine": 130,
                  "endColumn": 118
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2020-12-29T07-24-20Z__e5dd19de653b70258f25d06366e83d1b3b571482.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 130,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 11
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 11
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/setup-node@v2.1.3",
              "actions/upload-artifact@v2",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 5,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${GITHUB_SHA} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Run Docker label test cases",
                "shell": "bash",
                "run": ".automation/validate-docker-labels.sh"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\necho \"CI_ENV=${CI_ENV}\"\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${GITHUB_SHA}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }})",
                "uses": "actions/setup-node@v2.1.3",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }})",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }})",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{github.sha}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2021-01-02T20-20-01Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-dc23beaa-d7e5-5cc5-81d2-701434c41876",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-01-02T20-20-01Z__a613ef1ec59e471ef452e6c5854fa91157a08b43.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 40,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0d164a69-7216-50b7-a952-a3d6b81b3176",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-01-02T20-20-01Z__a613ef1ec59e471ef452e6c5854fa91157a08b43.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 5,
                  "endLine": 166,
                  "endColumn": 135
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-01-02T20-20-01Z__a613ef1ec59e471ef452e6c5854fa91157a08b43.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 166,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 12
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 12
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/setup-node@v2.1.3",
              "actions/upload-artifact@v2",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 9,
            "steps_with_conditionals": 8,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full) & push",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  TEST_KEYWORDS=$(echo \"${{github.event.head_commit.message}}\" | sed \"s/^TEST_KEYWORDS=\\(.*\\)$/\\1/\" )\n  echo \"Run only tests with keywords ${TEST_KEYWORDS}\"\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.1.3",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2021-01-23T23-08-55Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4b5446de-ec50-501a-8968-1765eb5a61b2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-01-23T23-08-55Z__0b3f7e8438892c56a0e510440f13d047aa842e23.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 40,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a12009cc-eb8a-5b49-8801-617a1c298efd",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-01-23T23-08-55Z__0b3f7e8438892c56a0e510440f13d047aa842e23.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 5,
                  "endLine": 171,
                  "endColumn": 135
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-01-23T23-08-55Z__0b3f7e8438892c56a0e510440f13d047aa842e23.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 171,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 12
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 12
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/setup-node@v2.1.3",
              "actions/upload-artifact@v2",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 9,
            "steps_with_conditionals": 8,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full) & push",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.1.3",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2021-01-25T19-09-46Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4f635047-0570-50c8-9e47-52818d2e5d08",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-01-25T19-09-46Z__2d657cf08cc75bca761b60e9806e0924a13dbc9d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 40,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-72d73fdf-a339-5385-9d71-eb7f097e6492",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-01-25T19-09-46Z__2d657cf08cc75bca761b60e9806e0924a13dbc9d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 5,
                  "endLine": 193,
                  "endColumn": 135
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-01-25T19-09-46Z__2d657cf08cc75bca761b60e9806e0924a13dbc9d.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 193,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 13
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 13
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/setup-node@v2.1.3",
              "actions/upload-artifact@v2",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 10,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.1.3",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2021-01-25T02-28-36Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fbcca298-19db-5cc2-80a7-661a007898e5",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-01-25T02-28-36Z__82ea02f48734341ed90f75022edd30e772ee8c02.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 40,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0d4d59df-a391-5542-b6ee-cd07629f19be",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-01-25T02-28-36Z__82ea02f48734341ed90f75022edd30e772ee8c02.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 5,
                  "endLine": 181,
                  "endColumn": 135
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-01-25T02-28-36Z__82ea02f48734341ed90f75022edd30e772ee8c02.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 181,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 13
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 13
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/setup-node@v2.1.3",
              "actions/upload-artifact@v2",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 10,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from forks)",
                "if": "github.repository != 'nvuillam/mega-linter' && !contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full) & push",
                "if": "github.repository == 'nvuillam/mega-linter' && !contains(github.event.head_commit.message, 'quick build')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.1.3",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2021-02-09T22-32-44Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1d4c7931-e873-51d3-9745-44aab773f2f0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-02-09T22-32-44Z__bc6f717b5d93c79ed009f28c7d3153ca48efc1bb.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 40,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-79889230-a6e2-5c36-95d7-5bc506eee50a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-02-09T22-32-44Z__bc6f717b5d93c79ed009f28c7d3153ca48efc1bb.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 5,
                  "endLine": 193,
                  "endColumn": 135
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-02-09T22-32-44Z__bc6f717b5d93c79ed009f28c7d3153ca48efc1bb.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 193,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 13
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 13
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/setup-node@v2.1.3",
              "actions/upload-artifact@v2",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 10,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.1.3",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2021-02-11T06-41-18Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d7720567-5876-516a-a700-8b8aea96589c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-02-11T06-41-18Z__c108ef892e060a8a2a0a3eaf5f93766dffcc611f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 40,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5870f854-9815-5d1d-9b6d-62650409830f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-02-11T06-41-18Z__c108ef892e060a8a2a0a3eaf5f93766dffcc611f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 5,
                  "endLine": 193,
                  "endColumn": 135
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-02-11T06-41-18Z__c108ef892e060a8a2a0a3eaf5f93766dffcc611f.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 193,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 13
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 13
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/setup-node@v2.1.3",
              "actions/upload-artifact@v2",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 10,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.1.3",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2021-03-06T21-24-51Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-769098e9-7887-5e2e-b530-76abaf89f756",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-03-06T21-24-51Z__908a2e9c5525ca7ac4fd1908353d4b6e31cc49b1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 40,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cc71b037-1bdf-5e6b-92a2-f6fbfadb6150",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-03-06T21-24-51Z__908a2e9c5525ca7ac4fd1908353d4b6e31cc49b1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 5,
                  "endLine": 193,
                  "endColumn": 135
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-03-06T21-24-51Z__908a2e9c5525ca7ac4fd1908353d4b6e31cc49b1.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 193,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 13
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 13
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.3.3",
              "actions/setup-node@v2.1.5",
              "actions/upload-artifact@v2",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 10,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.1.5",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2021-05-12T09-31-27Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8f72e9c4-ea9c-503d-b593-0b24e39fafce",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-05-12T09-31-27Z__eb4704b07634306adea27830d06d2334fa3d6e3f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 40,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e5bdfcb9-7616-57b5-9b90-ad204b498e3f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-05-12T09-31-27Z__eb4704b07634306adea27830d06d2334fa3d6e3f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 5,
                  "endLine": 193,
                  "endColumn": 135
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-05-12T09-31-27Z__eb4704b07634306adea27830d06d2334fa3d6e3f.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 193,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 13
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 13
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.3.4",
              "actions/setup-node@v2.1.5",
              "actions/upload-artifact@v2",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 10,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.1.5",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2021-06-12T18-09-17Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6d584ce7-b84c-59bc-8aea-ad8d0ccd71ec",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-06-12T18-09-17Z__6fdab89e1c6f56d9ba9bfb1733609ce99177b7b6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 40,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e7a34440-d469-5bd2-bde8-9d66521b3c22",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-06-12T18-09-17Z__6fdab89e1c6f56d9ba9bfb1733609ce99177b7b6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 5,
                  "endLine": 213,
                  "endColumn": 37
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-06-12T18-09-17Z__6fdab89e1c6f56d9ba9bfb1733609ce99177b7b6.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 213,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "actions/checkout@v2.3.4",
              "actions/setup-node@v2.1.5",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@master",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 60,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.1.5",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH"
                }
              }
            ]
          }
        }
      }
    },
    "2021-07-13T08-09-13Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-cbe603a5-9e64-5ce0-9293-022785f903f2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-07-13T08-09-13Z__a19df6f166fbeabd2c59b9b57e4dd335324d17c1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 40,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-dddac16a-b910-5845-aa01-e75e2035f5d6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-07-13T08-09-13Z__a19df6f166fbeabd2c59b9b57e4dd335324d17c1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 5,
                  "endLine": 213,
                  "endColumn": 37
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-07-13T08-09-13Z__a19df6f166fbeabd2c59b9b57e4dd335324d17c1.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 213,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "actions/checkout@v2.3.4",
              "actions/setup-node@v2.1.5",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@master",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.1.5",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH"
                }
              }
            ]
          }
        }
      }
    },
    "2021-08-07T15-42-19Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-00604d30-1898-581a-8051-a0cdab3c6597",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-08-07T15-42-19Z__6628ba10bf358478cd2682b3709af1deeefb6361.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 40,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0e8b0670-683e-58b0-b427-ad5b767865f7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-08-07T15-42-19Z__6628ba10bf358478cd2682b3709af1deeefb6361.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 5,
                  "endLine": 213,
                  "endColumn": 37
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-08-07T15-42-19Z__6628ba10bf358478cd2682b3709af1deeefb6361.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 213,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "actions/checkout@v2.3.4",
              "actions/setup-node@v2.1.5",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@0.0.18",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 30
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.1.5",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH"
                }
              }
            ]
          }
        }
      }
    },
    "2021-08-08T17-12-24Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-164821a1-64cd-5198-98ee-dbde0ea4dd1b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-08-08T17-12-24Z__24bdccdfea84ff5efecc0986dbfdaf8752b4636d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 40,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-71f8aff2-c586-58b8-a4e3-f2253c28cd05",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-08-08T17-12-24Z__24bdccdfea84ff5efecc0986dbfdaf8752b4636d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 5,
                  "endLine": 213,
                  "endColumn": 37
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-08-08T17-12-24Z__24bdccdfea84ff5efecc0986dbfdaf8752b4636d.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 213,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "actions/checkout@v2.3.4",
              "actions/setup-node@v2.1.5",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@0.0.18",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.1.5",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH"
                }
              }
            ]
          }
        }
      }
    },
    "2021-08-10T13-17-23Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5a3ff8f9-b06a-587b-b930-217f98c9465b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-08-10T13-17-23Z__68d87f58707d1912b705e071e4c03dc69d962500.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 40,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a838f757-ab3e-5cc2-986d-647a682850e7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-08-10T13-17-23Z__68d87f58707d1912b705e071e4c03dc69d962500.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 5,
                  "endLine": 213,
                  "endColumn": 37
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-08-10T13-17-23Z__68d87f58707d1912b705e071e4c03dc69d962500.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 213,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "actions/checkout@v2.3.4",
              "actions/setup-node@v2.1.5",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@0.0.19",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.1.5",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.19",
                "with": {
                  "image-ref": "docker.io/nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH"
                }
              }
            ]
          }
        }
      }
    },
    "2021-09-12T16-23-36Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1ea15e62-f6d6-5e3b-9fc7-efb02df48e7d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-09-12T16-23-36Z__f57ac1975806a19a3bea17a07d70dacaed3be502.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 40,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a9e49080-f259-5bd5-bfee-52bb395229f9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-09-12T16-23-36Z__f57ac1975806a19a3bea17a07d70dacaed3be502.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 5,
                  "endLine": 213,
                  "endColumn": 37
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-09-12T16-23-36Z__f57ac1975806a19a3bea17a07d70dacaed3be502.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 213,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "actions/checkout@v2.3.4",
              "actions/setup-node@v2.1.5",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@0.0.18",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.1.5",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH"
                }
              }
            ]
          }
        }
      }
    },
    "2021-09-19T14-55-37Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-865fc7fd-8388-5063-b0b7-41a010177512",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-09-19T14-55-37Z__e54d9d1a5b4ff715679342ee9c541792d3450a20.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 41,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-87865007-cd66-52b4-a752-17421660ecd5",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-09-19T14-55-37Z__e54d9d1a5b4ff715679342ee9c541792d3450a20.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 43,
                  "startColumn": 5,
                  "endLine": 214,
                  "endColumn": 37
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-09-19T14-55-37Z__e54d9d1a5b4ff715679342ee9c541792d3450a20.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 214,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "actions/checkout@v2.3.4",
              "actions/setup-node@v2.1.5",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@0.0.18",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}",
                  "cancel_others": true
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.1.5",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH"
                }
              }
            ]
          }
        }
      }
    },
    "2021-08-10T17-58-39Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b8c65e13-d369-5879-865f-b1b29e1407ef",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-08-10T17-58-39Z__b70e1e9fc315eebb91f9b11dd008d8341befe5c9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 40,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a01bf493-ff10-53b5-abaa-e48465045412",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-08-10T17-58-39Z__b70e1e9fc315eebb91f9b11dd008d8341befe5c9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 5,
                  "endLine": 213,
                  "endColumn": 37
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-08-10T17-58-39Z__b70e1e9fc315eebb91f9b11dd008d8341befe5c9.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 213,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "actions/checkout@v2.3.4",
              "actions/setup-node@v2.1.5",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@0.0.18",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}"
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.1.5",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH"
                }
              }
            ]
          }
        }
      }
    },
    "2021-10-03T20-46-48Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-117b0d91-af03-51ae-97d0-4b8d285857e6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-10-03T20-46-48Z__c46ce8d48d7c004eb6cbd5eccc72b3d79a6858b1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 41,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-41cc67ed-ce3e-51e5-8fc6-197d9265fe7b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-10-03T20-46-48Z__c46ce8d48d7c004eb6cbd5eccc72b3d79a6858b1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 43,
                  "startColumn": 5,
                  "endLine": 214,
                  "endColumn": 37
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-10-03T20-46-48Z__c46ce8d48d7c004eb6cbd5eccc72b3d79a6858b1.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 214,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "actions/checkout@v2.3.4",
              "actions/setup-node@v2.4.1",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@0.0.18",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}",
                  "cancel_others": true
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.4.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH"
                }
              }
            ]
          }
        }
      }
    },
    "2021-10-18T21-42-26Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8422843c-81a8-53f7-9b66-f79d6a153e48",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-10-18T21-42-26Z__3caf463c81be35ea8c6cffb4a451861a219e58d7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 41,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6a06bff0-63f5-5954-b2c2-15aad32c52a5",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-10-18T21-42-26Z__3caf463c81be35ea8c6cffb4a451861a219e58d7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 43,
                  "startColumn": 5,
                  "endLine": 214,
                  "endColumn": 37
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-10-18T21-42-26Z__3caf463c81be35ea8c6cffb4a451861a219e58d7.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 214,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "actions/checkout@v2.3.5",
              "actions/setup-node@v2.4.1",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@0.0.18",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "master",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}",
                  "cancel_others": true
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.5",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:latest\"\nif docker_tag_exists nvuillam/mega-linter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t nvuillam/mega-linter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'nvuillam/mega-linter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "nvuillam/mega-linter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.4.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/nvuillam/mega-linter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH"
                }
              }
            ]
          }
        }
      }
    },
    "2021-10-30T09-51-21Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-62af7604-5472-59d3-a919-60c4219cf803",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-10-30T09-51-21Z__4e2663d84c816f196d99d805dd528c49edede607.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 5,
                  "endLine": 41,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b242170c36d6c164:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ab9e304b-0774-53c1-9f26-f0c14ad53b7e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-10-30T09-51-21Z__4e2663d84c816f196d99d805dd528c49edede607.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 43,
                  "startColumn": 5,
                  "endLine": 214,
                  "endColumn": 37
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-10-30T09-51-21Z__4e2663d84c816f196d99d805dd528c49edede607.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 214,
          "num_jobs": 2,
          "steps_per_job": {
            "skip_checks": 1,
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 2,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "skip_checks": 1,
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 5,
            "actions_used": [
              "actions/checkout@v2.3.5",
              "actions/setup-node@v2.4.1",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@0.0.18",
              "fkirc/skip-duplicate-actions@master"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "jobs": {
          "skip_checks": {
            "name": "Skip checks",
            "if": "!contains(github.event.head_commit.message, 'skip deploy')",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "uses": "fkirc/skip-duplicate-actions@master",
                "with": {
                  "github_token": "${{ secrets.PAT || secrets.GITHUB_TOKEN }}",
                  "cancel_others": true
                }
              }
            ]
          },
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.5",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:latest\"\nif docker_tag_exists megalinter/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.4.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH"
                }
              }
            ]
          }
        }
      }
    },
    "2021-11-02T23-37-10Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5e230a0d-8a35-502d-8010-921ab4ac2f84",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-11-02T23-37-10Z__7b0dac518db5159e85fd3f681336202106f0c0fe.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 208,
                  "endColumn": 37
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-11-02T23-37-10Z__7b0dac518db5159e85fd3f681336202106f0c0fe.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 208,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.3.5",
              "actions/setup-node@v2.4.1",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@0.0.18"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.3.5",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:latest\"\nif docker_tag_exists megalinter/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.4.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH"
                }
              }
            ]
          }
        }
      }
    },
    "2021-11-04T21-04-20Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ed582bb2-977e-50a8-8102-fea5f88b21ef",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-11-04T21-04-20Z__9535d6d04f99f46d9060ca577ccbd2b5ba160a1d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 208,
                  "endColumn": 37
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-11-04T21-04-20Z__9535d6d04f99f46d9060ca577ccbd2b5ba160a1d.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 208,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.4.0",
              "actions/setup-node@v2.4.1",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@0.0.18"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.4.0",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:latest\"\nif docker_tag_exists megalinter/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.4.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH"
                }
              }
            ]
          }
        }
      }
    },
    "2021-11-09T08-35-05Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e5fcbe24-33fd-5e32-9ba3-fc274108ed38",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-11-09T08-35-05Z__c5388ad9323bd0907fb466de9773f7db15965494.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 208,
                  "endColumn": 37
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-11-09T08-35-05Z__c5388ad9323bd0907fb466de9773f7db15965494.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 208,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.4.0",
              "actions/setup-node@v2.4.1",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@0.0.18"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.4.0",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:beta\"\nif docker_tag_exists megalinter/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "Mega-Linter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.4.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH"
                }
              }
            ]
          }
        }
      }
    },
    "2021-11-11T10-32-24Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2adabc35-5f83-5c19-be76-98acaa0ca970",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-11-11T10-32-24Z__4aa6dd8956db9a9835af6b5fc1850f91b6c498b7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 208,
                  "endColumn": 37
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-11-11T10-32-24Z__4aa6dd8956db9a9835af6b5fc1850f91b6c498b7.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 208,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.4.0",
              "actions/setup-node@v2.4.1",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@0.0.18"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.4.0",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:beta\"\nif docker_tag_exists megalinter/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.4.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH"
                }
              }
            ]
          }
        }
      }
    },
    "2021-12-07T21-38-21Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-127fda59-af33-5208-9f34-5688e4f4e8f8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2021-12-07T21-38-21Z__dbd6aba152f5866f615821ea8ade18ce3e5e81d2.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 209,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2021-12-07T21-38-21Z__dbd6aba152f5866f615821ea8ade18ce3e5e81d2.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 209,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.4.0",
              "actions/setup-node@v2.4.1",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@0.0.18"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.4.0",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:beta\"\nif docker_tag_exists megalinter/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.4.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "5m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2022-01-22T19-39-35Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-26ade7b7-6bf0-5d3c-bc46-21bda7b9f2cd",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2022-01-22T19-39-35Z__accaaa6691a3788d2ea0029cd76cd8a53500a903.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 209,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2022-01-22T19-39-35Z__accaaa6691a3788d2ea0029cd76cd8a53500a903.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 209,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.4.0",
              "actions/setup-node@v2.5.1",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@0.0.18"
            ],
            "num_run_commands": 11,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.4.0",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:beta\"\nif docker_tag_exists megalinter/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.5.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "5m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2022-01-24T00-41-27Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-32429ec2-40a0-5fc3-91e7-140d28bc3daa",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2022-01-24T00-41-27Z__418d1cf6e1e7bc59bd92cca1074cd5b0f5400758.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 225,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2022-01-24T00-41-27Z__418d1cf6e1e7bc59bd92cca1074cd5b0f5400758.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 225,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 16
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 16
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v2.4.0",
              "actions/setup-node@v2.5.1",
              "actions/upload-artifact@v2",
              "aquasecurity/trivy-action@0.0.18"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v2.4.0",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:beta\"\nif docker_tag_exists megalinter/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v2",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.5.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "5m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2022-04-09T10-16-31Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e6fc9347-c532-535e-b933-23c1102af857",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2022-04-09T10-16-31Z__60604bc1a2788c31db0f5432eb812cb65bc8a39f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 225,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2022-04-09T10-16-31Z__60604bc1a2788c31db0f5432eb812cb65bc8a39f.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 225,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 16
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 16
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v3.0.0",
              "actions/setup-node@v2.5.1",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@0.0.18"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3.0.0",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:beta\"\nif docker_tag_exists megalinter/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.5.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "5m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2022-04-18T18-45-47Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-95a7a06a-384e-50b0-a0c0-bda485ecb0f1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2022-04-18T18-45-47Z__3af8854caeb74348e29c9dec2e633e4da6db5d05.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 225,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2022-04-18T18-45-47Z__3af8854caeb74348e29c9dec2e633e4da6db5d05.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 225,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 16
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 16
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v3.0.1",
              "actions/setup-node@v3.1.1",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@0.0.18"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3.0.1",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:beta\"\nif docker_tag_exists megalinter/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.1.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "5m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2022-04-18T00-18-35Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-de425875-b4aa-5230-ba5d-235e7f001f90",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2022-04-18T00-18-35Z__e4aada158e833fdae15978b08a31e0b4633caf5d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 225,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2022-04-18T00-18-35Z__e4aada158e833fdae15978b08a31e0b4633caf5d.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 225,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 16
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 16
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v3.0.1",
              "actions/setup-node@v2.5.1",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@0.0.18"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3.0.1",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:beta\"\nif docker_tag_exists megalinter/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v2.5.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && (${{ success() }} || ${{ failure() }}) && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "5m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2022-06-24T15-48-58Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-663ad600-86de-591f-b40d-3963bab7603c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2022-06-24T15-48-58Z__e939ff314791891124874df44cb93eec58d7a0f9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 225,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2022-06-24T15-48-58Z__e939ff314791891124874df44cb93eec58d7a0f9.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 225,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 16
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 16
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v3.0.1",
              "actions/setup-node@v3.1.1",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@0.0.18"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main",
              "alpha"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3.0.1",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:beta\"\nif docker_tag_exists megalinter/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"megalinter/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t megalinter/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'megalinter/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "megalinter/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=tap -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 30
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 10
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "report\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.1.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo npm ci && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@0.0.18",
                "with": {
                  "image-ref": "docker.io/megalinter/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2022-07-10T12-38-01Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fbd20336-309c-5f7b-829e-cf3416b06931",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2022-07-10T12-38-01Z__33ebb65f237ca4d35c08c7fd1ed4903de3b7cbc1.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 225,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2022-07-10T12-38-01Z__33ebb65f237ca4d35c08c7fd1ed4903de3b7cbc1.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 225,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 16
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 16
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.1.1",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\nif docker_tag_exists oxsecurity/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.1.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2022-07-10T21-40-31Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8ceb3ada-c1c6-50c5-88ef-fd8d3184cea0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2022-07-10T21-40-31Z__b5d7496bef8a24093e9b88cdd37bbee6807406c6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 226,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2022-07-10T21-40-31Z__b5d7496bef8a24093e9b88cdd37bbee6807406c6.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 226,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 16
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 16
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.1.1",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\nif docker_tag_exists oxsecurity/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.1.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2022-07-14T17-47-59Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6c538433-1284-5795-b53e-037ef722fe89",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2022-07-14T17-47-59Z__87c9fc9aa58ff607332f8ace496dd435cb850272.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 227,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2022-07-14T17-47-59Z__87c9fc9aa58ff607332f8ace496dd435cb850272.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 227,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.1.1",
              "actions/upload-artifact@v3"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\nif docker_tag_exists oxsecurity/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAILS=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.1.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2022-09-08T21-30-42Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-58eab998-9711-50ea-a0ab-94a75165d0b3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2022-09-08T21-30-42Z__cccaeca472cf9e7171af7f48858d1da65746dc15.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 224,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2022-09-08T21-30-42Z__cccaeca472cf9e7171af7f48858d1da65746dc15.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 224,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.1.1",
              "actions/upload-artifact@v3"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\nif docker_tag_exists oxsecurity/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.1.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2022-07-19T22-04-30Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-16d4049d-fa05-549b-b330-60dd728cb508",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2022-07-19T22-04-30Z__d58f1ed8015a4e004a08ce7cbba720d63c2552c5.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 227,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2022-07-19T22-04-30Z__d58f1ed8015a4e004a08ce7cbba720d63c2552c5.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 227,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.1.1",
              "actions/upload-artifact@v3"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\nif docker_tag_exists oxsecurity/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.1.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2022-09-11T02-10-32Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-33b6164b-8aa6-503c-aebe-d9297ee954b7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2022-09-11T02-10-32Z__95fbbab08b437468ca09ab6929f8c8cd0c67db1f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 224,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2022-09-11T02-10-32Z__95fbbab08b437468ca09ab6929f8c8cd0c67db1f.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 224,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 15
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 15
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.1.1",
              "actions/upload-artifact@v3"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\nif docker_tag_exists oxsecurity/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\nDOCKER_BUILDKIT=1 docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "DOCKER_BUILDKIT=1 docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.1.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2022-10-01T00-23-01Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e2c399fb-399c-5fe1-9231-5f3cf1733b4c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2022-10-01T00-23-01Z__927b88321345c1a98802886acd43eb6fdba0943d.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 224,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2022-10-01T00-23-01Z__927b88321345c1a98802886acd43eb6fdba0943d.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 224,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 16
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 16
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.1.1",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\nif docker_tag_exists oxsecurity/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\nDOCKER_BUILDKIT=1 docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "DOCKER_BUILDKIT=1 docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.1.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2022-10-23T08-55-53Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9c42dfd2-c5ea-5720-8309-b345715e3db8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2022-10-23T08-55-53Z__a47459fcb4521766738367f693b23bd98f9e164f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 224,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2022-10-23T08-55-53Z__a47459fcb4521766738367f693b23bd98f9e164f.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 224,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 16
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 16
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.1.1",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >> ${GITHUB_ENV}"
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"::set-output name=tag::${TAG}\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\nif docker_tag_exists oxsecurity/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\nDOCKER_BUILDKIT=1 docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "DOCKER_BUILDKIT=1 docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.1.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2022-10-23T07-55-01Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-44768b16-0e2c-5627-8040-fd39e0b4f829",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2022-10-23T07-55-01Z__2561f74f7fcab010df8f0a6ce75a4e9bc68a3a5e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 224,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2022-10-23T07-55-01Z__2561f74f7fcab010df8f0a6ce75a4e9bc68a3a5e.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 224,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 16
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 16
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.1.1",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\nif docker_tag_exists oxsecurity/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\nDOCKER_BUILDKIT=1 docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "DOCKER_BUILDKIT=1 docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.1.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2022-10-29T17-27-59Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f5bf9255-da3d-5701-ad40-a6241230a23b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2022-10-29T17-27-59Z__02919a39ccf9d20b016280de897c63df01fa5632.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 224,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2022-10-29T17-27-59Z__02919a39ccf9d20b016280de897c63df01fa5632.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 224,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 16
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 16
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.1.1",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\nif docker_tag_exists oxsecurity/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\nDOCKER_BUILDKIT=1 docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "DOCKER_BUILDKIT=1 docker build --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.1.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-01-01T21-09-44Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-296e4761-eb66-532b-ae72-6c35bf9b6d83",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2023-01-01T21-09-44Z__b359f699d3e601fbf0e1620449f1b959ef75e41f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 235,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-01-01T21-09-44Z__b359f699d3e601fbf0e1620449f1b959ef75e41f.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 235,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 18
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 18
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 6,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.1.1",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\nif docker_tag_exists oxsecurity/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker buildx build --platform linux/amd64 --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} --load . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "DOCKER_BUILD_PLATFORMS": "linux/amd64",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker buildx build --platform linux/amd64 --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} --load . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "DOCKER_BUILD_PLATFORMS": "linux/amd64",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.1.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-01-07T20-44-09Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-aa852061-34cc-521f-b817-8a873fd80d94",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2023-01-07T20-44-09Z__5603d4ae541724205229c00a1552c53d2427b9d3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 235,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-01-07T20-44-09Z__5603d4ae541724205229c00a1552c53d2427b9d3.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 235,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 18
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 18
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 6,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.6.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 90,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\nif docker_tag_exists oxsecurity/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker buildx build --platform linux/amd64 --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} --load . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "DOCKER_BUILD_PLATFORMS": "linux/amd64",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker buildx build --platform linux/amd64 --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} --load . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "DOCKER_BUILD_PLATFORMS": "linux/amd64",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.6.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-01-07T23-25-10Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7c06d8e7-af27-5a75-adb2-a366ccec4767",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2023-01-07T23-25-10Z__43d026138c7e2d2670e7255c8b2eb8912a558c14.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 235,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-01-07T23-25-10Z__43d026138c7e2d2670e7255c8b2eb8912a558c14.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 235,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 18
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 18
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 6,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.6.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Build image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "shell": "bash",
                "run": "function docker_tag_exists() {\n    echo \"Checking existence of https://hub.docker.com/v2/repositories/$1/tags/$2\"\n    curl --silent -f -lSL https://hub.docker.com/v2/repositories/$1/tags/$2 > /dev/null\n}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\nif docker_tag_exists oxsecurity/megalinter ${{steps.image_tag.outputs.tag}}; then\n   MEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\"\n   echo \"Reusing previously built image as base for quick build: ${MEGA_LINTER_BASE_IMAGE}\"\nfi\ndocker buildx build --platform linux/amd64 --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --build-arg \"MEGALINTER_BASE_IMAGE=${MEGA_LINTER_BASE_IMAGE}\" --no-cache -f \"Dockerfile-quick\" -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} --load . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;\n",
                "timeout-minutes": 60
              },
              {
                "name": "Push quickly built image",
                "if": "contains(github.event.head_commit.message, 'quick build push')",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile-quick",
                  "DOCKER_BUILD_PLATFORMS": "linux/amd64",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh || true"
              },
              {
                "name": "Build image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "shell": "bash",
                "run": "docker buildx build --platform linux/amd64 --build-arg \"BUILD_DATE=${BUILD_DATE}\" --build-arg \"BUILD_REVISION=${GITHUB_SHA}\" --build-arg \"BUILD_VERSION=${GITHUB_SHA}\" --no-cache -t oxsecurity/megalinter:${{steps.image_tag.outputs.tag}} --load . | while read line ; do echo \"$(date +'%H:%M:%S')| $line\"; done;",
                "timeout-minutes": 90
              },
              {
                "name": "Build image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "env": {
                  "DOCKER_USERNAME": "${{ secrets.DOCKER_USERNAME }}",
                  "DOCKER_PASSWORD": "${{ secrets.DOCKER_PASSWORD }}",
                  "IMAGE_REPO": "oxsecurity/megalinter",
                  "IMAGE_VERSION": "${{steps.image_tag.outputs.tag}}",
                  "DOCKERFILE_PATH": "Dockerfile",
                  "DOCKER_BUILD_PLATFORMS": "linux/amd64",
                  "REGISTRY": "Docker"
                },
                "shell": "bash",
                "run": ".automation/upload-docker.sh"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.6.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-02-15T06-25-47Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a8c43913-b14e-5a7c-ade2-4e8eeaf9e75a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2023-02-15T06-25-47Z__4077c46fa38e46d18100814d5933a0d43f95f4f6.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 256,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-02-15T06-25-47Z__4077c46fa38e46d18100814d5933a0d43f95f4f6.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 256,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 20
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 20
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 12,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.6.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/build-push-action@v4",
              "docker/login-action@v2",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Login to Docker Hub",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n",
                "uses": "docker/login-action@v2",
                "with": {
                  "username": "${{ secrets.DOCKER_USERNAME }}",
                  "password": "${{ secrets.DOCKER_PASSWORD }}"
                }
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n"
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.6.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-02-11T02-47-43Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-29550f76-882a-59b3-872d-a4d409d278a9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2023-02-11T02-47-43Z__2c78dd027b67e246a1ea7aeb3070246c6a2eed49.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 256,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-02-11T02-47-43Z__2c78dd027b67e246a1ea7aeb3070246c6a2eed49.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 256,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 20
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 20
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 12,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.6.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/build-push-action@v3",
              "docker/login-action@v2",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Login to Docker Hub",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n",
                "uses": "docker/login-action@v2",
                "with": {
                  "username": "${{ secrets.DOCKER_USERNAME }}",
                  "password": "${{ secrets.DOCKER_PASSWORD }}"
                }
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v3",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v3",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v3",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n"
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.6.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-02-19T20-35-01Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-43e93915-a705-54ea-87e7-8560d91cb5e7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2023-02-19T20-35-01Z__619de885cc96d59c5e9d68326b5ad0fe654ec08f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 46,
                  "startColumn": 5,
                  "endLine": 265,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-02-19T20-35-01Z__619de885cc96d59c5e9d68326b5ad0fe654ec08f.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 265,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 20
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 20
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 12,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.6.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/build-push-action@v4",
              "docker/login-action@v2",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Login to Docker Hub",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n",
                "uses": "docker/login-action@v2",
                "with": {
                  "username": "${{ secrets.DOCKER_USERNAME }}",
                  "password": "${{ secrets.DOCKER_PASSWORD }}"
                }
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n"
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.6.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-02-15T20-14-25Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7e9db631-c9fc-54c1-9ecf-63c30d1cc721",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2023-02-15T20-14-25Z__c0af37a4fbf009a03f05cf675283a3bc31fd07de.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 5,
                  "endLine": 256,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-02-15T20-14-25Z__c0af37a4fbf009a03f05cf675283a3bc31fd07de.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 256,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 20
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 20
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 12,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.6.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/build-push-action@v4",
              "docker/login-action@v2",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ]
          },
          "pull_request": {
            "branches-ignore": []
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Login to Docker Hub",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n",
                "uses": "docker/login-action@v2",
                "with": {
                  "username": "${{ secrets.DOCKER_USERNAME }}",
                  "password": "${{ secrets.DOCKER_PASSWORD }}"
                }
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n"
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${GITHUB_SHA} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.6.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-02-20T04-45-44Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-966a5800-cefd-54b9-986b-0ab51332adb6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2023-02-20T04-45-44Z__e90b3452049a19fa23a8a75d68c8089402cfcd9b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 46,
                  "startColumn": 5,
                  "endLine": 265,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-02-20T04-45-44Z__e90b3452049a19fa23a8a75d68c8089402cfcd9b.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 265,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 20
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 20
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 12,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.6.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/build-push-action@v4",
              "docker/login-action@v2",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${GITHUB_ACTOR}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Login to Docker Hub",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n",
                "uses": "docker/login-action@v2",
                "with": {
                  "username": "${{ secrets.DOCKER_USERNAME }}",
                  "password": "${{ secrets.DOCKER_PASSWORD }}"
                }
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n"
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "export CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{github.event.head_commit.message}}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{github.event.head_commit.message}}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${GITHUB_SHA} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${GITHUB_SHA} -e GITHUB_REF_NAME=${GITHUB_REF_NAME} -e PAT=\"${{secrets.PAT}}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{github.repository}}\" -e GITHUB_SHA=\"${{github.sha}}\" -e GITHUB_TOKEN=\"${{github.token}}\" -e GITHUB_RUN_ID=\"${{github.run_id}}\" -e PAT=\"${{secrets.PAT}}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.6.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{steps.image_tag.outputs.tag}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{steps.image_tag.outputs.tag}}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-02-26T00-23-18Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-b579beb6-7004-551b-9e29-04e743665201",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2023-02-26T00-23-18Z__497b09ac27bc6c734b6d0430b9b709c8e3e25b17.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 46,
                  "startColumn": 5,
                  "endLine": 269,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-02-26T00-23-18Z__497b09ac27bc6c734b6d0430b9b709c8e3e25b17.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 269,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 20
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 20
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 12,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.6.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/build-push-action@v4",
              "docker/login-action@v2",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Login to Docker Hub",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n",
                "uses": "docker/login-action@v2",
                "with": {
                  "username": "${{ secrets.DOCKER_USERNAME }}",
                  "password": "${{ secrets.DOCKER_PASSWORD }}"
                }
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\n\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e PAT=\"${{ secrets.PAT }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e PAT=\"${{ secrets.PAT }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.6.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-03-27T18-31-33Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c9a53a93-e31d-5794-8b75-f15858504ba0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2023-03-27T18-31-33Z__85aceceafb65c05740cfcae982f50ff8e386ddcc.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 52,
                  "startColumn": 5,
                  "endLine": 275,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-03-27T18-31-33Z__85aceceafb65c05740cfcae982f50ff8e386ddcc.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 275,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 20
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 20
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 12,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.6.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/build-push-action@v4",
              "docker/login-action@v2",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Login to Docker Hub",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n",
                "uses": "docker/login-action@v2",
                "with": {
                  "username": "${{ secrets.DOCKER_USERNAME }}",
                  "password": "${{ secrets.DOCKER_PASSWORD }}"
                }
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\n\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e PAT=\"${{ secrets.PAT }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e PAT=\"${{ secrets.PAT }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.6.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-02-26T20-32-34Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0996c809-e703-5073-a845-805f4a698495",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2023-02-26T20-32-34Z__7e091b730869efc4630b30425d4a62a536c5444a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 52,
                  "startColumn": 5,
                  "endLine": 275,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-02-26T20-32-34Z__7e091b730869efc4630b30425d4a62a536c5444a.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 275,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 20
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 20
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 12,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.6.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/build-push-action@v4",
              "docker/login-action@v2",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Login to Docker Hub",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n",
                "uses": "docker/login-action@v2",
                "with": {
                  "username": "${{ secrets.DOCKER_USERNAME }}",
                  "password": "${{ secrets.DOCKER_PASSWORD }}"
                }
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ github.sha }}\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\n\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e PAT=\"${{ secrets.PAT }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e PAT=\"${{ secrets.PAT }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.6.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "10m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-03-28T06-33-37Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c30dbdd0-d9cc-5156-b102-9b87d1ccd21f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2023-03-28T06-33-37Z__816d5b6f9b8e381179e760228c255092448a4a41.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 52,
                  "startColumn": 5,
                  "endLine": 275,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-03-28T06-33-37Z__816d5b6f9b8e381179e760228c255092448a4a41.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 275,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 20
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 20
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 12,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.6.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/build-push-action@v4",
              "docker/login-action@v2",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Login to Docker Hub",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n",
                "uses": "docker/login-action@v2",
                "with": {
                  "username": "${{ secrets.DOCKER_USERNAME }}",
                  "password": "${{ secrets.DOCKER_PASSWORD }}"
                }
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\n\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e PAT=\"${{ secrets.PAT }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e PAT=\"${{ secrets.PAT }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.6.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "security-checks": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "15m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-04-08T21-01-38Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-29abbbaf-baab-5181-8f03-7d9b6ecd4c48",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2023-04-08T21-01-38Z__4363d267fb9af1b08e9e82fb0f3aa965cd53a4bd.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 52,
                  "startColumn": 5,
                  "endLine": 275,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-04-08T21-01-38Z__4363d267fb9af1b08e9e82fb0f3aa965cd53a4bd.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 275,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 20
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 20
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 12,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.6.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/build-push-action@v4",
              "docker/login-action@v2",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Login to Docker Hub",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n",
                "uses": "docker/login-action@v2",
                "with": {
                  "username": "${{ secrets.DOCKER_USERNAME }}",
                  "password": "${{ secrets.DOCKER_PASSWORD }}"
                }
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\n\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e PAT=\"${{ secrets.PAT }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 60
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e PAT=\"${{ secrets.PAT }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.6.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "scanners": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "15m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-05-12T04-36-20Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-40741027-681c-5353-89d0-2f8916adec76",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2023-05-12T04-36-20Z__6b59e36bd1b0ae80e03c48b75d61572b314887b9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 52,
                  "startColumn": 5,
                  "endLine": 275,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-05-12T04-36-20Z__6b59e36bd1b0ae80e03c48b75d61572b314887b9.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 275,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 20
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 20
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 12,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.6.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/build-push-action@v4",
              "docker/login-action@v2",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 10,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Login to Docker Hub",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n",
                "uses": "docker/login-action@v2",
                "with": {
                  "username": "${{ secrets.DOCKER_USERNAME }}",
                  "password": "${{ secrets.DOCKER_PASSWORD }}"
                }
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": false,
                  "push": true,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\n\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e PAT=\"${{ secrets.PAT }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e PAT=\"${{ secrets.PAT }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.6.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "scanners": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "15m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-05-14T18-25-04Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e344f28e-695c-5743-af1e-48984bceb3ac",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/deploy-DEV__2023-05-14T18-25-04Z__e8e1e785597da0d400b493ede8895ff74c127218.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 52,
                  "startColumn": 5,
                  "endLine": 264,
                  "endColumn": 26
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "56b7cce3a86e1f2f:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-05-14T18-25-04Z__e8e1e785597da0d400b493ede8895ff74c127218.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 264,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 19
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 19
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 11,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.6.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/build-push-action@v4",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\n\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e PAT=\"${{ secrets.PAT }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e PAT=\"${{ secrets.PAT }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.6.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "scanners": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "15m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-05-18T14-54-57Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-05-18T14-54-57Z__b742d7619d9d26eecd4ea0eba880eb615a20ea59.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 265,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 19
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 19
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 11,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.6.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/build-push-action@v4",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\n\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.6.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "scanners": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "15m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-07-03T06-48-28Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-07-03T06-48-28Z__adef76f094305f0c987902d4008a20bff252c119.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 265,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 19
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 19
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 11,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.6.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/build-push-action@v4",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.6.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "scanners": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "15m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-07-10T12-00-35Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-07-10T12-00-35Z__7ed48a62301e56ca49bb5304353977209bbb1f07.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 265,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 19
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 19
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 11,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.7.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/build-push-action@v4",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.7.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "scanners": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "15m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-07-24T08-42-32Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-07-24T08-42-32Z__b6529477d484015a19b5c54bcd7cc96801550e92.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 275,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 21
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 21
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 11,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.7.0",
              "actions/upload-artifact@v3",
              "aquasecurity/trivy-action@master",
              "docker/build-push-action@v4",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 10,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Clean docker build cache",
                "run": "docker builder prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.7.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              },
              {
                "name": "free disk space",
                "run": "sudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Run Trivy vulnerability scanner",
                "uses": "aquasecurity/trivy-action@master",
                "with": {
                  "image-ref": "docker.io/oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                  "format": "table",
                  "exit-code": "1",
                  "ignore-unfixed": true,
                  "scanners": "vuln",
                  "vuln-type": "os,library",
                  "severity": "CRITICAL,HIGH",
                  "timeout": "15m0s"
                }
              }
            ]
          }
        }
      }
    },
    "2023-07-24T08-44-14Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-07-24T08-44-14Z__e28d4f50926d7374a9cb5488f6e7698e8fbb82dd.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 275,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 19
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 19
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 10,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.7.0",
              "actions/upload-artifact@v3",
              "docker/build-push-action@v4",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 9,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Clean docker build cache",
                "run": "docker builder prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.7.0",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2023-08-21T21-07-54Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-08-21T21-07-54Z__44e95228e1ce7268a042ab14a418460ab04c585a.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 275,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 19
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 19
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 10,
            "actions_used": [
              "actions/checkout@v3",
              "actions/setup-node@v3.8.1",
              "actions/upload-artifact@v3",
              "docker/build-push-action@v4",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 9,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Clean docker build cache",
                "run": "docker builder prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.8.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2023-09-05T20-54-53Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-09-05T20-54-53Z__095a05ab3b32d722b8805a3ab963d9920b35b1dd.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 275,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 19
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 19
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 10,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v3.8.1",
              "actions/upload-artifact@v3",
              "docker/build-push-action@v4",
              "docker/setup-buildx-action@v2",
              "docker/setup-qemu-action@v2"
            ],
            "num_run_commands": 9,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v2"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v2"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v4",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Clean docker build cache",
                "run": "docker builder prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.8.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2023-09-17T18-04-51Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-09-17T18-04-51Z__69a8a8e2d6adfa0dcc3986658dcdd787e5e5cc49.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 275,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 19
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 19
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 10,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v3.8.1",
              "actions/upload-artifact@v3",
              "docker/build-push-action@v5",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 9,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Clean docker build cache",
                "run": "docker builder prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.8.1",
                "with": {
                  "node-version": "12"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2023-10-02T09-39-32Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-10-02T09-39-32Z__77d4b162bf09a3be5de22909508666b1e8ddd8fe.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 275,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 19
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 19
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 10,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v3.8.1",
              "actions/upload-artifact@v3",
              "docker/build-push-action@v5",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 9,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Clean docker build cache",
                "run": "docker builder prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.8.1",
                "with": {
                  "node-version": "16"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2023-10-15T15-57-09Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-10-15T15-57-09Z__d70d63ea6d2152468713c898de34c9c562d6acda.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 284,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 20
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 20
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 10,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v3.8.1",
              "actions/upload-artifact@v3",
              "docker/build-push-action@v5",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 10,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Clean docker build cache",
                "run": "docker builder prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.8.1",
                "with": {
                  "node-version": "16"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2023-10-28T16-29-07Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-10-28T16-29-07Z__4b1a686519139764739af114742cba586acc6ae4.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 284,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 20
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 20
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 10,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v3.8.1",
              "actions/upload-artifact@v3",
              "docker/build-push-action@v5",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 10,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Clean docker build cache",
                "run": "docker builder prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.8.1",
                "with": {
                  "node-version": "18.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2023-11-18T23-42-32Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-11-18T23-42-32Z__55f2d6fea56eb46e5c6de49d69497be35ab1e690.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 284,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 20
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 20
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 10,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v3.8.1",
              "actions/upload-artifact@v3",
              "docker/build-push-action@v5",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 10,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "${{ success() }} || ${{ failure() }}",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "${{ success() }} || ${{ failure() }}",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.8.1",
                "with": {
                  "node-version": "18.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2023-11-19T10-58-48Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-11-19T10-58-48Z__a14d9b9cf095820dff5afb90bff332972252abb5.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 284,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 20
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 20
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 10,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v3.8.1",
              "actions/upload-artifact@v3",
              "docker/build-push-action@v5",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 10,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v3",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.8.1",
                "with": {
                  "node-version": "18.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2023-12-16T16-53-19Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-12-16T16-53-19Z__c98babfd729380f24c9d24bc93c21464277ad12b.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 284,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 20
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 20
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 10,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v3.8.1",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v5",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 10,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Get current date",
                "run": "echo \"BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" >>\"$GITHUB_ENV\""
              },
              {
                "name": "Build image tag name",
                "id": "image_tag",
                "run": "BRANCH_NAME=\"${GITHUB_REF##*/}\"\nTAG=\"test-${{ github.actor }}-${BRANCH_NAME}\"\necho \"Tag name: ${TAG}\"\necho \"tag=${TAG}\" >>\"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ env.BUILD_DATE }}\nBUILD_REVISION=${{ github.sha }}\nBUILD_VERSION=${{ steps.image_tag.outputs.tag }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint oxsecurity/megalinter:${{ steps.image_tag.outputs.tag }}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.8.1",
                "with": {
                  "node-version": "18.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ steps.image_tag.outputs.tag }} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2023-12-28T13-45-38Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2023-12-28T13-45-38Z__fc58836ca042cbbd96286c33a2d292f4d9d1a9d3.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 259,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v3.8.1",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v5",
              "docker/metadata-action@v5.3.0",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.3.0",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v3.8.1",
                "with": {
                  "node-version": "18.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-01-03T03-23-40Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-01-03T03-23-40Z__872bd1f7c3bc903f06246baac44c0ca82bbca966.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 259,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.0.1",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v5",
              "docker/metadata-action@v5.3.0",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.3.0",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.0.1",
                "with": {
                  "node-version": "18.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-01-03T12-42-42Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-01-03T12-42-42Z__cdbb60fe8f98e8ee8770ce0241645e5c732b9ef7.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 259,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.0.1",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v5",
              "docker/metadata-action@v5.4.0",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.4.0",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.0.1",
                "with": {
                  "node-version": "18.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-01-08T01-01-50Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-01-08T01-01-50Z__14c6c57470eccba394ae0113854a6fc747a5be28.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 259,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.0.1",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v5",
              "docker/metadata-action@v5.5.0",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.5.0",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\n"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.0.1",
                "with": {
                  "node-version": "18.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-02-06T06-50-49Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-02-06T06-50-49Z__ce438e86005f4a82df0d8f724f3968d0134f742a.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 261,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.0.1",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v5",
              "docker/metadata-action@v5.5.0",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.5.0",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.0.1",
                "with": {
                  "node-version": "18.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-02-07T21-16-32Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-02-07T21-16-32Z__c8f1d86e84f2839a20860cc8eba8708c5b8ac5c6.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 261,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.0.2",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v5",
              "docker/metadata-action@v5.5.0",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.5.0",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.0.2",
                "with": {
                  "node-version": "18.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-02-07T21-18-46Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-02-07T21-18-46Z__36b8ba23c92057d5065bdbfb76d4d3f78ca31e2c.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 261,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.0.2",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v5",
              "docker/metadata-action@v5.5.1",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.5.1",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.0.2",
                "with": {
                  "node-version": "18.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-04-16T10-27-57Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-04-16T10-27-57Z__85c5718689a1666d9c3ea68e7011ee910ba1396e.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 263,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.0.2",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v5",
              "docker/metadata-action@v5.5.1",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.5.1",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v5",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.0.2",
                "with": {
                  "node-version": "18.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-06-19T20-54-17Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-06-19T20-54-17Z__3d9852ee8c6fb0cb89487f096021b5b678972a7e.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 263,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.0.2",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.5.1",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.5.1",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.0.2",
                "with": {
                  "node-version": "18.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-07-15T08-40-51Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-07-15T08-40-51Z__b5066c9de8259083c6d9b87708784c097f131a99.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 263,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.0.3",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.5.1",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.5.1",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "contains(github.event.head_commit.message, 'quick build')",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.0.3",
                "with": {
                  "node-version": "18.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-08-11T20-07-03Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-08-11T20-07-03Z__7287aab76b085f9e32fc55f41c19fd8f02ba239d.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 259,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.0.3",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.5.1",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": {
            "branches-ignore": [],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          }
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.5.1",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.0.3",
                "with": {
                  "node-version": "18.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-08-18T16-35-28Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-08-18T16-35-28Z__b1c541f5c6d48c12905fed5050f6994fedee0ccf.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 251,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.0.3",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.5.1",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.5.1",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.0.3",
                "with": {
                  "node-version": "18.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-08-18T22-32-21Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-08-18T22-32-21Z__9c8241306aeec749d1e0a1452fe561ec754d98a9.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 251,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.0.3",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.5.1",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.5.1",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.0.3",
                "with": {
                  "node-version": "20.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && sudo yarn install --frozen-lockfile && sudo npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-08-19T04-38-21Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-08-19T04-38-21Z__978afeb7c201be84807901c43e3ddfdd3378d170.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 251,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.0.3",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.5.1",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.5.1",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.0.3",
                "with": {
                  "node-version": "20.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-09-21T11-55-05Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-09-21T11-55-05Z__5e31716bf084b9243c682105423a9d704f190adb.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 251,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.0.4",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.5.1",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.5.1",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.0.4",
                "with": {
                  "node-version": "20.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-10-13T01-45-28Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-10-13T01-45-28Z__0a4ce21eaaa37a2d6fcdf6827359ea08a412fe7e.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 251,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.0.4",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.5.1",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.5.1",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.0.4",
                "with": {
                  "node-version": "20.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-10-20T15-30-58Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-10-20T15-30-58Z__e13ac875b386086bf6f8ed2b2b6921a903b935be.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 254,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.0.4",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.5.1",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.5.1",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n--squash  # Enable image squashing to produce a single-layer image\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n--squash  # Enable image squashing to produce a single-layer image\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n--squash  # Enable image squashing to produce a single-layer image\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.0.4",
                "with": {
                  "node-version": "20.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-10-25T17-27-31Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-10-25T17-27-31Z__c2c877b58c629deb138e97b83575a45f90ea61af.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 254,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.1.0",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.5.1",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.5.1",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n--squash  # Enable image squashing to produce a single-layer image\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n--squash  # Enable image squashing to produce a single-layer image\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n--squash  # Enable image squashing to produce a single-layer image\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.1.0",
                "with": {
                  "node-version": "20.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-11-10T19-27-36Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-11-10T19-27-36Z__df3d6c0f7131ccb45bf92265a3de485c71b37585.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 251,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.1.0",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.5.1",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.5.1",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.1.0",
                "with": {
                  "node-version": "20.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2024-11-20T06-47-48Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2024-11-20T06-47-48Z__687dcbf74d738a5bbb2d47375eb28f1252b4daa9.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 251,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.1.0",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.6.1",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.6.1",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.1.0",
                "with": {
                  "node-version": "20.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2025-01-26T15-30-04Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2025-01-26T15-30-04Z__2704fea9031fe173f9b3b79b8608db69eda6d3f8.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 252,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.1.0",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.6.1",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.6.1",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "include-hidden-files": "true",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.1.0",
                "with": {
                  "node-version": "20.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2025-01-28T01-11-11Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2025-01-28T01-11-11Z__298e5bffe2dfab474726870344562ffba7686bce.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 252,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.2.0",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.6.1",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.6.1",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "include-hidden-files": "true",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.2.0",
                "with": {
                  "node-version": "20.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2025-02-27T18-28-39Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2025-02-27T18-28-39Z__4c1cb1fdbb7c15dc1902f3cf311a7712ba310a27.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 252,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.2.0",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.7.0",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.7.0",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "include-hidden-files": "true",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.2.0",
                "with": {
                  "node-version": "20.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2025-03-21T20-04-20Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2025-03-21T20-04-20Z__e377ecf3af149b8a46bae899a24c043f4d7c65c9.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 252,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.3.0",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.7.0",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.7.0",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "include-hidden-files": "true",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.3.0",
                "with": {
                  "node-version": "20.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2025-03-22T22-34-52Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2025-03-22T22-34-52Z__3d5e4bf89325febb9de2ef215ae7472fcebe9c12.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 252,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.3.0",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.7.0",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.7.0",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "include-hidden-files": "true",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.3.0",
                "with": {
                  "node-version": "22.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2025-04-15T02-18-58Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2025-04-15T02-18-58Z__4a9912eeb06a52b11b70e01fb7e317a4142deb6e.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 252,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.4.0",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.7.0",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.7.0",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "include-hidden-files": "true",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.4.0",
                "with": {
                  "node-version": "22.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2025-07-17T14-46-08Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2025-07-17T14-46-08Z__84742173a1a8af95399a4c16d8a4e9350da43fd2.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 249,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.4.0",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.7.0",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.7.0",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "include-hidden-files": "true",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.4.0",
                "with": {
                  "node-version": "22.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2025-08-04T09-48-06Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2025-08-04T09-48-06Z__4704b6470a7008aa2243bc0535390020ee3e3b96.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 249,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v4",
              "actions/setup-node@v4.4.0",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.8.0",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v4",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.8.0",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "include-hidden-files": "true",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.4.0",
                "with": {
                  "node-version": "22.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2025-08-20T22-37-32Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2025-08-20T22-37-32Z__a5461f6fd3e9c94a26ddd138918d957b229cb7f3.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 249,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v5",
              "actions/setup-node@v4.4.0",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.8.0",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v5",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.8.0",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "include-hidden-files": "true",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v4.4.0",
                "with": {
                  "node-version": "22.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2025-09-07T12-49-44Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2025-09-07T12-49-44Z__f54d209fb84c390a837e1b05f3dca4ad48cec2f8.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 249,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v5",
              "actions/setup-node@v5.0.0",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.8.0",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v5",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.8.0",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${{ github.event.head_commit.message }}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  COMMIT_MSG=\"${{ github.event.head_commit.message }}\"\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "include-hidden-files": "true",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v5.0.0",
                "with": {
                  "node-version": "22.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2025-09-07T16-57-05Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2025-09-07T16-57-05Z__388fa446ea48fb09626ead02380fa238161f0d60.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 250,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v5",
              "actions/setup-node@v5.0.0",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.8.0",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v5",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.8.0",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${COMMIT_MSG}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 90,
                "env": {
                  "COMMIT_MSG": "${{ github.event.head_commit.message }}"
                }
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "include-hidden-files": "true",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v5.0.0",
                "with": {
                  "node-version": "22.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    },
    "2025-09-13T20-27-03Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "deploy-DEV__2025-09-13T20-27-03Z__aaf1050b397f64485717da896dda799dae9e2816.yml",
          "workflow_name": "Build & Deploy - DEV",
          "triggers": {},
          "permissions": null,
          "concurrency": {
            "group": "${{ github.ref_name }}-${{ github.workflow }}",
            "cancel-in-progress": true
          },
          "defaults": null,
          "line_count": 250,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 17
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 17
            },
            "jobs_with_timeout": 1,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 9,
            "actions_used": [
              "actions/checkout@v5",
              "actions/setup-node@v5.0.0",
              "actions/upload-artifact@v4",
              "docker/build-push-action@v6",
              "docker/metadata-action@v5.8.0",
              "docker/setup-buildx-action@v3",
              "docker/setup-qemu-action@v3"
            ],
            "num_run_commands": 8,
            "steps_with_conditionals": 9,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build & Deploy - DEV",
        "true": {
          "push": {
            "branches-ignore": [
              "main"
            ],
            "paths-ignore": [
              ".github/CONTRIBUTING.md",
              "CHANGELOG.md",
              "README.md",
              ".github/workflows/slash-command-dispatch.yml",
              ".github/workflows/help-command.yml",
              ".github/workflows/build-command.yml"
            ]
          },
          "pull_request": null
        },
        "concurrency": {
          "group": "${{ github.ref_name }}-${{ github.workflow }}",
          "cancel-in-progress": true
        },
        "jobs": {
          "build": {
            "name": "Tests + Deploy Docker Image - DEV",
            "runs-on": "ubuntu-latest",
            "permissions": "read-all",
            "if": "(github.event_name == 'push' || github.event.pull_request.head.repo.full_name != github.repository) && !contains(github.event.head_commit.message, 'skip deploy')",
            "timeout-minutes": 120,
            "steps": [
              {
                "name": "Checkout Code",
                "uses": "actions/checkout@v5",
                "with": {
                  "fetch-depth": 0
                }
              },
              {
                "name": "Free Disk space",
                "shell": "bash",
                "run": "sudo rm -rf /usr/local/lib/android  # will release about 10 GB if you don't need Android\nsudo rm -rf /usr/share/dotnet # will release about 20GB if you don't need .NET\nsudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\n"
              },
              {
                "name": "Docker Metadata action",
                "uses": "docker/metadata-action@v5.8.0",
                "id": "meta",
                "with": {
                  "images": "${{ github.repository }}\n"
                }
              },
              {
                "name": "Set up QEMU",
                "uses": "docker/setup-qemu-action@v3"
              },
              {
                "name": "Set up Docker Buildx",
                "uses": "docker/setup-buildx-action@v3"
              },
              {
                "name": "Build MegaLinter Docker Image (quick)",
                "if": "${{ contains(github.event.head_commit.message, 'quick build') }}",
                "id": "docker_build_quick",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile-quick",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\nMEGA_LINTER_BASE_IMAGE=\"oxsecurity/megalinter:beta\"\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from forks)",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) ||\n(github.event_name == 'push' && github.repository != 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "id": "docker_build",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                },
                "timeout-minutes": 90
              },
              {
                "name": "Build MegaLinter Docker Image (full from main repo) & push",
                "if": "(\n(github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository) ||\n(github.event_name == 'push' && github.repository == 'oxsecurity/megalinter')\n)\n&&\n!contains(github.event.head_commit.message, 'quick build')\n",
                "uses": "docker/build-push-action@v6",
                "with": {
                  "context": ".",
                  "file": "Dockerfile",
                  "platforms": "linux/amd64",
                  "build-args": "BUILD_DATE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.created'] }}\nBUILD_VERSION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}\nBUILD_REVISION=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.revision'] }}\n",
                  "load": true,
                  "push": false,
                  "secrets": "GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }}\n",
                  "tags": "${{ steps.meta.outputs.tags }}"
                }
              },
              {
                "name": "Clean docker buildx cache",
                "run": "docker buildx prune --force"
              },
              {
                "name": "Run Test Cases",
                "shell": "bash",
                "run": "GITHUB_REPOSITORY=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.event.pull_request.head.repo.full_name }}\" || echo \"${{ github.repository }}\")\nGITHUB_BRANCH=$([ \"${{ github.event_name }}\" == \"pull_request\" ] && echo \"${{ github.head_ref }}\" || echo \"${{ github.ref_name }}\")\n\nexport CI_ENV=\"$(bash <(curl -s https://codecov.io/env)) -e GITHUB_ACTIONS\"\nTEST_KEYWORDS_TO_USE=\"\"\nif [[ \"${COMMIT_MSG}\" == *\"TEST_KEYWORDS=\"* ]]; then\n  TEST_KEYWORDS_TO_USE=${COMMIT_MSG#*TEST_KEYWORDS=}\n  echo \"Run only tests with keywords ${TEST_KEYWORDS_TO_USE}\"\n  if [[ \"${TEST_KEYWORDS_TO_USE}\" =~ $'\\r' ]]; then\n      echo \"Problem while parsing test keywords: switch back to all tests\"\n      TEST_KEYWORDS_TO_USE=\"\"\n  fi\nfi\ndocker image ls\ndocker run $CI_ENV -e TEST_CASE_RUN=true -e OUTPUT_FORMAT=text -e OUTPUT_FOLDER=${{ github.sha }} -e OUTPUT_DETAIL=detailed -e GITHUB_SHA=${{ github.sha }} -e GITHUB_REPOSITORY=${GITHUB_REPOSITORY} -e GITHUB_BRANCH=${GITHUB_BRANCH} -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -e TEST_KEYWORDS=\"${TEST_KEYWORDS_TO_USE}\" -e MEGALINTER_VOLUME_ROOT=\"${GITHUB_WORKSPACE}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}\n",
                "timeout-minutes": 120,
                "env": {
                  "COMMIT_MSG": "${{ github.event.head_commit.message }}"
                }
              },
              {
                "name": "Run against all code base",
                "if": "!contains(github.event.head_commit.message, 'quick build')",
                "shell": "bash",
                "run": "docker run -e GITHUB_REPOSITORY=\"${{ github.repository }}\" -e GITHUB_SHA=\"${{ github.sha }}\" -e GITHUB_TOKEN=\"${{ github.token }}\" -e GITHUB_RUN_ID=\"${{ github.run_id }}\" -e GITHUB_TOKEN=\"${{ secrets.GITHUB_TOKEN }}\" -v \"/var/run/docker.sock:/var/run/docker.sock:rw\" -v ${GITHUB_WORKSPACE}:/tmp/lint ${{ fromJson(steps.meta.outputs.json).tags[0]}}",
                "timeout-minutes": 15
              },
              {
                "name": "Archive production artifacts",
                "if": "success() || failure()",
                "uses": "actions/upload-artifact@v4",
                "with": {
                  "name": "MegaLinter reports",
                  "include-hidden-files": "true",
                  "path": "megalinter-reports\nmega-linter.log\nlinter-helps.json\nlinter-versions.json\n"
                }
              },
              {
                "name": "debug",
                "if": "success() || failure()",
                "run": "echo ${{ steps.docker_build.outcome }}"
              },
              {
                "name": "Clear disk space",
                "run": "sudo rm -rf /opt/ghc\nsudo rm -rf \"$AGENT_TOOLSDIRECTORY\"\nsudo swapoff -a || true\nsudo rm -f /swapfile || true\nsudo apt clean || true\n"
              },
              {
                "name": "Setup Node",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "uses": "actions/setup-node@v5.0.0",
                "with": {
                  "node-version": "22.x"
                }
              },
              {
                "name": "Install NPM dependencies",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && yarn install --frozen-lockfile && npm link"
              },
              {
                "name": "Run mega-linter-runner tests",
                "if": "${{ steps.docker_build.outcome }} == 'success' && !contains(github.event.head_commit.message, 'quick build')",
                "run": "cd mega-linter-runner && MEGALINTER_RELEASE=${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }} MEGALINTER_IMAGE=${{ fromJson(steps.meta.outputs.json).tags[0]}} MEGALINTER_NO_DOCKER_PULL=true npm run test"
              }
            ]
          }
        }
      }
    }
  }
}