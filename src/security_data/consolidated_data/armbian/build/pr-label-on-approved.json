{
  "repo_owner": "armbian",
  "repo_name": "build",
  "workflow_name": "pr-label-on-approved",
  "history": {
    "2024-10-25T20-37-15Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-54ba67c8-77d3-5586-86b6-eabd5539efee",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/pr-label-on-approved__2024-10-25T20-37-15Z__01c83b46390c4d51a7a22670a3c617bb336cf164.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 5,
                  "startColumn": 5,
                  "endLine": 14,
                  "endColumn": 40
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "b73e953c03042fa2:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "pr-label-on-approved__2024-10-25T20-37-15Z__01c83b46390c4d51a7a22670a3c617bb336cf164.yml",
          "workflow_name": "Label approved pull requests",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 14,
          "num_jobs": 1,
          "steps_per_job": {
            "labelWhenApproved": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "labelWhenApproved": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "pullreminders/label-when-approved-action@master"
            ],
            "num_run_commands": 0,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": "pull_request_review",
        "name": "Label approved pull requests",
        "jobs": {
          "labelWhenApproved": {
            "name": "Label when approved",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Label when approved",
                "uses": "pullreminders/label-when-approved-action@master",
                "env": {
                  "APPROVALS": "1",
                  "GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}",
                  "ADD_LABEL": "Ready to merge",
                  "REMOVE_LABEL": "Needs%20review"
                }
              }
            ]
          }
        }
      }
    },
    "2024-11-01T07-27-49Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3c69d386-d555-59f1-a9b7-52e38d2cf446",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/pr-label-on-approved__2024-11-01T07-27-49Z__d355c17dc3b7f3349d1dfe919df9bc40b25e4ed3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 5,
                  "startColumn": 5,
                  "endLine": 15,
                  "endColumn": 40
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "de47b73077d4dd4:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "pr-label-on-approved__2024-11-01T07-27-49Z__d355c17dc3b7f3349d1dfe919df9bc40b25e4ed3.yml",
          "workflow_name": "Label approved pull requests",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 15,
          "num_jobs": 1,
          "steps_per_job": {
            "labelWhenApproved": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "labelWhenApproved": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "pullreminders/label-when-approved-action@master"
            ],
            "num_run_commands": 0,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": "pull_request_target",
        "name": "Label approved pull requests",
        "jobs": {
          "labelWhenApproved": {
            "if": "github.event.review.state == 'approved'",
            "name": "Label when approved",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Label when approved",
                "uses": "pullreminders/label-when-approved-action@master",
                "env": {
                  "APPROVALS": "1",
                  "GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}",
                  "ADD_LABEL": "Ready to merge",
                  "REMOVE_LABEL": "Needs%20review"
                }
              }
            ]
          }
        }
      }
    },
    "2024-11-03T20-39-25Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1798bfd1-3207-5508-9e23-fe79bd915383",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/pr-label-on-approved__2024-11-03T20-39-25Z__52548e408aad1b47c150ee538366418c35df91bb.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 5,
                  "startColumn": 5,
                  "endLine": 15,
                  "endColumn": 40
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "7ab108abac2da1c:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "pr-label-on-approved__2024-11-03T20-39-25Z__52548e408aad1b47c150ee538366418c35df91bb.yml",
          "workflow_name": "Label approved pull requests",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 15,
          "num_jobs": 1,
          "steps_per_job": {
            "labelWhenApproved": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "labelWhenApproved": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "pullreminders/label-when-approved-action@master"
            ],
            "num_run_commands": 0,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": "pull_request_review",
        "name": "Label approved pull requests",
        "jobs": {
          "labelWhenApproved": {
            "if": "${{ github.repository_owner == 'armbian' }}",
            "name": "Label when approved",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Label when approved",
                "uses": "pullreminders/label-when-approved-action@master",
                "env": {
                  "APPROVALS": "1",
                  "GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}",
                  "ADD_LABEL": "Ready to merge",
                  "REMOVE_LABEL": "Needs%20review"
                }
              }
            ]
          }
        }
      }
    },
    "2025-09-13T11-53-41Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/code-injection/critical",
          "ruleIndex": 10,
          "kind": "fail",
          "level": "error",
          "correlationGuid": "workflow-5563adb3-94ce-5ff6-a580-ccac8eb02f6f",
          "message": {
            "text": "Potential code injection in [${{ steps.pr.outputs.number }}](1), which may be controlled by an external user ([workflow_run](2))."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/pr-label-on-approved__2025-09-13T11-53-41Z__29e30fa237c030b494c07e17116f41ce3ea730f0.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 44,
                  "startColumn": 34,
                  "endLine": null,
                  "endColumn": 64
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "92786c27781a67d0:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-094",
            "precision": "very-high",
            "security_severity": "9",
            "triage": "high"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "pr-label-on-approved__2025-09-13T11-53-41Z__29e30fa237c030b494c07e17116f41ce3ea730f0.yml",
          "workflow_name": "PR review labeler",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 53,
          "num_jobs": 1,
          "steps_per_job": {
            "label": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "label": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/download-artifact@v4",
              "actions/github-script@v7",
              "j-fulbright/label-when-approved-action@v1.2"
            ],
            "num_run_commands": 1,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "PR review labeler",
        "true": {
          "workflow_run": {
            "workflows": [
              "PR review listener"
            ],
            "types": [
              "completed"
            ]
          }
        },
        "jobs": {
          "label": {
            "if": "${{ github.event.workflow_run.conclusion == 'success' }}",
            "runs-on": "ubuntu-latest",
            "permissions": {
              "contents": "read",
              "issues": "write",
              "pull-requests": "write"
            },
            "steps": [
              {
                "name": "Download PR number artifact from upstream run",
                "uses": "actions/download-artifact@v4",
                "with": {
                  "name": "pr-number-${{ github.event.workflow_run.id }}",
                  "path": ".",
                  "run-id": "${{ github.event.workflow_run.id }}",
                  "github-token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "id": "pr",
                "run": "echo \"number=$(cat pr.txt)\" >> $GITHUB_OUTPUT"
              },
              {
                "name": "Label when approved",
                "uses": "j-fulbright/label-when-approved-action@v1.2",
                "with": {
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "label": "Ready to merge",
                  "require_committers_approval": "true",
                  "remove_label_when_approval_missing": "true",
                  "comment": "\u2705 This PR has been reviewed and approved \u2014 all set for merge!",
                  "pullRequestNumber": "${{ steps.pr.outputs.number }}"
                }
              },
              {
                "name": "Remove \"Needs review\" label",
                "if": "${{ success() }}",
                "uses": "actions/github-script@v7",
                "with": {
                  "script": "const { owner, repo } = context.repo;\nconst issue_number = ${{ steps.pr.outputs.number }};\ntry {\n  await github.rest.issues.removeLabel({\n    owner, repo, issue_number,\n    name: \"Needs review\"\n  });\n  core.info('Removed label \"Needs review\"');\n} catch (e) {\n  core.warning(`Could not remove label: ${e.message}`);\n}\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-09-14T11-44-47Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/code-injection/critical",
          "ruleIndex": 10,
          "kind": "fail",
          "level": "error",
          "correlationGuid": "workflow-425cd73c-0057-5a92-83b0-633966d87e17",
          "message": {
            "text": "Potential code injection in [${{ steps.pr.outputs.number }}](1), which may be controlled by an external user ([workflow_run](2))."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/pr-label-on-approved__2025-09-14T11-44-47Z__3bb8125be841c50db3e51dd57d060d58887cf45b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 44,
                  "startColumn": 34,
                  "endLine": null,
                  "endColumn": 64
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42da46ea0e4f16ee:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-094",
            "precision": "very-high",
            "security_severity": "9",
            "triage": "high"
          }
        },
        {
          "ruleId": "actions/code-injection/critical",
          "ruleIndex": 10,
          "kind": "fail",
          "level": "error",
          "correlationGuid": "workflow-3cf601c0-16bd-506e-85ef-efac561dce5c",
          "message": {
            "text": "Potential code injection in [${{ steps.pr.outputs.number }}](1), which may be controlled by an external user ([workflow_run](2))."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/pr-label-on-approved__2025-09-14T11-44-47Z__7995d2ac3fceda0acca3ea3ae442c960b391cbf9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 44,
                  "startColumn": 34,
                  "endLine": null,
                  "endColumn": 64
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42da46ea0e4f16bd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-094",
            "precision": "very-high",
            "security_severity": "9",
            "triage": "high"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "pr-label-on-approved__2025-09-14T11-44-47Z__7995d2ac3fceda0acca3ea3ae442c960b391cbf9.yml",
          "workflow_name": "PR review labeler",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 54,
          "num_jobs": 1,
          "steps_per_job": {
            "label": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "label": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/download-artifact@v4",
              "actions/github-script@v7",
              "j-fulbright/label-when-approved-action@v1.2"
            ],
            "num_run_commands": 1,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "PR review labeler",
        "true": {
          "workflow_run": {
            "workflows": [
              "PR review listener"
            ],
            "types": [
              "completed"
            ]
          }
        },
        "jobs": {
          "label": {
            "if": "${{ github.event.workflow_run.conclusion == 'success' }}",
            "runs-on": "ubuntu-latest",
            "permissions": {
              "contents": "read",
              "issues": "write",
              "pull-requests": "write"
            },
            "steps": [
              {
                "name": "Download PR number artifact from upstream run",
                "uses": "actions/download-artifact@v4",
                "with": {
                  "name": "pr-number-${{ github.event.workflow_run.id }}",
                  "path": ".",
                  "run-id": "${{ github.event.workflow_run.id }}",
                  "github-token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "id": "pr",
                "run": "echo \"number=$(cat pr.txt)\" >> $GITHUB_OUTPUT"
              },
              {
                "name": "Label when approved",
                "uses": "j-fulbright/label-when-approved-action@v1.2",
                "with": {
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "label": "Ready to merge",
                  "require_committers_approval": "true",
                  "remove_label_when_approval_missing": "true",
                  "comment": "\u2705 This PR has been reviewed and approved \u2014 all set for merge!",
                  "pullRequestNumber": "${{ steps.pr.outputs.number }}"
                }
              },
              {
                "name": "Remove review-related labels",
                "if": "${{ success() }}",
                "uses": "actions/github-script@v7",
                "with": {
                  "script": "const { owner, repo } = context.repo;\nconst issue_number = ${{ steps.pr.outputs.number }};\nconst labelsToRemove = [\"Needs review\", \"Work in progress\", \"Backlog\", \"Can be closed?\", \"Help needed\", \"Needs Documentation\"];\n\nfor (const name of labelsToRemove) {\n  try {\n    await github.rest.issues.removeLabel({ owner, repo, issue_number, name });\n    core.info(`Removed label \"${name}\"`);\n  } catch (e) {\n    core.warning(`Could not remove label \"${name}\": ${e.message}`);\n  }\n}\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-09-14T11-47-33Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/code-injection/critical",
          "ruleIndex": 10,
          "kind": "fail",
          "level": "error",
          "correlationGuid": "workflow-4dec9958-2a5e-5248-84e2-651f39f62146",
          "message": {
            "text": "Potential code injection in [${{ steps.pr.outputs.number }}](1), which may be controlled by an external user ([workflow_run](2))."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/pr-label-on-approved__2025-09-14T11-47-33Z__9fb0d863be037b28da0b15c2a6fb35a12fb6613c.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 44,
                  "startColumn": 34,
                  "endLine": null,
                  "endColumn": 64
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42da46ea0e4f16bd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-094",
            "precision": "very-high",
            "security_severity": "9",
            "triage": "high"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "pr-label-on-approved__2025-09-14T11-47-33Z__9fb0d863be037b28da0b15c2a6fb35a12fb6613c.yml",
          "workflow_name": "PR review labeler",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 54,
          "num_jobs": 1,
          "steps_per_job": {
            "label": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "label": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/download-artifact@v4",
              "actions/github-script@v8",
              "j-fulbright/label-when-approved-action@v1.2"
            ],
            "num_run_commands": 1,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "PR review labeler",
        "true": {
          "workflow_run": {
            "workflows": [
              "PR review listener"
            ],
            "types": [
              "completed"
            ]
          }
        },
        "jobs": {
          "label": {
            "if": "${{ github.event.workflow_run.conclusion == 'success' }}",
            "runs-on": "ubuntu-latest",
            "permissions": {
              "contents": "read",
              "issues": "write",
              "pull-requests": "write"
            },
            "steps": [
              {
                "name": "Download PR number artifact from upstream run",
                "uses": "actions/download-artifact@v4",
                "with": {
                  "name": "pr-number-${{ github.event.workflow_run.id }}",
                  "path": ".",
                  "run-id": "${{ github.event.workflow_run.id }}",
                  "github-token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "id": "pr",
                "run": "echo \"number=$(cat pr.txt)\" >> $GITHUB_OUTPUT"
              },
              {
                "name": "Label when approved",
                "uses": "j-fulbright/label-when-approved-action@v1.2",
                "with": {
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "label": "Ready to merge",
                  "require_committers_approval": "true",
                  "remove_label_when_approval_missing": "true",
                  "comment": "\u2705 This PR has been reviewed and approved \u2014 all set for merge!",
                  "pullRequestNumber": "${{ steps.pr.outputs.number }}"
                }
              },
              {
                "name": "Remove review-related labels",
                "if": "${{ success() }}",
                "uses": "actions/github-script@v8",
                "with": {
                  "script": "const { owner, repo } = context.repo;\nconst issue_number = ${{ steps.pr.outputs.number }};\nconst labelsToRemove = [\"Needs review\", \"Work in progress\", \"Backlog\", \"Can be closed?\", \"Help needed\", \"Needs Documentation\"];\n\nfor (const name of labelsToRemove) {\n  try {\n    await github.rest.issues.removeLabel({ owner, repo, issue_number, name });\n    core.info(`Removed label \"${name}\"`);\n  } catch (e) {\n    core.warning(`Could not remove label \"${name}\": ${e.message}`);\n  }\n}\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-09-14T11-49-34Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/code-injection/critical",
          "ruleIndex": 10,
          "kind": "fail",
          "level": "error",
          "correlationGuid": "workflow-d57b3801-c814-5f58-8953-f30bebdfcdda",
          "message": {
            "text": "Potential code injection in [${{ steps.pr.outputs.number }}](1), which may be controlled by an external user ([workflow_run](2))."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/pr-label-on-approved__2025-09-14T11-49-34Z__c3a7854f7395193e38a5dab44d4fd36d27d0c663.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 44,
                  "startColumn": 34,
                  "endLine": null,
                  "endColumn": 64
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "42da46ea0e4f16bd:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-094",
            "precision": "very-high",
            "security_severity": "9",
            "triage": "high"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "pr-label-on-approved__2025-09-14T11-49-34Z__c3a7854f7395193e38a5dab44d4fd36d27d0c663.yml",
          "workflow_name": "PR review labeler",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 54,
          "num_jobs": 1,
          "steps_per_job": {
            "label": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "label": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/download-artifact@v5",
              "actions/github-script@v8",
              "j-fulbright/label-when-approved-action@v1.2"
            ],
            "num_run_commands": 1,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "PR review labeler",
        "true": {
          "workflow_run": {
            "workflows": [
              "PR review listener"
            ],
            "types": [
              "completed"
            ]
          }
        },
        "jobs": {
          "label": {
            "if": "${{ github.event.workflow_run.conclusion == 'success' }}",
            "runs-on": "ubuntu-latest",
            "permissions": {
              "contents": "read",
              "issues": "write",
              "pull-requests": "write"
            },
            "steps": [
              {
                "name": "Download PR number artifact from upstream run",
                "uses": "actions/download-artifact@v5",
                "with": {
                  "name": "pr-number-${{ github.event.workflow_run.id }}",
                  "path": ".",
                  "run-id": "${{ github.event.workflow_run.id }}",
                  "github-token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "id": "pr",
                "run": "echo \"number=$(cat pr.txt)\" >> $GITHUB_OUTPUT"
              },
              {
                "name": "Label when approved",
                "uses": "j-fulbright/label-when-approved-action@v1.2",
                "with": {
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "label": "Ready to merge",
                  "require_committers_approval": "true",
                  "remove_label_when_approval_missing": "true",
                  "comment": "\u2705 This PR has been reviewed and approved \u2014 all set for merge!",
                  "pullRequestNumber": "${{ steps.pr.outputs.number }}"
                }
              },
              {
                "name": "Remove review-related labels",
                "if": "${{ success() }}",
                "uses": "actions/github-script@v8",
                "with": {
                  "script": "const { owner, repo } = context.repo;\nconst issue_number = ${{ steps.pr.outputs.number }};\nconst labelsToRemove = [\"Needs review\", \"Work in progress\", \"Backlog\", \"Can be closed?\", \"Help needed\", \"Needs Documentation\"];\n\nfor (const name of labelsToRemove) {\n  try {\n    await github.rest.issues.removeLabel({ owner, repo, issue_number, name });\n    core.info(`Removed label \"${name}\"`);\n  } catch (e) {\n    core.warning(`Could not remove label \"${name}\": ${e.message}`);\n  }\n}\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-04-12T18-04-11Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "pr-label-on-approved__2025-04-12T18-04-11Z__6a86fd7def35baa7106a6d0bffa32c1ce5cbba68.yml",
          "workflow_name": "Label approved pull requests",
          "triggers": {},
          "permissions": {
            "contents": "read",
            "pull-requests": "write",
            "issues": "write"
          },
          "concurrency": null,
          "defaults": null,
          "line_count": 21,
          "num_jobs": 1,
          "steps_per_job": {
            "labelWhenApproved": 1
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "labelWhenApproved": 1
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "pullreminders/label-when-approved-action@master"
            ],
            "num_run_commands": 0,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "true": "pull_request_review",
        "name": "Label approved pull requests",
        "permissions": {
          "contents": "read",
          "pull-requests": "write",
          "issues": "write"
        },
        "jobs": {
          "labelWhenApproved": {
            "if": "${{ github.repository_owner == 'armbian' }}",
            "name": "Label when approved",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Label when approved",
                "uses": "pullreminders/label-when-approved-action@master",
                "env": {
                  "APPROVALS": "1",
                  "GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}",
                  "ADD_LABEL": "Ready to merge",
                  "REMOVE_LABEL": "Needs%20review"
                }
              }
            ]
          }
        }
      }
    },
    "2025-09-12T19-31-19Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "pr-label-on-approved__2025-09-12T19-31-19Z__e60abc531b55417c7293dbbf579f99770217d9b0.yml",
          "workflow_name": "PR review labeler",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 31,
          "num_jobs": 1,
          "steps_per_job": {
            "label": 2
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "label": 2
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 1,
            "actions_used": [
              "j-fulbright/label-when-approved-action@v1.2"
            ],
            "num_run_commands": 1,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "PR review labeler",
        "true": {
          "workflow_run": {
            "workflows": [
              "PR review listener"
            ],
            "types": [
              "completed"
            ]
          }
        },
        "jobs": {
          "label": {
            "if": "${{ github.event.workflow_run.conclusion == 'success' && github.event.workflow_run.pull_requests[0] }}",
            "name": "Set label",
            "permissions": {
              "contents": "read",
              "issues": "write",
              "pull-requests": "write"
            },
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Extract PR number",
                "id": "pr",
                "run": "echo \"number=${{ github.event.workflow_run.pull_requests[0].number }}\" >> \"$GITHUB_OUTPUT\"\n"
              },
              {
                "name": "Label when approved",
                "uses": "j-fulbright/label-when-approved-action@v1.2",
                "with": {
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "label": "Ready to merge",
                  "require_committers_approval": "true",
                  "remove_label_when_approval_missing": "true",
                  "comment": "\u2705 This PR has been reviewed and approved \u2014 all set for merge!",
                  "pullRequestNumber": "${{ steps.pr.outputs.number }}"
                }
              }
            ]
          }
        }
      }
    },
    "2025-09-13T09-37-27Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "pr-label-on-approved__2025-09-13T09-37-27Z__47519373a624995dd3dfd7fbe11a03845d5559b8.yml",
          "workflow_name": "PR review labeler",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 48,
          "num_jobs": 1,
          "steps_per_job": {
            "label": 2
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "label": 2
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/github-script@v7",
              "j-fulbright/label-when-approved-action@v1.2"
            ],
            "num_run_commands": 0,
            "steps_with_conditionals": 1,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "PR review labeler",
        "true": {
          "workflow_run": {
            "workflows": [
              "PR review listener"
            ],
            "types": [
              "completed"
            ]
          }
        },
        "jobs": {
          "label": {
            "if": "${{ github.event.workflow_run.conclusion == 'success' }}",
            "runs-on": "ubuntu-latest",
            "permissions": {
              "contents": "read",
              "issues": "write",
              "pull-requests": "write"
            },
            "steps": [
              {
                "name": "Resolve PR number from head_sha",
                "id": "pr",
                "uses": "actions/github-script@v7",
                "with": {
                  "script": "const { owner, repo } = context.repo;\nconst sha = context.payload.workflow_run.head_sha;\n\nconst { data: prs } = await github.rest.repos.listPullRequestsAssociatedWithCommit({\n  owner, repo, commit_sha: sha\n});\n\nif (!prs.length) {\n  core.setFailed(`\u274c No PR found for commit ${sha}`);\n  return;\n}\n\n// Pick an open PR if possible\nconst pr = prs.find(p => p.state === 'open') || prs[0];\ncore.info(`Using PR #${pr.number}`);\ncore.setOutput('number', String(pr.number));\n"
                }
              },
              {
                "name": "Label when approved",
                "if": "${{ success() }}",
                "uses": "j-fulbright/label-when-approved-action@v1.2",
                "with": {
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "label": "Ready to merge",
                  "require_committers_approval": "true",
                  "remove_label_when_approval_missing": "true",
                  "comment": "\u2705 This PR has been reviewed and approved \u2014 all set for merge!",
                  "pullRequestNumber": "${{ steps.pr.outputs.number }}"
                }
              }
            ]
          }
        }
      }
    },
    "2025-09-13T10-17-09Z": {
      "vulnerability_list": [],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "pr-label-on-approved__2025-09-13T10-17-09Z__6e11920bf36879d53941e0c4f4fc2588563d784a.yml",
          "workflow_name": "PR review labeler",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 36,
          "num_jobs": 1,
          "steps_per_job": {
            "label": 3
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "label": 3
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 2,
            "actions_used": [
              "actions/download-artifact@v4",
              "j-fulbright/label-when-approved-action@v1.2"
            ],
            "num_run_commands": 1,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "PR review labeler",
        "true": {
          "workflow_run": {
            "workflows": [
              "PR review listener"
            ],
            "types": [
              "completed"
            ]
          }
        },
        "jobs": {
          "label": {
            "if": "${{ github.event.workflow_run.conclusion == 'success' }}",
            "runs-on": "ubuntu-latest",
            "permissions": {
              "contents": "read",
              "issues": "write",
              "pull-requests": "write"
            },
            "steps": [
              {
                "name": "Download PR number artifact from upstream run",
                "uses": "actions/download-artifact@v4",
                "with": {
                  "name": "pr-number-${{ github.event.workflow_run.id }}",
                  "path": ".",
                  "run-id": "${{ github.event.workflow_run.id }}",
                  "github-token": "${{ secrets.GITHUB_TOKEN }}"
                }
              },
              {
                "id": "pr",
                "run": "echo \"number=$(cat pr.txt)\" >> $GITHUB_OUTPUT"
              },
              {
                "name": "Label when approved",
                "uses": "j-fulbright/label-when-approved-action@v1.2",
                "with": {
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "label": "Ready to merge",
                  "require_committers_approval": "true",
                  "remove_label_when_approval_missing": "true",
                  "comment": "\u2705 This PR has been reviewed and approved \u2014 all set for merge!",
                  "pullRequestNumber": "${{ steps.pr.outputs.number }}"
                }
              }
            ]
          }
        }
      }
    }
  }
}