{
  "repo_owner": "appleboy",
  "repo_name": "ssh-action",
  "workflow_name": "main",
  "history": {
    "2024-07-14T09-19-13Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-013d601c-e2cf-519d-8318-1311ac8c28f7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-07-14T09-19-13Z__06fa62e61cac6c39015db4efcde64776f56965c4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 42,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-399fbf87-6400-571e-b179-fdd69e1e79e3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-07-14T09-19-13Z__06fa62e61cac6c39015db4efcde64776f56965c4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 43,
                  "startColumn": 5,
                  "endLine": 130,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4aca227d-ed1b-574a-b58a-13ebfaa204bf",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-07-14T09-19-13Z__06fa62e61cac6c39015db4efcde64776f56965c4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 131,
                  "startColumn": 5,
                  "endLine": 212,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d85f9f65-9d90-5f10-adf8-6e22ecbb4a83",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-07-14T09-19-13Z__06fa62e61cac6c39015db4efcde64776f56965c4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 213,
                  "startColumn": 5,
                  "endLine": 287,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-01e19398-7815-5171-abb8-87fb2ba4ef95",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-07-14T09-19-13Z__06fa62e61cac6c39015db4efcde64776f56965c4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 288,
                  "startColumn": 5,
                  "endLine": 341,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e021739d-c7e4-564e-a52e-f476e9e68c2b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-07-14T09-19-13Z__06fa62e61cac6c39015db4efcde64776f56965c4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 342,
                  "startColumn": 5,
                  "endLine": 476,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-85d70481-4c1a-549c-8bba-9f34d5bca089",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-07-14T09-19-13Z__06fa62e61cac6c39015db4efcde64776f56965c4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 477,
                  "startColumn": 5,
                  "endLine": 502,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1b222a7ae19431ad:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "main__2024-07-14T09-19-13Z__06fa62e61cac6c39015db4efcde64776f56965c4.yml",
          "workflow_name": "testing main branch",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 502,
          "num_jobs": 7,
          "steps_per_job": {
            "default-user-name-password": 3,
            "check-ssh-key": 7,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 9,
            "testing06": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 7,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 3,
              "check-ssh-key": 7,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 9,
              "testing06": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 2,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 25,
            "actions_used": [
              "./",
              "actions/checkout@v4",
              "fscarmen/warp-on-actions@v1.1"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 2
          }
        }
      },
      "workflow_json": {
        "name": "testing main branch",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "stop script if command error",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script_stop": true,
                  "sync": true,
                  "debug": true,
                  "script": "mkdir abc/def\nls -al\n"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script_stop": true,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script_stop": true,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "./",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "switch to root user",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script_stop": true,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          },
          "testing06": {
            "name": "testing ipv6",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up WARP",
                "uses": "fscarmen/warp-on-actions@v1.1",
                "with": {
                  "stack": "dual"
                }
              },
              {
                "name": "testing ipv6 for command",
                "run": "curl -m 9 --ipv6 --verbose https://google.com\n"
              },
              {
                "name": "testing ipv6",
                "uses": "./",
                "with": {
                  "host": "2402:1f00:8000:800::2628",
                  "username": "ubuntu",
                  "password": "${{ secrets.OVH_PASSWORD }}",
                  "protocol": "tcp6",
                  "port": 22,
                  "command_timeout": "30s",
                  "script": "whoami\n"
                }
              }
            ]
          }
        }
      }
    },
    "2024-07-20T05-32-11Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-604f17e4-f03a-5870-8ffc-24f3bfc297eb",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-07-20T05-32-11Z__b4a07ca5940a7dc94925e99f8e6eab3671b0fa64.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 42,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-86b1029e-1908-5451-98aa-db63bf957854",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-07-20T05-32-11Z__b4a07ca5940a7dc94925e99f8e6eab3671b0fa64.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 43,
                  "startColumn": 5,
                  "endLine": 130,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4d585e9a-d509-5256-88be-63b9703995f7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-07-20T05-32-11Z__b4a07ca5940a7dc94925e99f8e6eab3671b0fa64.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 131,
                  "startColumn": 5,
                  "endLine": 212,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a36416aa-66c1-5b85-bf17-29b0d4c1977f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-07-20T05-32-11Z__b4a07ca5940a7dc94925e99f8e6eab3671b0fa64.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 213,
                  "startColumn": 5,
                  "endLine": 287,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7c83bc83-0b68-5c7d-9fff-790cda09c10f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-07-20T05-32-11Z__b4a07ca5940a7dc94925e99f8e6eab3671b0fa64.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 288,
                  "startColumn": 5,
                  "endLine": 341,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4da5fc45-e7ba-5a2e-8651-681c82f66303",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-07-20T05-32-11Z__b4a07ca5940a7dc94925e99f8e6eab3671b0fa64.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 342,
                  "startColumn": 5,
                  "endLine": 486,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0552199a-102b-5035-afc5-dfd58b5fae3e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-07-20T05-32-11Z__b4a07ca5940a7dc94925e99f8e6eab3671b0fa64.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 487,
                  "startColumn": 5,
                  "endLine": 513,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1b222a7ae19431ad:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "main__2024-07-20T05-32-11Z__b4a07ca5940a7dc94925e99f8e6eab3671b0fa64.yml",
          "workflow_name": "testing main branch",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 513,
          "num_jobs": 7,
          "steps_per_job": {
            "default-user-name-password": 3,
            "check-ssh-key": 7,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 10,
            "testing06": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 7,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 3,
              "check-ssh-key": 7,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 10,
              "testing06": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 4,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 26,
            "actions_used": [
              "./",
              "actions/checkout@v4",
              "fscarmen/warp-on-actions@v1.1"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 4
          }
        }
      },
      "workflow_json": {
        "name": "testing main branch",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "stop script if command error",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script_stop": true,
                  "sync": true,
                  "debug": true,
                  "script": "mkdir abc/def\nls -al\n"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script_stop": true,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script_stop": true,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "./",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "pass secret variable in shell",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "cd ${{ secrets.PORT }}"
                }
              },
              {
                "name": "switch to root user",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script_stop": true,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          },
          "testing06": {
            "name": "testing ipv6",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up WARP",
                "uses": "fscarmen/warp-on-actions@v1.1",
                "with": {
                  "stack": "dual"
                }
              },
              {
                "name": "testing ipv6 for command",
                "run": "curl -m 9 --ipv6 --verbose https://google.com\n"
              },
              {
                "name": "testing ipv6",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "2402:1f00:8000:800::2628",
                  "username": "ubuntu",
                  "password": "${{ secrets.OVH_PASSWORD }}",
                  "protocol": "tcp6",
                  "port": 22,
                  "command_timeout": "30s",
                  "script": "whoami\n"
                }
              }
            ]
          }
        }
      }
    },
    "2024-10-23T17-27-03Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-160ed7ae-c4d0-5d3d-9d84-0b4a2a03d3cf",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-10-23T17-27-03Z__8b84eaec3a216f1a0a6f56e15a7ab08f9975236a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 45,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d339f60d-f8b1-5e9c-bec9-c5f4d411be2f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-10-23T17-27-03Z__8b84eaec3a216f1a0a6f56e15a7ab08f9975236a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 46,
                  "startColumn": 5,
                  "endLine": 133,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2e800d06-d62e-5a72-a5ab-790ed702a044",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-10-23T17-27-03Z__8b84eaec3a216f1a0a6f56e15a7ab08f9975236a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 134,
                  "startColumn": 5,
                  "endLine": 215,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f0226090-288e-51f9-8a07-16552069ea41",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-10-23T17-27-03Z__8b84eaec3a216f1a0a6f56e15a7ab08f9975236a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 216,
                  "startColumn": 5,
                  "endLine": 290,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8270bfe0-e7f9-5c4d-970a-338dd9ef5dca",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-10-23T17-27-03Z__8b84eaec3a216f1a0a6f56e15a7ab08f9975236a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 291,
                  "startColumn": 5,
                  "endLine": 344,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-81531088-ce01-5846-9df0-2eea6d0e56b6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-10-23T17-27-03Z__8b84eaec3a216f1a0a6f56e15a7ab08f9975236a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 345,
                  "startColumn": 5,
                  "endLine": 489,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7e88dd5d-d6a2-5bd8-8f04-890da511bb5f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-10-23T17-27-03Z__8b84eaec3a216f1a0a6f56e15a7ab08f9975236a.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 490,
                  "startColumn": 5,
                  "endLine": 516,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1b222a7ae19431ad:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "main__2024-10-23T17-27-03Z__8b84eaec3a216f1a0a6f56e15a7ab08f9975236a.yml",
          "workflow_name": "testing main branch",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 516,
          "num_jobs": 7,
          "steps_per_job": {
            "default-user-name-password": 3,
            "check-ssh-key": 7,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 10,
            "testing06": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 7,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 3,
              "check-ssh-key": 7,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 10,
              "testing06": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 4,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 26,
            "actions_used": [
              "./",
              "actions/checkout@v4",
              "fscarmen/warp-on-actions@v1.1"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 4
          }
        }
      },
      "workflow_json": {
        "name": "testing main branch",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "stop script if command error",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script_stop": true,
                  "sync": true,
                  "debug": true,
                  "script": "mkdir abc/def\nls -al\n"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script_stop": true,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script_stop": true,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "./",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "pass secret variable in shell",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "cd ${{ secrets.PORT }}"
                }
              },
              {
                "name": "switch to root user",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script_stop": true,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          },
          "testing06": {
            "name": "testing ipv6",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up WARP",
                "uses": "fscarmen/warp-on-actions@v1.1",
                "with": {
                  "stack": "dual"
                }
              },
              {
                "name": "testing ipv6 for command",
                "run": "curl -m 9 --ipv6 --verbose https://google.com\n"
              },
              {
                "name": "testing ipv6",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "2402:1f00:8000:800::2628",
                  "username": "ubuntu",
                  "password": "${{ secrets.OVH_PASSWORD }}",
                  "protocol": "tcp6",
                  "port": 22,
                  "command_timeout": "30s",
                  "script": "whoami\n"
                }
              }
            ]
          }
        }
      }
    },
    "2024-11-17T06-57-46Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f92ddc8a-4dc2-51d5-a58e-244ca29f54e6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-11-17T06-57-46Z__362a7f1677aa40aaec6bb1d6fd119b2e080fd7f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 54,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9bebdd17-beaf-5073-992e-42f50f8f500b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-11-17T06-57-46Z__362a7f1677aa40aaec6bb1d6fd119b2e080fd7f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 142,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d2b03d3d-8d6e-5011-abf5-24bff78afd4a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-11-17T06-57-46Z__362a7f1677aa40aaec6bb1d6fd119b2e080fd7f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 143,
                  "startColumn": 5,
                  "endLine": 224,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2a3cafe8-f395-5f21-be2c-a7f6b16acd1f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-11-17T06-57-46Z__362a7f1677aa40aaec6bb1d6fd119b2e080fd7f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 225,
                  "startColumn": 5,
                  "endLine": 299,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5d29b626-00b5-503d-af47-45468fc5b944",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-11-17T06-57-46Z__362a7f1677aa40aaec6bb1d6fd119b2e080fd7f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 300,
                  "startColumn": 5,
                  "endLine": 353,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-91d24c70-c4ba-5fc9-af38-cbb2843d9bbd",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-11-17T06-57-46Z__362a7f1677aa40aaec6bb1d6fd119b2e080fd7f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 354,
                  "startColumn": 5,
                  "endLine": 498,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1a285a80-e87e-5aed-abf6-e0acb2b9ee9e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-11-17T06-57-46Z__362a7f1677aa40aaec6bb1d6fd119b2e080fd7f3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 499,
                  "startColumn": 5,
                  "endLine": 525,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1b222a7ae19431ad:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "main__2024-11-17T06-57-46Z__362a7f1677aa40aaec6bb1d6fd119b2e080fd7f3.yml",
          "workflow_name": "testing main branch",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 525,
          "num_jobs": 7,
          "steps_per_job": {
            "default-user-name-password": 4,
            "check-ssh-key": 7,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 10,
            "testing06": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 7,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 4,
              "check-ssh-key": 7,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 10,
              "testing06": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 4,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 27,
            "actions_used": [
              "./",
              "actions/checkout@v4",
              "fscarmen/warp-on-actions@v1.1"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 4
          }
        }
      },
      "workflow_json": {
        "name": "testing main branch",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              },
              {
                "name": "ssh commands from a file",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script_path": "testdata/test.sh"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "stop script if command error",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script_stop": true,
                  "sync": true,
                  "debug": true,
                  "script": "mkdir abc/def\nls -al\n"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script_stop": true,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script_stop": true,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "./",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "pass secret variable in shell",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "cd ${{ secrets.PORT }}"
                }
              },
              {
                "name": "switch to root user",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script_stop": true,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          },
          "testing06": {
            "name": "testing ipv6",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up WARP",
                "uses": "fscarmen/warp-on-actions@v1.1",
                "with": {
                  "stack": "dual"
                }
              },
              {
                "name": "testing ipv6 for command",
                "run": "curl -m 9 --ipv6 --verbose https://google.com\n"
              },
              {
                "name": "testing ipv6",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "2402:1f00:8000:800::2628",
                  "username": "ubuntu",
                  "password": "${{ secrets.OVH_PASSWORD }}",
                  "protocol": "tcp6",
                  "port": 22,
                  "command_timeout": "30s",
                  "script": "whoami\n"
                }
              }
            ]
          }
        }
      }
    },
    "2024-12-02T15-19-33Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ec4731f3-62de-5cd6-8849-0848e47b1a86",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-02T15-19-33Z__e13c387332e012cca188219684f51e6ac401aa32.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 54,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f6d09cf7-7ed8-506e-93a1-723997a588a2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-02T15-19-33Z__e13c387332e012cca188219684f51e6ac401aa32.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 126,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e2701d30-aa35-5cba-a44d-38d2377bd323",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-02T15-19-33Z__e13c387332e012cca188219684f51e6ac401aa32.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 127,
                  "startColumn": 5,
                  "endLine": 207,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5a133acb-659e-58af-b26b-9c19a8901d88",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-02T15-19-33Z__e13c387332e012cca188219684f51e6ac401aa32.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 208,
                  "startColumn": 5,
                  "endLine": 281,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2fbbc5e8-5101-5d0c-8a1a-59cccebefd81",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-02T15-19-33Z__e13c387332e012cca188219684f51e6ac401aa32.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 282,
                  "startColumn": 5,
                  "endLine": 335,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3f01e85c-1b13-5d4d-93ee-75e488fac4b3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-02T15-19-33Z__e13c387332e012cca188219684f51e6ac401aa32.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 336,
                  "startColumn": 5,
                  "endLine": 479,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-97bb5092-78fe-5eef-911f-a31d2fafb256",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-02T15-19-33Z__e13c387332e012cca188219684f51e6ac401aa32.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 480,
                  "startColumn": 5,
                  "endLine": 508,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1b222a7ae19431ad:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f7a6c9f5-2173-5ed9-b829-e283c1b25a9f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-02T15-19-33Z__e13c387332e012cca188219684f51e6ac401aa32.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 509,
                  "startColumn": 5,
                  "endLine": 551,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "191c7981684d03c0:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "main__2024-12-02T15-19-33Z__e13c387332e012cca188219684f51e6ac401aa32.yml",
          "workflow_name": "testing main branch",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 551,
          "num_jobs": 8,
          "steps_per_job": {
            "default-user-name-password": 4,
            "check-ssh-key": 6,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 10,
            "testing06": 4,
            "testing07": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 8,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 4,
              "check-ssh-key": 6,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 10,
              "testing06": 4,
              "testing07": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 3,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 28,
            "actions_used": [
              "./",
              "actions/checkout@v4",
              "fscarmen/warp-on-actions@v1.1"
            ],
            "num_run_commands": 14,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 3
          }
        }
      },
      "workflow_json": {
        "name": "testing main branch",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              },
              {
                "name": "ssh commands from a file",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script_path": "testdata/test.sh"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "./",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "pass secret variable in shell",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "cd ${{ secrets.PORT }}"
                }
              },
              {
                "name": "switch to root user",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          },
          "testing06": {
            "name": "testing ipv6",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up WARP",
                "uses": "fscarmen/warp-on-actions@v1.1",
                "with": {
                  "stack": "dual"
                }
              },
              {
                "name": "testing ipv6 for command",
                "run": "curl -m 9 --ipv6 --verbose https://google.com\n"
              },
              {
                "name": "testing ipv6",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "2402:1f00:8000:800::2628",
                  "username": "ubuntu",
                  "password": "${{ secrets.OVH_PASSWORD }}",
                  "protocol": "tcp6",
                  "port": 22,
                  "command_timeout": "30s",
                  "script": "whoami\n"
                }
              }
            ]
          },
          "testing07": {
            "name": "some special character",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set Environment Variables",
                "run": "PASS='3HUS$?8kLu)}'\nprintf \"PASS=${PASS}\" >> $GITHUB_ENV\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD='${{ env.PASS }}'  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "${{ env.PASS }}",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              }
            ]
          }
        }
      }
    },
    "2024-12-02T13-25-26Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-025072e9-57bf-548e-97ec-ca35dff61b25",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-02T13-25-26Z__1c1ad10f6da46db2f81a68133f45b6a29317b741.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 54,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d7043309-d079-591a-b607-0d9a0886253c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-02T13-25-26Z__1c1ad10f6da46db2f81a68133f45b6a29317b741.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 126,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d6594d66-a457-5774-817d-33be9871ec2f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-02T13-25-26Z__1c1ad10f6da46db2f81a68133f45b6a29317b741.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 127,
                  "startColumn": 5,
                  "endLine": 207,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e78bac2f-6a43-5e09-a4b1-2f1923d634f6",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-02T13-25-26Z__1c1ad10f6da46db2f81a68133f45b6a29317b741.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 208,
                  "startColumn": 5,
                  "endLine": 281,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-65e57b25-7dca-59a6-92d7-3a628aa0005a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-02T13-25-26Z__1c1ad10f6da46db2f81a68133f45b6a29317b741.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 282,
                  "startColumn": 5,
                  "endLine": 335,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-51441e7a-ac30-5757-83fb-f8d8e4741019",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-02T13-25-26Z__1c1ad10f6da46db2f81a68133f45b6a29317b741.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 336,
                  "startColumn": 5,
                  "endLine": 479,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-baf6915a-730e-501e-9f9a-5dd27bc2d4b3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-02T13-25-26Z__1c1ad10f6da46db2f81a68133f45b6a29317b741.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 480,
                  "startColumn": 5,
                  "endLine": 506,
                  "endColumn": 20
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1b222a7ae19431ad:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "main__2024-12-02T13-25-26Z__1c1ad10f6da46db2f81a68133f45b6a29317b741.yml",
          "workflow_name": "testing main branch",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 506,
          "num_jobs": 7,
          "steps_per_job": {
            "default-user-name-password": 4,
            "check-ssh-key": 6,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 10,
            "testing06": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 7,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 4,
              "check-ssh-key": 6,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 10,
              "testing06": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 3,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 26,
            "actions_used": [
              "./",
              "actions/checkout@v4",
              "fscarmen/warp-on-actions@v1.1"
            ],
            "num_run_commands": 12,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 3
          }
        }
      },
      "workflow_json": {
        "name": "testing main branch",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              },
              {
                "name": "ssh commands from a file",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script_path": "testdata/test.sh"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "./",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "pass secret variable in shell",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "cd ${{ secrets.PORT }}"
                }
              },
              {
                "name": "switch to root user",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          },
          "testing06": {
            "name": "testing ipv6",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up WARP",
                "uses": "fscarmen/warp-on-actions@v1.1",
                "with": {
                  "stack": "dual"
                }
              },
              {
                "name": "testing ipv6 for command",
                "run": "curl -m 9 --ipv6 --verbose https://google.com\n"
              },
              {
                "name": "testing ipv6",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "2402:1f00:8000:800::2628",
                  "username": "ubuntu",
                  "password": "${{ secrets.OVH_PASSWORD }}",
                  "protocol": "tcp6",
                  "port": 22,
                  "command_timeout": "30s",
                  "script": "whoami\n"
                }
              }
            ]
          }
        }
      }
    },
    "2024-12-04T01-49-35Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1a3d1bb2-67e2-52ac-80fb-271247bc4232",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-04T01-49-35Z__102c0d2e5f9f4ec3afb6392f674a1ae9e970dea9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 54,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5b087eac-a85c-54c2-9f62-deba8d88dbe9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-04T01-49-35Z__102c0d2e5f9f4ec3afb6392f674a1ae9e970dea9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 126,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4afb85a5-3580-500b-9487-f04153602a23",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-04T01-49-35Z__102c0d2e5f9f4ec3afb6392f674a1ae9e970dea9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 127,
                  "startColumn": 5,
                  "endLine": 207,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4763f596-5588-58e0-b584-ebb48847b767",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-04T01-49-35Z__102c0d2e5f9f4ec3afb6392f674a1ae9e970dea9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 208,
                  "startColumn": 5,
                  "endLine": 281,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bcaec9db-327d-5b4e-a1e5-2c8b8d610d4c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-04T01-49-35Z__102c0d2e5f9f4ec3afb6392f674a1ae9e970dea9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 282,
                  "startColumn": 5,
                  "endLine": 335,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a7ad082d-6d8a-59a9-b2f5-c93b86f4a274",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-04T01-49-35Z__102c0d2e5f9f4ec3afb6392f674a1ae9e970dea9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 336,
                  "startColumn": 5,
                  "endLine": 479,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c5d35dbb-c9a9-5f11-b9e1-0a1f9883cfc7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-04T01-49-35Z__102c0d2e5f9f4ec3afb6392f674a1ae9e970dea9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 480,
                  "startColumn": 5,
                  "endLine": 508,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1b222a7ae19431ad:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-489cddc4-7ff2-5210-9c13-8803082cfb2e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-04T01-49-35Z__102c0d2e5f9f4ec3afb6392f674a1ae9e970dea9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 509,
                  "startColumn": 5,
                  "endLine": 553,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "191c7981684d03c0:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-649bc8e6-b580-53c2-b3a1-aa6dc9bc4188",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-04T01-49-35Z__102c0d2e5f9f4ec3afb6392f674a1ae9e970dea9.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 554,
                  "startColumn": 5,
                  "endLine": 596,
                  "endColumn": 61
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "main__2024-12-04T01-49-35Z__102c0d2e5f9f4ec3afb6392f674a1ae9e970dea9.yml",
          "workflow_name": "testing main branch",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 596,
          "num_jobs": 9,
          "steps_per_job": {
            "default-user-name-password": 4,
            "check-ssh-key": 6,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 10,
            "testing06": 4,
            "testing07": 4,
            "testing-capturing-output": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 9,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 4,
              "check-ssh-key": 6,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 10,
              "testing06": 4,
              "testing07": 4,
              "testing-capturing-output": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 3,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 30,
            "actions_used": [
              "./",
              "actions/checkout@v4",
              "fscarmen/warp-on-actions@v1.1"
            ],
            "num_run_commands": 16,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 3
          }
        }
      },
      "workflow_json": {
        "name": "testing main branch",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              },
              {
                "name": "ssh commands from a file",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script_path": "testdata/test.sh"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "./",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "pass secret variable in shell",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "cd ${{ secrets.PORT }}"
                }
              },
              {
                "name": "switch to root user",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          },
          "testing06": {
            "name": "testing ipv6",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up WARP",
                "uses": "fscarmen/warp-on-actions@v1.1",
                "with": {
                  "stack": "dual"
                }
              },
              {
                "name": "testing ipv6 for command",
                "run": "curl -m 9 --ipv6 --verbose https://google.com\n"
              },
              {
                "name": "testing ipv6",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "2402:1f00:8000:800::2628",
                  "username": "ubuntu",
                  "password": "${{ secrets.OVH_PASSWORD }}",
                  "protocol": "tcp6",
                  "port": 22,
                  "command_timeout": "30s",
                  "script": "whoami\n"
                }
              }
            ]
          },
          "testing07": {
            "name": "some special character",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set Environment Variables",
                "run": "PASS='3HUS$?8kLu)}'\nprintf \"PASS=${PASS}\" >> $GITHUB_ENV\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD='${{ env.PASS }}'  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "${{ env.PASS }}",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              }
            ]
          },
          "testing-capturing-output": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "id": "stdout",
                "name": "ssh command with stdout",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "capture_stdout": true,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              },
              {
                "name": "check stdout",
                "run": "echo \"stdout: ${{ steps.stdout.outputs.stdout }}\"\n"
              }
            ]
          }
        }
      }
    },
    "2024-12-05T08-23-32Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-225bfa12-aac0-5a5d-8f40-edceb4b39b83",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-05T08-23-32Z__66aa4d343bf909ac4fa0ac52f4e62a9adc354c95.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 54,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-8187923d-2606-57ec-bc91-764f30459fe2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-05T08-23-32Z__66aa4d343bf909ac4fa0ac52f4e62a9adc354c95.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 126,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-42229ec0-0c3a-5152-921c-013cb3f77ce0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-05T08-23-32Z__66aa4d343bf909ac4fa0ac52f4e62a9adc354c95.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 127,
                  "startColumn": 5,
                  "endLine": 207,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-650bf319-d361-51f6-882f-c287d2f7385b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-05T08-23-32Z__66aa4d343bf909ac4fa0ac52f4e62a9adc354c95.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 208,
                  "startColumn": 5,
                  "endLine": 281,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f44e9e3b-732f-58ea-a71c-35399a302739",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-05T08-23-32Z__66aa4d343bf909ac4fa0ac52f4e62a9adc354c95.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 282,
                  "startColumn": 5,
                  "endLine": 335,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6d867a83-72d1-5bbf-8abd-676a29ad9033",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-05T08-23-32Z__66aa4d343bf909ac4fa0ac52f4e62a9adc354c95.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 336,
                  "startColumn": 5,
                  "endLine": 479,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-132b0918-3733-505c-8744-149c432f771e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-05T08-23-32Z__66aa4d343bf909ac4fa0ac52f4e62a9adc354c95.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 480,
                  "startColumn": 5,
                  "endLine": 508,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1b222a7ae19431ad:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-7d28baa5-51e2-5982-a4b8-ef1dadd92237",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-05T08-23-32Z__66aa4d343bf909ac4fa0ac52f4e62a9adc354c95.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 509,
                  "startColumn": 5,
                  "endLine": 553,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "191c7981684d03c0:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a07580e1-953d-5aa9-b2d0-3b295014a35a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-05T08-23-32Z__66aa4d343bf909ac4fa0ac52f4e62a9adc354c95.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 554,
                  "startColumn": 5,
                  "endLine": 598,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-27927219-ea58-51f7-a428-5ced80a42be3",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2024-12-05T08-23-32Z__66aa4d343bf909ac4fa0ac52f4e62a9adc354c95.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 599,
                  "startColumn": 5,
                  "endLine": 683,
                  "endColumn": 14
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "main__2024-12-05T08-23-32Z__66aa4d343bf909ac4fa0ac52f4e62a9adc354c95.yml",
          "workflow_name": "testing main branch",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 683,
          "num_jobs": 10,
          "steps_per_job": {
            "default-user-name-password": 4,
            "check-ssh-key": 6,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 10,
            "testing06": 4,
            "testing07": 4,
            "testing-capturing-output": 4,
            "testing-script-stop": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 10,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 4,
              "check-ssh-key": 6,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 10,
              "testing06": 4,
              "testing07": 4,
              "testing-capturing-output": 4,
              "testing-script-stop": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 3,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 33,
            "actions_used": [
              "./",
              "actions/checkout@v4",
              "fscarmen/warp-on-actions@v1.1"
            ],
            "num_run_commands": 19,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 3
          }
        }
      },
      "workflow_json": {
        "name": "testing main branch",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              },
              {
                "name": "ssh commands from a file",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script_path": "testdata/test.sh"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "./",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "pass secret variable in shell",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "cd ${{ secrets.PORT }}"
                }
              },
              {
                "name": "switch to root user",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          },
          "testing06": {
            "name": "testing ipv6",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up WARP",
                "uses": "fscarmen/warp-on-actions@v1.1",
                "with": {
                  "stack": "dual"
                }
              },
              {
                "name": "testing ipv6 for command",
                "run": "curl -m 9 --ipv6 --verbose https://google.com\n"
              },
              {
                "name": "testing ipv6",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "2402:1f00:8000:800::2628",
                  "username": "ubuntu",
                  "password": "${{ secrets.OVH_PASSWORD }}",
                  "protocol": "tcp6",
                  "port": 22,
                  "command_timeout": "30s",
                  "script": "whoami\n"
                }
              }
            ]
          },
          "testing07": {
            "name": "some special character",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set Environment Variables",
                "run": "PASS='3HUS$?8kLu)}'\nprintf \"PASS=${PASS}\" >> $GITHUB_ENV\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD='${{ env.PASS }}'  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "${{ env.PASS }}",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              }
            ]
          },
          "testing-capturing-output": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "id": "stdout",
                "name": "ssh command with stdout",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "capture_stdout": true,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              },
              {
                "name": "check stdout",
                "run": "echo \"stdout: ${{ steps.stdout.outputs.stdout }}\"\n"
              }
            ]
          },
          "testing-script-stop": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "id": "stdout01",
                "name": "ssh command with stdout 01",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "capture_stdout": true,
                  "script": "#!/usr/bin/env bash\nset -e\necho \"TMP TESTING IF\"\nif [[ \"2\" == \"1\" ]]; then\n  echo \"True\"\nelse\n  echo \"False\"\nfi\n"
                }
              },
              {
                "name": "check stdout 01",
                "run": "echo \"stdout: ${{ steps.stdout01.outputs.stdout }}\"\nif echo \"${{ steps.stdout01.outputs.stdout }}\" | grep -q \"True\"; then\n  echo \"Output contains 'True'\"\n  exit 1\nfi\nif echo \"${{ steps.stdout01.outputs.stdout }}\" | grep -q \"False\"; then\n  echo \"Output contains 'False'\"\nfi\n"
              },
              {
                "id": "stdout02",
                "name": "ssh command with stdout 01",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "capture_stdout": true,
                  "script": "#!/usr/bin/env bash\nset -e\necho \"TMP TESTING IF\"\nif [[ \"1\" == \"1\" ]]; then\n  echo \"True\"\nelse\n  echo \"False\"\nfi\n"
                }
              },
              {
                "name": "check stdout 02",
                "run": "echo \"stdout: ${{ steps.stdout02.outputs.stdout }}\"\nif echo \"${{ steps.stdout02.outputs.stdout }}\" | grep -q \"False\"; then\n  echo \"Output contains 'False'\"\n  exit 1\nfi\nif echo \"${{ steps.stdout02.outputs.stdout }}\" | grep -q \"True\"; then\n  echo \"Output contains 'True'\"\nfi\n"
              }
            ]
          }
        }
      }
    },
    "2025-01-03T01-31-39Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-bc2d98e0-4273-50ed-911c-1b32e557b153",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-01-03T01-31-39Z__86aa40ddb7d085faad449ea3e1726b81949ef86b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 54,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d6a5e0c8-47fd-5d51-ac0b-91d49c7c968d",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-01-03T01-31-39Z__86aa40ddb7d085faad449ea3e1726b81949ef86b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 126,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-571d2100-5e75-52c1-a835-a4df21254008",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-01-03T01-31-39Z__86aa40ddb7d085faad449ea3e1726b81949ef86b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 127,
                  "startColumn": 5,
                  "endLine": 207,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-80c254a2-ad01-5cbe-a2e2-c3c538f3120e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-01-03T01-31-39Z__86aa40ddb7d085faad449ea3e1726b81949ef86b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 208,
                  "startColumn": 5,
                  "endLine": 281,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a1424da3-c698-518b-98b6-89e187a8b265",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-01-03T01-31-39Z__86aa40ddb7d085faad449ea3e1726b81949ef86b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 282,
                  "startColumn": 5,
                  "endLine": 335,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-115fa2d2-2947-5e38-8a0a-53a09be545a1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-01-03T01-31-39Z__86aa40ddb7d085faad449ea3e1726b81949ef86b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 336,
                  "startColumn": 5,
                  "endLine": 479,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-0eb0f002-d59d-5782-9199-2d14dcbb586b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-01-03T01-31-39Z__86aa40ddb7d085faad449ea3e1726b81949ef86b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 480,
                  "startColumn": 5,
                  "endLine": 508,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1b222a7ae19431ad:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2a4b771c-6309-5345-af20-1cc6a5d1543c",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-01-03T01-31-39Z__86aa40ddb7d085faad449ea3e1726b81949ef86b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 509,
                  "startColumn": 5,
                  "endLine": 553,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "191c7981684d03c0:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-3acf62f7-1e4f-5045-9b99-1044bf9fb4f2",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-01-03T01-31-39Z__86aa40ddb7d085faad449ea3e1726b81949ef86b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 554,
                  "startColumn": 5,
                  "endLine": 598,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-38617ef3-747c-55f6-8585-25fcf5b36228",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-01-03T01-31-39Z__86aa40ddb7d085faad449ea3e1726b81949ef86b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 599,
                  "startColumn": 5,
                  "endLine": 685,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d55fa0b8-c88d-53ab-8889-c4c72c1c37a0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-01-03T01-31-39Z__86aa40ddb7d085faad449ea3e1726b81949ef86b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 686,
                  "startColumn": 5,
                  "endLine": 724,
                  "endColumn": 29
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "main__2025-01-03T01-31-39Z__86aa40ddb7d085faad449ea3e1726b81949ef86b.yml",
          "workflow_name": "testing main branch",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 724,
          "num_jobs": 11,
          "steps_per_job": {
            "default-user-name-password": 4,
            "check-ssh-key": 6,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 10,
            "testing06": 4,
            "testing07": 4,
            "testing-capturing-output": 4,
            "testing-script-stop": 6,
            "testing-script-error": 3
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 11,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 4,
              "check-ssh-key": 6,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 10,
              "testing06": 4,
              "testing07": 4,
              "testing-capturing-output": 4,
              "testing-script-stop": 6,
              "testing-script-error": 3
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 4,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 35,
            "actions_used": [
              "./",
              "actions/checkout@v4",
              "fscarmen/warp-on-actions@v1.1"
            ],
            "num_run_commands": 20,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 4
          }
        }
      },
      "workflow_json": {
        "name": "testing main branch",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              },
              {
                "name": "ssh commands from a file",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script_path": "testdata/test.sh"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "./",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "pass secret variable in shell",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "cd ${{ secrets.PORT }}"
                }
              },
              {
                "name": "switch to root user",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          },
          "testing06": {
            "name": "testing ipv6",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up WARP",
                "uses": "fscarmen/warp-on-actions@v1.1",
                "with": {
                  "stack": "dual"
                }
              },
              {
                "name": "testing ipv6 for command",
                "run": "curl -m 9 --ipv6 --verbose https://google.com\n"
              },
              {
                "name": "testing ipv6",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "2402:1f00:8000:800::2628",
                  "username": "ubuntu",
                  "password": "${{ secrets.OVH_PASSWORD }}",
                  "protocol": "tcp6",
                  "port": 22,
                  "command_timeout": "30s",
                  "script": "whoami\n"
                }
              }
            ]
          },
          "testing07": {
            "name": "some special character",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set Environment Variables",
                "run": "PASS='3HUS$?8kLu)}'\nprintf \"PASS=${PASS}\" >> $GITHUB_ENV\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD='${{ env.PASS }}'  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "${{ env.PASS }}",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              }
            ]
          },
          "testing-capturing-output": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "id": "stdout",
                "name": "ssh command with stdout",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "capture_stdout": true,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              },
              {
                "name": "check stdout",
                "run": "echo \"stdout: ${{ steps.stdout.outputs.stdout }}\"\n"
              }
            ]
          },
          "testing-script-stop": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "id": "stdout01",
                "name": "ssh command with stdout 01",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "capture_stdout": true,
                  "script": "#!/usr/bin/env bash\nset -e\necho \"TMP TESTING IF\"\nif [[ \"2\" == \"1\" ]]; then\n  echo \"True\"\nelse\n  echo \"False\"\nfi\n"
                }
              },
              {
                "name": "check stdout 01",
                "run": "echo \"stdout: ${{ steps.stdout01.outputs.stdout }}\"\nif echo \"${{ steps.stdout01.outputs.stdout }}\" | grep -q \"True\"; then\n  echo \"Output contains 'True'\"\n  exit 1\nfi\nif echo \"${{ steps.stdout01.outputs.stdout }}\" | grep -q \"False\"; then\n  echo \"Output contains 'False'\"\nfi\n"
              },
              {
                "id": "stdout02",
                "name": "ssh command with stdout 01",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "capture_stdout": true,
                  "script": "#!/usr/bin/env bash\nset -e\necho \"TMP TESTING IF\"\nif [[ \"1\" == \"1\" ]]; then\n  echo \"True\"\nelse\n  echo \"False\"\nfi\n"
                }
              },
              {
                "name": "check stdout 02",
                "run": "echo \"stdout: ${{ steps.stdout02.outputs.stdout }}\"\nif echo \"${{ steps.stdout02.outputs.stdout }}\" | grep -q \"False\"; then\n  echo \"Output contains 'False'\"\n  exit 1\nfi\nif echo \"${{ steps.stdout02.outputs.stdout }}\" | grep -q \"True\"; then\n  echo \"Output contains 'True'\"\nfi\n"
              }
            ]
          },
          "testing-script-error": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "test script error",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "capture_stdout": true,
                  "script": "#!/usr/bin/env bash\nset -e\nls /nonexistent\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-05-18T03-26-30Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4d0fd21e-36d9-59a5-8076-ed7f95302d2e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-05-18T03-26-30Z__ffd1eec36471c1bfbebcf1941411db862c9b0e38.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 69,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-4218ff2b-8618-537e-8369-bb7867af7793",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-05-18T03-26-30Z__ffd1eec36471c1bfbebcf1941411db862c9b0e38.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 70,
                  "startColumn": 5,
                  "endLine": 141,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e882eb2d-5cd9-50ea-a01b-a6bd5532cce1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-05-18T03-26-30Z__ffd1eec36471c1bfbebcf1941411db862c9b0e38.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 142,
                  "startColumn": 5,
                  "endLine": 222,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-eb4055b4-6b66-536c-b824-cc8e0649ed82",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-05-18T03-26-30Z__ffd1eec36471c1bfbebcf1941411db862c9b0e38.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 223,
                  "startColumn": 5,
                  "endLine": 296,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-733f786c-02b5-5c63-9485-d2a6179f6c3a",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-05-18T03-26-30Z__ffd1eec36471c1bfbebcf1941411db862c9b0e38.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 297,
                  "startColumn": 5,
                  "endLine": 350,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-9f082eb9-0b38-53a2-ab83-237a98963997",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-05-18T03-26-30Z__ffd1eec36471c1bfbebcf1941411db862c9b0e38.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 351,
                  "startColumn": 5,
                  "endLine": 494,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "3ce8e927dec83061:5"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-07681756-3fee-5c84-925c-224a4ecd4c5f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-05-18T03-26-30Z__ffd1eec36471c1bfbebcf1941411db862c9b0e38.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 495,
                  "startColumn": 5,
                  "endLine": 523,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1b222a7ae19431ad:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1317559f-968b-59f4-86d1-96a2e9d3d3c4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-05-18T03-26-30Z__ffd1eec36471c1bfbebcf1941411db862c9b0e38.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 524,
                  "startColumn": 5,
                  "endLine": 568,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "191c7981684d03c0:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-fc65dc79-41e2-56d5-8176-b830a7905b48",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-05-18T03-26-30Z__ffd1eec36471c1bfbebcf1941411db862c9b0e38.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 569,
                  "startColumn": 5,
                  "endLine": 613,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:2"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c32cda2b-364d-5ee7-9545-214d9480e324",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-05-18T03-26-30Z__ffd1eec36471c1bfbebcf1941411db862c9b0e38.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 614,
                  "startColumn": 5,
                  "endLine": 700,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:3"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f3bbddf9-dbfa-51a4-a4d6-017ecfb8738e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/main__2025-05-18T03-26-30Z__ffd1eec36471c1bfbebcf1941411db862c9b0e38.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 701,
                  "startColumn": 5,
                  "endLine": 739,
                  "endColumn": 29
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "febdf5173e15a206:4"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "main__2025-05-18T03-26-30Z__ffd1eec36471c1bfbebcf1941411db862c9b0e38.yml",
          "workflow_name": "testing main branch",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 739,
          "num_jobs": 11,
          "steps_per_job": {
            "default-user-name-password": 5,
            "check-ssh-key": 6,
            "support-key-passphrase": 6,
            "multiple-server": 4,
            "support-ed25519-key": 4,
            "testing-with-env": 10,
            "testing06": 4,
            "testing07": 4,
            "testing-capturing-output": 4,
            "testing-script-stop": 6,
            "testing-script-error": 3
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 11,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "default-user-name-password": 5,
              "check-ssh-key": 6,
              "support-key-passphrase": 6,
              "multiple-server": 4,
              "support-ed25519-key": 4,
              "testing-with-env": 10,
              "testing06": 4,
              "testing07": 4,
              "testing-capturing-output": 4,
              "testing-script-stop": 6,
              "testing-script-error": 3
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 4,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 36,
            "actions_used": [
              "./",
              "actions/checkout@v4",
              "fscarmen/warp-on-actions@v1.1"
            ],
            "num_run_commands": 20,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 4
          }
        }
      },
      "workflow_json": {
        "name": "testing main branch",
        "true": [
          "push"
        ],
        "jobs": {
          "default-user-name-password": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              },
              {
                "name": "ssh commands from a file",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script_path": "testdata/test.sh"
                }
              },
              {
                "name": "multiple commands",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "script": "mkdir -p /tmp/test\necho \"hello world\" > /tmp/test/hello.txt\ncd /tmp/test\nls -al\ncat /tmp/test/hello.txt\n"
                }
              }
            ]
          },
          "check-ssh-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_rsa.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_rsa >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_rsa\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by private key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "wrong password but correct key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "abcdef",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami"
                }
              },
              {
                "name": "correct password but wrong key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "key": "password",
                  "port": 2222,
                  "script": "whoami"
                }
              }
            ]
          },
          "support-key-passphrase": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh key passphrase",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "missing ssh key passphrase",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "Multiline SSH commands interpreted as single lines",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "passphrase": 1234,
                  "script": "ls \\\n  -lah\n",
                  "use_insecure_cipher": true
                }
              }
            ]
          },
          "multiple-server": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_passphrase.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_passphrase >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_passphrase\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server-01 \\\n--hostname=openssh-server-01 \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-01 sh -c \"hostname -i\" > ip01.txt\necho \"REMOTE_HOST_01<<EOF\" >> $GITHUB_ENV\ncat ip01.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip01.txt\necho \"======================================\"\n\ndocker run -d \\\n--name=openssh-server-02 \\\n--hostname=openssh-server-02 \\\n-p 2223:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server-02 sh -c \"hostname -i\" > ip02.txt\necho \"REMOTE_HOST_02<<EOF\" >> $GITHUB_ENV\ncat ip02.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip02.txt\necho \"======================================\"\n\nsleep 2\n"
              },
              {
                "name": "Deployment to multiple hosts with different ports",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST_01 }}:2222,${{ env.REMOTE_HOST_02 }}:2222",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "passphrase": 1234,
                  "script": "whoami\n"
                }
              }
            ]
          },
          "support-ed25519-key": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              }
            ]
          },
          "testing-with-env": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "add public key to env",
                "run": "echo \"PUBLIC_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519.pub >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= public key =========\"\ncat testdata/.ssh/id_ed25519.pub\necho \"============================\"\necho \"PRIVATE_KEY<<EOF\" >> $GITHUB_ENV\ncat testdata/.ssh/id_ed25519 >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= private key =========\"\ncat testdata/.ssh/id_ed25519\necho \"============================\"\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e PUBLIC_KEY=\"${{ env.PUBLIC_KEY }}\" \\\n-e SUDO_ACCESS=true \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "testing id_ed25519 key",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "whoami\nls -al\n"
                }
              },
              {
                "name": "pass environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\n"
                }
              },
              {
                "name": "pass multiple environment",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "BAR": "FOO",
                  "SHA": "${{ github.sha }}",
                  "PORT": "${{ secrets.PORT }}"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,SHA,PORT",
                  "script": "echo \"I am $FOO, thanks\"\necho \"I am $BAR, thanks\"\necho \"sha: $SHA\"\necho \"port: $PORT\"\n"
                }
              },
              {
                "name": "custom envs format",
                "uses": "./",
                "env": {
                  "FOO": "BAR",
                  "AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "envs": "FOO,BAR,AAA",
                  "envs_format": "export TEST_{NAME}={VALUE}",
                  "script": "echo \"I am $TEST_FOO, thanks\"\necho \"I am $TEST_BAR, thanks\"\necho \"I am $BAR, thanks\"\necho \"I am $TEST_AAA, thanks\"\n"
                }
              },
              {
                "name": "pass all ENV variables to script",
                "uses": "./",
                "env": {
                  "INPUT_FOO": "BAR",
                  "INPUT_AAA": "BBB"
                },
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "allenvs": true,
                  "script": "echo \"I am $INPUT_FOO, thanks\"\necho \"I am $INPUT_AAA, thanks\"\necho \"$GITHUB_BASE_REF\"\necho \"$GITHUB_REF\"\n"
                }
              },
              {
                "name": "pass secret variable in shell",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "script": "cd ${{ secrets.PORT }}"
                }
              },
              {
                "name": "switch to root user",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "key": "${{ env.PRIVATE_KEY }}",
                  "port": 2222,
                  "request_pty": true,
                  "command_timeout": "30s",
                  "script": "whoami && echo 'hello world' && touch todo.txt\nsudo whoami\n"
                }
              }
            ]
          },
          "testing06": {
            "name": "testing ipv6",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set up WARP",
                "uses": "fscarmen/warp-on-actions@v1.1",
                "with": {
                  "stack": "dual"
                }
              },
              {
                "name": "testing ipv6 for command",
                "run": "curl -m 9 --ipv6 --verbose https://google.com\n"
              },
              {
                "name": "testing ipv6",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "2402:1f00:8000:800::2628",
                  "username": "ubuntu",
                  "password": "${{ secrets.OVH_PASSWORD }}",
                  "protocol": "tcp6",
                  "port": 22,
                  "command_timeout": "30s",
                  "script": "whoami\n"
                }
              }
            ]
          },
          "testing07": {
            "name": "some special character",
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Set Environment Variables",
                "run": "PASS='3HUS$?8kLu)}'\nprintf \"PASS=${PASS}\" >> $GITHUB_ENV\n"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD='${{ env.PASS }}'  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "ssh by username and password",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "${{ env.PASS }}",
                  "port": 2222,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              }
            ]
          },
          "testing-capturing-output": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "id": "stdout",
                "name": "ssh command with stdout",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "capture_stdout": true,
                  "script": "#!/usr/bin/env bash\nset -e\nwhoami\n"
                }
              },
              {
                "name": "check stdout",
                "run": "echo \"stdout: ${{ steps.stdout.outputs.stdout }}\"\n"
              }
            ]
          },
          "testing-script-stop": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "id": "stdout01",
                "name": "ssh command with stdout 01",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "capture_stdout": true,
                  "script": "#!/usr/bin/env bash\nset -e\necho \"TMP TESTING IF\"\nif [[ \"2\" == \"1\" ]]; then\n  echo \"True\"\nelse\n  echo \"False\"\nfi\n"
                }
              },
              {
                "name": "check stdout 01",
                "run": "echo \"stdout: ${{ steps.stdout01.outputs.stdout }}\"\nif echo \"${{ steps.stdout01.outputs.stdout }}\" | grep -q \"True\"; then\n  echo \"Output contains 'True'\"\n  exit 1\nfi\nif echo \"${{ steps.stdout01.outputs.stdout }}\" | grep -q \"False\"; then\n  echo \"Output contains 'False'\"\nfi\n"
              },
              {
                "id": "stdout02",
                "name": "ssh command with stdout 01",
                "uses": "./",
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "capture_stdout": true,
                  "script": "#!/usr/bin/env bash\nset -e\necho \"TMP TESTING IF\"\nif [[ \"1\" == \"1\" ]]; then\n  echo \"True\"\nelse\n  echo \"False\"\nfi\n"
                }
              },
              {
                "name": "check stdout 02",
                "run": "echo \"stdout: ${{ steps.stdout02.outputs.stdout }}\"\nif echo \"${{ steps.stdout02.outputs.stdout }}\" | grep -q \"False\"; then\n  echo \"Output contains 'False'\"\n  exit 1\nfi\nif echo \"${{ steps.stdout02.outputs.stdout }}\" | grep -q \"True\"; then\n  echo \"Output contains 'True'\"\nfi\n"
              }
            ]
          },
          "testing-script-error": {
            "runs-on": "ubuntu-latest",
            "steps": [
              {
                "name": "Checkout code",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "create new ssh server",
                "run": "docker run -d \\\n--name=openssh-server \\\n--hostname=openssh-server \\\n-p 2222:2222 \\\n-e SUDO_ACCESS=false \\\n-e PASSWORD_ACCESS=true  \\\n-e USER_PASSWORD=password  \\\n-e USER_NAME=linuxserver.io \\\n--restart unless-stopped \\\nlscr.io/linuxserver/openssh-server:latest\ndocker exec openssh-server sh -c \"hostname -i\" > ip.txt\necho \"REMOTE_HOST<<EOF\" >> $GITHUB_ENV\ncat ip.txt >> $GITHUB_ENV\necho \"EOF\" >> $GITHUB_ENV\necho \"======= container ip address =========\"\ncat ip.txt\necho \"======================================\"\nsleep 2\n"
              },
              {
                "name": "test script error",
                "uses": "./",
                "continue-on-error": true,
                "with": {
                  "host": "${{ env.REMOTE_HOST }}",
                  "username": "linuxserver.io",
                  "password": "password",
                  "port": 2222,
                  "capture_stdout": true,
                  "script": "#!/usr/bin/env bash\nset -e\nls /nonexistent\n"
                }
              }
            ]
          }
        }
      }
    }
  }
}