{
  "repo_owner": "ophub",
  "repo_name": "amlogic-s9xxx-armbian",
  "workflow_name": "compile-kernel-on-a-server",
  "history": {
    "2025-06-06T02-29-38Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-63a37122-ec74-514d-8fe8-049f1ac5ad30",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/compile-kernel-on-a-server__2025-06-06T02-29-38Z__50980f259431f9927e1e94dd9ea730c9e35903e4.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 95,
                  "startColumn": 5,
                  "endLine": 181,
                  "endColumn": 78
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f2db9c6d89149f6e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "compile-kernel-on-a-server__2025-06-06T02-29-38Z__50980f259431f9927e1e94dd9ea730c9e35903e4.yml",
          "workflow_name": "Compile the kernel on a server",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 181,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 3,
            "steps_with_conditionals": 2,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Compile the kernel on a server",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "kernel_source": {
                "description": "Select the kernel source",
                "required": false,
                "default": "unifreq",
                "type": "choice",
                "options": [
                  "unifreq",
                  "codesnas"
                ]
              },
              "kernel_version": {
                "description": "Select kernel version",
                "required": false,
                "default": "6.12.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.6.y_6.12.y",
                  "5.4.y_5.10.y_5.15.y",
                  "6.1.y_6.6.y_6.12.y",
                  "all"
                ]
              },
              "kernel_auto": {
                "description": "Auto use the latest kernel",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "silent_log": {
                "description": "Use silent logging",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "delete_source": {
                "description": "Delete the source after compilation",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_package": {
                "description": "Select compile package list",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "dtbs"
                ]
              },
              "kernel_toolchain": {
                "description": "Select the compilation toolchain",
                "required": false,
                "default": "gcc",
                "type": "choice",
                "options": [
                  "clang",
                  "gcc",
                  "gcc-14.2"
                ]
              },
              "compress_format": {
                "description": "Set the initrd compression format",
                "required": false,
                "default": "xz",
                "type": "choice",
                "options": [
                  "xz",
                  "gzip",
                  "zstd",
                  "lzma"
                ]
              },
              "kernel_sign": {
                "description": "Set the kernel custom signature",
                "required": false,
                "default": "-ophub",
                "type": "choice",
                "options": [
                  "-ophub",
                  "-yourname"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04-arm",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "id": "disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -hT\n"
              },
              {
                "name": "Create a mapped directory",
                "id": "mapped",
                "working-directory": "/builder",
                "run": "df -hT ${PWD}\nmkdir -p /builder/{kernel,output}\nln -sf /builder/kernel /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/compile-kernel/kernel\nln -sf /builder/output /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/compile-kernel/output\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile the kernel [ ${{ inputs.kernel_version }} ]",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.mapped.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "kernel",
                  "kernel_source": "${{ inputs.kernel_source }}",
                  "kernel_version": "${{ inputs.kernel_version }}",
                  "kernel_auto": "${{ inputs.kernel_auto }}",
                  "delete_source": "${{ inputs.delete_source }}",
                  "kernel_package": "${{ inputs.kernel_package }}",
                  "kernel_sign": "${{ inputs.kernel_sign }}",
                  "kernel_toolchain": "${{ inputs.kernel_toolchain }}",
                  "compress_format": "${{ inputs.compress_format }}",
                  "silent_log": "${{ inputs.silent_log }}"
                }
              },
              {
                "name": "Upload Kernel to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "kernel_stable",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "The kernel can be used to compile Armbian and OpenWrt.\nThe kernel source code comes from: ${{ inputs.kernel_source }}\nThe kernel compilation toolchain: ${{ inputs.kernel_toolchain }}\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-06-21T14-13-51Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-e076f67a-3a4d-5e5f-8d3a-c471bd6194f8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/compile-kernel-on-a-server__2025-06-21T14-13-51Z__87978de70f615515af036bcabd9562b38d7ec08e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 95,
                  "startColumn": 5,
                  "endLine": 181,
                  "endColumn": 78
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f2db9c6d89149f6e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "compile-kernel-on-a-server__2025-06-21T14-13-51Z__87978de70f615515af036bcabd9562b38d7ec08e.yml",
          "workflow_name": "Compile the kernel on a server",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 181,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 3,
            "steps_with_conditionals": 2,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Compile the kernel on a server",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "kernel_source": {
                "description": "Select the kernel source",
                "required": false,
                "default": "unifreq",
                "type": "choice",
                "options": [
                  "unifreq",
                  "codesnas"
                ]
              },
              "kernel_version": {
                "description": "Select kernel version",
                "required": false,
                "default": "5.4.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.6.y_6.12.y",
                  "5.4.y_5.10.y_5.15.y",
                  "6.1.y_6.6.y_6.12.y",
                  "all"
                ]
              },
              "kernel_auto": {
                "description": "Auto use the latest kernel",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "silent_log": {
                "description": "Use silent logging",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "delete_source": {
                "description": "Delete the source after compilation",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_package": {
                "description": "Select compile package list",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "dtbs"
                ]
              },
              "kernel_toolchain": {
                "description": "Select the compilation toolchain",
                "required": false,
                "default": "gcc",
                "type": "choice",
                "options": [
                  "clang",
                  "gcc",
                  "gcc-14.2"
                ]
              },
              "compress_format": {
                "description": "Set the initrd compression format",
                "required": false,
                "default": "xz",
                "type": "choice",
                "options": [
                  "xz",
                  "gzip",
                  "zstd",
                  "lzma"
                ]
              },
              "kernel_sign": {
                "description": "Set the kernel custom signature",
                "required": false,
                "default": "-ophub",
                "type": "choice",
                "options": [
                  "-ophub",
                  "-yourname"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04-arm",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "id": "disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -hT\n"
              },
              {
                "name": "Create a mapped directory",
                "id": "mapped",
                "working-directory": "/builder",
                "run": "df -hT ${PWD}\nmkdir -p /builder/{kernel,output}\nln -sf /builder/kernel /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/compile-kernel/kernel\nln -sf /builder/output /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/compile-kernel/output\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile the kernel [ ${{ inputs.kernel_version }} ]",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.mapped.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "kernel",
                  "kernel_source": "${{ inputs.kernel_source }}",
                  "kernel_version": "${{ inputs.kernel_version }}",
                  "kernel_auto": "${{ inputs.kernel_auto }}",
                  "delete_source": "${{ inputs.delete_source }}",
                  "kernel_package": "${{ inputs.kernel_package }}",
                  "kernel_sign": "${{ inputs.kernel_sign }}",
                  "kernel_toolchain": "${{ inputs.kernel_toolchain }}",
                  "compress_format": "${{ inputs.compress_format }}",
                  "silent_log": "${{ inputs.silent_log }}"
                }
              },
              {
                "name": "Upload Kernel to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "kernel_stable",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "The kernel can be used to compile Armbian and OpenWrt.\nThe kernel source code comes from: ${{ inputs.kernel_source }}\nThe kernel compilation toolchain: ${{ inputs.kernel_toolchain }}\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-08-12T12-48-33Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-918b58df-e403-543e-8e61-31b88da45379",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/compile-kernel-on-a-server__2025-08-12T12-48-33Z__0c79036619ccc71d81fe87e82aad5b48a4ce1faf.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 96,
                  "startColumn": 5,
                  "endLine": 182,
                  "endColumn": 78
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f2db9c6d89149f6e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "compile-kernel-on-a-server__2025-08-12T12-48-33Z__0c79036619ccc71d81fe87e82aad5b48a4ce1faf.yml",
          "workflow_name": "Compile the kernel on a server",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 182,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 3,
            "steps_with_conditionals": 2,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Compile the kernel on a server",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "kernel_source": {
                "description": "Select the kernel source",
                "required": false,
                "default": "unifreq",
                "type": "choice",
                "options": [
                  "unifreq",
                  "codesnas"
                ]
              },
              "kernel_version": {
                "description": "Select kernel version",
                "required": false,
                "default": "5.4.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.6.y_6.12.y",
                  "5.4.y_5.10.y_5.15.y",
                  "6.1.y_6.6.y_6.12.y",
                  "all"
                ]
              },
              "kernel_auto": {
                "description": "Auto use the latest kernel",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "silent_log": {
                "description": "Use silent logging",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "delete_source": {
                "description": "Delete the source after compilation",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_package": {
                "description": "Select compile package list",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "dtbs"
                ]
              },
              "kernel_toolchain": {
                "description": "Select the compilation toolchain",
                "required": false,
                "default": "gcc",
                "type": "choice",
                "options": [
                  "clang",
                  "gcc",
                  "gcc-14.2",
                  "gcc-14.3"
                ]
              },
              "compress_format": {
                "description": "Set the initrd compression format",
                "required": false,
                "default": "xz",
                "type": "choice",
                "options": [
                  "xz",
                  "gzip",
                  "zstd",
                  "lzma"
                ]
              },
              "kernel_sign": {
                "description": "Set the kernel custom signature",
                "required": false,
                "default": "-ophub",
                "type": "choice",
                "options": [
                  "-ophub",
                  "-yourname"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04-arm",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "id": "disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -hT\n"
              },
              {
                "name": "Create a mapped directory",
                "id": "mapped",
                "working-directory": "/builder",
                "run": "df -hT ${PWD}\nmkdir -p /builder/{kernel,output}\nln -sf /builder/kernel /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/compile-kernel/kernel\nln -sf /builder/output /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/compile-kernel/output\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile the kernel [ ${{ inputs.kernel_version }} ]",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.mapped.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "kernel",
                  "kernel_source": "${{ inputs.kernel_source }}",
                  "kernel_version": "${{ inputs.kernel_version }}",
                  "kernel_auto": "${{ inputs.kernel_auto }}",
                  "delete_source": "${{ inputs.delete_source }}",
                  "kernel_package": "${{ inputs.kernel_package }}",
                  "kernel_sign": "${{ inputs.kernel_sign }}",
                  "kernel_toolchain": "${{ inputs.kernel_toolchain }}",
                  "compress_format": "${{ inputs.compress_format }}",
                  "silent_log": "${{ inputs.silent_log }}"
                }
              },
              {
                "name": "Upload Kernel to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "kernel_stable",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "The kernel can be used to compile Armbian and OpenWrt.\nThe kernel source code comes from: ${{ inputs.kernel_source }}\nThe kernel compilation toolchain: ${{ inputs.kernel_toolchain }}\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-09-01T01-39-47Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-46339b9d-8381-5bdf-ad5d-69ec738c72aa",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/compile-kernel-on-a-server__2025-09-01T01-39-47Z__203cfbd0fd727b95519f55e193586cf6168bbed7.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 96,
                  "startColumn": 5,
                  "endLine": 182,
                  "endColumn": 78
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f2db9c6d89149f6e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "compile-kernel-on-a-server__2025-09-01T01-39-47Z__203cfbd0fd727b95519f55e193586cf6168bbed7.yml",
          "workflow_name": "Compile the kernel on a server",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 182,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 3,
            "steps_with_conditionals": 2,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Compile the kernel on a server",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "kernel_source": {
                "description": "Select the kernel source",
                "required": false,
                "default": "unifreq",
                "type": "choice",
                "options": [
                  "unifreq",
                  "codesnas"
                ]
              },
              "kernel_version": {
                "description": "Select kernel version",
                "required": false,
                "default": "6.12.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.6.y_6.12.y",
                  "5.4.y_5.10.y_5.15.y",
                  "6.1.y_6.6.y_6.12.y",
                  "all"
                ]
              },
              "kernel_auto": {
                "description": "Auto use the latest kernel",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "silent_log": {
                "description": "Use silent logging",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "delete_source": {
                "description": "Delete the source after compilation",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_package": {
                "description": "Select compile package list",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "dtbs"
                ]
              },
              "kernel_toolchain": {
                "description": "Select the compilation toolchain",
                "required": false,
                "default": "gcc",
                "type": "choice",
                "options": [
                  "clang",
                  "gcc",
                  "gcc-14.2",
                  "gcc-14.3"
                ]
              },
              "compress_format": {
                "description": "Set the initrd compression format",
                "required": false,
                "default": "xz",
                "type": "choice",
                "options": [
                  "xz",
                  "gzip",
                  "zstd",
                  "lzma"
                ]
              },
              "kernel_sign": {
                "description": "Set the kernel custom signature",
                "required": false,
                "default": "-ophub",
                "type": "choice",
                "options": [
                  "-ophub",
                  "-yourname"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04-arm",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "id": "disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -hT\n"
              },
              {
                "name": "Create a mapped directory",
                "id": "mapped",
                "working-directory": "/builder",
                "run": "df -hT ${PWD}\nmkdir -p /builder/{kernel,output}\nln -sf /builder/kernel /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/compile-kernel/kernel\nln -sf /builder/output /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/compile-kernel/output\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile the kernel [ ${{ inputs.kernel_version }} ]",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.mapped.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "kernel",
                  "kernel_source": "${{ inputs.kernel_source }}",
                  "kernel_version": "${{ inputs.kernel_version }}",
                  "kernel_auto": "${{ inputs.kernel_auto }}",
                  "delete_source": "${{ inputs.delete_source }}",
                  "kernel_package": "${{ inputs.kernel_package }}",
                  "kernel_sign": "${{ inputs.kernel_sign }}",
                  "kernel_toolchain": "${{ inputs.kernel_toolchain }}",
                  "compress_format": "${{ inputs.compress_format }}",
                  "silent_log": "${{ inputs.silent_log }}"
                }
              },
              {
                "name": "Upload Kernel to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "kernel_stable",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "The kernel can be used to compile Armbian and OpenWrt.\nThe kernel source code comes from: ${{ inputs.kernel_source }}\nThe kernel compilation toolchain: ${{ inputs.kernel_toolchain }}\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-09-01T05-12-08Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-023935f5-6ad5-5279-acc0-6a90435aa2a1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/compile-kernel-on-a-server__2025-09-01T05-12-08Z__85643d242aed8a66c9fb0232ca804bbcd9ea638b.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 96,
                  "startColumn": 5,
                  "endLine": 184,
                  "endColumn": 78
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f2db9c6d89149f6e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "compile-kernel-on-a-server__2025-09-01T05-12-08Z__85643d242aed8a66c9fb0232ca804bbcd9ea638b.yml",
          "workflow_name": "Compile the kernel on a server",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 184,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 3,
            "steps_with_conditionals": 2,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Compile the kernel on a server",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "kernel_source": {
                "description": "Select the kernel source",
                "required": false,
                "default": "unifreq",
                "type": "choice",
                "options": [
                  "unifreq",
                  "codesnas"
                ]
              },
              "kernel_version": {
                "description": "Select kernel version",
                "required": false,
                "default": "6.12.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.6.y_6.12.y",
                  "5.4.y_5.10.y_5.15.y",
                  "6.1.y_6.6.y_6.12.y",
                  "all"
                ]
              },
              "kernel_auto": {
                "description": "Auto use the latest kernel",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "silent_log": {
                "description": "Use silent logging",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "delete_source": {
                "description": "Delete the source after compilation",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_package": {
                "description": "Select compile package list",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "dtbs"
                ]
              },
              "kernel_toolchain": {
                "description": "Select the compilation toolchain",
                "required": false,
                "default": "gcc",
                "type": "choice",
                "options": [
                  "clang",
                  "gcc",
                  "gcc-14.2",
                  "gcc-14.3"
                ]
              },
              "compress_format": {
                "description": "Set the initrd compression format",
                "required": false,
                "default": "xz",
                "type": "choice",
                "options": [
                  "xz",
                  "gzip",
                  "zstd",
                  "lzma"
                ]
              },
              "kernel_sign": {
                "description": "Set the kernel custom signature",
                "required": false,
                "default": "-ophub",
                "type": "choice",
                "options": [
                  "-ophub",
                  "-yourname"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04-arm",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo -E timedatectl set-timezone \"${TZ}\"\nsudo -E apt-get install -y ntpdate\nsudo -E ntpdate pool.ntp.org\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "id": "disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -hT\n"
              },
              {
                "name": "Create a mapped directory",
                "id": "mapped",
                "working-directory": "/builder",
                "run": "df -hT ${PWD}\nmkdir -p /builder/{kernel,output}\nln -sf /builder/kernel /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/compile-kernel/kernel\nln -sf /builder/output /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/compile-kernel/output\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile the kernel [ ${{ inputs.kernel_version }} ]",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.mapped.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "kernel",
                  "kernel_source": "${{ inputs.kernel_source }}",
                  "kernel_version": "${{ inputs.kernel_version }}",
                  "kernel_auto": "${{ inputs.kernel_auto }}",
                  "delete_source": "${{ inputs.delete_source }}",
                  "kernel_package": "${{ inputs.kernel_package }}",
                  "kernel_sign": "${{ inputs.kernel_sign }}",
                  "kernel_toolchain": "${{ inputs.kernel_toolchain }}",
                  "compress_format": "${{ inputs.compress_format }}",
                  "silent_log": "${{ inputs.silent_log }}"
                }
              },
              {
                "name": "Upload Kernel to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "kernel_stable",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "The kernel can be used to compile Armbian and OpenWrt.\nThe kernel source code comes from: ${{ inputs.kernel_source }}\nThe kernel compilation toolchain: ${{ inputs.kernel_toolchain }}\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-09-01T09-42-48Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c0db01e4-d8de-506c-8d2b-01f9f1ed2727",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/compile-kernel-on-a-server__2025-09-01T09-42-48Z__3e1dbb2461344ee272d9644b70bceabdfe93c3da.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 96,
                  "startColumn": 5,
                  "endLine": 184,
                  "endColumn": 78
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "f2db9c6d89149f6e:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "compile-kernel-on-a-server__2025-09-01T09-42-48Z__3e1dbb2461344ee272d9644b70bceabdfe93c3da.yml",
          "workflow_name": "Compile the kernel on a server",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 184,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 6
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 6
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/amlogic-s9xxx-armbian@main"
            ],
            "num_run_commands": 3,
            "steps_with_conditionals": 2,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Compile the kernel on a server",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "kernel_source": {
                "description": "Select the kernel source",
                "required": false,
                "default": "unifreq",
                "type": "choice",
                "options": [
                  "unifreq",
                  "codesnas"
                ]
              },
              "kernel_version": {
                "description": "Select kernel version",
                "required": false,
                "default": "6.12.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.6.y_6.12.y",
                  "5.4.y_5.10.y_5.15.y",
                  "6.1.y_6.6.y_6.12.y",
                  "all"
                ]
              },
              "kernel_auto": {
                "description": "Auto use the latest kernel",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "silent_log": {
                "description": "Use silent logging",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "delete_source": {
                "description": "Delete the source after compilation",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "kernel_package": {
                "description": "Select compile package list",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "dtbs"
                ]
              },
              "kernel_toolchain": {
                "description": "Select the compilation toolchain",
                "required": false,
                "default": "gcc",
                "type": "choice",
                "options": [
                  "clang",
                  "gcc",
                  "gcc-14.2",
                  "gcc-14.3"
                ]
              },
              "compress_format": {
                "description": "Set the initrd compression format",
                "required": false,
                "default": "xz",
                "type": "choice",
                "options": [
                  "xz",
                  "gzip",
                  "zstd",
                  "lzma"
                ]
              },
              "kernel_sign": {
                "description": "Set the kernel custom signature",
                "required": false,
                "default": "-ophub",
                "type": "choice",
                "options": [
                  "-ophub",
                  "-yourname"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "Etc/UTC"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04-arm",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-build-armbian)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo -E timedatectl set-timezone \"${TZ}\"\nsudo -E apt-get install -y ntpdate\nsudo -E ntpdate pool.ntp.org\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "id": "disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -hT\n"
              },
              {
                "name": "Create a mapped directory",
                "id": "mapped",
                "working-directory": "/builder",
                "run": "df -hT ${PWD}\nmkdir -p /builder/{kernel,output}\nln -sf /builder/kernel /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/compile-kernel/kernel\nln -sf /builder/output /home/runner/work/_actions/ophub/amlogic-s9xxx-armbian/main/compile-kernel/output\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Compile the kernel [ ${{ inputs.kernel_version }} ]",
                "uses": "ophub/amlogic-s9xxx-armbian@main",
                "if": "${{ steps.mapped.outputs.status }} == 'success' && !cancelled()",
                "with": {
                  "build_target": "kernel",
                  "kernel_source": "${{ inputs.kernel_source }}",
                  "kernel_version": "${{ inputs.kernel_version }}",
                  "kernel_auto": "${{ inputs.kernel_auto }}",
                  "delete_source": "${{ inputs.delete_source }}",
                  "kernel_package": "${{ inputs.kernel_package }}",
                  "kernel_sign": "${{ inputs.kernel_sign }}",
                  "kernel_toolchain": "${{ inputs.kernel_toolchain }}",
                  "compress_format": "${{ inputs.compress_format }}",
                  "silent_log": "${{ inputs.silent_log }}"
                }
              },
              {
                "name": "Upload Kernel to Release",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "kernel_stable",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "The kernel can be used to compile Armbian and OpenWrt.\nThe kernel source code comes from: ${{ inputs.kernel_source }}\nThe kernel compilation toolchain: ${{ inputs.kernel_toolchain }}\n"
                }
              }
            ]
          }
        }
      }
    }
  }
}