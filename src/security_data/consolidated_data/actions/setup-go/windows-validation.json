{
  "repo_owner": "actions",
  "repo_name": "setup-go",
  "workflow_name": "windows-validation",
  "history": {
    "2023-08-12T19-56-36Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c2460800-2f64-50b7-b2be-e0b6de5e6e54",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2023-08-12T19-56-36Z__aabcd82874ac639eecd888d979c7170c6ad0d30e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 15,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5e10f8cbdf34adc3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-41499dd3-4907-55c6-8975-dbee8b0606c5",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2023-08-12T19-56-36Z__aabcd82874ac639eecd888d979c7170c6ad0d30e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 83,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "354a3bdcaccf9ddc:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-5de1c29e-74d0-571f-88d2-09c480211b17",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2023-08-12T19-56-36Z__aabcd82874ac639eecd888d979c7170c6ad0d30e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 84,
                  "startColumn": 5,
                  "endLine": 116,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "e6896ea7b9b98375:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d2b5b8b7-828c-5e65-9c44-d2e3f565ab85",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2023-08-12T19-56-36Z__aabcd82874ac639eecd888d979c7170c6ad0d30e.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 117,
                  "startColumn": 5,
                  "endLine": 139,
                  "endColumn": 6
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1228d96c553aacdf:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "windows-validation__2023-08-12T19-56-36Z__aabcd82874ac639eecd888d979c7170c6ad0d30e.yml",
          "workflow_name": "Validate Windows installation",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 139,
          "num_jobs": 4,
          "steps_per_job": {
            "create-link-if-not-default": 5,
            "find-default-go": 1,
            "dont-create-link-if-default": 4,
            "hostedtoolcache": 3
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 4,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 3,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "create-link-if-not-default": 5,
              "find-default-go": 1,
              "dont-create-link-if-default": 4,
              "hostedtoolcache": 3
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 7,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 6,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Validate Windows installation",
        "true": {
          "push": {
            "branches": [
              "main"
            ],
            "paths-ignore": [
              "**.md"
            ]
          },
          "pull_request": {
            "paths-ignore": [
              "**.md"
            ]
          }
        },
        "jobs": {
          "create-link-if-not-default": {
            "runs-on": "windows-latest",
            "name": "Validate if symlink is created",
            "strategy": {
              "matrix": {
                "cache": [
                  false,
                  true
                ],
                "go": [
                  "1.20.1"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Setup ${{ matrix.cache }}, cache: ${{ matrix.go }}",
                "uses": "./",
                "with": {
                  "go-version": "${{ matrix.go }}",
                  "cache": "${{ matrix.cache }}"
                }
              },
              {
                "name": "Drive C: should have zero size link",
                "run": "du -m -s 'C:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64'\n# make sure drive c: contains only a link\nsize=$(du -m -s 'C:\\hostedtoolcache\\ windows\\go\\${{ matrix.go }}\\x64'|cut -f1 -d$'\\t')\nif [ $size -ne 0 ];then\n  echo 'Size of the link created on drive c: must be 0'\n  exit 1\nfi\n",
                "shell": "bash"
              },
              {
                "name": "Drive D: space usage should be below 1G",
                "run": "du -m -s 'D:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64'\nsize=$(du -m -s 'D:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64'|cut -f1 -d$'\\t')\n# make sure archive does not take lot of space\nif [ $size -gt 999 ];then\n  echo 'Size of installed on drive d: go is too big';\n  exit 1\nfi\n",
                "shell": "bash"
              },
              {
                "name": "Test paths and environments",
                "run": "echo $PATH\nwhich go\ngo version\ngo env\nif [ $(which go) != '/c/hostedtoolcache/windows/go/${{ matrix.go }}/x64/bin/go' ];then\n  echo 'which go should return \"/c/hostedtoolcache/windows/go/${{ matrix.go }}/x64/bin/go\"'\n  exit 1\nfi\nif [ $(go env GOROOT) != 'C:\\ hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64' ];then \n  echo 'go env GOROOT should return \"C:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64\"'\n  exit 1\nfi\n",
                "shell": "bash"
              }
            ]
          },
          "find-default-go": {
            "name": "Find default go version",
            "runs-on": "windows-latest",
            "outputs": {
              "version": "${{ steps.goversion.outputs.version }}"
            },
            "steps": [
              {
                "run": "version=`go env GOVERSION|sed s/^go//`\necho \"default go version: $version\"\necho \"version=$version\" >> \"$GITHUB_OUTPUT\"\n",
                "id": "goversion",
                "shell": "bash"
              }
            ]
          },
          "dont-create-link-if-default": {
            "name": "Validate if symlink is not created for default go",
            "runs-on": "windows-latest",
            "needs": "find-default-go",
            "strategy": {
              "matrix": {
                "cache": [
                  false,
                  true
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Setup default go, cache: ${{ matrix.cache }}",
                "uses": "./",
                "with": {
                  "go-version": "${{ needs.find-default-go.outputs.version }}",
                  "cache": "${{ matrix.cache }}"
                }
              },
              {
                "name": "Drive C: should have Go installation, cache: ${{ matrix.cache}}",
                "run": "size=$(du -m -s 'C:\\hostedtoolcache\\windows\\go\\${{ needs.find-default-go.outputs.version }}\\x64'|cut -f1 -d$'\\t')\nif [ $size -eq 0 ];then\n  echo 'Size of the hosted go installed on drive c: must be above zero'\n  exit 1\nfi\n",
                "shell": "bash"
              },
              {
                "name": "Drive D: should not have Go installation, cache: ${{ matrix.cache }}",
                "run": "if [ -e 'D:\\hostedtoolcache\\windows\\go\\${{ needs.find-default-go.outputs.version }}\\x64' ];then\n  echo 'D:\\hostedtoolcache\\windows\\go\\${{ needs.find-default-go.outputs.version }}\\x64 should not exist for hosted version of go';\n  exit 1\nfi\n",
                "shell": "bash"
              }
            ]
          },
          "hostedtoolcache": {
            "name": "Validate if hostedtoolcache works as expected",
            "runs-on": "windows-latest",
            "strategy": {
              "matrix": {
                "cache": [
                  false
                ],
                "go": [
                  "1.20.1"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Setup ${{ matrix.go }}, cache: ${{ matrix.cache }}",
                "uses": "./",
                "with": {
                  "go-version": "${{ matrix.go }}",
                  "cache": "${{ matrix.cache }}"
                }
              },
              {
                "name": "Setup ${{ matrix.go }}, cache: ${{ matrix.cache }} (from hostedtoolcache)",
                "uses": "./",
                "with": {
                  "go-version": "${{ matrix.go }}",
                  "cache": "${{ matrix.cache }}"
                }
              }
            ]
          }
        }
      }
    },
    "2023-08-03T12-33-56Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6a2a3a06-6c2d-54b1-b7f8-4f12c60b2ff9",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2023-08-03T12-33-56Z__93397bea11091df50f3d7e59dc26a7711a8bcfbe.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 15,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5e10f8cbdf34adc3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-32ee327c-de24-590f-9c49-3fbe72d57081",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2023-08-03T12-33-56Z__93397bea11091df50f3d7e59dc26a7711a8bcfbe.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 83,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "354a3bdcaccf9ddc:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-ed2b7293-ac5a-5e73-ae8d-920d5598a8ae",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2023-08-03T12-33-56Z__93397bea11091df50f3d7e59dc26a7711a8bcfbe.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 84,
                  "startColumn": 5,
                  "endLine": 114,
                  "endColumn": 21
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "e6896ea7b9b98375:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "windows-validation__2023-08-03T12-33-56Z__93397bea11091df50f3d7e59dc26a7711a8bcfbe.yml",
          "workflow_name": "Validate Windows installation",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 114,
          "num_jobs": 3,
          "steps_per_job": {
            "create-link-if-not-default": 5,
            "find-default-go": 1,
            "dont-create-link-if-default": 4
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 3,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 2,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "create-link-if-not-default": 5,
              "find-default-go": 1,
              "dont-create-link-if-default": 4
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 4,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 6,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Validate Windows installation",
        "true": {
          "push": {
            "branches": [
              "main"
            ],
            "paths-ignore": [
              "**.md"
            ]
          },
          "pull_request": {
            "paths-ignore": [
              "**.md"
            ]
          }
        },
        "jobs": {
          "create-link-if-not-default": {
            "runs-on": "windows-latest",
            "name": "Validate if symlink is created",
            "strategy": {
              "matrix": {
                "cache": [
                  false,
                  true
                ],
                "go": [
                  "1.20.1"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Setup ${{ matrix.cache }}, cache: ${{ matrix.go }}",
                "uses": "./",
                "with": {
                  "go-version": "${{ matrix.go }}",
                  "cache": "${{ matrix.cache }}"
                }
              },
              {
                "name": "Drive C: should have zero size link",
                "run": "du -m -s 'C:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64'\n# make sure drive c: contains only a link\nsize=$(du -m -s 'C:\\hostedtoolcache\\ windows\\go\\${{ matrix.go }}\\x64'|cut -f1 -d$'\\t')\nif [ $size -ne 0 ];then\n  echo 'Size of the link created on drive c: must be 0'\n  exit 1\nfi\n",
                "shell": "bash"
              },
              {
                "name": "Drive D: space usage should be below 1G",
                "run": "du -m -s 'D:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64'\nsize=$(du -m -s 'D:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64'|cut -f1 -d$'\\t')\n# make sure archive does not take lot of space\nif [ $size -gt 999 ];then\n  echo 'Size of installed on drive d: go is too big';\n  exit 1\nfi\n",
                "shell": "bash"
              },
              {
                "name": "Test paths and environments",
                "run": "echo $PATH\nwhich go\ngo version\ngo env\nif [ $(which go) != '/c/hostedtoolcache/windows/go/${{ matrix.go }}/x64/bin/go' ];then\n  echo 'which go should return \"/c/hostedtoolcache/windows/go/${{ matrix.go }}/x64/bin/go\"'\n  exit 1\nfi\nif [ $(go env GOROOT) != 'C:\\ hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64' ];then \n  echo 'go env GOROOT should return \"C:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64\"'\n  exit 1\nfi\n",
                "shell": "bash"
              }
            ]
          },
          "find-default-go": {
            "name": "Find default go version",
            "runs-on": "windows-latest",
            "outputs": {
              "version": "${{ steps.goversion.outputs.version }}"
            },
            "steps": [
              {
                "run": "version=`go env GOVERSION|sed s/^go//`\necho \"default go version: $version\"\necho \"version=$version\" >> \"$GITHUB_OUTPUT\"\n",
                "id": "goversion",
                "shell": "bash"
              }
            ]
          },
          "dont-create-link-if-default": {
            "name": "Validate if symlink is not created for default go",
            "runs-on": "windows-latest",
            "needs": "find-default-go",
            "strategy": {
              "matrix": {
                "cache": [
                  false,
                  true
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Setup default go, cache: ${{ matrix.cache }}",
                "uses": "./",
                "with": {
                  "go-version": "${{ needs.find-default-go.outputs.version }}",
                  "cache": "${{ matrix.cache }}"
                }
              },
              {
                "name": "Drive C: should have Go installation, cache: ${{ matrix.cache}}",
                "run": "size=$(du -m -s 'C:\\hostedtoolcache\\windows\\go\\${{ needs.find-default-go.outputs.version }}\\x64'|cut -f1 -d$'\\t')\nif [ $size -eq 0 ];then\n  echo 'Size of the hosted go installed on drive c: must be above zero'\n  exit 1\nfi\n",
                "shell": "bash"
              },
              {
                "name": "Drive D: should not have Go installation, cache: ${{ matrix.cache}}",
                "run": "if [ -e 'D:\\hostedtoolcache\\windows\\go\\${{ needs.find-default-go.outputs.version }}\\x64' ];then\n  echo 'D:\\hostedtoolcache\\windows\\go\\${{ needs.find-default-go.outputs.version }}\\x64 should not exist for hosted version of go';\n  exit 1\nfi\n",
                "shell": "bash"
              }
            ]
          }
        }
      }
    },
    "2023-08-12T21-57-09Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-93413e8a-f315-54aa-b74f-23840c2ed7c8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2023-08-12T21-57-09Z__48ac8fd236c79c21571daf4d4cbab6e189121007.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 15,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5e10f8cbdf34adc3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a6804e6d-69b0-56be-aa6c-4bf7e190a8a0",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2023-08-12T21-57-09Z__48ac8fd236c79c21571daf4d4cbab6e189121007.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 83,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "354a3bdcaccf9ddc:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-585e4943-e275-598e-9e7e-2210e72654a4",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2023-08-12T21-57-09Z__48ac8fd236c79c21571daf4d4cbab6e189121007.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 84,
                  "startColumn": 5,
                  "endLine": 116,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "e6896ea7b9b98375:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-18b815d3-7356-5866-9326-9115173fa0d1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2023-08-12T21-57-09Z__48ac8fd236c79c21571daf4d4cbab6e189121007.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 117,
                  "startColumn": 5,
                  "endLine": 136,
                  "endColumn": 38
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1228d96c553aacdf:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "windows-validation__2023-08-12T21-57-09Z__48ac8fd236c79c21571daf4d4cbab6e189121007.yml",
          "workflow_name": "Validate Windows installation",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 136,
          "num_jobs": 4,
          "steps_per_job": {
            "create-link-if-not-default": 5,
            "find-default-go": 1,
            "dont-create-link-if-default": 4,
            "hostedtoolcache": 3
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 4,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 3,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "create-link-if-not-default": 5,
              "find-default-go": 1,
              "dont-create-link-if-default": 4,
              "hostedtoolcache": 3
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 7,
            "actions_used": [
              "./",
              "actions/checkout@v3"
            ],
            "num_run_commands": 6,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Validate Windows installation",
        "true": {
          "push": {
            "branches": [
              "main"
            ],
            "paths-ignore": [
              "**.md"
            ]
          },
          "pull_request": {
            "paths-ignore": [
              "**.md"
            ]
          }
        },
        "jobs": {
          "create-link-if-not-default": {
            "runs-on": "windows-latest",
            "name": "Validate if symlink is created",
            "strategy": {
              "matrix": {
                "cache": [
                  false,
                  true
                ],
                "go": [
                  "1.20.1"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Setup ${{ matrix.cache }}, cache: ${{ matrix.go }}",
                "uses": "./",
                "with": {
                  "go-version": "${{ matrix.go }}",
                  "cache": "${{ matrix.cache }}"
                }
              },
              {
                "name": "Drive C: should have zero size link",
                "run": "du -m -s 'C:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64'\n# make sure drive c: contains only a link\nsize=$(du -m -s 'C:\\hostedtoolcache\\ windows\\go\\${{ matrix.go }}\\x64'|cut -f1 -d$'\\t')\nif [ $size -ne 0 ];then\n  echo 'Size of the link created on drive c: must be 0'\n  exit 1\nfi\n",
                "shell": "bash"
              },
              {
                "name": "Drive D: space usage should be below 1G",
                "run": "du -m -s 'D:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64'\nsize=$(du -m -s 'D:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64'|cut -f1 -d$'\\t')\n# make sure archive does not take lot of space\nif [ $size -gt 999 ];then\n  echo 'Size of installed on drive d: go is too big';\n  exit 1\nfi\n",
                "shell": "bash"
              },
              {
                "name": "Test paths and environments",
                "run": "echo $PATH\nwhich go\ngo version\ngo env\nif [ $(which go) != '/c/hostedtoolcache/windows/go/${{ matrix.go }}/x64/bin/go' ];then\n  echo 'which go should return \"/c/hostedtoolcache/windows/go/${{ matrix.go }}/x64/bin/go\"'\n  exit 1\nfi\nif [ $(go env GOROOT) != 'C:\\ hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64' ];then \n  echo 'go env GOROOT should return \"C:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64\"'\n  exit 1\nfi\n",
                "shell": "bash"
              }
            ]
          },
          "find-default-go": {
            "name": "Find default go version",
            "runs-on": "windows-latest",
            "outputs": {
              "version": "${{ steps.goversion.outputs.version }}"
            },
            "steps": [
              {
                "run": "version=`go env GOVERSION|sed s/^go//`\necho \"default go version: $version\"\necho \"version=$version\" >> \"$GITHUB_OUTPUT\"\n",
                "id": "goversion",
                "shell": "bash"
              }
            ]
          },
          "dont-create-link-if-default": {
            "name": "Validate if symlink is not created for default go",
            "runs-on": "windows-latest",
            "needs": "find-default-go",
            "strategy": {
              "matrix": {
                "cache": [
                  false,
                  true
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Setup default go, cache: ${{ matrix.cache }}",
                "uses": "./",
                "with": {
                  "go-version": "${{ needs.find-default-go.outputs.version }}",
                  "cache": "${{ matrix.cache }}"
                }
              },
              {
                "name": "Drive C: should have Go installation, cache: ${{ matrix.cache}}",
                "run": "size=$(du -m -s 'C:\\hostedtoolcache\\windows\\go\\${{ needs.find-default-go.outputs.version }}\\x64'|cut -f1 -d$'\\t')\nif [ $size -eq 0 ];then\n  echo 'Size of the hosted go installed on drive c: must be above zero'\n  exit 1\nfi\n",
                "shell": "bash"
              },
              {
                "name": "Drive D: should not have Go installation, cache: ${{ matrix.cache }}",
                "run": "if [ -e 'D:\\hostedtoolcache\\windows\\go\\${{ needs.find-default-go.outputs.version }}\\x64' ];then\n  echo 'D:\\hostedtoolcache\\windows\\go\\${{ needs.find-default-go.outputs.version }}\\x64 should not exist for hosted version of go';\n  exit 1\nfi\n",
                "shell": "bash"
              }
            ]
          },
          "hostedtoolcache": {
            "name": "Validate if hostedtoolcache works as expected",
            "runs-on": "windows-latest",
            "strategy": {
              "matrix": {
                "cache": [
                  false
                ],
                "go": [
                  "1.20.1"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v3"
              },
              {
                "name": "Setup ${{ matrix.go }}, cache: ${{ matrix.cache }}",
                "uses": "./",
                "with": {
                  "go-version": "${{ matrix.go }}",
                  "cache": "${{ matrix.cache }}"
                }
              },
              {
                "name": "Setup ${{ matrix.go }}, cache: ${{ matrix.cache }} (from hostedtoolcache)",
                "uses": "./",
                "with": {
                  "go-version": "${{ matrix.go }}",
                  "cache": "${{ matrix.cache }}"
                }
              }
            ]
          }
        }
      }
    },
    "2023-09-05T15-42-39Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6c1f63f8-ae8c-5aa3-a1bd-48b696d5f3e1",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2023-09-05T15-42-39Z__3d65fa57fcbfe4a359b6b71a6c65e6eec12984eb.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 15,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5e10f8cbdf34adc3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-2776e5e9-d861-5993-97ec-49f80430e3b8",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2023-09-05T15-42-39Z__3d65fa57fcbfe4a359b6b71a6c65e6eec12984eb.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 83,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "354a3bdcaccf9ddc:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c7ccade1-004c-5a6b-99b4-87fc2d35fa79",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2023-09-05T15-42-39Z__3d65fa57fcbfe4a359b6b71a6c65e6eec12984eb.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 84,
                  "startColumn": 5,
                  "endLine": 116,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "e6896ea7b9b98375:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-a9de77b7-d800-5bd5-bdaa-17f32b7307c7",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2023-09-05T15-42-39Z__3d65fa57fcbfe4a359b6b71a6c65e6eec12984eb.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 117,
                  "startColumn": 5,
                  "endLine": 136,
                  "endColumn": 38
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1228d96c553aacdf:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "windows-validation__2023-09-05T15-42-39Z__3d65fa57fcbfe4a359b6b71a6c65e6eec12984eb.yml",
          "workflow_name": "Validate Windows installation",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 136,
          "num_jobs": 4,
          "steps_per_job": {
            "create-link-if-not-default": 5,
            "find-default-go": 1,
            "dont-create-link-if-default": 4,
            "hostedtoolcache": 3
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 4,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 3,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "create-link-if-not-default": 5,
              "find-default-go": 1,
              "dont-create-link-if-default": 4,
              "hostedtoolcache": 3
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 7,
            "actions_used": [
              "./",
              "actions/checkout@v4"
            ],
            "num_run_commands": 6,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Validate Windows installation",
        "true": {
          "push": {
            "branches": [
              "main"
            ],
            "paths-ignore": [
              "**.md"
            ]
          },
          "pull_request": {
            "paths-ignore": [
              "**.md"
            ]
          }
        },
        "jobs": {
          "create-link-if-not-default": {
            "runs-on": "windows-latest",
            "name": "Validate if symlink is created",
            "strategy": {
              "matrix": {
                "cache": [
                  false,
                  true
                ],
                "go": [
                  "1.20.1"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Setup ${{ matrix.cache }}, cache: ${{ matrix.go }}",
                "uses": "./",
                "with": {
                  "go-version": "${{ matrix.go }}",
                  "cache": "${{ matrix.cache }}"
                }
              },
              {
                "name": "Drive C: should have zero size link",
                "run": "du -m -s 'C:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64'\n# make sure drive c: contains only a link\nsize=$(du -m -s 'C:\\hostedtoolcache\\ windows\\go\\${{ matrix.go }}\\x64'|cut -f1 -d$'\\t')\nif [ $size -ne 0 ];then\n  echo 'Size of the link created on drive c: must be 0'\n  exit 1\nfi\n",
                "shell": "bash"
              },
              {
                "name": "Drive D: space usage should be below 1G",
                "run": "du -m -s 'D:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64'\nsize=$(du -m -s 'D:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64'|cut -f1 -d$'\\t')\n# make sure archive does not take lot of space\nif [ $size -gt 999 ];then\n  echo 'Size of installed on drive d: go is too big';\n  exit 1\nfi\n",
                "shell": "bash"
              },
              {
                "name": "Test paths and environments",
                "run": "echo $PATH\nwhich go\ngo version\ngo env\nif [ $(which go) != '/c/hostedtoolcache/windows/go/${{ matrix.go }}/x64/bin/go' ];then\n  echo 'which go should return \"/c/hostedtoolcache/windows/go/${{ matrix.go }}/x64/bin/go\"'\n  exit 1\nfi\nif [ $(go env GOROOT) != 'C:\\ hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64' ];then\n  echo 'go env GOROOT should return \"C:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64\"'\n  exit 1\nfi\n",
                "shell": "bash"
              }
            ]
          },
          "find-default-go": {
            "name": "Find default go version",
            "runs-on": "windows-latest",
            "outputs": {
              "version": "${{ steps.goversion.outputs.version }}"
            },
            "steps": [
              {
                "run": "version=`go env GOVERSION|sed s/^go//`\necho \"default go version: $version\"\necho \"version=$version\" >> \"$GITHUB_OUTPUT\"\n",
                "id": "goversion",
                "shell": "bash"
              }
            ]
          },
          "dont-create-link-if-default": {
            "name": "Validate if symlink is not created for default go",
            "runs-on": "windows-latest",
            "needs": "find-default-go",
            "strategy": {
              "matrix": {
                "cache": [
                  false,
                  true
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Setup default go, cache: ${{ matrix.cache }}",
                "uses": "./",
                "with": {
                  "go-version": "${{ needs.find-default-go.outputs.version }}",
                  "cache": "${{ matrix.cache }}"
                }
              },
              {
                "name": "Drive C: should have Go installation, cache: ${{ matrix.cache}}",
                "run": "size=$(du -m -s 'C:\\hostedtoolcache\\windows\\go\\${{ needs.find-default-go.outputs.version }}\\x64'|cut -f1 -d$'\\t')\nif [ $size -eq 0 ];then\n  echo 'Size of the hosted go installed on drive c: must be above zero'\n  exit 1\nfi\n",
                "shell": "bash"
              },
              {
                "name": "Drive D: should not have Go installation, cache: ${{ matrix.cache }}",
                "run": "if [ -e 'D:\\hostedtoolcache\\windows\\go\\${{ needs.find-default-go.outputs.version }}\\x64' ];then\n  echo 'D:\\hostedtoolcache\\windows\\go\\${{ needs.find-default-go.outputs.version }}\\x64 should not exist for hosted version of go';\n  exit 1\nfi\n",
                "shell": "bash"
              }
            ]
          },
          "hostedtoolcache": {
            "name": "Validate if hostedtoolcache works as expected",
            "runs-on": "windows-latest",
            "strategy": {
              "matrix": {
                "cache": [
                  false
                ],
                "go": [
                  "1.20.1"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Setup ${{ matrix.go }}, cache: ${{ matrix.cache }}",
                "uses": "./",
                "with": {
                  "go-version": "${{ matrix.go }}",
                  "cache": "${{ matrix.cache }}"
                }
              },
              {
                "name": "Setup ${{ matrix.go }}, cache: ${{ matrix.cache }} (from hostedtoolcache)",
                "uses": "./",
                "with": {
                  "go-version": "${{ matrix.go }}",
                  "cache": "${{ matrix.cache }}"
                }
              }
            ]
          }
        }
      }
    },
    "2025-09-04T02-56-07Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-f82a4ff6-8b42-5820-a2f1-23932e1c73bf",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2025-09-04T02-56-07Z__44694675825211faa026b3c33043df3e48a5fa00.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 15,
                  "startColumn": 5,
                  "endLine": 70,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "5e10f8cbdf34adc3:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-1cf66e88-dd8e-5555-8d67-50d2af2c861f",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2025-09-04T02-56-07Z__44694675825211faa026b3c33043df3e48a5fa00.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 71,
                  "startColumn": 5,
                  "endLine": 83,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "354a3bdcaccf9ddc:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-6cb3d907-df0b-5f4f-be07-62ddf7b70440",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2025-09-04T02-56-07Z__44694675825211faa026b3c33043df3e48a5fa00.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 84,
                  "startColumn": 5,
                  "endLine": 116,
                  "endColumn": 3
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "e6896ea7b9b98375:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        },
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-c8cc77ba-15e7-5f52-8b97-52e2dbf6d951",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/windows-validation__2025-09-04T02-56-07Z__44694675825211faa026b3c33043df3e48a5fa00.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 117,
                  "startColumn": 5,
                  "endLine": 136,
                  "endColumn": 38
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "1228d96c553aacdf:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "windows-validation__2025-09-04T02-56-07Z__44694675825211faa026b3c33043df3e48a5fa00.yml",
          "workflow_name": "Validate Windows installation",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 136,
          "num_jobs": 4,
          "steps_per_job": {
            "create-link-if-not-default": 5,
            "find-default-go": 1,
            "dont-create-link-if-default": 4,
            "hostedtoolcache": 3
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 4,
            "num_dependencies_between_jobs": 1,
            "num_matrix_strategies": 3,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "create-link-if-not-default": 5,
              "find-default-go": 1,
              "dont-create-link-if-default": 4,
              "hostedtoolcache": 3
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 7,
            "actions_used": [
              "./",
              "actions/checkout@v5"
            ],
            "num_run_commands": 6,
            "steps_with_conditionals": 0,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Validate Windows installation",
        "true": {
          "push": {
            "branches": [
              "main"
            ],
            "paths-ignore": [
              "**.md"
            ]
          },
          "pull_request": {
            "paths-ignore": [
              "**.md"
            ]
          }
        },
        "jobs": {
          "create-link-if-not-default": {
            "runs-on": "windows-latest",
            "name": "Validate if symlink is created",
            "strategy": {
              "matrix": {
                "cache": [
                  false,
                  true
                ],
                "go": [
                  "1.20.1"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v5"
              },
              {
                "name": "Setup ${{ matrix.cache }}, cache: ${{ matrix.go }}",
                "uses": "./",
                "with": {
                  "go-version": "${{ matrix.go }}",
                  "cache": "${{ matrix.cache }}"
                }
              },
              {
                "name": "Drive C: should have zero size link",
                "run": "du -m -s 'C:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64'\n# make sure drive c: contains only a link\nsize=$(du -m -s 'C:\\hostedtoolcache\\ windows\\go\\${{ matrix.go }}\\x64'|cut -f1 -d$'\\t')\nif [ $size -ne 0 ];then\n  echo 'Size of the link created on drive c: must be 0'\n  exit 1\nfi\n",
                "shell": "bash"
              },
              {
                "name": "Drive D: space usage should be below 1G",
                "run": "du -m -s 'D:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64'\nsize=$(du -m -s 'D:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64'|cut -f1 -d$'\\t')\n# make sure archive does not take lot of space\nif [ $size -gt 999 ];then\n  echo 'Size of installed on drive d: go is too big';\n  exit 1\nfi\n",
                "shell": "bash"
              },
              {
                "name": "Test paths and environments",
                "run": "echo $PATH\nwhich go\ngo version\ngo env\nif [ $(which go) != '/c/hostedtoolcache/windows/go/${{ matrix.go }}/x64/bin/go' ];then\n  echo 'which go should return \"/c/hostedtoolcache/windows/go/${{ matrix.go }}/x64/bin/go\"'\n  exit 1\nfi\nif [ $(go env GOROOT) != 'C:\\ hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64' ];then\n  echo 'go env GOROOT should return \"C:\\hostedtoolcache\\windows\\go\\${{ matrix.go }}\\x64\"'\n  exit 1\nfi\n",
                "shell": "bash"
              }
            ]
          },
          "find-default-go": {
            "name": "Find default go version",
            "runs-on": "windows-latest",
            "outputs": {
              "version": "${{ steps.goversion.outputs.version }}"
            },
            "steps": [
              {
                "run": "version=`go env GOVERSION|sed s/^go//`\necho \"default go version: $version\"\necho \"version=$version\" >> \"$GITHUB_OUTPUT\"\n",
                "id": "goversion",
                "shell": "bash"
              }
            ]
          },
          "dont-create-link-if-default": {
            "name": "Validate if symlink is not created for default go",
            "runs-on": "windows-latest",
            "needs": "find-default-go",
            "strategy": {
              "matrix": {
                "cache": [
                  false,
                  true
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v5"
              },
              {
                "name": "Setup default go, cache: ${{ matrix.cache }}",
                "uses": "./",
                "with": {
                  "go-version": "${{ needs.find-default-go.outputs.version }}",
                  "cache": "${{ matrix.cache }}"
                }
              },
              {
                "name": "Drive C: should have Go installation, cache: ${{ matrix.cache}}",
                "run": "size=$(du -m -s 'C:\\hostedtoolcache\\windows\\go\\${{ needs.find-default-go.outputs.version }}\\x64'|cut -f1 -d$'\\t')\nif [ $size -eq 0 ];then\n  echo 'Size of the hosted go installed on drive c: must be above zero'\n  exit 1\nfi\n",
                "shell": "bash"
              },
              {
                "name": "Drive D: should not have Go installation, cache: ${{ matrix.cache }}",
                "run": "if [ -e 'D:\\hostedtoolcache\\windows\\go\\${{ needs.find-default-go.outputs.version }}\\x64' ];then\n  echo 'D:\\hostedtoolcache\\windows\\go\\${{ needs.find-default-go.outputs.version }}\\x64 should not exist for hosted version of go';\n  exit 1\nfi\n",
                "shell": "bash"
              }
            ]
          },
          "hostedtoolcache": {
            "name": "Validate if hostedtoolcache works as expected",
            "runs-on": "windows-latest",
            "strategy": {
              "matrix": {
                "cache": [
                  false
                ],
                "go": [
                  "1.20.1"
                ]
              }
            },
            "steps": [
              {
                "uses": "actions/checkout@v5"
              },
              {
                "name": "Setup ${{ matrix.go }}, cache: ${{ matrix.cache }}",
                "uses": "./",
                "with": {
                  "go-version": "${{ matrix.go }}",
                  "cache": "${{ matrix.cache }}"
                }
              },
              {
                "name": "Setup ${{ matrix.go }}, cache: ${{ matrix.cache }} (from hostedtoolcache)",
                "uses": "./",
                "with": {
                  "go-version": "${{ matrix.go }}",
                  "cache": "${{ matrix.cache }}"
                }
              }
            ]
          }
        }
      }
    }
  }
}