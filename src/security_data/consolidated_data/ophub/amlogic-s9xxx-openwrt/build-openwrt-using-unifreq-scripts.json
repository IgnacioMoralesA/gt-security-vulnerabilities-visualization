{
  "repo_owner": "ophub",
  "repo_name": "amlogic-s9xxx-openwrt",
  "workflow_name": "build-openwrt-using-unifreq-scripts",
  "history": {
    "2025-06-06T02-34-10Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d6758d68-a064-5ee5-a0cf-d0b987ac464b",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-openwrt-using-unifreq-scripts__2025-06-06T02-34-10Z__816ad9d1d758b7dfc5ca086a2fe57ee007487474.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 118,
                  "startColumn": 5,
                  "endLine": 246,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-openwrt-using-unifreq-scripts__2025-06-06T02-34-10Z__816ad9d1d758b7dfc5ca086a2fe57ee007487474.yml",
          "workflow_name": "Build OpenWrt using Unifreq scripts",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 246,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/flippy-openwrt-actions@main"
            ],
            "num_run_commands": 4,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build OpenWrt using Unifreq scripts",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "openwrt_soc": {
                "description": "Select device board",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "s922x_s905x3_s905x2_s912_s905d_s905",
                  "ak88",
                  "beikeyun",
                  "cm3",
                  "e20c",
                  "e24c",
                  "e25",
                  "e52c",
                  "e54c",
                  "ht2",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h69k-max",
                  "h88k",
                  "h88k-v3",
                  "jp-tvbox",
                  "l1pro",
                  "photonicat",
                  "qemu",
                  "r66s",
                  "r68s",
                  "rock5b",
                  "rock5c",
                  "rk3399",
                  "s905",
                  "s905d",
                  "s905x2",
                  "s905x3",
                  "s912",
                  "s922x",
                  "s922x-n2",
                  "vplus",
                  "watermelon-pi",
                  "zcube1-max",
                  "diy"
                ]
              },
              "customize_rk3399": {
                "description": "Set customize rk3399 devices",
                "required": false,
                "default": "none",
                "type": "choice",
                "options": [
                  "tvi3315a:rk3399-tvi3315a.dtb/sw799:rk3399-bozz-sw799.dtb",
                  "none"
                ]
              },
              "openwrt_kernel": {
                "description": "Select kernel version",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "kernel_repo": {
                "description": "Set the kernel repository",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel",
                  "breakingbadboy/OpenWrt"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "openwrt_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set OpenWrt builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel",
                  "yourname"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-make-openwrt)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo timedatectl set-timezone \"${TZ}\"\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download OpenWrt",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "armsr_tarfile_repo=\"ophub/amlogic-s9xxx-openwrt\"\nreleases_tag_keywords=\"OpenWrt_lede_\"\n\narmsr_tarfile_path=\"openwrt/output\"\n[[ -d \"${armsr_tarfile_path}\" ]] || mkdir -p ${armsr_tarfile_path}\nln -sf /builder/openwrt ${GITHUB_WORKSPACE}/openwrt\n\nlatest_version=$(curl -s \\\n      -H \"Accept: application/vnd.github+json\" \\\n      -H \"Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}\" \\\n      https://api.github.com/repos/${armsr_tarfile_repo}/releases?per_page=100 | \\\n      jq -r --arg RTK \"${releases_tag_keywords}\" \\\n      --arg BOARD \"-rootfs.tar.gz\" \\\n      '[.[] | select(.tag_name | contains($RTK))] |\n      map(.assets[] | select(.browser_download_url | endswith($BOARD))) |\n      sort_by(.updated_at) |\n      reverse |\n      .[0] |\n      {data: .updated_at, url: .browser_download_url}')\n\n[[ -z \"${latest_version}\" || \"${latest_version}\" == \"null\" ]] && echo \"Invalid OpenWrt rootfs download address.\" && exit 1\nlatest_updated_at=\"$(echo ${latest_version} | jq -r '.data')\"\nlatest_url=\"$(echo ${latest_version} | jq -r '.url')\"\n\nopenwrt_filename=\"${latest_url##*/}\"\ncurl -fsSL \"${latest_url}\" -o \"${armsr_tarfile_path}/${openwrt_filename}\"\n[[ \"${?}\" -ne \"0\" ]] && echo \"Invalid OpenWrt rootfs download address.\" && exit 1\n\necho \"build_tag=OpenWrt_armv8_${{ inputs.openwrt_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Clone packit source code",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "SCRIPT_REPO_URL=\"https://github.com/unifreq/openwrt_packit\"\nSCRIPT_REPO_BRANCH=\"master\"\nSELECT_PACKITPATH=\"openwrt_packit\"\ngit clone -q --single-branch --depth=1 --branch=${SCRIPT_REPO_BRANCH} ${SCRIPT_REPO_URL} ${SELECT_PACKITPATH}\nln -sf /builder/${SELECT_PACKITPATH} /opt/${SELECT_PACKITPATH}\n"
              },
              {
                "name": "Packaging OpenWrt",
                "uses": "ophub/flippy-openwrt-actions@main",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "env": {
                  "OPENWRT_ARMSR": "openwrt/output/*rootfs.tar.gz",
                  "SELECT_PACKITPATH": "openwrt_packit",
                  "PACKAGE_SOC": "${{ inputs.openwrt_soc }}",
                  "CUSTOMIZE_RK3399": "${{ inputs.customize_rk3399 }}",
                  "KERNEL_REPO_URL": "${{ inputs.kernel_repo }}",
                  "KERNEL_VERSION_NAME": "${{ inputs.openwrt_kernel }}",
                  "KERNEL_AUTO_LATEST": "${{ inputs.auto_kernel }}",
                  "WHOAMI": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload the packaged OpenWrt",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.down.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### OpenWrt Image information\n- Default IP: 192.168.1.1\n- Default username: root\n- Default password: password\n- Default WIFI name: OpenWrt\n- Default WIFI password: none\n### Install to EMMC\n- Login to OpenWrt \u2192 System \u2192 Amlogic Service \u2192 Install OpenWrt\n### OpenWrt source code\n- [lede](https://github.com/coolsnowwolf/lede)\n### OpenWrt Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-09-01T05-12-15Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d280308b-96f7-5a86-979d-2fcd8ad44f16",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-openwrt-using-unifreq-scripts__2025-09-01T05-12-15Z__57ed12ba24d2e40098cc5d72a003a06c73a8e70f.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 118,
                  "startColumn": 5,
                  "endLine": 248,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-openwrt-using-unifreq-scripts__2025-09-01T05-12-15Z__57ed12ba24d2e40098cc5d72a003a06c73a8e70f.yml",
          "workflow_name": "Build OpenWrt using Unifreq scripts",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 248,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/flippy-openwrt-actions@main"
            ],
            "num_run_commands": 4,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build OpenWrt using Unifreq scripts",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "openwrt_soc": {
                "description": "Select device board",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "s922x_s905x3_s905x2_s912_s905d_s905",
                  "ak88",
                  "beikeyun",
                  "cm3",
                  "e20c",
                  "e24c",
                  "e25",
                  "e52c",
                  "e54c",
                  "ht2",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h69k-max",
                  "h88k",
                  "h88k-v3",
                  "jp-tvbox",
                  "l1pro",
                  "photonicat",
                  "qemu",
                  "r66s",
                  "r68s",
                  "rock5b",
                  "rock5c",
                  "rk3399",
                  "s905",
                  "s905d",
                  "s905x2",
                  "s905x3",
                  "s912",
                  "s922x",
                  "s922x-n2",
                  "vplus",
                  "watermelon-pi",
                  "zcube1-max",
                  "diy"
                ]
              },
              "customize_rk3399": {
                "description": "Set customize rk3399 devices",
                "required": false,
                "default": "none",
                "type": "choice",
                "options": [
                  "tvi3315a:rk3399-tvi3315a.dtb/sw799:rk3399-bozz-sw799.dtb",
                  "none"
                ]
              },
              "openwrt_kernel": {
                "description": "Select kernel version",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "kernel_repo": {
                "description": "Set the kernel repository",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel",
                  "breakingbadboy/OpenWrt"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "openwrt_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set OpenWrt builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel",
                  "yourname"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "America/New_York"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-make-openwrt)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo -E timedatectl set-timezone \"${TZ}\"\nsudo -E apt-get install -y ntpdate\nsudo -E ntpdate pool.ntp.org\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download OpenWrt",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "armsr_tarfile_repo=\"ophub/amlogic-s9xxx-openwrt\"\nreleases_tag_keywords=\"OpenWrt_lede_\"\n\narmsr_tarfile_path=\"openwrt/output\"\n[[ -d \"${armsr_tarfile_path}\" ]] || mkdir -p ${armsr_tarfile_path}\nln -sf /builder/openwrt ${GITHUB_WORKSPACE}/openwrt\n\nlatest_version=$(curl -s \\\n      -H \"Accept: application/vnd.github+json\" \\\n      -H \"Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}\" \\\n      https://api.github.com/repos/${armsr_tarfile_repo}/releases?per_page=100 | \\\n      jq -r --arg RTK \"${releases_tag_keywords}\" \\\n      --arg BOARD \"-rootfs.tar.gz\" \\\n      '[.[] | select(.tag_name | contains($RTK))] |\n      map(.assets[] | select(.browser_download_url | endswith($BOARD))) |\n      sort_by(.updated_at) |\n      reverse |\n      .[0] |\n      {data: .updated_at, url: .browser_download_url}')\n\n[[ -z \"${latest_version}\" || \"${latest_version}\" == \"null\" ]] && echo \"Invalid OpenWrt rootfs download address.\" && exit 1\nlatest_updated_at=\"$(echo ${latest_version} | jq -r '.data')\"\nlatest_url=\"$(echo ${latest_version} | jq -r '.url')\"\n\nopenwrt_filename=\"${latest_url##*/}\"\ncurl -fsSL \"${latest_url}\" -o \"${armsr_tarfile_path}/${openwrt_filename}\"\n[[ \"${?}\" -ne \"0\" ]] && echo \"Invalid OpenWrt rootfs download address.\" && exit 1\n\necho \"build_tag=OpenWrt_armv8_${{ inputs.openwrt_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Clone packit source code",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "SCRIPT_REPO_URL=\"https://github.com/unifreq/openwrt_packit\"\nSCRIPT_REPO_BRANCH=\"master\"\nSELECT_PACKITPATH=\"openwrt_packit\"\ngit clone -q --single-branch --depth=1 --branch=${SCRIPT_REPO_BRANCH} ${SCRIPT_REPO_URL} ${SELECT_PACKITPATH}\nln -sf /builder/${SELECT_PACKITPATH} /opt/${SELECT_PACKITPATH}\n"
              },
              {
                "name": "Packaging OpenWrt",
                "uses": "ophub/flippy-openwrt-actions@main",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "env": {
                  "OPENWRT_ARMSR": "openwrt/output/*rootfs.tar.gz",
                  "SELECT_PACKITPATH": "openwrt_packit",
                  "PACKAGE_SOC": "${{ inputs.openwrt_soc }}",
                  "CUSTOMIZE_RK3399": "${{ inputs.customize_rk3399 }}",
                  "KERNEL_REPO_URL": "${{ inputs.kernel_repo }}",
                  "KERNEL_VERSION_NAME": "${{ inputs.openwrt_kernel }}",
                  "KERNEL_AUTO_LATEST": "${{ inputs.auto_kernel }}",
                  "WHOAMI": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload the packaged OpenWrt",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.down.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### OpenWrt Image information\n- Default IP: 192.168.1.1\n- Default username: root\n- Default password: password\n- Default WIFI name: OpenWrt\n- Default WIFI password: none\n### Install to EMMC\n- Login to OpenWrt \u2192 System \u2192 Amlogic Service \u2192 Install OpenWrt\n### OpenWrt source code\n- [lede](https://github.com/coolsnowwolf/lede)\n### OpenWrt Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    },
    "2025-09-01T09-42-55Z": {
      "vulnerability_list": [
        {
          "ruleId": "actions/missing-workflow-permissions",
          "ruleIndex": 0,
          "kind": "fail",
          "level": "warning",
          "correlationGuid": "workflow-d7e7b336-ec3e-5def-90d4-87e89083522e",
          "message": {
            "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/build-openwrt-using-unifreq-scripts__2025-09-01T09-42-55Z__eeced5d322e40fe751617b5c973100a7044868e3.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 118,
                  "startColumn": 5,
                  "endLine": 248,
                  "endColumn": 25
                }
              }
            }
          ],
          "partialFingerprints": {
            "primaryLocationLineHash": "60ea361c35d0a005:1"
          },
          "baselineState": "new",
          "properties": {
            "cwe": "CWE-275",
            "precision": "high",
            "security_severity": "5.0",
            "triage": "medium"
          }
        }
      ],
      "workflow_metadata": {
        "workflow_metadata": {
          "file_name": "build-openwrt-using-unifreq-scripts__2025-09-01T09-42-55Z__eeced5d322e40fe751617b5c973100a7044868e3.yml",
          "workflow_name": "Build OpenWrt using Unifreq scripts",
          "triggers": {},
          "permissions": null,
          "concurrency": null,
          "defaults": null,
          "line_count": 248,
          "num_jobs": 1,
          "steps_per_job": {
            "build": 7
          }
        },
        "workflow_metrics": {
          "workflow_level": {
            "num_jobs": 1,
            "num_dependencies_between_jobs": 0,
            "num_matrix_strategies": 0,
            "num_triggers_defined": 0
          },
          "job_level": {
            "num_steps_per_job": {
              "build": 7
            },
            "jobs_with_timeout": 0,
            "jobs_with_continue_on_error": 0,
            "num_distinct_runs_on": 1,
            "jobs_with_container": 0,
            "jobs_with_services": 0
          },
          "step_level": {
            "num_actions_uses": 3,
            "actions_used": [
              "actions/checkout@v4",
              "ncipollo/release-action@main",
              "ophub/flippy-openwrt-actions@main"
            ],
            "num_run_commands": 4,
            "steps_with_conditionals": 4,
            "steps_with_continue_on_error": 0
          }
        }
      },
      "workflow_json": {
        "name": "Build OpenWrt using Unifreq scripts",
        "true": {
          "repository_dispatch": null,
          "workflow_dispatch": {
            "inputs": {
              "openwrt_soc": {
                "description": "Select device board",
                "required": false,
                "default": "all",
                "type": "choice",
                "options": [
                  "all",
                  "s922x_s905x3_s905x2_s912_s905d_s905",
                  "ak88",
                  "beikeyun",
                  "cm3",
                  "e20c",
                  "e24c",
                  "e25",
                  "e52c",
                  "e54c",
                  "ht2",
                  "h28k",
                  "h66k",
                  "h68k",
                  "h69k",
                  "h69k-max",
                  "h88k",
                  "h88k-v3",
                  "jp-tvbox",
                  "l1pro",
                  "photonicat",
                  "qemu",
                  "r66s",
                  "r68s",
                  "rock5b",
                  "rock5c",
                  "rk3399",
                  "s905",
                  "s905d",
                  "s905x2",
                  "s905x3",
                  "s912",
                  "s922x",
                  "s922x-n2",
                  "vplus",
                  "watermelon-pi",
                  "zcube1-max",
                  "diy"
                ]
              },
              "customize_rk3399": {
                "description": "Set customize rk3399 devices",
                "required": false,
                "default": "none",
                "type": "choice",
                "options": [
                  "tvi3315a:rk3399-tvi3315a.dtb/sw799:rk3399-bozz-sw799.dtb",
                  "none"
                ]
              },
              "openwrt_kernel": {
                "description": "Select kernel version",
                "required": false,
                "default": "5.15.y_6.1.y",
                "type": "choice",
                "options": [
                  "5.4.y",
                  "5.10.y",
                  "5.15.y",
                  "6.1.y",
                  "6.6.y",
                  "6.12.y",
                  "5.4.y_5.10.y",
                  "5.15.y_6.1.y",
                  "6.1.y_6.12.y",
                  "6.1.y_6.6.y",
                  "6.6.y_6.12.y"
                ]
              },
              "kernel_repo": {
                "description": "Set the kernel repository",
                "required": false,
                "default": "ophub/kernel",
                "type": "choice",
                "options": [
                  "ophub/kernel",
                  "breakingbadboy/OpenWrt"
                ]
              },
              "auto_kernel": {
                "description": "Auto use the latest kernel",
                "required": false,
                "default": true,
                "type": "boolean"
              },
              "openwrt_storage": {
                "description": "Select image storage type.",
                "required": false,
                "default": "save",
                "type": "choice",
                "options": [
                  "save",
                  "temp"
                ]
              },
              "builder_name": {
                "description": "Set OpenWrt builder signature.",
                "required": false,
                "default": "ophub",
                "type": "choice",
                "options": [
                  "ophub",
                  "angel",
                  "yourname"
                ]
              }
            }
          }
        },
        "env": {
          "TZ": "Etc/UTC"
        },
        "jobs": {
          "build": {
            "runs-on": "ubuntu-22.04",
            "if": "${{ github.event.repository.owner.id }} == ${{ github.event.sender.id }}",
            "steps": [
              {
                "name": "Checkout",
                "uses": "actions/checkout@v4"
              },
              {
                "name": "Initialization environment",
                "id": "init",
                "env": {
                  "DEBIAN_FRONTEND": "noninteractive"
                },
                "run": "docker rmi $(docker images -q) 2>/dev/null\n[[ -n \"${AGENT_TOOLSDIRECTORY}\" ]] && sudo rm -rf \"${AGENT_TOOLSDIRECTORY}\"\nsudo rm -rf /usr/share/dotnet /usr/local/lib/android 2>/dev/null\nsudo swapoff -a\nsudo rm -f /swapfile /mnt/swapfile\nsudo -E apt-get -y update\nsudo -E apt-get -y purge azure-cli ghc* zulu* llvm* firefox google* dotnet* powershell openjdk* mongodb* moby* || true\nsudo -E apt-get -y install $(curl -fsSL https://tinyurl.com/ubuntu2204-make-openwrt)\nsudo -E systemctl daemon-reload\n#sudo -E apt-get -y full-upgrade\nsudo -E apt-get -y autoremove --purge\nsudo -E apt-get clean\nsudo sed -i '/NVM_DIR/d;/skel/d' /root/{.bashrc,.profile}\nsudo rm -rf ~/{.cargo,.dotnet,.rustup}\nsudo -E timedatectl set-timezone \"${TZ}\"\nsudo -E apt-get install -y ntpdate\nsudo -E ntpdate pool.ntp.org\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Create simulated physical disk",
                "run": "mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 1)\nroot_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\\..*//') - 4)\nsudo truncate -s \"${mnt_size}\"G /mnt/mnt.img\nsudo truncate -s \"${root_size}\"G /root.img\nsudo losetup /dev/loop6 /mnt/mnt.img\nsudo losetup /dev/loop7 /root.img\nsudo pvcreate /dev/loop6\nsudo pvcreate /dev/loop7\nsudo vgcreate github /dev/loop6 /dev/loop7\nsudo lvcreate -n runner -l 100%FREE github\nsudo mkfs.xfs /dev/github/runner\nsudo mkdir -p /builder\nsudo mount /dev/github/runner /builder\nsudo chown -R runner.runner /builder\ndf -Th\n"
              },
              {
                "name": "Download OpenWrt",
                "id": "down",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "armsr_tarfile_repo=\"ophub/amlogic-s9xxx-openwrt\"\nreleases_tag_keywords=\"OpenWrt_lede_\"\n\narmsr_tarfile_path=\"openwrt/output\"\n[[ -d \"${armsr_tarfile_path}\" ]] || mkdir -p ${armsr_tarfile_path}\nln -sf /builder/openwrt ${GITHUB_WORKSPACE}/openwrt\n\nlatest_version=$(curl -s \\\n      -H \"Accept: application/vnd.github+json\" \\\n      -H \"Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}\" \\\n      https://api.github.com/repos/${armsr_tarfile_repo}/releases?per_page=100 | \\\n      jq -r --arg RTK \"${releases_tag_keywords}\" \\\n      --arg BOARD \"-rootfs.tar.gz\" \\\n      '[.[] | select(.tag_name | contains($RTK))] |\n      map(.assets[] | select(.browser_download_url | endswith($BOARD))) |\n      sort_by(.updated_at) |\n      reverse |\n      .[0] |\n      {data: .updated_at, url: .browser_download_url}')\n\n[[ -z \"${latest_version}\" || \"${latest_version}\" == \"null\" ]] && echo \"Invalid OpenWrt rootfs download address.\" && exit 1\nlatest_updated_at=\"$(echo ${latest_version} | jq -r '.data')\"\nlatest_url=\"$(echo ${latest_version} | jq -r '.url')\"\n\nopenwrt_filename=\"${latest_url##*/}\"\ncurl -fsSL \"${latest_url}\" -o \"${armsr_tarfile_path}/${openwrt_filename}\"\n[[ \"${?}\" -ne \"0\" ]] && echo \"Invalid OpenWrt rootfs download address.\" && exit 1\n\necho \"build_tag=OpenWrt_armv8_${{ inputs.openwrt_storage }}_$(date +\"%Y.%m\")\" >> ${GITHUB_OUTPUT}\necho \"status=success\" >> ${GITHUB_OUTPUT}\n"
              },
              {
                "name": "Clone packit source code",
                "working-directory": "/builder",
                "if": "${{ steps.init.outputs.status }} == 'success' && !cancelled()",
                "run": "SCRIPT_REPO_URL=\"https://github.com/unifreq/openwrt_packit\"\nSCRIPT_REPO_BRANCH=\"master\"\nSELECT_PACKITPATH=\"openwrt_packit\"\ngit clone -q --single-branch --depth=1 --branch=${SCRIPT_REPO_BRANCH} ${SCRIPT_REPO_URL} ${SELECT_PACKITPATH}\nln -sf /builder/${SELECT_PACKITPATH} /opt/${SELECT_PACKITPATH}\n"
              },
              {
                "name": "Packaging OpenWrt",
                "uses": "ophub/flippy-openwrt-actions@main",
                "if": "${{ steps.down.outputs.status }} == 'success' && !cancelled()",
                "env": {
                  "OPENWRT_ARMSR": "openwrt/output/*rootfs.tar.gz",
                  "SELECT_PACKITPATH": "openwrt_packit",
                  "PACKAGE_SOC": "${{ inputs.openwrt_soc }}",
                  "CUSTOMIZE_RK3399": "${{ inputs.customize_rk3399 }}",
                  "KERNEL_REPO_URL": "${{ inputs.kernel_repo }}",
                  "KERNEL_VERSION_NAME": "${{ inputs.openwrt_kernel }}",
                  "KERNEL_AUTO_LATEST": "${{ inputs.auto_kernel }}",
                  "WHOAMI": "${{ inputs.builder_name }}"
                }
              },
              {
                "name": "Upload the packaged OpenWrt",
                "uses": "ncipollo/release-action@main",
                "if": "${{ env.PACKAGED_STATUS }} == 'success' && !cancelled()",
                "with": {
                  "tag": "${{ steps.down.outputs.build_tag }}",
                  "artifacts": "${{ env.PACKAGED_OUTPUTPATH }}/*",
                  "allowUpdates": true,
                  "removeArtifacts": false,
                  "replacesArtifacts": true,
                  "token": "${{ secrets.GITHUB_TOKEN }}",
                  "body": "### OpenWrt Image information\n- Default IP: 192.168.1.1\n- Default username: root\n- Default password: password\n- Default WIFI name: OpenWrt\n- Default WIFI password: none\n### Install to EMMC\n- Login to OpenWrt \u2192 System \u2192 Amlogic Service \u2192 Install OpenWrt\n### OpenWrt source code\n- [lede](https://github.com/coolsnowwolf/lede)\n### OpenWrt Image Verification\n- sha256sum\n"
                }
              }
            ]
          }
        }
      }
    }
  }
}